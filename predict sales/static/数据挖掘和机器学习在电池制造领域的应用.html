<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --mermaid-theme: default; --mermaid-sequence-numbers: off; --mermaid-flowchart-curve: linear; --mermaid--gantt-left-padding: 75; --sequence-theme: simple; }


:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-fences-math .MathJax_SVG_Display, .md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: visible; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; zoom: 90%; }
#math-inline-preview-content { zoom: 1.1; }
.MathJax_SVG * { transition: none 0s ease 0s; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-require-zoom-fix foreignobject { font-size: var(--mermaid-font-zoom); }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-math .MathJax_SVG_Display { margin-top: 8px; cursor: default; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}



</style><title>数据挖掘和机器学习在电池制造领域的应用</title>
</head>
<body class='typora-export os-windows typora-export-show-outline typora-export-collapse-outline'><div class='typora-export-content'>
<div class="typora-export-sidebar"><div class="outline-content"><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#导言">导言</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#i-何为数据挖掘">i. 何为数据挖掘？</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ii-数据挖掘概述">i.i. 数据挖掘概述</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#iii-数据挖掘过程">i.ii. 数据挖掘过程</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#ii-何为机器学习">ii. 何为机器学习？</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#iii-机器学习概述">ii.i. 机器学习概述</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#iiii-机器学习过程">ii.ii. 机器学习过程</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#iii-数据挖掘机器学习和人工智能">iii. 数据挖掘，机器学习和人工智能</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#iii-电池背后的数据应用逻辑">iii. 电池背后的数据应用逻辑</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#iiii-数据指标可量化">iii.i. 数据指标可量化</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#iiiii-内联性强关系复杂">iii.ii. 内联性强，关系复杂</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#从数据到应用">从数据到应用</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#锂离子电池制造一致性要求">锂离子电池制造一致性要求</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#数据维度大人力">数据维度大，人力</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#电池研制测试周期长时效性问题突出">电池研制测试周期长，时效性问题突出</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#电池构成体系复杂变量组合巨大">电池构成体系复杂，变量组合巨大,</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#文中出现的名词解释">文中出现的名词解释</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#文中默认的单位量纲">文中默认的单位量纲</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#文中部分编辑处理">文中部分编辑处理</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#1项目安排">1.项目安排</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#11-项目目的">1.1 项目目的</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#12-项目流程">1.2 项目流程</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#2-数据收集清洗">2. 数据收集、清洗</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h1"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3-探索性数据分析数据预处理上）">3. 探索性数据分析/数据预处理（上）</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#31-概述">3.1 概述</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#32-流程">3.2 流程</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#33-查看数据信息">3.3 查看数据信息</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#331-数据理解">3.3.1 数据理解</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3311-字段总数">3.3.1.1 字段总数</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3312-初步特征选择">3.3.1.2 初步特征选择</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3313-查看数据类型">3.3.1.3 查看数据类型</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#332-获取各统计量">3.3.2 获取各统计量</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#bonus-统计信息输出">BONUS: 统计信息输出</a></div><ul class="outline-children"></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34-数据特征分析">3.4 数据特征分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#341-分布分析">3.4.1 分布分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3411-离散变量分布情况">3.4.1.1 离散变量分布情况</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3412-连续变量分布情况">3.4.1.2 连续变量分布情况</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34121-单变量分析">3.4.1.2.1 单变量分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#341211-特征变量分析">3.4.1.2.1.1 特征变量分析</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#341212-标签变量分析">3.4.1.2.1.2 标签变量分析</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#341213-其它分析工具">3.4.1.2.1.3 其它分析工具</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34122-多变量分析">3.4.1.2.2 多变量分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#341221-二维变量分析">3.4.1.2.2.1 二维变量分析</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#341222-三维及高维变量分析">3.4.1.2.2.2 三维及高维变量分析</a></div><ul class="outline-children"></ul></li></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342-相关性分析">3.4.2 相关性分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3421-线性相关分析">3.4.2.1 线性相关分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34211-皮尔森相关系数">3.4.2.1.1 皮尔森相关系数</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342111-基本概念">3.4.2.1.1.1 基本概念</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342112-案例分析">3.4.2.1.1.2 案例分析</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34212-相关系数与回归系数">3.4.2.1.2 相关系数与回归系数</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342121-相关系数与回归系数的关系">3.4.2.1.2.1 相关系数与回归系数的关系</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342122-解释性分析">3.4.2.1.2.2 解释性分析</a></div><ul class="outline-children"></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#3422--方差分析anova）">3.4.2.2  方差分析（ANOVA）</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34221-基本概念">3.4.2.2.1 基本概念</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342211-实施步骤">3.4.2.2.1.1 实施步骤</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#34222-单因素方差分析">3.4.2.2.2 单因素方差分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#342221-案例分析">3.4.2.2.2.1 案例分析</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h5 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#bonussa软件上的anova分析">BONUS：SA软件上的ANOVA分析</a></div><ul class="outline-children"></ul></li></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h2 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#35-本章总结">3.5 本章总结</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h1 outline-item-open"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4-探索性数据分析数据预处理下）">4. 探索性数据分析/数据预处理（下）</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#41-缺失值分析">4.1 缺失值分析</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#411-缺失值来源">4.1.1 缺失值来源</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#412-缺失值检测">4.1.2 缺失值检测</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#413-缺失值处理">4.1.3 缺失值处理</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4131-人工填充">4.1.3.1 人工填充</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4132-特殊值填充">4.1.3.2 特殊值填充</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4133-统计量填充">4.1.3.3 统计量填充</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4134-相似填充">4.1.3.4 相似填充</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4135-插值法填充">4.1.3.5 插值法填充</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4136-使用模型预测缺失值">4.1.3.6 使用模型预测缺失值</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#案例分析随机森林预测缺失值"><strong>案例分析：随机森林预测缺失值</strong></a></div><ul class="outline-children"></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h2 outline-item-open"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#42-异常检测">4.2 异常检测</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#421-基本概念">4.2.1 基本概念</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#422-单变量异常检测">4.2.2 单变量异常检测</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4221-案例分析电池寿命异常检测">4.2.2.1 案例分析：电池寿命异常检测</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#42211-基于特征重要性的数据分组">4.2.2.1.1 基于特征重要性的数据分组</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#42211-基于统计学的算法">4.2.2.1.1 基于统计学的算法</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#422111-3σ原则">4.2.2.1.1.1 3σ原则</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#422112-四分位法箱线图分析法）">4.2.2.1.1.2 四分位法（箱线图分析法）</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h5 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#42212-基于孤立森林的异常检测">4.2.2.1.2 基于孤立森林的异常检测</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#42213-基于knn-的异常检测">4.2.2.1.3 <strong>基于KNN 的异常检测</strong></a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#42214-基于dbscan的异常检测">4.2.2.1.4 基于DBSCAN的异常检测</a></div><ul class="outline-children"></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#423-二变量异常检测">4.2.3 二变量异常检测</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4231-常见异常检测算法">4.2.3.1 常见异常检测算法</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4232-异常检测在锂电池测试领域的具体含义">4.2.3.2 异常检测在锂电池测试领域的具体含义  </a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4233-异常检测评价">4.2.3.3 异常检测评价</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4234-案例分析电池分容容量与首次容量的异常检测">4.2.3.4 案例分析：电池分容容量与首次容量的异常检测</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#424-多变量异常检测">4.2.4 多变量异常检测</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#4241-案例分析量产lfp10370c2-200mah电池循环百分比容量的异常检测">4.2.4.1 案例分析：量产LFP10370C2-200mAh电池循环百分比容量的异常检测</a></div><ul class="outline-children"></ul></li></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h1 outline-item-open"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5-特征工程">5. 特征工程</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h2 outline-item-open"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#51-特征工程在电池领域的应用">5.1 特征工程在电池领域的应用</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#511-特征困境">5.1.1 特征困境</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h3 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#512-特征工程对于电池设计的重要性">5.1.2 特征工程对于电池设计的重要性</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h2"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#52-数据预处理">5.2 数据预处理</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#521-无量纲化">5.2.1 无量纲化</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5211-标准化z-score-标准化）">5.2.1.1 标准化（Z-Score 标准化）</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5212-归一化min-max-缩放）">5.2.1.2 归一化（Min-Max 缩放）</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5213-区间缩放">5.2.1.3 区间缩放</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5214-样本归一化">5.2.1.4 样本归一化</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5215-范数">5.2.1.5 范数</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5216-不同无量纲处理的区别与应用场景">5.2.1.6 不同无量纲处理的区别与应用场景</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#522-分类变量编码离散化">5.2.2 分类变量编码/离散化</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5221-定量特征二值化">5.2.2.1 <strong>定量特征二值化</strong></a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5222-分箱编码">5.2.2.2 分箱编码</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h5 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#52221-无监督分箱">5.2.2.2.1 无监督分箱</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h5"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#52222-有监督分箱">5.2.2.2.2 有监督分箱</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#522221-卡方分箱">5.2.2.2.2.1 卡方分箱</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#522222-best-ks分箱">5.2.2.2.2.2 Best-KS分箱</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h6 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#522223-woe编码和iv">5.2.2.2.2.3 WOE编码和IV</a></div><ul class="outline-children"></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5223-利用woe和iv优化电池设计">5.2.2.3 利用WOE和IV优化电池设计</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5223-序列编码">5.2.2.3 序列编码</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5224-one-hot编码哑变量编码">5.2.2.4 One-Hot编码/哑变量编码</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5225-二进制编码">5.2.2.5 二进制编码</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5226-histgram-映射">5.2.2.6 Histgram 映射</a></div><ul class="outline-children"></ul></li></ul></li><li class="outline-item-wrapper outline-h3"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#523-数据变换">5.2.3 数据变换</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5231-对数变换">5.2.3.1 对数变换</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5232-多项式变换">5.2.3.2 多项式变换</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5233-幂变换">5.2.3.3 幂变换</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5234-box-cox-变换">5.2.3.4 Box-Cox 变换</a></div><ul class="outline-children"></ul></li></ul></li></ul></li><li class="outline-item-wrapper outline-h2 outline-item-open"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#53-特征选择">5.3 特征选择</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h3 outline-item-open"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#531-过滤法">5.3.1 过滤法</a></div><ul class="outline-children"><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5311-方差过滤">5.3.1.1 方差过滤</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#5312相关性过滤">5.3.1.2相关性过滤</a></div><ul class="outline-children"></ul></li><li class="outline-item-wrapper outline-h4 outline-item-single"><div class="outline-item"><span class="outline-expander"></span><a class="outline-label" href="#53121-卡方过滤">5.3.1.2.1 卡方过滤</a></div><ul class="outline-children"></ul></li></ul></li></ul></li></ul></li></div></div><div id='write'  class=''><center><font face="黑体" color="blue" size="5">数据挖掘和机器学习在锂离子电池工业领域的应用</font></center><p align="right"><font face="黑体" color="black" size="5">——吴睿滨</font></p><p>&nbsp;</p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n5"><a class="md-toc-inner" href="#导言">导言</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n6"><a class="md-toc-inner" href="#i-何为数据挖掘">i. 何为数据挖掘？</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n7"><a class="md-toc-inner" href="#ii-数据挖掘概述">i.i. 数据挖掘概述</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n18"><a class="md-toc-inner" href="#iii-数据挖掘过程">i.ii. 数据挖掘过程</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n24"><a class="md-toc-inner" href="#ii-何为机器学习">ii. 何为机器学习？</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n25"><a class="md-toc-inner" href="#iii-机器学习概述">ii.i. 机器学习概述</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n35"><a class="md-toc-inner" href="#iiii-机器学习过程">ii.ii. 机器学习过程</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n43"><a class="md-toc-inner" href="#iii-数据挖掘机器学习和人工智能">iii. 数据挖掘，机器学习和人工智能</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n54"><a class="md-toc-inner" href="#iii-电池背后的数据应用逻辑">iii. 电池背后的数据应用逻辑</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n55"><a class="md-toc-inner" href="#iiii-数据指标可量化">iii.i. 数据指标可量化</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n60"><a class="md-toc-inner" href="#iiiii-内联性强关系复杂">iii.ii. 内联性强，关系复杂</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n72"><a class="md-toc-inner" href="#从数据到应用">从数据到应用</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n92"><a class="md-toc-inner" href="#锂离子电池制造一致性要求">锂离子电池制造一致性要求</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n96"><a class="md-toc-inner" href="#数据维度大人力">数据维度大，人力</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n97"><a class="md-toc-inner" href="#电池研制测试周期长时效性问题突出">电池研制测试周期长，时效性问题突出</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n98"><a class="md-toc-inner" href="#电池构成体系复杂变量组合巨大">电池构成体系复杂，变量组合巨大,</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n99"><a class="md-toc-inner" href="#文中出现的名词解释">文中出现的名词解释</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n121"><a class="md-toc-inner" href="#文中默认的单位量纲">文中默认的单位量纲</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n144"><a class="md-toc-inner" href="#文中部分编辑处理">文中部分编辑处理</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n166"><a class="md-toc-inner" href="#1项目安排">1.项目安排</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n167"><a class="md-toc-inner" href="#11-项目目的">1.1 项目目的</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n169"><a class="md-toc-inner" href="#12-项目流程">1.2 项目流程</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n173"><a class="md-toc-inner" href="#2-数据收集清洗">2. 数据收集、清洗</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n174"><a class="md-toc-inner" href="#3-探索性数据分析数据预处理上）">3. 探索性数据分析/数据预处理（上）</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n175"><a class="md-toc-inner" href="#31-概述">3.1 概述</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n177"><a class="md-toc-inner" href="#32-流程">3.2 流程</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n182"><a class="md-toc-inner" href="#33-查看数据信息">3.3 查看数据信息</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n184"><a class="md-toc-inner" href="#331-数据理解">3.3.1 数据理解</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n185"><a class="md-toc-inner" href="#3311-字段总数">3.3.1.1 字段总数</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n189"><a class="md-toc-inner" href="#3312-初步特征选择">3.3.1.2 初步特征选择</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n193"><a class="md-toc-inner" href="#3313-查看数据类型">3.3.1.3 查看数据类型</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n240"><a class="md-toc-inner" href="#332-获取各统计量">3.3.2 获取各统计量</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n325"><a class="md-toc-inner" href="#bonus-统计信息输出">BONUS: 统计信息输出</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n329"><a class="md-toc-inner" href="#34-数据特征分析">3.4 数据特征分析</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n330"><a class="md-toc-inner" href="#341-分布分析">3.4.1 分布分析</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n332"><a class="md-toc-inner" href="#3411-离散变量分布情况">3.4.1.1 离散变量分布情况</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n345"><a class="md-toc-inner" href="#3412-连续变量分布情况">3.4.1.2 连续变量分布情况</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n346"><a class="md-toc-inner" href="#34121-单变量分析">3.4.1.2.1 单变量分析</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n347"><a class="md-toc-inner" href="#341211-特征变量分析">3.4.1.2.1.1 特征变量分析</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n365"><a class="md-toc-inner" href="#341212-标签变量分析">3.4.1.2.1.2 标签变量分析</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n369"><a class="md-toc-inner" href="#341213-其它分析工具">3.4.1.2.1.3 其它分析工具</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n379"><a class="md-toc-inner" href="#34122-多变量分析">3.4.1.2.2 多变量分析</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n381"><a class="md-toc-inner" href="#341221-二维变量分析">3.4.1.2.2.1 二维变量分析</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n463"><a class="md-toc-inner" href="#341222-三维及高维变量分析">3.4.1.2.2.2 三维及高维变量分析</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n523"><a class="md-toc-inner" href="#342-相关性分析">3.4.2 相关性分析</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n531"><a class="md-toc-inner" href="#3421-线性相关分析">3.4.2.1 线性相关分析</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n532"><a class="md-toc-inner" href="#34211-皮尔森相关系数">3.4.2.1.1 皮尔森相关系数</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n533"><a class="md-toc-inner" href="#342111-基本概念">3.4.2.1.1.1 基本概念</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n549"><a class="md-toc-inner" href="#342112-案例分析">3.4.2.1.1.2 案例分析</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n556"><a class="md-toc-inner" href="#34212-相关系数与回归系数">3.4.2.1.2 相关系数与回归系数</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n557"><a class="md-toc-inner" href="#342121-相关系数与回归系数的关系">3.4.2.1.2.1 相关系数与回归系数的关系</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n594"><a class="md-toc-inner" href="#342122-解释性分析">3.4.2.1.2.2 解释性分析</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n635"><a class="md-toc-inner" href="#3422--方差分析anova）">3.4.2.2  方差分析（ANOVA）</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n637"><a class="md-toc-inner" href="#34221-基本概念">3.4.2.2.1 基本概念</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n665"><a class="md-toc-inner" href="#342211-实施步骤">3.4.2.2.1.1 实施步骤</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n686"><a class="md-toc-inner" href="#34222-单因素方差分析">3.4.2.2.2 单因素方差分析</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n688"><a class="md-toc-inner" href="#342221-案例分析">3.4.2.2.2.1 案例分析</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n784"><a class="md-toc-inner" href="#bonussa软件上的anova分析">BONUS：SA软件上的ANOVA分析</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n811"><a class="md-toc-inner" href="#35-本章总结">3.5 本章总结</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n820"><a class="md-toc-inner" href="#4-探索性数据分析数据预处理下）">4. 探索性数据分析/数据预处理（下）</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n822"><a class="md-toc-inner" href="#41-缺失值分析">4.1 缺失值分析</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n826"><a class="md-toc-inner" href="#411-缺失值来源">4.1.1 缺失值来源</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n841"><a class="md-toc-inner" href="#412-缺失值检测">4.1.2 缺失值检测</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n858"><a class="md-toc-inner" href="#413-缺失值处理">4.1.3 缺失值处理</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n866"><a class="md-toc-inner" href="#4131-人工填充">4.1.3.1 人工填充</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n872"><a class="md-toc-inner" href="#4132-特殊值填充">4.1.3.2 特殊值填充</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n876"><a class="md-toc-inner" href="#4133-统计量填充">4.1.3.3 统计量填充</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n883"><a class="md-toc-inner" href="#4134-相似填充">4.1.3.4 相似填充</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n885"><a class="md-toc-inner" href="#4135-插值法填充">4.1.3.5 插值法填充</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n917"><a class="md-toc-inner" href="#4136-使用模型预测缺失值">4.1.3.6 使用模型预测缺失值</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n931"><a class="md-toc-inner" href="#案例分析随机森林预测缺失值"><strong>案例分析：随机森林预测缺失值</strong></a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1005"><a class="md-toc-inner" href="#42-异常检测">4.2 异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1006"><a class="md-toc-inner" href="#421-基本概念">4.2.1 基本概念</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1095"><a class="md-toc-inner" href="#422-单变量异常检测">4.2.2 单变量异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1097"><a class="md-toc-inner" href="#4221-案例分析电池寿命异常检测">4.2.2.1 案例分析：电池寿命异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n1109"><a class="md-toc-inner" href="#42211-基于特征重要性的数据分组">4.2.2.1.1 基于特征重要性的数据分组</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n1127"><a class="md-toc-inner" href="#42211-基于统计学的算法">4.2.2.1.1 基于统计学的算法</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n1129"><a class="md-toc-inner" href="#422111-3σ原则">4.2.2.1.1.1 3σ原则</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n1150"><a class="md-toc-inner" href="#422112-四分位法箱线图分析法）">4.2.2.1.1.2 四分位法（箱线图分析法）</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n1167"><a class="md-toc-inner" href="#42212-基于孤立森林的异常检测">4.2.2.1.2 基于孤立森林的异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n1192"><a class="md-toc-inner" href="#42213-基于knn-的异常检测">4.2.2.1.3 <strong>基于KNN 的异常检测</strong></a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n1214"><a class="md-toc-inner" href="#42214-基于dbscan的异常检测">4.2.2.1.4 基于DBSCAN的异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1274"><a class="md-toc-inner" href="#423-二变量异常检测">4.2.3 二变量异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1277"><a class="md-toc-inner" href="#4231-常见异常检测算法">4.2.3.1 常见异常检测算法</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1340"><a class="md-toc-inner" href="#4232-异常检测在锂电池测试领域的具体含义">4.2.3.2 异常检测在锂电池测试领域的具体含义  </a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1348"><a class="md-toc-inner" href="#4233-异常检测评价">4.2.3.3 异常检测评价</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1387"><a class="md-toc-inner" href="#4234-案例分析电池分容容量与首次容量的异常检测">4.2.3.4 案例分析：电池分容容量与首次容量的异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1432"><a class="md-toc-inner" href="#424-多变量异常检测">4.2.4 多变量异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1434"><a class="md-toc-inner" href="#4241-案例分析量产lfp10370c2-200mah电池循环百分比容量的异常检测">4.2.4.1 案例分析：量产LFP10370C2-200mAh电池循环百分比容量的异常检测</a></span><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n1462"><a class="md-toc-inner" href="#5-特征工程">5. 特征工程</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1477"><a class="md-toc-inner" href="#51-特征工程在电池领域的应用">5.1 特征工程在电池领域的应用</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1479"><a class="md-toc-inner" href="#511-特征困境">5.1.1 特征困境</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1489"><a class="md-toc-inner" href="#512-特征工程对于电池设计的重要性">5.1.2 特征工程对于电池设计的重要性</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1581"><a class="md-toc-inner" href="#52-数据预处理">5.2 数据预处理</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1599"><a class="md-toc-inner" href="#521-无量纲化">5.2.1 无量纲化</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1602"><a class="md-toc-inner" href="#5211-标准化z-score-标准化）">5.2.1.1 标准化（Z-Score 标准化）</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1606"><a class="md-toc-inner" href="#5212-归一化min-max-缩放）">5.2.1.2 归一化（Min-Max 缩放）</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1610"><a class="md-toc-inner" href="#5213-区间缩放">5.2.1.3 区间缩放</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1623"><a class="md-toc-inner" href="#5214-样本归一化">5.2.1.4 样本归一化</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1627"><a class="md-toc-inner" href="#5215-范数">5.2.1.5 范数</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1663"><a class="md-toc-inner" href="#5216-不同无量纲处理的区别与应用场景">5.2.1.6 不同无量纲处理的区别与应用场景</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1682"><a class="md-toc-inner" href="#522-分类变量编码离散化">5.2.2 分类变量编码/离散化</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1683"><a class="md-toc-inner" href="#5221-定量特征二值化">5.2.2.1 <strong>定量特征二值化</strong></a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1687"><a class="md-toc-inner" href="#5222-分箱编码">5.2.2.2 分箱编码</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n1705"><a class="md-toc-inner" href="#52221-无监督分箱">5.2.2.2.1 无监督分箱</a></span><span role="listitem" class="md-toc-item md-toc-h5" data-ref="n1759"><a class="md-toc-inner" href="#52222-有监督分箱">5.2.2.2.2 有监督分箱</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n1762"><a class="md-toc-inner" href="#522221-卡方分箱">5.2.2.2.2.1 卡方分箱</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n1878"><a class="md-toc-inner" href="#522222-best-ks分箱">5.2.2.2.2.2 Best-KS分箱</a></span><span role="listitem" class="md-toc-item md-toc-h6" data-ref="n1962"><a class="md-toc-inner" href="#522223-woe编码和iv">5.2.2.2.2.3 WOE编码和IV</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2168"><a class="md-toc-inner" href="#5223-利用woe和iv优化电池设计">5.2.2.3 利用WOE和IV优化电池设计</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2430"><a class="md-toc-inner" href="#5223-序列编码">5.2.2.3 序列编码</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2437"><a class="md-toc-inner" href="#5224-one-hot编码哑变量编码">5.2.2.4 One-Hot编码/哑变量编码</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2581"><a class="md-toc-inner" href="#5225-二进制编码">5.2.2.5 二进制编码</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2626"><a class="md-toc-inner" href="#5226-histgram-映射">5.2.2.6 Histgram 映射</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n2693"><a class="md-toc-inner" href="#523-数据变换">5.2.3 数据变换</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2695"><a class="md-toc-inner" href="#5231-对数变换">5.2.3.1 对数变换</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2701"><a class="md-toc-inner" href="#5232-多项式变换">5.2.3.2 多项式变换</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2726"><a class="md-toc-inner" href="#5233-幂变换">5.2.3.3 幂变换</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2730"><a class="md-toc-inner" href="#5234-box-cox-变换">5.2.3.4 Box-Cox 变换</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n2742"><a class="md-toc-inner" href="#53-特征选择">5.3 特征选择</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n2793"><a class="md-toc-inner" href="#531-过滤法">5.3.1 过滤法</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2796"><a class="md-toc-inner" href="#5311-方差过滤">5.3.1.1 方差过滤</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2810"><a class="md-toc-inner" href="#5312相关性过滤">5.3.1.2相关性过滤</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n2819"><a class="md-toc-inner" href="#53121-卡方过滤">5.3.1.2.1 卡方过滤</a></span></p></div><h1 id='导言'><span>导言</span></h1><h2 id='i-何为数据挖掘'><span>i. 何为数据挖掘？</span></h2><h3 id='ii-数据挖掘概述'><span>i.i. 数据挖掘概述</span></h3><ul><li><p><span>数据挖掘是一个用数据发现问题、解决问题的专业领域。</span></p></li><li><p><span>通常通过对数据的探索、处理、分析或建模实现。</span></p></li><li><p><span>把信息转化为价值，要经历信息、数据、知识、价值四个层面，数据挖掘就是中间的重要环节，是从数据中发现知识的过程。   </span></p><p><img src="pic\数据挖掘.jpg" alt="数据挖掘" style="zoom:67%;" /></p><center><a name="图i.1">数据挖掘</a></center><p>&nbsp;</p></li></ul><h3 id='iii-数据挖掘过程'><span>i.ii. 数据挖掘过程</span></h3><ul><li><span>简单地可以分为：数据收集、数据预处理、数据探索分析、模型应用、评估、知识展示等。</span></li><li><span>具体地划分的话，每个过程又能分为多个分支，如数据预处理其实可以再细分为数据清洗、数据探索分析、数据变换等。如果再继续细分，数据探索分析其实还可以再细分为分布分析、异常值处理，缺失值处理，数据变换可以再细分为数据类型转换，数据量纲处理等。可以说数据挖掘作为一个学术领域，横跨多个学科，涵盖了统计学、数学、机器学习和计算机技术等，应用在比如金融、商业分析、工业等的各个行业领域。</span></li></ul><h2 id='ii-何为机器学习'><span>ii. 何为机器学习？</span></h2><h3 id='iii-机器学习概述'><span>ii.i. 机器学习概述</span></h3><ul><li><p><span>机器学习是一门多领域交叉学科，涉及概率论、统计学、线性代数、计算机数学等多门学科，专门研究计算机怎样模拟或实现人类的学习行为，以获取新的知识或技能，重新组织已有的知识结构使之不断改善自身的性能。机器学习是人工智能（Artificial Intelligence）的一个子集，同时它也是人工智能的核心，是使计算机具有智能的根本途径。（引用自：百度百科）</span></p></li><li><p><span>机器学习（machine learning, ML）根据不同的划分策略可以有不同的分类，比如以学习目的来划分，就可以简单分为：分类、回归、关联等。如果以学习方式来划分，可以分为：监督学习，半监督学习，无监督学习，强化学习。以应用层面来划分，机器学习可以应用在计算机视觉（Computer Vision, CV）、自然语言处理（Nature language processing, NLP）、数据挖掘（DataMining）等。当然如果以具体模型来划分，那就更为繁杂了。</span></p><p>&nbsp;</p></li></ul><p><img src="pic/机器学习.png" alt="'机器学习'" title="机器学习应用领域" style="zoom:67%;" /></p><p>&nbsp;</p><center><a name="图2">机器学习应用领域</a></center><h3 id='iiii-机器学习过程'><span>ii.ii. 机器学习过程</span></h3><ul><li><span>机器学习从高度抽象的角度看，其实可以分解为三大要素：模型（model)、策略（strategy）、算法（algorithm）。</span></li><li><span>从上面的要素出发，机器学习的过程实际上就是在实施这三个要素的过程：构建模型、确定策略、应用算法。但这种说法过于抽象，也损失不少细节。从应用层面上讲，其实机器学习是数据挖掘的一个工具或者某种意义上也可以理解为一个子集，它的实施过程也同数据挖掘一样：原材料获取（数据收集）—&gt; 材料处理加工（数据清洗、数据预处理、特征工程）—&gt; 材料性能分析（统计分析、建模分析）—&gt; 结果评价—&gt; 结果展示和应用。</span></li><li></li></ul><h2 id='iii-数据挖掘机器学习和人工智能'><span>iii. 数据挖掘，机器学习和人工智能</span></h2><ul><li><span>数据挖掘是从现有的信息中提取数据的模式和模型，即精选出最重要的信息，以用于未来机器学习和AI的数据使用。数据挖掘本质上是机器学习和人工智能的基础，前者为后两者提供数据支撑。机器学习是人工智能很重要的一部分，前者是后者的子集，同时机器学习也是人工智能的一种实现（以面向对象的角度理解，前者也是后者的对象实例）。理论上人工智能几乎包括了所有机器能做的内容，当然也包括机器学习全部内容和部分数据挖掘的内容。</span></li><li><span>数据挖掘也会使用大量机器学习的算法，但是其特定的环境和目的和机器学习不太一样。</span></li><li><span>这三者的区别主要是目的不同，其手段(算法，模型)有很大的重叠，所以容易混淆。</span></li></ul><p><img src="pic/三者区别.jpg" alt="'数据挖掘，机器学习和人工智能之间的关系'" style="zoom:67%;" /></p><p>&nbsp;</p><center><a name="图3">人工智能涵盖领域</a></center><h2 id='iii-电池背后的数据应用逻辑'><span>iii. 电池背后的数据应用逻辑</span></h2><h3 id='iiii-数据指标可量化'><span>iii.i. 数据指标可量化</span></h3><ul><li><span>从1799年伏特发明电池至今，电池技术走过了200年的岁月，应用在电池设计、制造、测试等各个阶段的数据标准逐步完善，大部分性能和指标实现了量化。锂离子电池从被发明至今，也已经走过30多个年头，除了继承电池原有的数据标准（材料性能指标、电性能指标、安全性能指标、力学性能指标……）外，又有了自己独特的发展。以工艺参数为例，得益于制造和检测装备的升级进步，我们能对各个工艺指标进行量化设计和监控。而成熟的数据标准和可量化意味着体系更容易提取数学模式，也更容易被数学模型解释，这也让数据挖掘和机器学习这个方面可以有所作为。</span></li></ul><h3 id='iiiii-内联性强关系复杂'><span>iii.ii. 内联性强，关系复杂</span></h3><ul><li><p><span>经验和各种物理、化学公式告诉我们，电池各个工艺构成，使用参数，环境参数等影响因素会对电池的最终性能指标会有着显著影响。比如，以电化学角度来理解：从电流—电势方程</span><sup><span>(1)</span></sup><span>(在离子扩散较快时，反应界面浓度与溶液本体浓度基本相等，方程演变为Bulter-Volmer方程）来看，凡是能影响界面面积A、反应速率k</span><sub><span>0</span></sub><span>、界面浓度C(0,t)、电极电势E、平衡电势E</span><sub><span>eq</span></sub><span>、体系温度T等的因素都会对电池最终电性能产生影响。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n65" cid="n65" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="134.97ex" height="35.303ex" viewBox="0 -1416.8 58111.7 15200" role="img" focusable="false" style="vertical-align: -31.884ex; margin-bottom: -0.129ex; max-width: 100%;"><defs><path stroke-width="0" id="E2-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E2-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E2-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E2-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E2-MJMATHI-46" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path><path stroke-width="0" id="E2-MJMATHI-6B" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path stroke-width="0" id="E2-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E2-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path stroke-width="0" id="E2-MJMATHI-43" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path stroke-width="0" id="E2-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E2-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E2-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E2-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E2-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E2-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E2-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path stroke-width="0" id="E2-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E2-MJMATHI-3B1" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path><path stroke-width="0" id="E2-MJMATHI-66" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path stroke-width="0" id="E2-MJMAIN-394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path><path stroke-width="0" id="E2-MJMATHI-45" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path stroke-width="0" id="E2-MJMATHI-71" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path stroke-width="0" id="E2-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E2-MJMATHI-64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path stroke-width="0" id="E2-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E2-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path><path stroke-width="0" id="E2-MJMAIN-3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E2-MJMAIN-2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path><path stroke-width="0" id="E2-MJMATHI-54" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9732,0)"><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-69" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-3D" x="622" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-6E" x="1678" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-41" x="2278" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-46" x="3028" y="0"></use><g transform="translate(5439,0)"><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-6B" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-30" x="736" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-5B" x="4752" y="0"></use><g transform="translate(7410,0)"><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-43" x="0" y="0"></use><g transform="translate(1029,-221)"><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-4F" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-78" x="763" y="0"></use></g></g><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-28" x="6904" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-30" x="7293" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-2C" x="7793" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-74" x="8238" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-29" x="8599" y="0"></use><g transform="translate(12943,0)"><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-65" x="0" y="0"></use><g transform="translate(671,594)"><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-2212" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-3B1" x="778" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-6E" x="1418" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-66" x="2018" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-394" x="2568" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-28" x="3401" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-45" x="3790" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-2212" x="4554" y="0"></use><g transform="translate(5429,0)"><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-45" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E2-MJMATHI-65" x="1043" y="-213"></use></g><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-71" x="6499" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-29" x="6959" y="0"></use></g></g><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-2212" x="14972" y="0"></use><g transform="translate(23001,0)"><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-43" x="0" y="0"></use><g transform="translate(1029,-216)"><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-52" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-64" x="759" y="0"></use></g></g><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-28" x="17694" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-30" x="18083" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-2C" x="18583" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-74" x="19028" y="0"></use><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-29" x="19389" y="0"></use><g transform="translate(28480,0)"><use transform="scale(1.44)" xlink:href="#E2-MJMATHI-65" x="0" y="0"></use><g transform="translate(671,594)"><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-28" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-31" x="389" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-2212" x="889" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-3B1" x="1667" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-29" x="2307" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-6E" x="2696" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-66" x="3296" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-394" x="3846" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-28" x="4679" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-45" x="5068" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-2212" x="5832" y="0"></use><g transform="translate(6730,0)"><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-45" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E2-MJMATHI-65" x="1043" y="-213"></use></g><use transform="scale(1.018)" xlink:href="#E2-MJMATHI-71" x="7777" y="0"></use><use transform="scale(1.018)" xlink:href="#E2-MJMAIN-29" x="8237" y="0"></use></g></g><use transform="scale(1.44)" xlink:href="#E2-MJMAIN-5D" x="26559" y="0"></use></g><g transform="translate(0,-7510)"><g transform="translate(56833,0)"><g id="mjx-eqn-1" transform="translate(0,5918)"><use xlink:href="#E2-MJMAIN-28"></use><use xlink:href="#E2-MJMAIN-31" x="389" y="0"></use><use xlink:href="#E2-MJMAIN-29" x="889" y="0"></use></g></g><g transform="translate(23448,0)"><g transform="translate(-15,0)"><g transform="translate(0,5918)"><use xlink:href="#E2-MJMATHI-6E" x="0" y="0"></use><use xlink:href="#E2-MJMAIN-3A" x="877" y="0"></use><g transform="translate(1433,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">反</text></g><g transform="translate(2249,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">应</text></g><g transform="translate(3064,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">电</text></g><g transform="translate(3879,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">子</text></g><g transform="translate(4695,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">数</text></g></g><g transform="translate(0,4568)"><use xlink:href="#E2-MJMATHI-41" x="0" y="0"></use><use xlink:href="#E2-MJMAIN-3A" x="1027" y="0"></use><g transform="translate(1583,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">电</text></g><g transform="translate(2399,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">极</text></g><use xlink:href="#E2-MJMAIN-2F" x="3214" y="0"></use><g transform="translate(3714,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">溶</text></g><g transform="translate(4529,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">液</text></g><g transform="translate(5345,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">界</text></g><g transform="translate(6160,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">面</text></g><g transform="translate(6976,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">面</text></g><g transform="translate(7791,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">积</text></g></g><g transform="translate(0,3218)"><use xlink:href="#E2-MJMATHI-46" x="0" y="0"></use><g transform="translate(749,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">：</text></g><g transform="translate(1564,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">法</text></g><g transform="translate(2379,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">拉</text></g><g transform="translate(3195,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">第</text></g><g transform="translate(4010,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">常</text></g><g transform="translate(4826,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">数</text></g></g><g transform="translate(0,1918)"><use xlink:href="#E2-MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMAIN-30" x="736" y="-213"></use><use xlink:href="#E2-MJMAIN-3A" x="1252" y="0"></use><g transform="translate(1808,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">标</text></g><g transform="translate(2623,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">准</text></g><g transform="translate(3439,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">反</text></g><g transform="translate(4254,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">应</text></g><g transform="translate(5070,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">速</text></g><g transform="translate(5885,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">率</text></g></g><g transform="translate(0,618)"><use xlink:href="#E2-MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-154)"><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-78" x="763" y="0"></use></g><use xlink:href="#E2-MJMAIN-3A" x="2036" y="0"></use><g transform="translate(2592,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">反</text></g><g transform="translate(3408,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">应</text></g><g transform="translate(4223,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">界</text></g><g transform="translate(5038,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">面</text></g><g transform="translate(5854,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">氧</text></g><g transform="translate(6669,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">化</text></g><g transform="translate(7485,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">态</text></g><g transform="translate(8300,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">物</text></g><g transform="translate(9116,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">质</text></g><g transform="translate(9931,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">浓</text></g><g transform="translate(10747,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">度</text></g></g><g transform="translate(0,-682)"><use xlink:href="#E2-MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-64" x="759" y="0"></use></g><use xlink:href="#E2-MJMAIN-3A" x="1999" y="0"></use><g transform="translate(2555,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">反</text></g><g transform="translate(3370,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">应</text></g><g transform="translate(4186,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">界</text></g><g transform="translate(5001,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">面</text></g><g transform="translate(5816,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">氧</text></g><g transform="translate(6632,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">化</text></g><g transform="translate(7447,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">态</text></g><g transform="translate(8263,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">物</text></g><g transform="translate(9078,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">质</text></g><g transform="translate(9894,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">浓</text></g><g transform="translate(10709,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">度</text></g></g><g transform="translate(0,-1982)"><use xlink:href="#E2-MJMATHI-3B1" x="0" y="0"></use><use xlink:href="#E2-MJMAIN-3A" x="917" y="0"></use><g transform="translate(1473,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">传</text></g><g transform="translate(2289,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">递</text></g><g transform="translate(3104,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">系</text></g><g transform="translate(3919,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(4735,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(5550,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">势</text></g><g transform="translate(6366,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">垒</text></g><g transform="translate(7181,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">对</text></g><g transform="translate(7997,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">称</text></g><g transform="translate(8812,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">系</text></g><g transform="translate(9628,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">数</text></g></g><g transform="translate(0,-3282)"><use xlink:href="#E2-MJMATHI-45" x="0" y="0"></use><use xlink:href="#E2-MJMAIN-3A" x="1041" y="0"></use><g transform="translate(1597,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">电</text></g><g transform="translate(2413,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">极</text></g><g transform="translate(3228,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">电</text></g><g transform="translate(4043,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">势</text></g></g><g transform="translate(0,-4582)"><use xlink:href="#E2-MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-150)"><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-65" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E2-MJMATHI-71" x="466" y="0"></use></g><use xlink:href="#E2-MJMAIN-3A" x="1770" y="0"></use><g transform="translate(2326,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">平</text></g><g transform="translate(3141,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">衡</text></g><g transform="translate(3957,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">电</text></g><g transform="translate(4772,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">势</text></g></g><g transform="translate(0,-5969)"><use xlink:href="#E2-MJMATHI-66" x="0" y="0"></use><use xlink:href="#E2-MJMAIN-3D" x="827" y="0"></use><use xlink:href="#E2-MJMATHI-46" x="1883" y="0"></use><use xlink:href="#E2-MJMAIN-2F" x="2632" y="0"></use><use xlink:href="#E2-MJMATHI-52" x="3132" y="0"></use><use xlink:href="#E2-MJMATHI-54" x="3891" y="0"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">\Large
i=nAFk_0[\,C_{Ox}(0,t)e^{-\alpha nf \Delta (E-E_eq)}-C_{Rd}(0,t)e^{(1-\alpha)nf\Delta (E-E_eq)}\,\tag1]\\
\begin{align}
&n:反应电子数\\
&A:电极/溶液界面面积\\
&F：法拉第常数\\
&k_0:标准反应速率\\
&C_{Ox}:反应界面氧化态物质浓度\\
&C_{Rd}:反应界面氧化态物质浓度\\
&\alpha:传递系数，势垒对称系数\\
&E:电极电势\\
&E_{eq}:平衡电势\\
&f=F/RT
\end{align}</script></div></div><p><span>可问题不仅止于此，往下深究你会发现，反应界面面积跟电池结构设计，电解液分布，正负极活性物质颗粒特性状态等相关；标准反应速率又与参与反应的正负极材料特性、电解液特性（由阿伦尼乌斯方程</span><sup><span>(2)</span></sup><span>知道，不同材料体系的活化能Ea不同，前因子A也不同）等因素紧密相连；</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n68" cid="n68" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="134.97ex" height="19.847ex" viewBox="0 -4508.4 58111.7 8545.2" role="img" focusable="false" style="vertical-align: -9.376ex; max-width: 100%;"><defs><path stroke-width="0" id="E3-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E3-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E3-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E3-MJMATHI-6B" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path stroke-width="0" id="E3-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E3-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E3-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path stroke-width="0" id="E3-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E3-MJMATHI-45" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path stroke-width="0" id="E3-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E3-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E3-MJMATHI-54" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path stroke-width="0" id="E3-MJMAIN-3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(56833,0)"><g id="mjx-eqn-2" transform="translate(0,2805)"><use xlink:href="#E3-MJMAIN-28"></use><use xlink:href="#E3-MJMAIN-32" x="389" y="0"></use><use xlink:href="#E3-MJMAIN-29" x="889" y="0"></use></g></g><g transform="translate(24915,0)"><g transform="translate(-15,0)"><g transform="translate(0,2805)"><use transform="scale(1.44)" xlink:href="#E3-MJMATHI-6B" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E3-MJMAIN-3D" x="798" y="0"></use><use transform="scale(1.44)" xlink:href="#E3-MJMATHI-41" x="1854" y="0"></use><g transform="translate(3750,0)"><use transform="scale(1.44)" xlink:href="#E3-MJMATHI-65" x="0" y="0"></use><g transform="translate(671,594)"><g transform="translate(172,0)"><rect stroke="none" width="1717" height="86" x="0" y="211"></rect><g transform="translate(86,554)"><use transform="scale(0.72)" xlink:href="#E3-MJMAIN-2212" x="0" y="0"></use><g transform="translate(560,0)"><use transform="scale(0.72)" xlink:href="#E3-MJMATHI-45" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E3-MJMATHI-61" x="737" y="-150"></use></g></g><g transform="translate(331,-422)"><use transform="scale(0.72)" xlink:href="#E3-MJMATHI-52" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E3-MJMATHI-54" x="758" y="0"></use></g></g></g></g></g><g transform="translate(0,1455)"><use xlink:href="#E3-MJMATHI-6B" x="0" y="0"></use><use xlink:href="#E3-MJMAIN-3A" x="798" y="0"></use><g transform="translate(1354,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">反</text></g><g transform="translate(2170,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">应</text></g><g transform="translate(2985,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">速</text></g><g transform="translate(3800,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">率</text></g></g><g transform="translate(0,155)"><use xlink:href="#E3-MJMATHI-41" x="0" y="0"></use><use xlink:href="#E3-MJMAIN-3A" x="1027" y="0"></use><g transform="translate(1583,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">前</text></g><g transform="translate(2399,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">因</text></g><g transform="translate(3214,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">子</text></g></g><g transform="translate(0,-1145)"><use xlink:href="#E3-MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E3-MJMATHI-61" x="1043" y="-213"></use><use xlink:href="#E3-MJMAIN-3A" x="1489" y="0"></use><g transform="translate(2045,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">活</text></g><g transform="translate(2861,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">化</text></g><g transform="translate(3676,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">能</text></g></g><g transform="translate(0,-2445)"><use xlink:href="#E3-MJMATHI-52" x="0" y="0"></use><use xlink:href="#E3-MJMAIN-3A" x="1036" y="0"></use><g transform="translate(1592,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">摩</text></g><g transform="translate(2408,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">尔</text></g><g transform="translate(3223,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">气</text></g><g transform="translate(4038,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">体</text></g><g transform="translate(4854,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">常</text></g><g transform="translate(5669,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">数</text></g></g><g transform="translate(0,-3745)"><use xlink:href="#E3-MJMATHI-54" x="0" y="0"></use><use xlink:href="#E3-MJMAIN-3A" x="981" y="0"></use><g transform="translate(1537,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">绝</text></g><g transform="translate(2353,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">对</text></g><g transform="translate(3168,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">温</text></g><g transform="translate(3983,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">度</text></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-3">\begin{align}
&\Large k=Ae^{\frac{-E_a}{RT}\tag2}\\
&k:反应速率\\
&A:前因子\\
&E_a:活化能\\
&R:摩尔气体常数\\
&T:绝对温度
&\end{align}</script></div></div><p><span>界面浓度被液相传质过程（主要是扩散过程），电解液特性，正负极颗粒特性这些过程因素控制；电极电势直接与材料体系，内阻分布，电池结构设计，荷电状态等因素相关......随着深入分析，你会发现，这完全是一个几近无限复杂的问题，影响最终结果的变量因素错综复杂，大部分的影响关系都无法用有限的数学方程确定，甚至很多都无法量化（比如材料特性就很难完全量化）。就像下面的动态关系图所展示的那样，各种因素相互影响：</span></p><iframe src="pyecharts/关系图.html" height="520"></iframe><p><span>在高维特征空间内的数据分析，传统工具显得比较吃力，比如要了解多维特征空间的数据分布情况以及作解释性分析，传统的SAS软件（比如最常见的EXCEL，minitab, origin等，还有学习成本较高，面向数据专家的SAS，SPSS等）要不是力不从心，要不然就是对统计学知识要求太高。而高维空间的数据问题恰恰是机器学习的强项，机器学习不仅可以依靠模型得出较为准确的输出，也能一定程度为结果提供高维空间下的解释性分析（深度学习除外）。</span></p></li></ul><h3 id='从数据到应用'><span>从数据到应用</span></h3><ul><li><p><span>过往的电池设计是以历史经验为基础（其实就是技术人员的个人经验），固定大部分的特定变量组合（即不作为变量分析），针对特定问题进行有限变量（大部分是1-2维变量）分析，进而得出在这变量空间内的局部较优解，然后不断地优化，迭代上述步骤。这也是最普遍，最常见的做法。举个例子说明，我们从物理直觉上，可以判断出电池的使用寿命(cycle life)肯定与材料组成、工艺参数直接相关，这种相关性却无法被简单定量化表示，而要通过不断的变量组合、实验试错，但考虑到成本，效率，时效等原因，我们单次只能选取一到两个变量做对比实验，比如正极材料，电解液这两个变量组合，那么其它变量就被固化下来，如负极，隔膜等，等到有新的实验需求，然后在以同样的手段，更新迭代实验，进而得到符合我们预期的变量组合。这种做法本身是没有问题的，只是会有两个问题产生：</span></p><ol start='' ><li><p><span>实验数据没有被充分利用，假设目前有两组实验数据，a实验所采用的变量组合是</span><span class='math-in-toc'>$X^1$</span><span>，</span><span class='math-in-toc'>$X^1$</span><span>是n维特征空间里的一个向量，</span><span class='math-in-toc'>$ X^1=[x_1^1，x_2^1,x_3^1,...x^1_n] $</span><span>,</span></p><p><span class='math-in-toc'>$X^2$</span><span>是n维特征空间里的另一个向量，</span><span class='math-in-toc'>$ X^2=[x_1^2，x_2^2,x_3^2,...x^2_n] $</span><span>。如果两个实验想要对比得出直观的结论，起码要将变量控制在越少越好。通常需要将n维空间压缩到低维空间，这个过程</span></p></li><li><p><span>实验结果只能收敛于特定空间的局部较优解，很难获得全局较优解。</span></p></li></ol></li></ul><ul><li><p><span>比如举个例子，当前作锂离子电池设计时，要控制最终的电阻，其实很容易利用各个组成的数据指标来实现，比如电池的电阻就可以近似看成各个电池构成组件的电阻线性与各组件的接触电阻之和</span><sup><span>(2)</span></sup><span>，而各部件的电阻和接触电阻其实也可以由其内禀的电阻率和几何尺寸得出。换句话说，电池内阻的影响因素遍布整个变量空间，而非单一变量控制。当然这个例子是电池系统中相对简单的线性模型。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n86" cid="n86" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="134.97ex" height="21.307ex" viewBox="0 -4822.8 58111.7 9174" role="img" focusable="false" style="vertical-align: -10.106ex; max-width: 100%;"><defs><path stroke-width="0" id="E4-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E4-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E4-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E4-MJMATHI-49" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path><path stroke-width="0" id="E4-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E4-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E4-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E4-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E4-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E4-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E4-MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path stroke-width="0" id="E4-MJMATHI-6B" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path stroke-width="0" id="E4-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E4-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path stroke-width="0" id="E4-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E4-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E4-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E4-MJMATHI-63" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path stroke-width="0" id="E4-MJMATHI-6F" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path stroke-width="0" id="E4-MJMATHI-66" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path stroke-width="0" id="E4-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E4-MJMATHI-70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path stroke-width="0" id="E4-MJMAIN-3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E4-MJMATHI-64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path stroke-width="0" id="E4-MJMATHI-68" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path stroke-width="0" id="E4-MJMATHI-75" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E4-MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path stroke-width="0" id="E4-MJMATHI-43" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path stroke-width="0" id="E4-MJMAIN-3B" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 85 94 103T137 121Q202 121 202 8Q202 -44 183 -94T144 -169T118 -194Q115 -194 106 -186T95 -174Q94 -171 107 -155T137 -107T160 -38Q161 -32 162 -22T165 -4T165 4Q165 5 161 4T142 0Q110 0 94 18T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(56833,0)"><g id="mjx-eqn-3" transform="translate(0,2657)"><use xlink:href="#E4-MJMAIN-28"></use><use xlink:href="#E4-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E4-MJMAIN-29" x="889" y="0"></use></g></g><g transform="translate(18259,0)"><g transform="translate(-15,0)"><g transform="translate(0,2657)"><use transform="scale(1.2)" xlink:href="#E4-MJMATHI-49" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E4-MJMATHI-52" x="504" y="0"></use><use transform="scale(1.2)" xlink:href="#E4-MJMAIN-3D" x="1540" y="0"></use><g transform="translate(3115,0)"><use transform="scale(1.2)" xlink:href="#E4-MJSZ2-2211" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E4-MJMATHI-69" x="848" y="-1534"></use><use transform="scale(0.849)" xlink:href="#E4-MJMATHI-6E" x="721" y="1626"></use></g><use transform="scale(1.2)" xlink:href="#E4-MJMATHI-49" x="4207" y="0"></use><g transform="translate(5653,0)"><use transform="scale(1.2)" xlink:href="#E4-MJMATHI-52" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E4-MJMATHI-69" x="1073" y="-213"></use></g><use transform="scale(1.2)" xlink:href="#E4-MJMAIN-2B" x="6175" y="0"></use><g transform="translate(8610,0)"><use transform="scale(1.2)" xlink:href="#E4-MJSZ2-2211" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E4-MJMATHI-6A" x="815" y="-1534"></use><use transform="scale(0.849)" xlink:href="#E4-MJMATHI-6B" x="760" y="1626"></use></g><use transform="scale(1.2)" xlink:href="#E4-MJMATHI-49" x="8786" y="0"></use><g transform="translate(11148,0)"><use transform="scale(1.2)" xlink:href="#E4-MJMATHI-52" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E4-MJMATHI-6A" x="1073" y="-213"></use></g></g><g transform="translate(0,-37)"><use xlink:href="#E4-MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E4-MJMATHI-69" x="1073" y="-213"></use><g transform="translate(1102,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">：</text></g><use xlink:href="#E4-MJMATHI-72" x="1918" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="2369" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="2835" y="0"></use><use xlink:href="#E4-MJMATHI-69" x="3304" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="3649" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="4118" y="0"></use><use xlink:href="#E4-MJMATHI-61" x="4479" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="5008" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="5608" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="6041" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="6785" y="0"></use><use xlink:href="#E4-MJMATHI-66" x="7270" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="8097" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="8530" y="0"></use><use xlink:href="#E4-MJMATHI-6D" x="9015" y="0"></use><use xlink:href="#E4-MJMATHI-70" x="9893" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="10396" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="10881" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="11481" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="11947" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="12547" y="0"></use></g><g transform="translate(0,-1342)"><use xlink:href="#E4-MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E4-MJMATHI-6A" x="1073" y="-213"></use><use xlink:href="#E4-MJMAIN-3A" x="1428" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="1983" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="2416" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="2901" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="3501" y="0"></use><use xlink:href="#E4-MJMATHI-61" x="3862" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="4391" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="4824" y="0"></use><use xlink:href="#E4-MJMATHI-72" x="5463" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="5914" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="6380" y="0"></use><use xlink:href="#E4-MJMATHI-69" x="6849" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="7194" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="7663" y="0"></use><use xlink:href="#E4-MJMATHI-61" x="8024" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="8553" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="9153" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="9586" y="0"></use><use xlink:href="#E4-MJMATHI-66" x="10052" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="10880" y="0"></use><use xlink:href="#E4-MJMATHI-66" x="11365" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="11915" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="12348" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="12833" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="13433" y="0"></use><use xlink:href="#E4-MJMATHI-61" x="13794" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="14323" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="14756" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="15117" y="0"></use><use xlink:href="#E4-MJMATHI-64" x="15583" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="16384" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="16817" y="0"></use><use xlink:href="#E4-MJMATHI-6D" x="17302" y="0"></use><use xlink:href="#E4-MJMATHI-70" x="18180" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="18683" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="19168" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="19768" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="20234" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="20834" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="21195" y="0"></use></g><g transform="translate(0,-2737)"><use xlink:href="#E4-MJMATHI-6E" x="0" y="0"></use><use xlink:href="#E4-MJMAIN-3A" x="877" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="1433" y="0"></use><use xlink:href="#E4-MJMATHI-68" x="1794" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="2370" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="3114" y="0"></use><use xlink:href="#E4-MJMATHI-75" x="3714" y="0"></use><use xlink:href="#E4-MJMATHI-6D" x="4286" y="0"></use><use xlink:href="#E4-MJMATHI-62" x="5164" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="5593" y="0"></use><use xlink:href="#E4-MJMATHI-72" x="6059" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="6510" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="7257" y="0"></use><use xlink:href="#E4-MJMATHI-66" x="7742" y="0"></use><use xlink:href="#E4-MJMATHI-43" x="8569" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="9329" y="0"></use><use xlink:href="#E4-MJMATHI-6D" x="9814" y="0"></use><use xlink:href="#E4-MJMATHI-70" x="10692" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="11195" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="11680" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="12280" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="12746" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="13346" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="13707" y="0"></use><use xlink:href="#E4-MJMAIN-3B" x="14176" y="0"></use></g><g transform="translate(0,-4042)"><use xlink:href="#E4-MJMATHI-6B" x="0" y="0"></use><use xlink:href="#E4-MJMAIN-3A" x="798" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="1354" y="0"></use><use xlink:href="#E4-MJMATHI-68" x="1715" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="2291" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="3035" y="0"></use><use xlink:href="#E4-MJMATHI-75" x="3635" y="0"></use><use xlink:href="#E4-MJMATHI-6D" x="4207" y="0"></use><use xlink:href="#E4-MJMATHI-62" x="5085" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="5514" y="0"></use><use xlink:href="#E4-MJMATHI-72" x="5980" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="6431" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="7178" y="0"></use><use xlink:href="#E4-MJMATHI-66" x="7663" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="8490" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="8923" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="9408" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="10008" y="0"></use><use xlink:href="#E4-MJMATHI-61" x="10369" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="10898" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="11331" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="11692" y="0"></use><use xlink:href="#E4-MJMATHI-64" x="12158" y="0"></use><use xlink:href="#E4-MJMATHI-63" x="12959" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="13392" y="0"></use><use xlink:href="#E4-MJMATHI-6D" x="13877" y="0"></use><use xlink:href="#E4-MJMATHI-70" x="14755" y="0"></use><use xlink:href="#E4-MJMATHI-6F" x="15258" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="15743" y="0"></use><use xlink:href="#E4-MJMATHI-65" x="16343" y="0"></use><use xlink:href="#E4-MJMATHI-6E" x="16809" y="0"></use><use xlink:href="#E4-MJMATHI-74" x="17409" y="0"></use><use xlink:href="#E4-MJMATHI-73" x="17770" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">\begin{align}
&\large IR=\sum_{i}^n IR_i\,+\sum_j^kIR_{j}\tag{3}	\\
&R_i：resistance \;of\; component\\
&R_j:  contact\; resistancef \; of contacted\; components\; \\
&n:the\;numbers \;of \;Components;\\
&k:the\; numbers\;of\;contacted \;components
\end{align}</script></div></div><p>&nbsp;</p><p><span>关系复杂，指的是，任一指标的最终</span></p><p><span>像这种有着明确物理模式的数据应用还有很多，但其它内联强但暂时没有明确的物理解释的数据组合其实从数学挖掘角度来看也能提供一定的分析视角。比如，我们从物理直觉上，可以判断出电池的使用寿命(cycle life)肯定与材料组成、工艺参数直接相关，但这种相关性却无法被简单定量化表示，而是通过不断的变量组合、实验试错，</span></p></li><li><p><span>相对于制造技术的发展，锂电池的数据挖掘工作其实还有很大的空间可以拓展。</span></p></li></ul><h3 id='锂离子电池制造一致性要求'><span>锂离子电池制造一致性要求</span></h3><ul><li><span>锂离子电池数据离散性指标往往意味着特征数据和标签数据</span></li></ul><h3 id='数据维度大人力'><span>数据维度大，人力</span></h3><h3 id='电池研制测试周期长时效性问题突出'><span>电池研制测试周期长，时效性问题突出</span></h3><h3 id='电池构成体系复杂变量组合巨大'><span>电池构成体系复杂，变量组合巨大,</span></h3><h2 id='文中出现的名词解释'><span>文中出现的名词解释</span></h2><ol start='' ><li><mark><span>特征</span></mark><span>：自变量，比如电解液种类，测试温度这些工艺变量，它是数据挖掘和机器学习的输入部分（Input);</span></li><li><mark><span>标签</span></mark><span>：因变量，比如我们要预测的电池寿命，某一阶段的电池容量等，它是数据挖掘和机器学习的输出部分（Output);</span></li><li><mark><span>变量</span></mark><span>：自变量和因变量的总称，由具体语境判断是特征还是标签。</span></li><li><mark><span>样本</span></mark><span>：数据集里拥有完整特征和标签的最小组成，即一个电芯的数据集合。</span></li><li><mark><span>因素</span></mark><span>：方差分析的研究变量，可以理解成特征，例如，电池测试温度、充电电流等。</span></li><li><mark><span>水平/处理条件</span></mark><span>：因素中的内容（不同离散取值）称为水平，例如，25℃、40℃等温度取值就是温度因素的水平，也称处理条件。</span></li><li><mark><span>控制变量</span></mark><span>：方差分析里的自变量。</span></li><li><mark><span>训练集</span></mark><span>：机器学习中，训练集数据用来估计模型，本文常用X_train表示训练集中的特征数据，Y_train表示训练集中的标签数据。训练集对于设计人员是已知的。</span></li><li><mark><span>验证集</span></mark><span>:机器学习中，验证集数据用来确定网络结构或者控制模型复杂程度的参数。验证集对于设计人员是已知的。</span></li><li><mark><span>测试集</span></mark><span>：机器学习中，测试集数据最终选择最优的模型的性能如何，本文常用X_test表示测试集中的特征数据，Y_test表示测试集中的标签数据。X_test对于设计人员是已知的，Y_test对于设计人员是未知的，</span><strong><span>是要预测的部分</span></strong><span>。</span></li></ol><h2 id='文中默认的单位量纲'><span>文中默认的单位量纲</span></h2><ol start='' ><li><mark><span>电池容量</span></mark><span>：mAh</span></li><li><mark><span>温度</span></mark><span>：℃ （注：公式里出现温度为热力学温度，即开尔文温度，默认单位：K）</span></li><li><mark><span>电流</span></mark><span>：A </span></li><li><mark><span>电阻</span></mark><span>：Ω</span></li><li><mark><span>电压</span></mark><span>：V </span></li><li><mark><span>隔膜相关厚度</span></mark><span>：μm </span></li><li><mark><span>隔膜相关长度、宽度</span></mark><span>: cm </span></li><li><mark><span>充电后搁置时间</span></mark><span>: min </span></li><li><mark><span>放电后搁置时间</span></mark><span>: s</span></li><li><mark><span>循环寿命</span></mark><span>: 次</span></li></ol><p><span>注：出于数据样本特征名称和标签名称一致性考虑，故本文中部分数值和图表不显示单位，默认单位参照上述标准。除非特殊说明，否则本文中出现的数值对应的单位量纲均以上述为准。</span></p><h2 id='文中部分编辑处理'><span>文中部分编辑处理</span></h2><ul><li><p><span>由于数据挖掘和机器学习在应用过程中会输出大量的图表，所以本文只选取关键图表进行编码，其余介绍型图片且未被引用的图表将不编码，只标识图表名称。图表编码规则为： ”图“ + 1级标题序号 + 图序号 + 具体图名称，例如 </span><a href="#图3.1"><span>图3.1 电池不同组成材料在样本空间上的分布</span></a><span>，即是第3章内容第一张图表。同时由于便于编辑操作，并没有对图表进行单位标注，默认单位可以参考</span><a href='#文中默认的单位量纲'><span>文中默认的单位量纲</span></a><span>这一章节。</span></p></li><li><p><span>为了能更好将实现过程和结果数据展示出来，文中会出现数据处理过程中的源代码，并以灰色内嵌框呈现，如下例所示：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 井号后为注释部分。</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'我是例子。'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">我是例子。</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre></li><li><p><span>出于对于不同浏览器的兼容性考虑，段落开头不会进行缩进处理，段落之间会空出一行来分隔。无序列表和有序列表则会按嵌套缩进。下面是列表样式举例：</span></p><p><span>无序列表举例：</span></p><p><span>  ●   ……</span></p><p><span>        ○ ……</span></p><p><span>                ■  ……</span></p><p><span>有序列表举例：</span></p><ol start='' ><li><p><span>……</span></p><p><span>α. ……</span></p></li></ol><p>&nbsp;</p></li><li><p><span>本文主要部分是由markdown标记语言和html标记语言混合编辑，公式和部分特殊格式采用LATEX语法编辑，但因为精力和技术所限，没有对不同终端进行适配，所以在有些输出终端可能会出现页面布局混乱的可能。建议在电脑显示终端阅读，浏览器推荐使用Chrome。</span></p></li></ul><p>&nbsp;</p><h1 id='1项目安排'><span>1.项目安排</span></h1><h2 id='11-项目目的'><span>1.1 项目目的</span></h2><p>&nbsp;</p><h2 id='12-项目流程'><span>1.2 项目流程</span></h2><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h1 id='2-数据收集清洗'><span>2. 数据收集、清洗</span></h1><h1 id='3-探索性数据分析数据预处理上）'><span>3. 探索性数据分析/数据预处理（上）</span></h1><h2 id='31-概述'><span>3.1 概述</span></h2><p><span>EDA(Exploratory Data Analysis)-探索性数据分析是指对已有的数据（ 特别是调查或观察得来的原始数据 ）在尽量少的先验假定下进行探索通过作图、制表、方程拟合、计算特征量等手段探索数据的结构和规律的一种数据分析方法，是从数据中检测，纠正或删除损坏，不准确或不适用于模型的记录的过程 。作用是让人能够了解变量之间的相互关系以及变量与预测值之间的关系，然后进行相应的数据处理，让数据适应模型，匹配模型的需求，使得数据集进行机器学习或深度学习时，获得较好的效果。EDA过程其实就是机器学习里的数据预处理（Data Preprocessing）过程，只是叫法不同罢了。EDA过程可能面对的问题有：数据类型不同，比如有的是文字，有的是数字，有的含时间序列，有的连续，有的间断。也可能，数据的质量不行，有噪声，有异常，有缺失，数据出错，量纲不一，有重复，数据是偏态，数据量太大或太小 。本质上讲，EDA过程就是处理这些问题的过程。</span></p><h2 id='32-流程'><span>3.2 流程</span></h2><p><span>如果说数据收集、清洗是数据科学工作中最费时的工作，那么EDA过程应该就是数据挖掘或者机器学习中最细致的工作，它的成败好坏直接决定了数据挖掘和机器学习的结果。就如常言，算法决定了结果的下限，数据质量才决定了模型的上限（鉴于行文篇幅合理安排的考虑，缺失值分析和异常检测将安排在下一章节</span><a href='探索性数据分析/数据预处理（下）'><span>探索性数据分析/数据预处理（下）</span></a><span>里面）。</span></p><p>&nbsp;</p><p><img src="pic/EDA.png" alt="EDA" title="EDA流程图" style="zoom:67%;" /></p><center><a name="图3">EDA流程图</a></center><h2 id='33-查看数据信息'><span>3.3 查看数据信息</span></h2><p>&nbsp;</p><h3 id='331-数据理解'><span>3.3.1 数据理解</span></h3><h4 id='3311-字段总数'><span>3.3.1.1 字段总数</span></h4><p><span>利用pandas.columns，pandas.shape命令直接查看数据情况，结果如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看数据信息</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">columns</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Index</span>([<span class="cm-string">'times'</span>, <span class="cm-string">'capacity'</span>, <span class="cm-string">'循环次数表'</span>, <span class="cm-string">'all_capacity'</span>, <span class="cm-string">'上柜日期'</span>, <span class="cm-string">'设备号'</span>, <span class="cm-string">'行号'</span>, <span class="cm-string">'列号'</span>, <span class="cm-string">'日期条件列'</span>, <span class="cm-string">'批次条件列'</span>, <span class="cm-string">'试产单号/批次号'</span>, <span class="cm-string">'型号'</span>, <span class="cm-string">'容量mAh'</span>, <span class="cm-string">'工步'</span>, <span class="cm-string">'电解液'</span>, <span class="cm-string">'正极材料'</span>, <span class="cm-string">'负极材料'</span>, <span class="cm-string">'隔膜纸'</span>, <span class="cm-string">'2ex百分比'</span>, <span class="cm-string">'分容容量'</span>, <span class="cm-string">'首次容量'</span>, <span class="cm-string">'单次放电容量'</span>, <span class="cm-string">'异常升高次数'</span>, <span class="cm-string">'异常升高信息'</span>, <span class="cm-string">'异常断点次数'</span>, <span class="cm-string">'异常断点信息'</span>, <span class="cm-string">'温度'</span>, <span class="cm-string">'充电倍率'</span>, <span class="cm-string">'循环寿命'</span>, <span class="cm-string">'t500'</span>, <span class="cm-string">'t1000'</span>, <span class="cm-string">'t1500'</span>,<span class="cm-string">'t2000'</span>, <span class="cm-string">'t2500'</span>, <span class="cm-string">'t3000'</span>, <span class="cm-string">'t3500'</span>, <span class="cm-string">'t4000'</span>, <span class="cm-string">'t4500'</span>, <span class="cm-string">'t5000'</span>, <span class="cm-string">'t5500'</span>,<span class="cm-string">'t6000'</span>, <span class="cm-string">'t6500'</span>, <span class="cm-string">'t7000'</span>, <span class="cm-string">'t7500'</span>, <span class="cm-string">'t8000'</span>, <span class="cm-string">'t8500'</span>, <span class="cm-string">'t9000'</span>, <span class="cm-string">'t9500'</span>,<span class="cm-string">'t10000'</span>, <span class="cm-string">'t10500'</span>, <span class="cm-string">'t11000'</span>, <span class="cm-string">'t11500'</span>, <span class="cm-string">'t12000'</span>, <span class="cm-string">'t12500'</span>, <span class="cm-string">'t13000'</span>,<span class="cm-string">'t13500'</span>, <span class="cm-string">'t14000'</span>, <span class="cm-string">'t14500'</span>, <span class="cm-string">'t15000'</span>],<span class="cm-variable">dtype</span>=<span class="cm-string">'object'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看数据维度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(<span class="cm-number">2659</span>, <span class="cm-number">59</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 230px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><span>在这里，对上述字段名称进行一些解释，方便大家理解特征的涵义。&#39;times&#39;、 &#39;capacity&#39;、 &#39;循环次数表&#39;、&#39;all_capacity&#39; 这四个特征，分别是在数据收集阶段，从原始数据收集的关于电池大循环（全充放循环）在周期中的分布数组、关于电池大循环容量（全充放循环，即电池经历若干次循环后的实际容量）在容量中的分布数组、电池在500次循环间隔取得的最为接近的大循环序号数组、电池在500次循环间隔取得的最为接近的大循环对应容量数组。可能这么说有点不好理解，不过没关系，这对接下来的操作和解释没有影响，因为这四列严格上来讲不是特征列，只是在程序设计阶段，方便操作而设计，最终也不会用在建模中，大家可以不用太关注。&#39;2ex百分比&#39;是指电池以2倍工作放电容量的工步占工作循环的百分比。t500是指循环次数最为接近500次循环的大循环容量（其实就是经历过500次循环后电池的实际容量，只不过电池测试设计时，技术人员并没有特意在500，1000等这样的间隔点设置全充放工步，这里是取最为接近500间隔的数值，方便分析），同理 t1000、t1500等也是如此。’工步‘是指从数据文件中提取的工步信息，’充电倍率‘是指从工艺登记（循环登记表）文件中所提取的工步信息，两者理论上是一致的。’循环寿命‘是指电池达到设定寿命时所经历的循环次数，对于不同型号的电池，设定寿命标准不同（比如LFP10370C2-200mAh就是以165mAh容量为限，亦或者触发测试程序的电压下限)。从数据维度上看，总共2659行（即2659个样本），59列（28个特征列，即特征维度为28维；31个标签列，即标签维度为31维，但对于每个样本并没有一定有31个输出，比如有些电芯在8000次循环就到寿命或结束测试了，后面的循环数据就没有了）。</span></p><h4 id='3312-初步特征选择'><span>3.3.1.2 初步特征选择</span></h4><p><span>其实特征选择是属于后续</span><a href="#特征工程"><span>特征工程</span></a><span>的一部分，主要作用是寻找对模型有较高影响的特征，摒弃对模型没有影响，甚至是降低模型精度的特征，从而降低数据维度，减少开销，提高模型表现。之所以在EDA阶段就进行特征选择，其实主要是出于结果可视化的考虑，因为如果有太多特征列，就会导致查看统计信息时比较不直观，同时也是便于缺失值分析和异常值分析的降维考虑。特征选择后的结果如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.25px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Index</span>([<span class="cm-string">'电解液'</span>, <span class="cm-string">'正极材料'</span>, <span class="cm-string">'负极材料'</span>, <span class="cm-string">'隔膜纸'</span>, <span class="cm-string">'2ex百分比'</span>, <span class="cm-string">'单次放电容量'</span>, <span class="cm-string">'充电倍率'</span>, <span class="cm-string">'温度'</span>,<span class="cm-string">'分容容量'</span>,<span class="cm-string">'首次容量'</span>, <span class="cm-string">'循环寿命'</span>, <span class="cm-string">'t500'</span>, <span class="cm-string">'t1000'</span>, <span class="cm-string">'t1500'</span>, <span class="cm-string">'t2000'</span>, <span class="cm-string">'t2500'</span>, <span class="cm-string">'t3000'</span>,<span class="cm-string">'t3500'</span>, <span class="cm-string">'t4000'</span>, <span class="cm-string">'t4500'</span>, <span class="cm-string">'t5000'</span>, <span class="cm-string">'t5500'</span>, <span class="cm-string">'t6000'</span>, <span class="cm-string">'t6500'</span>, <span class="cm-string">'t7000'</span>,<span class="cm-string">'t7500'</span>, <span class="cm-string">'t8000'</span>, <span class="cm-string">'t8500'</span>, <span class="cm-string">'t9000'</span>, <span class="cm-string">'t9500'</span>, <span class="cm-string">'t10000'</span>, <span class="cm-string">'t10500'</span>,<span class="cm-string">'t11000'</span>, <span class="cm-string">'t11500'</span>, <span class="cm-string">'t12000'</span>, <span class="cm-string">'t12500'</span>, <span class="cm-string">'t13000'</span>, <span class="cm-string">'t13500'</span>, <span class="cm-string">'t14000'</span>,<span class="cm-string">'t14500'</span>, <span class="cm-string">'t15000'</span>],<span class="cm-variable">dtype</span>=<span class="cm-string">'object'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><p><span>之所以做这样的选择，具体原因会在</span><a href='#特征工程'><a href="#特征工程"><span>特征工程</span></a></a><span>的章节详细解释。这里简略说一下，留下的特征组合是分为两部分，一部分是电池的工艺特征部分[&#39;电解液&#39;, &#39;正极材料&#39;, &#39;负极材料&#39;, &#39;隔膜纸&#39;]，另一部分是电池的测试工艺特征部分[&#39;2ex百分比&#39;, &#39;单次放电容量&#39;, &#39;充电倍率&#39;, &#39;温度&#39;, &#39;分容容量&#39;, &#39;首次容量&#39;]。剩下的[&#39;循环寿命&#39;, &#39;t500&#39;, &#39;t1000&#39;……]是属于标签部分，是我们模型要预测的输出（output)，不是特征(input)。</span><strong><span>经过初步特征选择后的样本维度为（2659，41），样本维度有了一定的降低，这对于减少模型复杂度和计算开销有一定的帮助。同时，后续过程中，会根据实际需要，进行特征的变换、构造、选择等操作，这会导致数据维度的变化。</span></strong></p><h4 id='3313-查看数据类型'><span>3.3.1.3 </span><a id='查看数据类型'><span>查看数据类型</span></a></h4><p><span>不同的数据类型有着不同的处理方式，一般数据根据信息构成可以分为：</span></p><ul><li><span>定量数据：指的是一些数值，用于衡量某件东西的数量，根据数值的取值，大部分为连续变量数据。</span></li><li><span>定性数据：指的是一些类别，用于描述某件东西的性质，定性数据是离散变量数据。</span></li></ul><p><span>实际的数据类型会比较复杂，下面的分类有一定的借鉴意义：</span></p><figure><table><thead><tr><th style='text-align:left;' ><span>数据类型</span></th><th><span>数据名称</span></th><th><span>数学含义</span></th><th><span>描述</span></th><th><span>举例</span></th><th><span>可用操作</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><div style="width: 50pt"><span>离散定性                                                 </span></div></td><td><div style="width: 50pt"><span>名义                                                  </span></div></td><td><div style="width: 50pt"><span>=，</span><span class='math-in-toc'>$\neq$</span><span>                                                      </span></div></td><td><div style="width: 200pt"><span>名义变量就是不同的名字，用来告诉我们，这两个数据是否相同</span></div></td><td><div style="width: 50pt"><span>邮编，性别，工号                                                 </span></div></td><td><div style="width: 75pt"><span>众数，信息熵，相关性分析，卡方检验                                      </span></div></td></tr><tr><td style='text-align:left;' ><span>离散定性</span></td><td><span>有序</span></td><td><span>&lt;，&gt;</span></td><td><span>有序变量为数据的相对大小提供信息，告诉我们数据的顺序，但数据之间的大小间隔不具有固定意义，因此有序变量不能加减</span></td><td><span>学历，硬度</span></td><td><span>中位数，分位数，非参分析，符号检验</span></td></tr><tr><td style='text-align:left;' ><span>连续定量</span></td><td><span>有距</span></td><td><span>+，-</span></td><td><span>有距变量之间的间隔是有固定意义的，可以加减，比如同一单位量纲</span></td><td><span>摄氏度温度</span></td><td><span>均值，标准差，皮尔逊相关分析，t检验，F检验</span></td></tr><tr><td style='text-align:left;' ><span>连续定量</span></td><td><span>比率</span></td><td><span>*，/</span></td><td><span>比变量之间的间隔和比例本身都是有意义的，既可减又可乘除</span></td><td><span>电流，质量</span></td><td><span>几何平均，调和平均，百分数，变化量</span></td></tr></tbody></table></figure><p><span>用pandas.info()命令查看数据类型，结果如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment"># &nbsp; Column &nbsp;  Non-Null Count  Dtype &nbsp;</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">---</span> &nbsp;<span class="cm-operator">------</span> &nbsp; &nbsp;<span class="cm-operator">--------------</span> &nbsp;<span class="cm-operator">-----</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">0</span> &nbsp; <span class="cm-variable">电解液</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">1</span> &nbsp; <span class="cm-variable">正极材料</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">2</span> &nbsp; <span class="cm-variable">负极材料</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">3</span> &nbsp; <span class="cm-variable">隔膜纸</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">4</span> &nbsp; <span class="cm-number">2</span><span class="cm-variable">ex百分比</span> &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">5</span> &nbsp; <span class="cm-variable">单次放电容量</span> &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">int64</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">6</span> &nbsp; <span class="cm-variable">充电倍率</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">7</span> &nbsp; <span class="cm-variable">温度</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">8</span> &nbsp; <span class="cm-variable">分容容量</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">9</span> &nbsp; <span class="cm-variable">首次容量</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">10</span> &nbsp;<span class="cm-variable">循环寿命</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1551</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">11</span> &nbsp;<span class="cm-variable">t500</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">……</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><p><span>可以看出&#39;电解液&#39;，&#39;正极材料&#39;，&#39;负极材料&#39;，&#39;隔膜纸&#39;，’充电倍率‘，’温度‘  这几个特征是文本类别，是定性的离散变量，其余的特征和标签都为定量的连续变量。</span></p><h4 id='332-获取各统计量'><span>3.3.2 获取各统计量</span></h4><p><span>利用pandas.describe()查看各统计量，包括个数、平均值、标准差、四分位值、最大最小值等统计量信息，这些信息可以帮助我们更好地判断数据的分布情况、异常情况，进而为下一步的分析提供依据。这边截取一部分结果展示：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">describe</span>().<span class="cm-property">iloc</span>[:,<span class="cm-number">0</span>:<span class="cm-number">7</span>]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><figure><table><thead><tr><th style='text-align:right;' >&nbsp;</th><th style='text-align:right;' ><span>2ex百分比</span></th><th style='text-align:right;' ><span>单次放电容量</span></th><th style='text-align:right;' ><span>分容容量</span></th><th style='text-align:right;' ><span>首次容量</span></th><th style='text-align:right;' ><span>循环寿命</span></th><th style='text-align:right;' ><span>t500</span></th><th style='text-align:right;' ><span>t1000</span></th></tr></thead><tbody><tr><td style='text-align:right;' ><span>count</span></td><td style='text-align:right;' ><span>2659.000000</span></td><td style='text-align:right;' ><span>2659.000000</span></td><td style='text-align:right;' ><span>2659.000000</span></td><td style='text-align:right;' ><span>2659.000000</span></td><td style='text-align:right;' ><span>1551.000000</span></td><td style='text-align:right;' ><span>2659.000000</span></td><td style='text-align:right;' ><span>2658.000000</span></td></tr><tr><td style='text-align:right;' ><span>mean</span></td><td style='text-align:right;' ><span>1.076073</span></td><td style='text-align:right;' ><span>82.009026</span></td><td style='text-align:right;' ><span>217.226859</span></td><td style='text-align:right;' ><span>217.231056</span></td><td style='text-align:right;' ><span>7618.856867</span></td><td style='text-align:right;' ><span>214.039030</span></td><td style='text-align:right;' ><span>210.520614</span></td></tr><tr><td style='text-align:right;' ><span>std</span></td><td style='text-align:right;' ><span>0.130721</span></td><td style='text-align:right;' ><span>1.126295</span></td><td style='text-align:right;' ><span>11.191466</span></td><td style='text-align:right;' ><span>10.905870</span></td><td style='text-align:right;' ><span>5004.821288</span></td><td style='text-align:right;' ><span>11.586694</span></td><td style='text-align:right;' ><span>12.638039</span></td></tr><tr><td style='text-align:right;' ><span>min</span></td><td style='text-align:right;' ><span>1.004000</span></td><td style='text-align:right;' ><span>59.000000</span></td><td style='text-align:right;' ><span>168.792889</span></td><td style='text-align:right;' ><span>176.083000</span></td><td style='text-align:right;' ><span>694.000000</span></td><td style='text-align:right;' ><span>170.119528</span></td><td style='text-align:right;' ><span>171.000000</span></td></tr><tr><td style='text-align:right;' ><span>25%</span></td><td style='text-align:right;' ><span>1.050000</span></td><td style='text-align:right;' ><span>82.000000</span></td><td style='text-align:right;' ><span>208.524014</span></td><td style='text-align:right;' ><span>209.628319</span></td><td style='text-align:right;' ><span>2427.000000</span></td><td style='text-align:right;' ><span>208.008500</span></td><td style='text-align:right;' ><span>205.389424</span></td></tr><tr><td style='text-align:right;' ><span>50%</span></td><td style='text-align:right;' ><span>1.050000</span></td><td style='text-align:right;' ><span>82.000000</span></td><td style='text-align:right;' ><span>220.394639</span></td><td style='text-align:right;' ><span>220.300000</span></td><td style='text-align:right;' ><span>7291.000000</span></td><td style='text-align:right;' ><span>217.374194</span></td><td style='text-align:right;' ><span>214.512194</span></td></tr><tr><td style='text-align:right;' ><span>75%</span></td><td style='text-align:right;' ><span>1.050000</span></td><td style='text-align:right;' ><span>82.000000</span></td><td style='text-align:right;' ><span>225.335917</span></td><td style='text-align:right;' ><span>224.915917</span></td><td style='text-align:right;' ><span>11596.000000</span></td><td style='text-align:right;' ><span>221.908083</span></td><td style='text-align:right;' ><span>218.939438</span></td></tr><tr><td style='text-align:right;' ><span>max</span></td><td style='text-align:right;' ><span>2.000000</span></td><td style='text-align:right;' ><span>83.000000</span></td><td style='text-align:right;' ><span>240.674167</span></td><td style='text-align:right;' ><span>239.923806</span></td><td style='text-align:right;' ><span>20291.000000</span></td><td style='text-align:right;' ><span>237.746944</span></td><td style='text-align:right;' ><span>235.058444</span></td></tr></tbody></table></figure><h4 id='bonus-统计信息输出'><span>BONUS: 统计信息输出</span></h4><p><span>可以利用第三库实现统计信息的文本化，并输出为网页文件，方便查阅。如果有兴趣可以打开</span><a href='reference/data_report.html'><span>data_report.html</span></a><span>，查看详细统计信息。但由于数据信息量较大，生成的网页文件较大，对于有些终端（手机等便携设备）可能无法打开，或显示不完整（例如图例文字缺少对中文支持）。分析系统会自动将数据文件的各个离散变量做频数、极值、排序、缺失值等统计分析并绘制条形图，会对连续变量做极值、缺失值、零值、平均值等统计分析并绘制直方图。同时，分析系统会对各变量进行相关性分析（Pearson相关系数、Spearman相关系数、Kendall相关系数等）、绘制成热力图、变量分布等操作，效果参照下截图：</span></p><p><img src="pic/统计组合.png" style="zoom:67%;" /></p><p>&nbsp;</p><h2 id='34-数据特征分析'><span>3.4 数据特征分析</span></h2><h3 id='341-分布分析'><span>3.4.1 分布分析</span></h3><p><span>数据的分布情况可以直接反应它的集中趋势和散布情况，这是理解数据和其背后规律的绝佳切入点。分布类型可分为离散分布和常用连续分布两类。常见的分布种类有：正太分布(高斯分布)、均匀分布、伯努利分布、泊松分布等。一般生产与科学实验中很多随机变量的概率分布都可以近似地用正态分布来描述。</span></p><h4 id='3411-离散变量分布情况'><span>3.4.1.1 离散变量分布情况</span></h4><p><span>本项目中的离散变量主要是电池的工艺材料参数，即电解液种类、正负极种类等，由于实验样本天然的偏态分布（实验设计总倾向于优化纵深的方向），对离散变量进行分布分析，有助于我们理解样本构成，各特征的主体构成、各特征的独立分布和联合分布情况。</span></p><p><img src="D:\train\figure\离散单变量分布分析3.png" style="zoom: 67%;" /></p><center><a name="图3.1">图3.1 电池不同组成材料在样本空间上的分布</a></center>	<p>&nbsp;</p><p><span>由于静态图表太过于拥挤，影响显示效果。为此制作了下面动态视图，动态视图可以通过鼠标或者底部滑轨进行柱状图的偏移和缩放，同时也提供了图片下载，折线图转换等功能，特别是加入数据视图显示，方便阅读原始数据。可以点击图表右侧的工具栏进行选择。(建议使用Chrome浏览器)</span></p><p>&nbsp;</p><iframe src="pyecharts/不同材料柱状图1.html" width="200" height="2800"></iframe><p>&nbsp;</p><p>&nbsp;</p><iframe src="pyecharts/各离散特征组成1.html" width="150" height="1050"></iframe><p>&nbsp;</p><p><span>从上述柱状图和饼图可以看出，本次实验程序自动抓取的数据样本中，电解液主要是TC-E269-F4和SS-ZZWB011两种，正极材料主要以P2为主，负极材料主要是CP5和CP5-H，隔膜主要恩捷高孔（9+3)</span><span>*</span><span>33/32.5和W-SCOPE高孔（9+3)</span><span>*</span><span>32.5为主，2ex百分比主要是1.05，温度几乎都集中在25℃和40℃两个温度上。各特征的主体分布符合之前的电池实验设计上，这也部分说明了当前我司的实验设计也是朝着优化这几个关键特征取值的方向。不过，这样偏态的特征分布对于后续的机器学习会产生不小的麻烦，比如后续要涉及到的的</span><a href='#异常检测'><span>异常检测</span></a><span>（Outlier Detection)中，很多算法是基于特征的空间距离、密度、聚类，这就会导致频数较少的特征所构成的样本也容易被划为异常类，虽然这种异常类属于natural outlier(自然产生的离群点)，即合理但偏离样本群体的异常类（非人为因素导致的异常），会跟其它non-natural outlier(真正的人为异常点)交织在一起，让算法无法区分，降低算法精度，提高检测成本。</span></p><h4 id='3412-连续变量分布情况'><span>3.4.1.2 连续变量分布情况</span></h4><h5 id='34121-单变量分析'><span>3.4.1.2.1 单变量分析</span></h5><h6 id='341211-特征变量分析'><span>3.4.1.2.1.1 特征变量分析</span></h6><p><span>在本项目的工艺参数特征中，其实完全由电芯自身性能决定而非人为设计的连续型变量特征只有 ‘分容容量’ 和 ‘首次容量’ 两个，其它如单次放电容量，充、放点搁置时间等均为人为设计的实验参数。所以对这两个变量的分析，可以为我们提供一些关于电池的性能解释。</span></p><center>
<div>
<img src="figure/分容容量直方概率图.png"><img src="figure/首次容量直方概率图.png">
</div>
</center>
<center></center><p><span>从上方的频数直方图和核密度曲线（经过平滑处理）可以看出，这两个变量都近似出现双峰分布的情况，两个峰值中心大体出现在200 （对应的样本分布记为</span><mark><span>N</span><sub><span>200</span></sub></mark><span>）和220（对应的样本分布记为</span><mark><span>N</span><sub><span>220</span></sub></mark><span>）位置。处于N</span><sub><span>200</span></sub><span>分布的电池样本要比N</span><sub><span>220</span></sub><span>分布来得少，从目标预期上讲，大部分情况下，我们都希望样本的分容容量能大于200（标准容量200mAh，设计时会留有一定的余量）。这样的分布情况能较好地体现LFP10370C2-200这款电池在这两个特征上的集中和离散情况，也就是大部分实验组合在分容容量和首次容量这两个特征上的取值，在以200和220为均值中心，呈现近似双正态分布，符合中心极限定理的预期。这对于实验设计者来说，可以起到一定的帮助。这种分布其实也隐含地告诉我们，可以通过对特定分布的特征组合进行分析，进而找出关键影响特征。为了比较两个特征的差异情况，可以做偏度和峰度分析。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'分容容量的偏度是{:.4f}，峰度是{:.4f}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">data</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">skew</span>(), <span class="cm-variable">data</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">kurt</span>()))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'首次容量的偏度是{:.4f}，峰度是{:.4f}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">data</span>[<span class="cm-string">'首次容量'</span>].<span class="cm-property">skew</span>(), <span class="cm-variable">data</span>[<span class="cm-string">'首次容量'</span>].<span class="cm-property">kurt</span>()))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量的偏度是</span><span class="cm-operator">-</span><span class="cm-number">0.7928</span><span class="cm-variable">，峰度是0</span><span class="cm-number">.0854</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">首次容量的偏度是</span><span class="cm-operator">-</span><span class="cm-number">0.7291</span><span class="cm-variable">，峰度是</span><span class="cm-operator">-</span><span class="cm-number">0.2874</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><p><span>偏度是衡量随机变量概率分布的不对称性，是相对于平均值不对称程度的度量。有以下特性：</span></p><blockquote><p><span>偏度的取值范围为(-∞,+∞)。</span></p><p><span>当偏度&lt;0时，概率分布图左偏。</span></p><p><span>当偏度=0时，表示数据相对均匀的分布在平均值两侧，但不一定是绝对的对称分布。</span></p><p><span>当偏度&gt;0时，概率分布图右偏。</span></p></blockquote><p><span>从结果上看，两个特征的偏度很接近，说明两个特征变量的左偏程度比较接近。</span></p><p><span>峰度可以用来度量随机变量概率分布的陡峭程度，是概率密度在均值处峰值高低的特征。有以下特性：</span></p><blockquote><p><span>峰度的取值范围为[-2,+∞)（作偏移处理，即超值峰度）。</span></p><p><span>完全服从正态分布的数据的峰度值为 0，峰度值越大，概率分布图越高尖，峰度值越小，越矮胖。</span></p></blockquote><p><span>从结果上看，两个特征的峰度也极为接近，都接近于0，说明这两组特征是比较理想的正态分布。</span></p><h6 id='341212-标签变量分析'><span>3.4.1.2.1.2 标签变量分析</span></h6><p><span>因为本次项目中的标签均为连续型数值变量，所以可以直接对其进行分布分析，结果如下：</span></p><center>
    <div>
        <img src="figure/循环寿命直方概率图.png"><img src="figure/t500.png"><img src="figure/t1000.png">
    </div>
</center><p><span>从循环寿命的分布上看，有很大部分是落在了小于5000次的范围里，近似于尾长型分布，这个情况也是符合实验规律的，毕竟电池实验本身就是不断研究精进、试错的过程。有少部分电池样本的循环寿命接近20000次。这些异常优秀的样本也可以作为重点信息进行研究。而非常有趣的一点是，对于电池在循环500次、1000次后的容量，也是跟分容容量和首次容量一样均是双中心的正态分布。对于分容容量和首次容量应该跟电池在循环中的容量有着很强的正相关型，这也符合理论经验。当然随着循环次数的进行，有些样本会提前掉队，达到寿命，所以整体上将，随着t500、t1000……标签逐渐递增，后面标签对应的样本数量会逐渐减少。另外如果想了解完整的标签分布情况，可以查看</span><a href='reference/data_report.html'><span>data_report.html</span></a><span>。</span></p><h6 id='341213-其它分析工具'><span>3.4.1.2.1.3 其它分析工具</span></h6><p><span>当然，如果想要查看特征对应的分布情况，还可以采用箱线图，小提琴图等形式，这两个图在后面的</span><a herf='#异常检测'><span>异常检测</span></a><span>和其它数据分析中也会有较多的应用：</span></p><center>
    <div>
        <img src="figure/box-an.png"><img src="figure/violin-an.png">
    </div></center><p>&nbsp;</p><p><span>箱形图绘制须使用常用的统计量，能提供有关数据位置和分散情况的关键信息，尤其在比较不同的母体数据时更可表现其差异。箱形图的绘制主要包含六个数据节点，需要先将数据从大到小进行排列，然后分别计算出它的上边缘，上四分位数，中位数，下四分位数，下边缘，上下边缘外围则是异常值（像图中所示分容容量低于下四分位的点），后面在异常检测中会经常使用。</span></p><p><span>小提琴图是用来展示多组数据的分布状态以及概率密度。这种图表结合了箱形图和密度图的特征，主要用来显示数据的分布形状。跟箱形图类似，但是在密度层面展示更好。在数据量非常大不方便一个一个展示的时候小提琴图特别适用。小提琴图其实是箱线图与核密度图的结合，箱线图展示了分位数的位置，小提琴图则展示了任意位置的密度，通过小提琴图可以知道哪些位置的密度较高。小提琴中白点是中位数，黑色盒型的范围是下四分位点到上四分位点，细黑线表示须。外部形状即为核密度估计（在概率论中用来估计未知的密度函数，属于非参数检验方法之一）。</span></p><p><span>从分容容量的箱型图可以看出，所有样本的平均值大约220，而小提琴图则进一步告诉我们N</span><sub><span>200</span></sub><span>和N</span><sub><span>220</span></sub><span>两个分布中心和对应的密度：以N</span><sub><span>220</span></sub><span>为分布中心的样本密度要</span><b><mark><span>大于</span></mark></b><span>以N</span><sub><span>200</span></sub><span>为分布中心的样本密度。</span></p><p><span>当然，我们也可以在单一图像将多个连续变量（同一单位量纲）同时表示出来，比如可以对将它们放在一张箱形图里，这样可以帮助我们更好地了解多个连续变量各自的分布情况（不是联合分布），如下图所示:</span></p><div align="center">
    <img src="figure/多离散变量各自分布.png">
</div><p><span>从上面的多变量箱线图可以看出，随着实验循环次数的增加，电芯容量的分布均值逐渐减少，这符合电池容量损耗规律。</span></p><h5 id='34122-多变量分析'><span>3.4.1.2.2 多变量分析</span></h5><p><span>单纯在单变量上理解数据显然不能全面地理解分析数据，我们需要寻找变量间的关系。当然这种关系可以是离散变量+连续变量，或者连续变量+连续变量，又或者是离散变量+离散变量（本次项目，离散变量大多是预设的工艺参数、材料参数等，大多数情况下可以理解离散变量之间线性无关，无需做离散变量间的分布分析和相关性分析），具体分析方法由变量类型决定。在数据量很大的情况下，数据可视化是最好的途径。分析连续变量之间的关系，我们可以直接观察变量间的散点图，当然因为样本数量比较多，我们也可以采用其它可视化工具。</span></p><h6 id='341221-二维变量分析'><span>3.4.1.2.2.1 二维变量分析</span></h6><p><b><a id='案例1 各工艺特征对循环寿命的二元分布'><span>案例1 各工艺特征对循环寿命的二元分布</span></a></b></p><p><span>影响电池寿命的两类重要因素，除了材料因素之外，就是电池的使用环境，比如温度，充放电电流、充放电后搁置时间等，下面选温度、充电电流、充电后搁置时间、放电后搁置时间这四个工艺特征，看一下它们各自对电池最终寿命的分布情况有着怎样的影响。下面是这几种因素条件下的循环寿命分布增强箱型图（关于如何理解增强箱型图，可以点击这篇</span><a href='https://vita.had.co.nz/papers/letter-value-plot.pdf' target='_blank'><span> Letter-value plots: Boxplots for large data</span></a><span>论文了解）。</span></p><div align="center">
    <img src="figure/T-L.PNG"><img src="figure/C-L.PNG"><img src="figure/CT-L.PNG"><img src="figure/DT-L.PNG">
</div><p><span>从温度上看，随着温度提升，循环寿命的分布中心也随之提高，这符合电池理论与实际经验；从充电电流上，对于LFP10370C2-200mAh电池，电池寿命随电流从0.8A-1.6A提升而逐渐升高。而对于充电后搁置时间和放电后搁置时间这两种特征，电池寿命并不呈现与之相同的正/负相关变化，这里面存在两种可能性：</span></p><ol start='' ><li><span>LFP10370C2-200mAh这款电池的特性（背后那支无法看清全貌的物理学上帝之手）决定；</span></li><li><span>样本不均衡，比如这些特征对应的少数样本（如充电后搁置时间里的14分钟这个值所对应的电池样本）刚好本身的电池材料特性就比其它多数样本来的表现不好，所以本来就没有可比性（电池材料都不同了，自然可比性无从谈起）。</span></li></ol><p><span>对于技术人员，是很欢迎第一种可能的，因为那就意味着又掌握了一种电池规律。所以为了排除第二种可能性，必须将研究范围进行收缩，挑选那些样本材料相同，但测试参数不同的样本集合来进行研究，由于篇幅限制，只挑选充电后搁置时间这个特征具体过程如下：</span></p><p><span>step1: 首先先看一下，充电后搁置时间这个特征各个离散变量出现的频数。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看不同充电后搁置时间的样本数量</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> [<span class="cm-number">0.5</span>,<span class="cm-number">3.5</span>,<span class="cm-number">7.0</span>,<span class="cm-number">14.0</span>]:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">n</span> = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">"充电后搁置时间"</span>]==<span class="cm-variable">i</span>) <span class="cm-operator">&amp;</span> (<span class="cm-variable">data</span>[<span class="cm-string">"循环寿命"</span>].<span class="cm-property">notna</span>())][<span class="cm-string">"充电后搁置时间"</span>].<span class="cm-property">count</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'充电后搁置时间为{}的样本数量为:{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">i</span>,<span class="cm-variable">n</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电后搁置时间为0</span><span class="cm-number">.5</span><span class="cm-variable">的样本数量为</span>:<span class="cm-number">1330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电后搁置时间为3</span><span class="cm-number">.5</span><span class="cm-variable">的样本数量为</span>:<span class="cm-number">4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电后搁置时间为7</span><span class="cm-number">.0</span><span class="cm-variable">的样本数量为</span>:<span class="cm-number">203</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电后搁置时间为14</span><span class="cm-number">.0</span><span class="cm-variable">的样本数量为</span>:<span class="cm-number">11</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><div align="center">
    <img src="figure/充电后搁置时间频数.png">
</div> <p><span>很不幸的是，3.5分钟对应的样本数量太少，无法形成有效样本集合。那我们退而求次，看一下，0.5，7，14分钟充电后搁置时间对电池寿命的影响。</span></p><p><span>step2: 对数据样本进行分组，挑选目标样本。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 先根据材料进行分组</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_com</span> = <span class="cm-variable">data</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_index</span> = <span class="cm-variable">grouped_com</span>.<span class="cm-property">count</span>()[<span class="cm-string">'分容容量'</span>].<span class="cm-property">sort_values</span>(<span class="cm-variable">ascending</span>=<span class="cm-keyword">False</span>).<span class="cm-property">index</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 选出同时含有0.5,7,14分钟充电后搁置时间的样本数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">tar</span>(<span class="cm-variable">grouped_index</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">lis_index</span> = []</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">lis_df</span> = []</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">grouped_index</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_single_group</span> = <span class="cm-variable">grouped_com</span>.<span class="cm-property">get_group</span>(<span class="cm-variable">i</span>)[</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  [<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,<span class="cm-string">'温度'</span>,<span class="cm-string">'2ex百分比'</span>,<span class="cm-string">'充电后搁置时间'</span>,<span class="cm-string">'放电后搁置时间'</span>,<span class="cm-string">'循环寿命'</span>]]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">if</span> (<span class="cm-number">0.5</span> <span class="cm-keyword">in</span> <span class="cm-variable">data_single_group</span>[<span class="cm-string">'充电后搁置时间'</span>].<span class="cm-property">to_list</span>()) <span class="cm-operator">&amp;</span><span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  (<span class="cm-number">7.0</span> <span class="cm-keyword">in</span> <span class="cm-variable">data_single_group</span>[<span class="cm-string">'充电后搁置时间'</span>].<span class="cm-property">to_list</span>()) <span class="cm-operator">&amp;</span><span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  (<span class="cm-number">14.0</span> <span class="cm-keyword">in</span> <span class="cm-variable">data_single_group</span>[<span class="cm-string">'充电后搁置时间'</span>].<span class="cm-property">to_list</span>()): </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">lis_df</span>.<span class="cm-property">append</span>(<span class="cm-variable">data_single_group</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">lis_index</span>.<span class="cm-property">append</span>(<span class="cm-variable">i</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">pass</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">pd</span>.<span class="cm-property">concat</span>(<span class="cm-variable">lis_df</span>),<span class="cm-variable">lis_index</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span> = <span class="cm-variable">tar</span>(<span class="cm-variable">grouped_index</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">电解液</span> <span class="cm-variable">正极材料</span> &nbsp; <span class="cm-variable">负极材料</span> &nbsp; &nbsp; <span class="cm-variable">隔膜纸</span> &nbsp; &nbsp;<span class="cm-variable">温度</span> <span class="cm-number">2</span><span class="cm-variable">ex百分比</span> <span class="cm-variable">充电后搁置时间</span> <span class="cm-variable">放电后搁置时间</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">422</span> &nbsp; <span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp; <span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp;<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">25</span> &nbsp; <span class="cm-number">1.004</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">10.0</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">423</span> &nbsp; <span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp; <span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp;<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">25</span> &nbsp; <span class="cm-number">1.004</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">10.0</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">424</span> &nbsp; <span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp; <span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp;<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">25</span> &nbsp; <span class="cm-number">1.004</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">10.0</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">425</span> &nbsp; <span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp; <span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp;<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">25</span> &nbsp; <span class="cm-number">1.004</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">10.0</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">426</span> &nbsp; <span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp; <span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp;<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">40</span> &nbsp; <span class="cm-number">1.004</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0.5</span> &nbsp; &nbsp; <span class="cm-number">10.0</span> &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> ... &nbsp; &nbsp; &nbsp; &nbsp;  ...  ... &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...  .. &nbsp; &nbsp; ... &nbsp; &nbsp;  ... &nbsp; &nbsp;  ... &nbsp; ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-null cm-error">[</span><span class="cm-number">317</span> <span class="cm-variable">rows</span> <span class="cm-variable">x</span> <span class="cm-number">9</span> <span class="cm-variable">columns</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [(<span class="cm-string">'TC-E269-F4'</span>, <span class="cm-string">'P2'</span>, <span class="cm-string">'CP5'</span>, <span class="cm-string">'恩捷高孔(9+3)*33'</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  (<span class="cm-string">'TC-E269-F4'</span>, <span class="cm-string">'P2'</span>, <span class="cm-string">'CP5-H'</span>, <span class="cm-string">'恩捷高孔(9+3)*33'</span>)]<span class="cm-error">)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 713px;"></div><div class="CodeMirror-gutters" style="display: none; height: 713px;"></div></div></div></pre><p><span>从结果上，充电后搁置时间同时含有0.5，7，14这三个值的材料组合只有下面两组 :</span></p><ul><li><span>&#39;TC-E269-F4&#39;, &#39;P2&#39;, &#39;CP5&#39;, &#39;恩捷高孔(9+3)</span><span>*</span><span>33&#39;</span></li><li><span>&#39;TC-E269-F4&#39;, &#39;P2&#39;, &#39;CP5-H&#39;, &#39;恩捷高孔(9+3)*33&#39;     </span></li></ul><p><span>step3: 对目标样本组进行二元变量分析，即分析充电后搁置时间对电池循环寿命的影响。</span></p><div align="center">
    <img src="figure/充电后搁置时间对循环寿命的影响.png">
</div><p><span>从上面的分类箱型图可以看出：</span></p><ol start='' ><li><span>在0.5分钟充电后搁置时间下，循环寿命在所有组别里表现最好；40℃相比于25℃，循环寿命的分布中心略微提高；</span></li><li><span>在7分钟充电后搁置时间下，循环寿命比0.5分钟时急剧下降，40℃相比于25℃，循环寿命的分布中心提高明显；</span></li><li><span>电池样本在充电后搁置时间为7分钟和14分钟时，循环寿命没有显著区别。</span></li></ol><p><span>同样的分析手法，也可以应用于其它材料组合上，限于篇幅和行文重点不在于某个具体案例，所以没有过多展开讨论。</span></p><p><b><a id='案例2 分容容量与首次容量的二元分布'><span>案例2 分容容量与首次容量的二元分布</span></a></b></p><p><span>由于整个样本特征和标签维度太大（59维），不能一一展示任意两个变量的分布情况（数据维度有60维，就有</span><span class='math-in-toc'>$C_{60}^2$</span><span>=1770种分组）。实际在作分析时，会有目的性选取实验设计者关注的部分。比如下面这个例子就是分容容量和首次容量的二维分布情况。下面各图按顺序依次是带频数色谱的二元直方图，带密度色谱的二元核密度图，带箱型图的二元直方图，带小提琴图的二元直方图，带直方图的二元散点图。</span></p><div align="center">
    <img src="figure/分容和首次1.png"><img src="figure/分容和首次2.png"><img src="figure/joint-box.png" style="zoom: 80%;"><img src="figure/joint-violin.png" style="zoom: 80%;"><img src="figure/joint-an.png">
</div><p><span>从这几个图可以清晰地看出，这两个连续变量除了各自保留原有的N</span><sub><span>200</span></sub><span>和N</span><sub><span>220</span></sub><span>分布中心外，分容容量和首次容量在二元分布上呈现显著的线性相关（近似于y=kx，且k接近1，图像中的绿线）。</span></p><p>&nbsp;</p><p><b><a id='案例3 分容容量与循环寿命的二元分布'><span>案例3 分容容量与循环寿命的二元分布</span></a></b></p><p><span>同样，为了探寻特征和标签之间的关系，我们也可以对分容容量和循环寿命变量做二元分布分析：</span></p><div align="center">
    <img src="figure/分容和寿命2.png"><img src="figure/分容和寿命3.png" style="zoom: 80%;"><img src="figure/分容和寿命4.png" style="zoom: 80%;"><img src="figure/分容和寿命5.png" style="zoom: 80%;">
</div><p>&nbsp;</p><p><span>从上面的分布图中，出现了两个分布中心，对应的分容容量分布中心大致在200和220附近，对应的循环寿命分布中心大致在2000和10000附近且在2000分布的样本密度要大于10000的样品密度。</span><b><mark><span>其实这样的分布情况就意味着，对于大多数样本，当分容容量在200左右时，最终寿命落在小于5000的范围的概率会非常大；当分容容量在220附近及大于220时，最终寿命落在10000附近及以上的概率会比较大！这是一个非常有用的统计学结论，比如可以用在循环寿命预测上，对于实验设计人员如果只要知道电池的分容容量，就可以对电池最终寿命有一个概率判断。</span></mark></b><span>那么具体概率是多少呢？这是可以通过对原数据进行计算得出，为了简单操作，我们假设以210为分容容量阈值，循环寿命以7300为阈值来计算：</span></p><p><span>A为分容容量的完备事件组，分容容量小于210mAh记为A</span><sub><span>0</span></sub><span>，分容容量大于等于210mAh记为A</span><sub><span>1</span></sub><span>；</span></p><p><span>B为循环寿命的完备事件组，循环寿命小于7300记为B</span><sub><span>0</span></sub><span>，循环寿命大于等于7300记为B</span><sub><span>1</span></sub><span>；</span></p><p><span>P(A</span><sub><span>i</span></sub><span>，B</span><sub><span>i</span></sub><span>)为两事件的联合概率，计算如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分容容量小于210，循环寿命小于7300的联合概率</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A0B0</span> = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">&lt;</span><span class="cm-number">210</span>) <span class="cm-operator">&amp;</span> (<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>]<span class="cm-operator">&lt;</span><span class="cm-number">7300</span>) <span class="cm-operator">&amp;</span> (<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>())].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">P0</span>= <span class="cm-variable">A0B0</span><span class="cm-operator">/</span><span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>()].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果：32.24%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分容容量大于210，循环寿命大于7300的联合概率</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A1B1</span> = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">&gt;</span>=<span class="cm-number">210</span>) <span class="cm-operator">&amp;</span> (<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>]<span class="cm-operator">&gt;</span>=<span class="cm-number">7300</span>) <span class="cm-operator">&amp;</span> (<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>())].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">P1</span>= <span class="cm-variable">A1B1</span><span class="cm-operator">/</span><span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>()].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果：48.16%</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p><span>联合概率只给出了目标样本在样本总体中的概率情况，我们更希望得到给出特定分容容量条件下，循环寿命是否小于7300的条件概率。</span></p><p><span>P( B</span><sub><span>i</span></sub><span> | A</span><sub><span>i</span></sub><span>)为在A</span><sub><span>i</span></sub><span>发生的前提下，B</span><sub><span>i</span></sub><span>发生的条件概率，则 </span><span class='math-in-toc'>$ P( B~i~ \,|\, A~i~)\,=\,\frac{P( B~i~ \,,\, A~i~)}{P( A~i~ )}$</span><span>, 具体计算如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分容容量小于210,循环寿命小于7300的条件概率</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A0</span> = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">&lt;</span><span class="cm-number">210</span>) <span class="cm-operator">&amp;</span> (<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>())].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]<span class="cm-operator">/</span><span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>()].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">PA0</span>= <span class="cm-variable">P0</span><span class="cm-operator">/</span><span class="cm-variable">A0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果：94.70%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分容容量大于等于210,循环寿命大于等于7300的条件概率</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">A1</span> = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">&gt;</span>=<span class="cm-number">210</span>) <span class="cm-operator">&amp;</span> (<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>())].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]<span class="cm-operator">/</span><span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>()].<span class="cm-property">shape</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">PA1</span>= <span class="cm-variable">P1</span><span class="cm-operator">/</span><span class="cm-variable">A1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果：73.02%</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p><span>如果假设该样本集合能较好地反映真实总体情况，即以最大似然估计来看，可以推出以下结论：</span></p><ol start='' ><li><b><mark><span>当如果一个电芯的分容容量小于210mAh, 那么这个电芯在经历循环寿命测试后，有94.70%的概率其循环寿命会小于7300。</span></mark></b></li><li><b><mark><span>当如果一个电芯的分容容量大于等于210mAh, 那么这个电芯在经历循环寿命测试后，有73.02%的概率其循环寿命会大于等于7300。</span></mark></b></li></ol><p><span>当然上述结论没有考虑各个电芯的材料和工步差异，对于不同材料组合和工步，其条件概率会不同。但是从整体上看，样本的条件概率会符合上述结论。</span></p><p><span>同样地，我们可以计算出，已知首次容量条件下，循环寿命是否小于7300的条件概率，并将结果跟上面结果合并，做成表格，如下：</span></p><figure><table><thead><tr><th><span>容量、寿命取值</span></th><th><span>联合概率</span><span class='math-in-toc'>$ P( B~i~ \,,\, A~i~)$</span></th><th><span>条件概率</span><span class='math-in-toc'>$ P( B~i~ \,|\, A~i~)$</span></th></tr></thead><tbody><tr><td><span>分容容量&lt; 210mAh，寿命&lt;7300</span></td><td><span>32.24%</span></td><td><span>94.70%</span></td></tr><tr><td><span>分容容量&gt;= 210mAh，寿命&gt;=7300</span></td><td><span>48.16%</span></td><td><span>73.02%</span></td></tr><tr><td><span>首次容量&lt; 210mAh，寿命&lt;7300</span></td><td><span>33.27%</span></td><td><span>93.99%</span></td></tr><tr><td><span>首次容量&gt;= 210mAh，寿命&gt;=7300</span></td><td><span>47.84%</span></td><td><span>72.53%</span></td></tr></tbody></table></figure><p><b><mark><span>从结果上看，已知分容容量或首次容量条件下，判断循环寿命是否小于7300的条件概率，两者相差效果不大，分容容量的条件下的条件概率略高。上面的分析是简单将各个连续变量分为两组（小于/大于等于设定阈值），如果将组别细分，可以得到更为精细的预测结果。这个例子也说明了分布分析在数据挖掘中的效用。在实际应用中技术人员可以采用精细划分的分容容量来预测循环寿命。</span></mark></b></p><h6 id='341222-三维及高维变量分析'><span>3.4.1.2.2.2 三维及高维变量分析</span></h6><p><b><a id='案例1 分容容量、首次容量与循环寿命的三元分布'><span>案例1 分容容量、首次容量与循环寿命的三元分布</span></a></b><span>		</span></p><p><span>由于三个变量都为连续变量，从可视化的角度上讲，可以做一个</span><a id='3D散点图'><span>3D散点图</span></a><span>，看一下大概的分布情况：</span></p><div align="center">
    <img src="figure/3D6.png" style="zoom: 40%" :=""><img src="figure/3D11.png" style="zoom: 40%">
</div><p>&nbsp;</p><p><span>从上面第一个图可以看出，大体上空间点是聚集成簇的，根据循环寿命的取值，大致可以分为两个部分，同时有少量离群点（潜在异常点）。跟二元分析类似，根据分容容量和首次容量的取值不同，我们可以进一步对散点进行分组，由于样本数量太多，静态3D散点图不太方便直观。下面是动态3D散点图：</span></p><p>&nbsp;</p><p>&nbsp;</p><iframe src="pyecharts/scatter3d.html" height="700"></iframe><p>&nbsp;</p><p><span>动态3D散点图能帮助我们对数据细节有更好地理解。另外我们可以用分解变量，构筑关系子图的方式对数据进行更好地剖析。下面为</span><a id='配对关系图'><span>配对关系图</span></a><span>，位于对角线的图形是单变量的直方图和核密度曲线图，网格矩阵对角线上方的是两变量之间的散点图，对角线下方的是两变量之间的二元核密度图。</span></p><div align="center">
    <img src="figure/pair2.png">
</div><p>&nbsp;</p><p><span>从配对关系图很明显地看出，分容容量和首次容量之间强线性关系，两者关于循环寿命的二元核密度图和散点图非常接近。与二元分布的分析类似，但增加了一个维度的变量，我们要对概率公式进行相应改造：</span></p><p><span>A</span><sup><span>0</span></sup><span>为分容容量的完备事件组，分容容量小于210mAh记为A</span><sub><span>0</span></sub><sup><span>0</span></sup><span>，分容容量大于等于210mAh记为A</span><sub><span>1</span></sub><sup><span>0</span></sup><span>；</span></p><p><span>A</span><sup><span>1</span></sup><span>为首次容量的完备事件组，首次容量小于210mAh记为A</span><sub><span>0</span></sub><sup><span>1</span></sup><span>，首次容量大于等于210mAh记为A</span><sub><span>1</span></sub><sup><span>1</span></sup><span>；</span></p><p><span>B为循环寿命的完备事件组，循环寿命小于7300记为B</span><sub><span>0</span></sub><span>，循环寿命大于等于7300记为B</span><sub><span>1</span></sub><span>；</span></p><p><span>P(B</span><sub><span>i</span></sub><span>，A</span><sub><span>i</span></sub><sup><span>0</span></sup><span>，A</span><sub><span>i</span></sub><sup><span>1</span></sup><span>）为三事件的联合概率，P( B</span><sub><span>i</span></sub><span> | A</span><sub><span>i</span></sub><sup><span>0</span></sup><span>，A</span><sub><span>i</span></sub><sup><span>1</span></sup><span>)为在A</span><sub><span>i</span></sub><sup><span>0</span></sup><span>，A</span><sub><span>i</span></sub><sup><span>1</span></sup><span>两者同时发生的前提下，B</span><sub><span>i</span></sub><span>发生的条件概率</span></p><p><span>公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n482" cid="n482" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="6.703ex" viewBox="0 -1678.8 59683.7 2886" role="img" focusable="false" style="vertical-align: -2.804ex; max-width: 100%;"><defs><path stroke-width="0" id="E5-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E5-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E5-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E5-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E5-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E5-MJMATHI-50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path stroke-width="0" id="E5-MJMATHI-42" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path stroke-width="0" id="E5-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E5-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E5-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E5-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E5-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E5-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E5-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E5-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path stroke-width="0" id="E5-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-3.1"><use xlink:href="#E5-MJMAIN-28"></use><use xlink:href="#E5-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E5-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E5-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E5-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(19705,0)"><g transform="translate(-15,0)"><use xlink:href="#E5-MJMATHI-50" x="0" y="0"></use><use xlink:href="#E5-MJMAIN-28" x="751" y="0"></use><use xlink:href="#E5-MJMATHI-42" x="1140" y="0"></use><use xlink:href="#E5-MJMATHI-69" x="2149" y="0"></use><use xlink:href="#E5-MJMAIN-7C" x="2910" y="0"></use><g transform="translate(3355,0)"><use xlink:href="#E5-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E5-MJMAIN-30" x="1060" y="509"></use><use transform="scale(0.707)" xlink:href="#E5-MJMATHI-69" x="1060" y="-429"></use></g><use xlink:href="#E5-MJMAIN-2C" x="4558" y="0"></use><g transform="translate(5170,0)"><use xlink:href="#E5-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E5-MJMAIN-31" x="1060" y="487"></use><use transform="scale(0.707)" xlink:href="#E5-MJMATHI-69" x="1060" y="-429"></use></g><use xlink:href="#E5-MJMAIN-29" x="6540" y="0"></use><use xlink:href="#E5-MJMAIN-3D" x="7207" y="0"></use><g transform="translate(8151,0)"><g transform="translate(397,0)"><rect stroke="none" width="7049" height="60" x="0" y="220"></rect><g transform="translate(60,781)"><use xlink:href="#E5-MJMATHI-50" x="0" y="0"></use><use xlink:href="#E5-MJMAIN-28" x="751" y="0"></use><use xlink:href="#E5-MJMATHI-42" x="1140" y="0"></use><use xlink:href="#E5-MJMATHI-69" x="2149" y="0"></use><use xlink:href="#E5-MJMAIN-2C" x="2910" y="0"></use><g transform="translate(3521,0)"><use xlink:href="#E5-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E5-MJMAIN-30" x="1060" y="509"></use><use transform="scale(0.707)" xlink:href="#E5-MJMATHI-69" x="1060" y="-429"></use></g><use xlink:href="#E5-MJMAIN-2C" x="4725" y="0"></use><g transform="translate(5336,0)"><use xlink:href="#E5-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E5-MJMAIN-31" x="1060" y="487"></use><use transform="scale(0.707)" xlink:href="#E5-MJMATHI-69" x="1060" y="-429"></use></g><use xlink:href="#E5-MJMAIN-29" x="6540" y="0"></use></g><g transform="translate(1251,-802)"><use xlink:href="#E5-MJMATHI-50" x="0" y="0"></use><use xlink:href="#E5-MJMAIN-28" x="751" y="0"></use><g transform="translate(1140,0)"><use xlink:href="#E5-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E5-MJMAIN-30" x="1060" y="509"></use><use transform="scale(0.707)" xlink:href="#E5-MJMATHI-69" x="1060" y="-429"></use></g><use xlink:href="#E5-MJMAIN-2C" x="2343" y="0"></use><g transform="translate(2954,0)"><use xlink:href="#E5-MJMATHI-41" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E5-MJMAIN-31" x="1060" y="487"></use><use transform="scale(0.707)" xlink:href="#E5-MJMATHI-69" x="1060" y="-429"></use></g><use xlink:href="#E5-MJMAIN-29" x="4158" y="0"></use></g></g></g><use xlink:href="#E5-MJMATHI-69" x="16719" y="0"></use><use xlink:href="#E5-MJMAIN-2208" x="17341" y="0"></use><use xlink:href="#E5-MJMAIN-5B" x="18286" y="0"></use><use xlink:href="#E5-MJMAIN-30" x="18731" y="0"></use><use xlink:href="#E5-MJMAIN-2C" x="19231" y="0"></use><use xlink:href="#E5-MJMAIN-31" x="19842" y="0"></use><use xlink:href="#E5-MJMAIN-5D" x="20342" y="0"></use></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">P( B~i~ \,|\, A_i^0,\,A_i^1\,)=\,\frac{P( B~i~ \,,\, A_i^0,\,A_i^1)}{P( A_i^0 ,\,A_i^1)}\quad i\in[\,0,\,1]\tag{3.1}</script></div></div><p><span>计算结果如下：</span></p><figure><table><thead><tr><th><span>分容容量、首次容量、循环寿命取值</span></th><th><span>联合概率P(B</span><sub><span>i</span></sub><span>，A</span><sub><span>i</span></sub><sup><span>0</span></sup><span>，A</span><sub><span>i</span></sub><sup><span>1</span></sup><span>）</span></th><th><span>条件概率P(B</span><sub><span>i</span></sub><span>  </span><span>|</span><span>A</span><sub><span>i</span></sub><sup><span>0</span></sup><span>，A</span><sub><span>i</span></sub><sup><span>1</span></sup><span>）</span></th></tr></thead><tbody><tr><td><span>分容&amp;首次&lt;210mAh，寿命&lt;7300</span></td><td><span>31.85%</span></td><td><span>89.98%</span></td></tr><tr><td><span>分容&amp;首次&gt;=210mAh，寿命&gt;=7300</span></td><td><span>47.71%</span></td><td><span>72.33%</span></td></tr></tbody></table></figure><p><b><a id='案例2 电池材料与分容容量的多元分布'><span>案例2 电池材料与分容容量的多元分布</span></a></b><span>		</span></p><p><span>从可视化的角度上讲，无法进行三维以上维度空间（在本例中，是电解液，正极材料，负极材料，隔膜纸这四个离散变量，加分容容量一个连续变量）的可视化，人类也无法直观想象出高于三维的维度空间里的数据分布，但是我们可以取巧，因为有四个维度是离散值，我们可以将每个离散值一 一作图，从而起到降维的作用。由于降维后的图片数量太多，这里就不展示了，可以点击</span><a href='figure/五维空间可视化.png'><span>链接</span></a><span>访问。同时因为选定了负极材料和隔膜纸对分容容的分布影响，我们也可以省略正极材料和电解液部分，可以点击</span><a href='figure/三变量联合分布.png'><span>链接</span></a><span>访问。</span></p><p>&nbsp;</p><div>
<img style="width:50%;" src="figure/电解液-分容.png"><img style="width:50%;" src="figure/正极材料-分容.png"><img style="width:50%;" src="figure/负极材料-分容.png"><img style="width:50%;" src="figure/隔膜纸-分容.png">
</div><p>&nbsp;</p><p><span>因为离散值比较多，直方图看起来不是很直观，大家可以点击查看</span><a href='figure/四维KDE.png'><span>核密度曲线</span></a><span> 。从上述的结果可以看出，不同种电解液和不同种正极材料在分容容量特征空间上仍然能取得较好的双正态分布，跟之前的分容容量的单变量分布较为一致。而负极材料和隔膜纸在分容容量特征空间上均值中心分布较为离散，且有部分的负极材料种类和隔膜纸种类，在落在N</span><sub><span>200</span></sub><span>分布的样本数量会比落在N</span><sub><span>220</span></sub><span>分布的样本数量来的多，这与整体分布相比，呈现较大的异常。那么可能的原因可能有：</span></p><ol start='' ><li><b><mark><span>含有这些负极材料、隔膜的样本太少，刚好这些样本里，这些负极材料、隔膜跟其它正极材料、电解液的特征组合产生了某种奇妙的反应，使其是在分容容量上趋向N</span><sub><span>200</span></sub><span>分布，我们可以戏称为“遇人不淑”</span></mark></b><span>；</span></li><li><b><mark><span>这些负极材料、隔膜，本身对分容容量的影响就大于其它材料因素，不管与其搭配的样本组合里正极材料、电解液如何变化，分容容量都会趋向落在N</span><sub><span>200</span></sub><span>附近。这也意味着对分布容量而言，这些样本中，负极材料种类和隔膜种类，是影响N</span><sub><span>200</span></sub><span>分布的决定因素，我们可以戏称为“天生异禀&quot;。</span></mark></b></li></ol><p><span>为此，我们可以对样本在负极材料和隔膜纸上的分组分布进行进一步探索:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_neg</span> = <span class="cm-variable">data</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'负极材料'</span>])</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_neg</span>.<span class="cm-property">describe</span>()[<span class="cm-string">'分容容量'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_sep</span> = <span class="cm-variable">data</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'隔膜纸'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_sep</span>.<span class="cm-property">describe</span>()[<span class="cm-string">'分容容量'</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><div align="center">
    <img src="figure/负极材料对分容容量的影响.png" width="300px" height="300px"> <img src="figure/隔膜对分容容量的影响.png" width="300px" height="300px">
</div><p><span>通过进一步的对数据进行分组发现：在负极材料中CP7-M+BAG-8K这种负极材料，样本总数为228，均值为199.3，标准差为3.80。这种情况很可能就是我们刚才分析的第二种可能，即本身&quot;天生异禀&quot;，但是不要轻易下结论，我们还需进一步探究含CP7-M+BAG-8K的特征组合，如果特征组合比较多（即跟多种正极材料、电解液组合），那就可以基本判断CP7-M+BAG-8K这种材料真的是“天生异禀”了。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span>=<span class="cm-variable">data</span>.<span class="cm-property">dropna</span>(<span class="cm-variable">subset</span>=[<span class="cm-string">'分容容量'</span>])</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看与CP7-M+BAG-8K搭配的电解液组合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'负极材料'</span>]==<span class="cm-string">'CP7-M+BAG-8K'</span>][<span class="cm-string">'电解液'</span>].<span class="cm-property">unique</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">array</span>([<span class="cm-string">'样品SS-ZZWB011'</span>, <span class="cm-string">'SS-ZZWB077'</span>, <span class="cm-string">'SS-ZZWB078'</span>, <span class="cm-string">'SS-ZZWB079'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB080'</span>, <span class="cm-string">'SS-ZZWB081'</span>, <span class="cm-string">'SS-ZZWB082'</span>, <span class="cm-string">'SS-ZZWB083'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB084'</span>, <span class="cm-string">'SS-ZZWB085'</span>, <span class="cm-string">'SS-ZZWB086'</span>, <span class="cm-string">'SS-ZZWB087'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB088'</span>, <span class="cm-string">'SS-ZZWB089'</span>, <span class="cm-string">'SS-ZZWB090'</span>, <span class="cm-string">'SS-ZZWB091'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB092'</span>, <span class="cm-string">'量产SS-ZZWB011'</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">object</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 看与CP7-M+BAG-8K搭配的正极材料组合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'负极材料'</span>]==<span class="cm-string">'CP7-M+BAG-8K'</span>][<span class="cm-string">'正极材料'</span>].<span class="cm-property">unique</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">array</span>([<span class="cm-string">'P2'</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">object</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看与CP7-M+BAG-8K搭配的隔膜纸组合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'负极材料'</span>]==<span class="cm-string">'CP7-M+BAG-8K'</span>][<span class="cm-string">'隔膜纸'</span>].<span class="cm-property">unique</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">array</span>([<span class="cm-string">'W-SCOPE高孔9*32.5'</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">object</span>) </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 414px;"></div><div class="CodeMirror-gutters" style="display: none; height: 414px;"></div></div></div></pre><p><span>从结果上看，当负极材料是CP7-M+BAG-8K时，不管何种电解液，样本的分容容量最终还是会落在N</span><sub><span>200</span></sub><span>附近，电解液搭配不会对N</span><sub><span>200</span></sub><span>分布产生影响；正极材料P2从图2可以知道，其分布跟整体分容容量分布较为一致，可以排除P2“天生异禀”的可能；剩下隔膜中，只有一种搭配：W-SCOPE高孔9</span><span>*</span><span>32.5， 由图3知道，W-SCOPE高孔9*32.5正好就是我们要排查的潜在“天生异禀”因素，所以我们进一步对其进行分析：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看与W-SCOPE高孔9*32.5搭配的负极材料组合</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'隔膜纸'</span>]==<span class="cm-string">'W-SCOPE高孔9*32.5'</span>][<span class="cm-string">'负极材料'</span>].<span class="cm-property">unique</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">array</span>([<span class="cm-string">'CP7-M+BAG-8K'</span>, <span class="cm-string">'KC-4'</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">object</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看与W-SCOPE高孔9*32.5搭配的电解液组合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'隔膜纸'</span>]==<span class="cm-string">'W-SCOPE高孔9*32.5'</span>][<span class="cm-string">'电解液'</span>].<span class="cm-property">unique</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">array</span>([<span class="cm-string">'样品SS-ZZWB011'</span>, <span class="cm-string">'SS-ZZWB077'</span>, <span class="cm-string">'SS-ZZWB078'</span>, <span class="cm-string">'SS-ZZWB079'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB080'</span>, <span class="cm-string">'SS-ZZWB081'</span>, <span class="cm-string">'SS-ZZWB082'</span>, <span class="cm-string">'SS-ZZWB083'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB084'</span>, <span class="cm-string">'SS-ZZWB085'</span>, <span class="cm-string">'SS-ZZWB086'</span>, <span class="cm-string">'SS-ZZWB087'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB088'</span>, <span class="cm-string">'SS-ZZWB089'</span>, <span class="cm-string">'SS-ZZWB090'</span>, <span class="cm-string">'SS-ZZWB091'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-string">'SS-ZZWB092'</span>, <span class="cm-string">'量产SS-ZZWB011'</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">object</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看与W-SCOPE高孔9*32.5搭配的正极材料组合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'隔膜纸'</span>]==<span class="cm-string">'W-SCOPE高孔9*32.5'</span>][<span class="cm-string">'正极材料'</span>].<span class="cm-property">unique</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">array</span>([<span class="cm-string">'P2'</span>], <span class="cm-variable">dtype</span>=<span class="cm-builtin">object</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 345px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><p><span>好吧，分析到这一步，结论已经比较明显了，</span><b><mark><span>当负极材料是&#39;CP7-M+BAG-8K&#39;，KC-4&#39;，隔膜是&#39;W-SCOPE高孔9*32.5&#39;时，对于LFP10370C-200mAh电池，分容容量都会落在N</span><sub><span>200</span></sub><span>分布中心附近。</span></mark></b><span>如果要进一步的分析到底是这两种负极材料决定了N</span><sub><span>200</span></sub><span>分布，还是W-SCOPE高孔9</span><span>*</span><span>32.5决定了N</span><sub><span>200</span></sub><span>分布，还是它们联合决定了N</span><sub><span>200</span></sub><span>分布，只需下列措施其中之一即可：</span></p><ol start='' ><li><span>扩充样本里包括的实验组合，引入交叉验证组合；</span></li><li><span>如果没有现成的交叉验证组合，设计并实施。</span></li></ol><p><span>由于篇幅原因，没有对其它多变量的联合分布做进一步的分析，但基本流程与上述分析过程一致，如可以对循环寿命这些标签变量做上述分析。</span></p><p>&nbsp;</p><h3 id='342-相关性分析'><span>3.4.2 相关性分析</span></h3><p><span>相关性分析是指对两个或多个具备相关性的变量元素进行分析，从而衡量两个变量因素的相关密切程度。其实在本文中，相关性分析是分为两个部分展开的：</span></p><ol start='' ><li><span>第一部分是在EDA/数据预处理阶段开展的（即本节内容），主要是先用传统的统计学方法而不是用机器学习算法进行的相关性分析，主要做法包括可视化（诸如此前在分布分析中运用的散点图，核密度图等），计算相关系数（皮尔森相关系数、斯皮尔曼秩相关系数、判定系数等），方差分析等。</span></li><li><span>第二部分是在</span><a href='#特征工程'><span>特征工程</span></a><span>里利用机器学习算法进行的相关性分析，包括卡方检验、F检验、互信息等相关性分析算法对特征进行筛选，重要性解释等工作。</span></li></ol><p><span>本节着重进行上述第一部分的分析。同时在上节</span><a href='#多变量分析'><span>多变量分析</span></a><span>中为了研究不同变量之间是如何相互影响的，其实已经做了很多相关性分析，比如各种可视化图形，那么这一节主要是对相关系数等数值的研究上。</span></p><h4 id='3421-线性相关分析'><span>3.4.2.1 线性相关分析</span></h4><h5 id='34211-皮尔森相关系数'><span>3.4.2.1.1 皮尔森相关系数</span></h5><h6 id='342111-基本概念'><span>3.4.2.1.1.1 基本概念</span></h6><p><span>在三大相关系数中，spearman和kendall属于等级相关系数亦称为“秩相关系数”，是反映等级相关程度的统计分析指标，主要用排名分序分析中，在本项目中不会应用到。皮尔森（pearson）相关系数是衡量线性关联性的程度，它的一个几何解释是其代表两个变量的取值根据均值集中后构成的向量之间夹角的余弦。从理论上来讲，它只适用于线性的情况，并且隐含着高斯分布的假设，公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n535" cid="n535" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="7.312ex" viewBox="0 -1836 59683.7 3148" role="img" focusable="false" style="vertical-align: -3.047ex; max-width: 100%;"><defs><path stroke-width="0" id="E6-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E6-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E6-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E6-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E6-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E6-MJMATHI-3C1" d="M58 -216Q25 -216 23 -186Q23 -176 73 26T127 234Q143 289 182 341Q252 427 341 441Q343 441 349 441T359 442Q432 442 471 394T510 276Q510 219 486 165T425 74T345 13T266 -10H255H248Q197 -10 165 35L160 41L133 -71Q108 -168 104 -181T92 -202Q76 -216 58 -216ZM424 322Q424 359 407 382T357 405Q322 405 287 376T231 300Q217 269 193 170L176 102Q193 26 260 26Q298 26 334 62Q367 92 389 158T418 266T424 322Z"></path><path stroke-width="0" id="E6-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path stroke-width="0" id="E6-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E6-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path stroke-width="0" id="E6-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E6-MJMATHI-43" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path stroke-width="0" id="E6-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E6-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E6-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path><path stroke-width="0" id="E6-MJMATHI-45" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path stroke-width="0" id="E6-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-3.2" transform="translate(0,279)"><use xlink:href="#E6-MJMAIN-28"></use><use xlink:href="#E6-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E6-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E6-MJMAIN-32" x="1167" y="0"></use><use xlink:href="#E6-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(17362,0)"><g transform="translate(-15,0)"><g transform="translate(0,279)"><use xlink:href="#E6-MJMATHI-3C1" x="0" y="0"></use><g transform="translate(517,-150)"><use transform="scale(0.707)" xlink:href="#E6-MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMAIN-2C" x="852" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMATHI-59" x="1130" y="0"></use></g><use xlink:href="#E6-MJMAIN-3D" x="2233" y="0"></use><g transform="translate(3011,0)"><g transform="translate(397,0)"><rect stroke="none" width="5249" height="60" x="0" y="220"></rect><g transform="translate(60,721)"><use xlink:href="#E6-MJMATHI-43" x="0" y="0"></use><use xlink:href="#E6-MJMATHI-4F" x="760" y="0"></use><use xlink:href="#E6-MJMATHI-56" x="1523" y="0"></use><use xlink:href="#E6-MJMAIN-28" x="2292" y="0"></use><use xlink:href="#E6-MJMATHI-58" x="2681" y="0"></use><use xlink:href="#E6-MJMAIN-2C" x="3533" y="0"></use><use xlink:href="#E6-MJMATHI-59" x="3977" y="0"></use><use xlink:href="#E6-MJMAIN-29" x="4740" y="0"></use></g><g transform="translate(1382,-686)"><use xlink:href="#E6-MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMATHI-58" x="807" y="-213"></use><g transform="translate(1273,0)"><use xlink:href="#E6-MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMATHI-59" x="807" y="-213"></use></g></g></g></g><use xlink:href="#E6-MJMAIN-3D" x="9056" y="0"></use><g transform="translate(9834,0)"><g transform="translate(397,0)"><rect stroke="none" width="14954" height="60" x="0" y="220"></rect><g transform="translate(2938,721)"><use xlink:href="#E6-MJMATHI-45" x="0" y="0"></use><use xlink:href="#E6-MJMAIN-28" x="764" y="0"></use><use xlink:href="#E6-MJMATHI-58" x="1153" y="0"></use><use xlink:href="#E6-MJMATHI-59" x="2005" y="0"></use><use xlink:href="#E6-MJMAIN-29" x="2768" y="0"></use><use xlink:href="#E6-MJMAIN-2212" x="3379" y="0"></use><use xlink:href="#E6-MJMATHI-45" x="4379" y="0"></use><use xlink:href="#E6-MJMAIN-28" x="5143" y="0"></use><use xlink:href="#E6-MJMATHI-58" x="5532" y="0"></use><use xlink:href="#E6-MJMAIN-29" x="6384" y="0"></use><use xlink:href="#E6-MJMATHI-45" x="6773" y="0"></use><use xlink:href="#E6-MJMAIN-28" x="7537" y="0"></use><use xlink:href="#E6-MJMATHI-59" x="7926" y="0"></use><use xlink:href="#E6-MJMAIN-29" x="8689" y="0"></use></g><g transform="translate(60,-1081)"><g transform="translate(475,0)"><use xlink:href="#E6-MJMATHI-45" x="0" y="0"></use><use xlink:href="#E6-MJMAIN-28" x="764" y="0"></use><g transform="translate(1153,0)"><use xlink:href="#E6-MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMAIN-32" x="1215" y="408"></use></g><use xlink:href="#E6-MJMAIN-29" x="2465" y="0"></use><use xlink:href="#E6-MJMAIN-2212" x="3077" y="0"></use><g transform="translate(4077,0)"><use xlink:href="#E6-MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMAIN-32" x="1091" y="408"></use></g><use xlink:href="#E6-MJMAIN-28" x="5302" y="0"></use><use xlink:href="#E6-MJMATHI-58" x="5691" y="0"></use><use xlink:href="#E6-MJMAIN-29" x="6543" y="0"></use></g><path fill="none" stroke-width="75" d="M 37,623 L 200,37 L 400,1522 L 7482,1522" transform="translate(0,-450)"></path><g transform="translate(7482,0)"><g transform="translate(475,0)"><use xlink:href="#E6-MJMATHI-45" x="0" y="0"></use><use xlink:href="#E6-MJMAIN-28" x="764" y="0"></use><g transform="translate(1153,0)"><use xlink:href="#E6-MJMATHI-59" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMAIN-32" x="1156" y="408"></use></g><use xlink:href="#E6-MJMAIN-29" x="2424" y="0"></use><use xlink:href="#E6-MJMAIN-2212" x="3035" y="0"></use><g transform="translate(4035,0)"><use xlink:href="#E6-MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E6-MJMAIN-32" x="1091" y="408"></use></g><use xlink:href="#E6-MJMAIN-28" x="5261" y="0"></use><use xlink:href="#E6-MJMATHI-59" x="5650" y="0"></use><use xlink:href="#E6-MJMAIN-29" x="6413" y="0"></use></g><path fill="none" stroke-width="75" d="M 37,623 L 200,37 L 400,1522 L 7352,1522" transform="translate(0,-450)"></path></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">\rho_{X,Y}=\frac{COV(X,Y)}{\sigma_X\sigma_Y}=\frac{E(XY)-E(X)E(Y)}{{\enclose{radical}{E(X^2)-E^2(X)}}{\enclose{radical}{E(Y^2)-E^2(Y)}}}\tag{3.2}</script></div></div><p><span>两个连续变量(X,Y)的pearson相关性系数(Px,y)等于它们之间的协方差cov(X,Y)除以它们各自标准差的乘积(σX,σY)。系数的取值总是在-1.0到1.0之间，接近0的变量之间为无相关性，接近1或者-1被称为具有强相关性，具体：</span></p><ol start='' ><li><span>当相关系数为0时，X和Y两变量无关系。</span></li><li><span>当X的值增大（减小），Y值增大（减小），两个变量为正相关，相关系数在0与1之间。</span></li><li><span>当X的值增大（减小），Y值减小（增大），两个变量为负相关，相关系数在-1与0之间。</span></li></ol><p><span>相关系数揭示的是两个连续变量之间的关系，由于数据集里连续变量比较多，不好直观显示，下面是数据里两两连续变量之间的相关系数热力图（HeatMap）：</span></p><div align="center">
    <img src="figure/标签相关性热力图2.png">
</div><p>&nbsp;</p><p><span>通过上面的相关性系数热力图可以直观地看出，</span><strong><span>不同循环次数后的电池容量随着之间的循环间隔的加大，相关性逐渐减弱。</span></strong><span>也可以</span><a href='pyecharts/动态热力图2.html' target='blank'><span>点击链接</span></a><span>的动态热力图会更直观。</span></p><h6 id='342112-案例分析'><span>3.4.2.1.1.2 案例分析</span></h6><p><span>那么还是以案例来解释比较直观。上节</span><a href="#案例2 分容容量与首次容量的二元分布"><span>案例2 分容容量与首次容量的二元分布</span></a><span>中，我们通过可视化手段知道分容容量与首次容量存在很强的线性相关性，那么具体的相关性就可以用pearson系数来衡量。计算过程如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"># 计算分容容量与首次容量之间的pearson相关系数</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">covxy = (data['分容容量'] * data['首次容量']).mean()-data['分容容量'].mean()*data['首次容量'].mean()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">sigmaxy = ((data['分容容量']*data['分容容量']).mean()- (data['分容容量'].mean()) ** 2) ** 0.5 * \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((data['首次容量']*data['首次容量']).mean()- (data['首次容量'].mean()) ** 2) ** 0.5</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">pxy=covxy/sigmaxy</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">pxy</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"># 结果 0.9689334594059054</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p><mark><span>计算结果显示，分容容量和首次容量的pearson相关系数高达0.9689，这也说明这两个变量之间具有很强的正线性相关，这与图像结果是吻合的。</span></mark></p><p><span>再来看一个案例，上节的</span><a href='#案例3 分容容量与循环寿命的二元分布'><span>案例3 分容容量与循环寿命的二元分布</span></a><span>中，我们用条件概率解释了分容容量与循环寿命之间的关系，那么用皮尔森（pearson）相关系数的结果又如何呢？</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算分容容量与循环寿命之间pearson相关系数</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_nonan</span> = <span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">notna</span>()]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">covxy</span> = (<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>] <span class="cm-operator">*</span> <span class="cm-variable">data_nonan</span>[<span class="cm-string">'循环寿命'</span>]).<span class="cm-property">mean</span>()<span class="cm-operator">-</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sigmaxy</span> = ((<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]).<span class="cm-property">mean</span>()<span class="cm-operator">-</span> (<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()) <span class="cm-operator">**</span> <span class="cm-number">2</span>) <span class="cm-operator">**</span> <span class="cm-number">0.5</span> <span class="cm-operator">*</span> <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((<span class="cm-variable">data_nonan</span>[<span class="cm-string">'循环寿命'</span>]<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'循环寿命'</span>]).<span class="cm-property">mean</span>()<span class="cm-operator">-</span> (<span class="cm-variable">data_nonan</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">mean</span>()) <span class="cm-operator">**</span> <span class="cm-number">2</span>) <span class="cm-operator">**</span> <span class="cm-number">0.5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pxy</span>=<span class="cm-variable">covxy</span><span class="cm-operator">/</span><span class="cm-variable">sigmaxy</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pxy</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果 0.7059972546695781</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><p><span>计算结果显示，分容容量和循环寿命之间的pearson相关系数为0.7059，显示这两个变量之间有一定的正线性相关。</span></p><h5 id='34212-相关系数与回归系数'><span>3.4.2.1.2 相关系数与回归系数</span></h5><h6 id='342121-相关系数与回归系数的关系'><span>3.4.2.1.2.1 相关系数与回归系数的关系</span></h6><p><span>当然，我们也想知道数据里各个连续变量之间的pearson相关系数（以下简称相关系数），从而对各变量之间的相关性作出判断。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lis_p</span> = {}</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">data</span>.<span class="cm-property">columns</span>[<span class="cm-operator">-</span><span class="cm-number">32</span>:<span class="cm-operator">-</span><span class="cm-number">1</span>]:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data_nonan</span> = <span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-variable">i</span>].<span class="cm-property">notna</span>()]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">covxy</span> = (<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>] <span class="cm-operator">*</span> <span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>]).<span class="cm-property">mean</span>()<span class="cm-operator">-</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">sigmaxy</span> = ((<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]).<span class="cm-property">mean</span>()<span class="cm-operator">-</span> (<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()) <span class="cm-operator">**</span> <span class="cm-number">2</span>) <span class="cm-operator">**</span> <span class="cm-number">0.5</span> <span class="cm-operator">*</span> <span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ((<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>]<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>]).<span class="cm-property">mean</span>()<span class="cm-operator">-</span> (<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>].<span class="cm-property">mean</span>()) <span class="cm-operator">**</span> <span class="cm-number">2</span>) <span class="cm-operator">**</span> <span class="cm-number">0.5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">pxy</span>=<span class="cm-variable">covxy</span><span class="cm-operator">/</span><span class="cm-variable">sigmaxy</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">lis_p</span>[<span class="cm-variable">i</span>] = <span class="cm-variable">pxy</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'分容容量与{0}之间的pearson相关系数为：{1:.6f}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">i</span>,<span class="cm-variable">pxy</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与循环寿命之间的pearson相关系数为：0</span><span class="cm-number">.705997</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t500之间的pearson相关系数为：0</span><span class="cm-number">.908722</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t1000之间的pearson相关系数为：0</span><span class="cm-number">.865651</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t1500之间的pearson相关系数为：0</span><span class="cm-number">.825394</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t2000之间的pearson相关系数为：0</span><span class="cm-number">.737453</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t2500之间的pearson相关系数为：0</span><span class="cm-number">.588964</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t3000之间的pearson相关系数为：0</span><span class="cm-number">.420446</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t3500之间的pearson相关系数为：0</span><span class="cm-number">.312960</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t4000之间的pearson相关系数为：0</span><span class="cm-number">.234606</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t4500之间的pearson相关系数为：0</span><span class="cm-number">.165589</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t5000之间的pearson相关系数为：0</span><span class="cm-number">.180787</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t5500之间的pearson相关系数为：0</span><span class="cm-number">.146572</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">……</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t13500之间的pearson相关系数为：</span><span class="cm-operator">-</span><span class="cm-number">0.138443</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t14000之间的pearson相关系数为：</span><span class="cm-operator">-</span><span class="cm-number">0.183502</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t14500之间的pearson相关系数为：</span><span class="cm-operator">-</span><span class="cm-number">0.215364</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">分容容量与t15000之间的pearson相关系数为：</span><span class="cm-operator">-</span><span class="cm-number">0.155746</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 621px;"></div><div class="CodeMirror-gutters" style="display: none; height: 621px;"></div></div></div></pre><p><span>从结果可以看出，随着循环次数的增加，分容容量与电池容量的线性相关性逐渐减弱，到最后甚至会出现一定负相关性，如何理解这里的变化呢？看一下图像或许能有所启发:</span></p><div align="center">
    <img src="figure/相关分析1.png" style="zoom:80%"><img src="figure/相关分析2.png" style="zoom:80%"><img src="figure/相关分析3.png" style="zoom:80%"><img src="figure/相关分析4.png" style="zoom:80%">
</div><p>&nbsp;</p><p>&nbsp;</p><p><span>上面四张散点图分别代表分容容量和t500，t5000，t10000，t15000的电池容量之间的联合分布，粉色直线是两变量之间的线性拟合回归直线。那么从回归直线的斜率是否能代表pearson相关系数呢？其实是可以的，即可以用回归系数（回归直线斜率）来反映相关系数。至于原因，这就要回到统计学里回归系数和相关系数的定义以及公式来理解。总结来就是：对数据标准化后，一元线性回归的系数就是皮尔逊相关系数，换个说法就是回归系数β乘以X和Y变量的标准差之比结果为相关系数ρ</span><sub><span>X,Y</span></sub><span>，推导过程如下:</span></p><p><span>对于一元简单线性回归：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n566" cid="n566" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="2.808ex" viewBox="0 -840.4 59683.7 1209.2" role="img" focusable="false" style="vertical-align: -0.857ex; max-width: 100%;"><defs><path stroke-width="0" id="E7-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E7-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E7-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E7-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E7-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path stroke-width="0" id="E7-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E7-MJMATHI-3B2" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path><path stroke-width="0" id="E7-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path stroke-width="0" id="E7-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E7-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-3.3" transform="translate(0,-25)"><use xlink:href="#E7-MJMAIN-28"></use><use xlink:href="#E7-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E7-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E7-MJMAIN-33" x="1167" y="0"></use><use xlink:href="#E7-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(27137,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use xlink:href="#E7-MJMATHI-59" x="0" y="0"></use><use xlink:href="#E7-MJMAIN-3D" x="1040" y="0"></use><use xlink:href="#E7-MJMATHI-3B2" x="2096" y="0"></use><use xlink:href="#E7-MJMATHI-58" x="2662" y="0"></use><use xlink:href="#E7-MJMAIN-2B" x="3736" y="0"></use><g transform="translate(4737,0)"><use xlink:href="#E7-MJMATHI-3B2" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E7-MJMAIN-30" x="800" y="-325"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">Y=βX+β_0\tag{3.3}</script></div></div><p><span>我们知道其回归系数β满足：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n568" cid="n568" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="6.094ex" viewBox="0 -1574 59683.7 2624" role="img" focusable="false" style="vertical-align: -2.439ex; max-width: 100%;"><defs><path stroke-width="0" id="E8-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E8-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E8-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E8-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E8-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E8-MJMATHI-3B2" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path><path stroke-width="0" id="E8-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E8-MJMATHI-43" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path stroke-width="0" id="E8-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E8-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E8-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path stroke-width="0" id="E8-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E8-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path stroke-width="0" id="E8-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E8-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-3.4"><use xlink:href="#E8-MJMAIN-28"></use><use xlink:href="#E8-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E8-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E8-MJMAIN-34" x="1167" y="0"></use><use xlink:href="#E8-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(26317,0)"><g transform="translate(-15,0)"><use xlink:href="#E8-MJMATHI-3B2" x="0" y="0"></use><use xlink:href="#E8-MJMAIN-3D" x="850" y="0"></use><g transform="translate(1628,0)"><g transform="translate(397,0)"><rect stroke="none" width="5249" height="60" x="0" y="220"></rect><g transform="translate(60,721)"><use xlink:href="#E8-MJMATHI-43" x="0" y="0"></use><use xlink:href="#E8-MJMATHI-4F" x="760" y="0"></use><use xlink:href="#E8-MJMATHI-56" x="1523" y="0"></use><use xlink:href="#E8-MJMAIN-28" x="2292" y="0"></use><use xlink:href="#E8-MJMATHI-58" x="2681" y="0"></use><use xlink:href="#E8-MJMAIN-2C" x="3533" y="0"></use><use xlink:href="#E8-MJMATHI-59" x="3977" y="0"></use><use xlink:href="#E8-MJMAIN-29" x="4740" y="0"></use></g><g transform="translate(670,-722)"><use xlink:href="#E8-MJMATHI-56" x="0" y="0"></use><use xlink:href="#E8-MJMATHI-41" x="769" y="0"></use><use xlink:href="#E8-MJMATHI-52" x="1519" y="0"></use><use xlink:href="#E8-MJMAIN-28" x="2278" y="0"></use><use xlink:href="#E8-MJMATHI-58" x="2667" y="0"></use><use xlink:href="#E8-MJMAIN-29" x="3519" y="0"></use></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">\beta=\frac{COV(X,Y)}{VAR(X)}\tag{3.4}</script></div></div><p><span>而相关系数ρ</span><sub><span>XY</span></sub><span>满足：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n570" cid="n570" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="5.729ex" viewBox="0 -1469.2 59683.7 2466.8" role="img" focusable="false" style="vertical-align: -2.317ex; max-width: 100%;"><defs><path stroke-width="0" id="E9-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E9-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E9-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E9-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E9-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E9-MJMATHI-3C1" d="M58 -216Q25 -216 23 -186Q23 -176 73 26T127 234Q143 289 182 341Q252 427 341 441Q343 441 349 441T359 442Q432 442 471 394T510 276Q510 219 486 165T425 74T345 13T266 -10H255H248Q197 -10 165 35L160 41L133 -71Q108 -168 104 -181T92 -202Q76 -216 58 -216ZM424 322Q424 359 407 382T357 405Q322 405 287 376T231 300Q217 269 193 170L176 102Q193 26 260 26Q298 26 334 62Q367 92 389 158T418 266T424 322Z"></path><path stroke-width="0" id="E9-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path stroke-width="0" id="E9-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E9-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path stroke-width="0" id="E9-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E9-MJMATHI-43" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path stroke-width="0" id="E9-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E9-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E9-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-3.5" transform="translate(0,-68)"><use xlink:href="#E9-MJMAIN-28"></use><use xlink:href="#E9-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E9-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E9-MJMAIN-35" x="1167" y="0"></use><use xlink:href="#E9-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(25626,0)"><g transform="translate(-15,0)"><g transform="translate(0,-68)"><use xlink:href="#E9-MJMATHI-3C1" x="0" y="0"></use><g transform="translate(517,-150)"><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMAIN-2C" x="852" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-59" x="1130" y="0"></use></g><use xlink:href="#E9-MJMAIN-3D" x="2233" y="0"></use><g transform="translate(3011,0)"><g transform="translate(397,0)"><rect stroke="none" width="5249" height="60" x="0" y="220"></rect><g transform="translate(60,721)"><use xlink:href="#E9-MJMATHI-43" x="0" y="0"></use><use xlink:href="#E9-MJMATHI-4F" x="760" y="0"></use><use xlink:href="#E9-MJMATHI-56" x="1523" y="0"></use><use xlink:href="#E9-MJMAIN-28" x="2292" y="0"></use><use xlink:href="#E9-MJMATHI-58" x="2681" y="0"></use><use xlink:href="#E9-MJMAIN-2C" x="3533" y="0"></use><use xlink:href="#E9-MJMATHI-59" x="3977" y="0"></use><use xlink:href="#E9-MJMAIN-29" x="4740" y="0"></use></g><g transform="translate(1382,-686)"><use xlink:href="#E9-MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-58" x="807" y="-213"></use><g transform="translate(1273,0)"><use xlink:href="#E9-MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E9-MJMATHI-59" x="807" y="-213"></use></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-9">\rho_{X,Y}=\frac{COV(X,Y)}{\sigma_X\sigma_Y}\tag{3.5}</script></div></div><p><span>简单联立方程 (6)、(7) 就可以得出：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n572" cid="n572" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="4.877ex" viewBox="0 -1312 59683.7 2100" role="img" focusable="false" style="vertical-align: -1.675ex; margin-bottom: -0.155ex; max-width: 100%;"><defs><path stroke-width="0" id="E10-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E10-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E10-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E10-MJMAIN-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path stroke-width="0" id="E10-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E10-MJMATHI-3C1" d="M58 -216Q25 -216 23 -186Q23 -176 73 26T127 234Q143 289 182 341Q252 427 341 441Q343 441 349 441T359 442Q432 442 471 394T510 276Q510 219 486 165T425 74T345 13T266 -10H255H248Q197 -10 165 35L160 41L133 -71Q108 -168 104 -181T92 -202Q76 -216 58 -216ZM424 322Q424 359 407 382T357 405Q322 405 287 376T231 300Q217 269 193 170L176 102Q193 26 260 26Q298 26 334 62Q367 92 389 158T418 266T424 322Z"></path><path stroke-width="0" id="E10-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path stroke-width="0" id="E10-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E10-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path stroke-width="0" id="E10-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E10-MJMATHI-3B2" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z"></path><path stroke-width="0" id="E10-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-3.6" transform="translate(0,113)"><use xlink:href="#E10-MJMAIN-28"></use><use xlink:href="#E10-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E10-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E10-MJMAIN-36" x="1167" y="0"></use><use xlink:href="#E10-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(27271,0)"><g transform="translate(-15,0)"><g transform="translate(0,113)"><use xlink:href="#E10-MJMATHI-3C1" x="0" y="0"></use><g transform="translate(517,-252)"><use transform="scale(0.707)" xlink:href="#E10-MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E10-MJMAIN-2C" x="852" y="0"></use><use transform="scale(0.707)" xlink:href="#E10-MJMATHI-59" x="1130" y="0"></use></g><use xlink:href="#E10-MJMAIN-3D" x="2233" y="0"></use><use xlink:href="#E10-MJMATHI-3B2" x="3289" y="0"></use><g transform="translate(3855,0)"><g transform="translate(120,0)"><rect stroke="none" width="1393" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="#E10-MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E10-MJMATHI-58" x="807" y="-213"></use></g><g transform="translate(91,-686)"><use xlink:href="#E10-MJMATHI-3C3" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E10-MJMATHI-59" x="807" y="-213"></use></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-10">ρ_{X,Y}=β\frac{\sigma_X}{\sigma_Y}\tag{3.6}</script></div></div><p><span>那么，对上面四张图的变量组进行计算：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果(省略源代码)，其中σx、E(X)分别为分容容量的标准差、均值；σy、E(Y)分别为电池容量的标准差、均值；</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># E(XY)为分容容量与电池容量乘积的均值，COV(X,Y)为协方差，β为回归系数，ρxy为相关系数。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">经历过t500循环的样本数量为</span>:<span class="cm-number">2659</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σx</span>=<span class="cm-number">11.1915</span>, <span class="cm-variable">E</span>(<span class="cm-variable">X</span>)=<span class="cm-number">217.2269</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σy</span>=<span class="cm-number">11.5867</span>, <span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-number">214.0390</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)=<span class="cm-number">46612.8177</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">COV</span>(<span class="cm-variable">X</span>,<span class="cm-variable">Y</span>)=<span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)<span class="cm-operator">-</span><span class="cm-variable">E</span>(<span class="cm-variable">X</span>)<span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-number">117.791529</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">β</span>=<span class="cm-number">0.9408</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ρxy</span>=<span class="cm-number">0.9087</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-----------------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">经历过t5000循环的样本数量为</span>:<span class="cm-number">1645</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σx</span>=<span class="cm-number">8.3782</span>, <span class="cm-variable">E</span>(<span class="cm-variable">X</span>)=<span class="cm-number">221.6066</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σy</span>=<span class="cm-number">9.4246</span>, <span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-number">202.8496</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)=<span class="cm-number">44967.0913</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">COV</span>(<span class="cm-variable">X</span>,<span class="cm-variable">Y</span>)=<span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)<span class="cm-operator">-</span><span class="cm-variable">E</span>(<span class="cm-variable">X</span>)<span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-number">14.266443</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">β</span>=<span class="cm-number">0.2034</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ρxy</span>=<span class="cm-number">0.1808</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-----------------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">经历过t10000循环的样本数量为</span>:<span class="cm-number">1062</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σx</span>=<span class="cm-number">8.7862</span>, <span class="cm-variable">E</span>(<span class="cm-variable">X</span>)=<span class="cm-number">222.4330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σy</span>=<span class="cm-number">10.4840</span>, <span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-number">192.8401</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)=<span class="cm-number">42891.8817</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">COV</span>(<span class="cm-variable">X</span>,<span class="cm-variable">Y</span>)=<span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)<span class="cm-operator">-</span><span class="cm-variable">E</span>(<span class="cm-variable">X</span>)<span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-operator">-</span><span class="cm-number">2.110506</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">β</span>=<span class="cm-operator">-</span><span class="cm-number">0.0274</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ρxy</span>=<span class="cm-operator">-</span><span class="cm-number">0.0229</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-----------------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">经历过t15000循环的样本数量为</span>:<span class="cm-number">413</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σx</span>=<span class="cm-number">10.6782</span>, <span class="cm-variable">E</span>(<span class="cm-variable">X</span>)=<span class="cm-number">220.8363</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">σy</span>=<span class="cm-number">11.1704</span>, <span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-number">186.8070</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)=<span class="cm-number">41235.2385</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">COV</span>(<span class="cm-variable">X</span>,<span class="cm-variable">Y</span>)=<span class="cm-variable">E</span>(<span class="cm-variable">XY</span>)<span class="cm-operator">-</span><span class="cm-variable">E</span>(<span class="cm-variable">X</span>)<span class="cm-variable">E</span>(<span class="cm-variable">Y</span>)=<span class="cm-operator">-</span><span class="cm-number">18.532299</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">β</span>=<span class="cm-operator">-</span><span class="cm-number">0.1629</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ρxy</span>=<span class="cm-operator">-</span><span class="cm-number">0.1557</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 759px;"></div><div class="CodeMirror-gutters" style="display: none; height: 759px;"></div></div></div></pre><p><span>结合上述求出的回归系数结果，再对比上面四张带回归直线的散点图，我们可以将相关系数跟回归系数（即回归直线斜率）联系起来。那么为什么要引入回归系数来说明两变量间的关系呢？除了两个系数存在数学转换关系外，还有就要涉及到对数据的理解上来。这里有一个核心的问题：</span><mark><span>一个电池分容容量确定后，在特定实验条件下，各个循环阶段的电池容量是否就确定了？</span></mark><span>那么对这个问题的不同视角就会产生统计学上的理解差异：</span></p><ul><li><span>看法1：分容容量完全不会对后续的各阶段电池容量产生影响，它们之间相互独立。</span></li><li><span>看法2：分容容量直接决定了后续的各阶段电池容量，分容容量是自变量。</span></li><li><span>看法3：分容容量会对后续的各阶段电池容量产生影响，但还存在其它影响因素；同时分容容量与后续的各阶段电池容量一样，都会受到来自其它因素的影响，即分容容量本身作为自变量、因变量两者身份同时存在的。</span></li></ul><p><span>在回归中，应变量即Y是随x的改变而改变，而在相关分析时则预设xy相互独立。相关表示两变量间的相互关系，是双方向的。而回归则表示Y随X而变化，这种关系是单方向的。那么在本项目中，我们是将分容容量作为特征（自变量）看待，而各阶段电池容量是作为标签（因变量）看待，自然而然，应该采用回归的角度来理解分容容量和各阶段电池容量之间的关系。但是，这里存在一个误解，即：自变量和因变量的选取是人为设定的，不一定是物理真实的反映。其实就是上面核心问题所提到的，分容容量是否决定后续各阶段电池容量。</span></p><ul><li><span>对于看法1，只能用相关系数来探索XY之间的关系，而不能用回归角度，因为它们之间相互独立，不存在因果关系。</span></li><li><span>对于看法2，要用回归角度来探索XY之间的关系，因为两变量存在天然的因果关系。</span></li><li><span>对于看法3，其实是隐含两者之间会存在一定的相关性，可能是因果相关性，也有可能是非因果相关性，亦或者两者都有，因为我们不是上帝，无法准确知道背后的因果律，所以要结合相关系数与回归系数，综合来看待分容容量与后续各阶段电池容量的关系。</span></li></ul><p><span>事实上，看法3更符合电池研究的经验结论，所以作者本人在做相关分析时引入了回归系数。</span><mark><span>回归系数（斜率）其实表示1个单位的x引起多少个单位的y变化。</span></mark><span>还是以上面计算出的数值为例：</span><mark><span>样本的分容容量x与经历过500次循环电池容量y的回归系数β为0.9408，这意味着1个单位的分容容量会在经历过500次循环后会影响 (不是决定，因为分容容量是其它影响因素的综合表现 ) 电池容量0.9408个单位的正向变化，就总体平均而言，讨论样本里的LFP10370C2-200mAh电池的平均分容容量为217mAh，则经历500次循环，其电池平均剩余容量（214mAh)里是分容容量贡献的部分为217*0.9408≈204mAh，则截距β</span><sub><span>0</span></sub><span>=214-204=10mA。换角度来看待这个说法，即在214mAh的平均剩余容量里有204mAh是由分容容量贡献的，而只有10mAh是由非 ’ 分容容量 ‘ 因素贡献的，说明在经历了500次循环后，分容容量这个因素（其实是其它因素综合作用，主要是材料因素和温度，这是因为在分容容量是在测试之初得到的，且在不同测试中，分容阶段的工步其实是比较一致的，所以可以认为材料因素和温度比测试条件因素对分容影响更大，而分容容量只是这些影响因素的表现）是影响电池容量的主导因素。如果电池经历了15000次循环，则β为-0.1629，则电池平均剩余容量（186mAh)里由分容容量贡献的部分为220</span><span>*</span><span>（-0.1629)=-35mAh，则截距β</span><sub><span>0</span></sub><span>=186-(-35)=221mAh，说明电池在经历15000次循环后分容容量这个’因素‘已经对平均剩余容量无影响甚至负影响（负值的产生其实说明了在t15000的413个电池样本中有些电池样本，在起始分容容量较高的情况下反倒会导致电池容量更快下降或者在起始分容容量较低的情况下反倒会导致电池容量更缓慢下降，这些 ’异常点 ‘ 导致负值的产生，在下面的</span><a href='解释性分析'><span>解释性分析</span></a><span>中将会提到），而其它因素则占据了主要部分。</span></mark></p><p><span>上一个段落的分析其实是不考虑电池样本个体差异的，只考虑样本总体平均情况。对于不同材料的电池、不同测试条件的电池，其结论也会有所变化。同时用回归系数来阐明一个电池自变量对电池容量的影响，本质上是将电池体系看作是简单的线性模型，这其实是做了极大的简化处理的，而现实的电池模型会更加复杂。但不管怎么说，用回归系数来做特征重要性的工作可以为电池研究提供一个数学工具。</span></p><p><span>那么该如何从解释，随着循环次数的增加，分容容量和电池容量的相关系数或回归系数随之下降呢？如果单纯从数学角度解释，主要是因为两变量的协方差COV(X,Y) 随循环次数的增加而下降，进而导致相关系数ρ</span><sub><span>XY</span></sub><span>的下降，这点很容易从计算结果中得出。但是，作为技术人员，其实我们更希望能得到物理原理上的解释。下面这个小节</span><a href='解释性分析'><span>解释性分析</span></a><span>会给出一些视角。</span></p><h6 id='342122-解释性分析'><span>3.4.2.1.2.2 解释性分析</span></h6><p><span>从相关系数的定义分析，相关系数指出：当X的值增大（减小），Y值增大（减小），两变量正相关；当X的值增大（减小），Y值减小（增大），两变量负相关。其实这里的X与Y不是一个标量，而是每个变量组成的向量，即X=(x</span><sub><span>1</span></sub><span>, x</span><sub><span>2</span></sub><span>, x</span><sub><span>3</span></sub><span>, ……x</span><sub><span>n</span></sub><span>)，Y=(y</span><sub><span>1</span></sub><span>, y</span><sub><span>2</span></sub><span>, y</span><sub><span>3</span></sub><span>, ……y</span><sub><span>n</span></sub><span>)。</span></p><ul><li><span>如果X, Y两个向量里每个对应方向（一个方向对应一个样本）的数值都能很好地服从正相关约定，那么对于整体来讲，自然表现出强正相关性；</span></li><li><span>如果有些方向上的数值不服从正相关约定，就会导致整体的正相关性下降，这些不服从正相关的样本我们可戏称为 ‘老鼠屎’；当这些不服从正相关的样本多到一定程度，就会使X、Y之间本来有的相关性退化为随机无序状态，自然整体相关性就趋近于0；</span></li><li><span>如果这些 ‘老鼠屎’ 样本数量足够多，且如果这些不服从正相关的样本在X，Y空间里呈现强负相关性，那么就有可能导致X,Y两变量整体呈现负相关。</span></li></ul><p><span>上述三个过程正好就体现在分容容量与电池容量的相关性结果上（即相关系数从接近1逐步下降到接近于0，之后变为负数反向增加），那要怎么验证上述的说法呢？其实关键的就是怎么找到这些 ‘老鼠屎’。一个办法是从协方差的公式入手：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n604" cid="n604" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="2.808ex" viewBox="0 -840.4 59683.7 1209.2" role="img" focusable="false" style="vertical-align: -0.857ex; max-width: 100%;"><defs><path stroke-width="0" id="E11-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E11-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E11-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E11-MJMAIN-37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path><path stroke-width="0" id="E11-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E11-MJMATHI-43" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path stroke-width="0" id="E11-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E11-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E11-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path stroke-width="0" id="E11-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E11-MJMATHI-59" d="M66 637Q54 637 49 637T39 638T32 641T30 647T33 664T42 682Q44 683 56 683Q104 680 165 680Q288 680 306 683H316Q322 677 322 674T320 656Q316 643 310 637H298Q242 637 242 624Q242 619 292 477T343 333L346 336Q350 340 358 349T379 373T411 410T454 461Q546 568 561 587T577 618Q577 634 545 637Q528 637 528 647Q528 649 530 661Q533 676 535 679T549 683Q551 683 578 682T657 680Q684 680 713 681T746 682Q763 682 763 673Q763 669 760 657T755 643Q753 637 734 637Q662 632 617 587Q608 578 477 424L348 273L322 169Q295 62 295 57Q295 46 363 46Q379 46 384 45T390 35Q390 33 388 23Q384 6 382 4T366 1Q361 1 324 1T232 2Q170 2 138 2T102 1Q84 1 84 9Q84 14 87 24Q88 27 89 30T90 35T91 39T93 42T96 44T101 45T107 45T116 46T129 46Q168 47 180 50T198 63Q201 68 227 171L252 274L129 623Q128 624 127 625T125 627T122 629T118 631T113 633T105 634T96 635T83 636T66 637Z"></path><path stroke-width="0" id="E11-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E11-MJMATHI-45" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path stroke-width="0" id="E11-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E11-MJMAIN-AF" d="M69 544V590H430V544H69Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-3.7" transform="translate(0,-29)"><use xlink:href="#E11-MJMAIN-28"></use><use xlink:href="#E11-MJMAIN-33" x="389" y="0"></use><use xlink:href="#E11-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E11-MJMAIN-37" x="1167" y="0"></use><use xlink:href="#E11-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(22397,0)"><g transform="translate(-15,0)"><g transform="translate(0,-29)"><use xlink:href="#E11-MJMATHI-43" x="0" y="0"></use><use xlink:href="#E11-MJMATHI-4F" x="760" y="0"></use><use xlink:href="#E11-MJMATHI-56" x="1523" y="0"></use><use xlink:href="#E11-MJMAIN-28" x="2292" y="0"></use><use xlink:href="#E11-MJMATHI-58" x="2681" y="0"></use><use xlink:href="#E11-MJMAIN-2C" x="3533" y="0"></use><use xlink:href="#E11-MJMATHI-59" x="3977" y="0"></use><use xlink:href="#E11-MJMAIN-29" x="4740" y="0"></use><use xlink:href="#E11-MJMAIN-3D" x="5407" y="0"></use><use xlink:href="#E11-MJMATHI-45" x="6463" y="0"></use><use xlink:href="#E11-MJMAIN-28" x="7227" y="0"></use><use xlink:href="#E11-MJMAIN-28" x="7616" y="0"></use><use xlink:href="#E11-MJMATHI-58" x="8005" y="0"></use><use xlink:href="#E11-MJMAIN-2212" x="9079" y="0"></use><g transform="translate(10079,0)"><use xlink:href="#E11-MJMATHI-58" x="0" y="0"></use><use xlink:href="#E11-MJMAIN-AF" x="274" y="217"></use></g><use xlink:href="#E11-MJMAIN-29" x="10931" y="0"></use><use xlink:href="#E11-MJMAIN-28" x="11320" y="0"></use><use xlink:href="#E11-MJMATHI-59" x="11709" y="0"></use><use xlink:href="#E11-MJMAIN-2212" x="12694" y="0"></use><g transform="translate(13695,0)"><use xlink:href="#E11-MJMATHI-59" x="0" y="0"></use><use xlink:href="#E11-MJMAIN-AF" x="249" y="217"></use></g><use xlink:href="#E11-MJMAIN-29" x="14458" y="0"></use><use xlink:href="#E11-MJMAIN-29" x="14847" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">COV(X,Y)=E((X-\bar{X})(Y-\bar{Y}))\tag{3.7}</script></div></div><p><span>如果两个变量的变化趋于一致，也就是说如果其中一个大于自身的期望值，另一个也大于自身的期望值，那么两个变量之间的协方差就是正值；如果两个变量的变化趋势相反，则协方差为负值。那么我们令：</span></p><p><span>A为分容容量的完备事件组，分容容量x</span><sub><span>i</span></sub><span>小于分容容量均值</span><span class='math-in-toc'>$\bar{X}$</span><span>记为A</span><sub><span>0</span></sub><span>，x</span><sub><span>i</span></sub><span>大于等于</span><span class='math-in-toc'>$\bar{X}$</span><span>记为A</span><sub><span>1</span></sub><span>；</span></p><p><span>B为电池容量的完备事件组，电池容量y</span><sub><span>i</span></sub><span>小于分容容量均值</span><span class='math-in-toc'>$\bar{Y}$</span><span>记为B</span><sub><span>0</span></sub><span>，x</span><sub><span>i</span></sub><span>大于等于</span><span class='math-in-toc'>$\bar{Y}$</span><span>记为B</span><sub><span>1</span></sub><span>；</span></p><p><span>那么对于一个样本而言（为简便操作，这里不考虑相关系数为0的情况），则存在下列几种可能组合计算如下：</span></p><figure><table><thead><tr><th><span>A\B</span></th><th><span>B</span><sub><span>0</span></sub></th><th><span>B</span><sub><span>1</span></sub></th></tr></thead><tbody><tr><td><span>A</span><sub><span>0</span></sub></td><td><span>正相关（ ρ</span><sub><span>XY</span></sub><span> &gt; 0 ）</span></td><td><mark><span>负相关</span></mark><span>（ ρ</span><sub><span>XY</span></sub><span> &lt; 0 ）</span></td></tr><tr><td><span>A</span><sub><span>1</span></sub></td><td><mark><span>负相关</span></mark><span>（ ρ</span><sub><span>XY</span></sub><span> &lt; 0 ）</span></td><td><span>正相关（ ρ</span><sub><span>XY</span></sub><span> &gt; 0 )</span></td></tr></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 找出负相关的电池样本并按绝对值大小排序</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">std</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">beta</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mean</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span>[<span class="cm-string">'分容容量'</span>,<span class="cm-string">'t500'</span>,<span class="cm-string">'t5000'</span>,<span class="cm-string">'t10000'</span>,<span class="cm-string">'t15000'</span>]:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data_nonan</span> = <span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-variable">i</span>].<span class="cm-property">notna</span>()]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">std</span>[<span class="cm-variable">i</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>].<span class="cm-property">std</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">mean</span>[<span class="cm-variable">i</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">if</span> <span class="cm-variable">i</span><span class="cm-operator">!</span>=<span class="cm-string">'分容容量'</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'相关性'</span>]=(<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">&lt;</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()) == (<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>] <span class="cm-operator">&lt;</span> <span class="cm-variable">mean</span>[<span class="cm-variable">i</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'X-X`'</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">-</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'Y-Y`'</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>] <span class="cm-operator">-</span> <span class="cm-variable">mean</span>[<span class="cm-variable">i</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'(X-X`)(Y-Y`)'</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-string">'X-X`'</span>]<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'Y-Y`'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'相关性'</span>]==<span class="cm-keyword">False</span>][[<span class="cm-string">'分容容量'</span>,<span class="cm-string">'X-X`'</span>,<span class="cm-variable">i</span>,<span class="cm-string">'Y-Y`'</span>,<span class="cm-string">'(X-X`)(Y-Y`)'</span>]].<span class="cm-property">sort_values</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">by</span>=<span class="cm-string">'(X-X`)(Y-Y`)'</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'-'</span><span class="cm-operator">*</span><span class="cm-number">80</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">分容容量</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>` &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">t500</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`  (<span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>`)(<span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">16</span> &nbsp; &nbsp;<span class="cm-number">204.766028</span> <span class="cm-operator">-</span><span class="cm-number">12.460831</span> &nbsp;<span class="cm-number">222.885611</span> &nbsp;<span class="cm-number">8.846581</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">110.235753</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1351</span> &nbsp;<span class="cm-number">199.696417</span> <span class="cm-operator">-</span><span class="cm-number">17.530442</span> &nbsp;<span class="cm-number">220.106306</span> &nbsp;<span class="cm-number">6.067275</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">106.362022</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1347</span> &nbsp;<span class="cm-number">199.598694</span> <span class="cm-operator">-</span><span class="cm-number">17.628165</span> &nbsp;<span class="cm-number">219.806972</span> &nbsp;<span class="cm-number">5.767942</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">101.678233</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">... &nbsp; &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1243</span> &nbsp;<span class="cm-number">217.665694</span> &nbsp; <span class="cm-number">0.438835</span> &nbsp;<span class="cm-number">214.034083</span> <span class="cm-operator">-</span><span class="cm-number">0.004947</span> &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.002171</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">225</span> <span class="cm-variable">rows</span> <span class="cm-variable">x</span> <span class="cm-number">5</span> <span class="cm-variable">columns</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">分容容量</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>` &nbsp; &nbsp; &nbsp; <span class="cm-variable">t5000</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`  (<span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>`)(<span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2247</span> &nbsp;<span class="cm-number">232.800000</span> &nbsp;<span class="cm-number">11.193377</span> &nbsp;<span class="cm-number">169.300000</span> <span class="cm-operator">-</span><span class="cm-number">33.549645</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">375.533833</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1531</span> &nbsp;<span class="cm-number">203.568861</span> <span class="cm-operator">-</span><span class="cm-number">18.037762</span> &nbsp;<span class="cm-number">218.146278</span> &nbsp;<span class="cm-number">15.296632</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">275.917012</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1356</span> &nbsp;<span class="cm-number">191.950083</span> <span class="cm-operator">-</span><span class="cm-number">29.656540</span> &nbsp;<span class="cm-number">211.964833</span> &nbsp; <span class="cm-number">9.115188</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">270.324934</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">... &nbsp; &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1810</span> &nbsp;<span class="cm-number">221.612056</span> &nbsp; <span class="cm-number">0.005433</span> &nbsp;<span class="cm-number">198.706167</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">4.143479</span> &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.022510</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">609</span> <span class="cm-variable">rows</span> <span class="cm-variable">x</span> <span class="cm-number">5</span> <span class="cm-variable">columns</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">分容容量</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>` &nbsp; &nbsp; &nbsp;<span class="cm-variable">t10000</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`  (<span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>`)(<span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1616</span> &nbsp;<span class="cm-number">172.169028</span> <span class="cm-operator">-</span><span class="cm-number">50.263953</span> &nbsp;<span class="cm-number">201.716861</span> &nbsp; <span class="cm-number">8.876788</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">446.182439</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1516</span> &nbsp;<span class="cm-number">200.396917</span> <span class="cm-operator">-</span><span class="cm-number">22.036064</span> &nbsp;<span class="cm-number">211.060944</span> &nbsp;<span class="cm-number">18.220871</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">401.516275</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1519</span> &nbsp;<span class="cm-number">199.913278</span> <span class="cm-operator">-</span><span class="cm-number">22.519703</span> &nbsp;<span class="cm-number">210.069917</span> &nbsp;<span class="cm-number">17.229843</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">388.010946</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">... &nbsp; &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1002</span> &nbsp;<span class="cm-number">221.900000</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">0.532980</span> &nbsp;<span class="cm-number">192.870278</span> &nbsp; <span class="cm-number">0.030204</span> &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.016098</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">489</span> <span class="cm-variable">rows</span> <span class="cm-variable">x</span> <span class="cm-number">5</span> <span class="cm-variable">columns</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">分容容量</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>` &nbsp; &nbsp; &nbsp;<span class="cm-variable">t15000</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`  (<span class="cm-variable">X</span><span class="cm-operator">-</span><span class="cm-variable">X</span>`)(<span class="cm-variable">Y</span><span class="cm-operator">-</span><span class="cm-variable">Y</span>`)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1616</span> &nbsp;<span class="cm-number">172.169028</span> <span class="cm-operator">-</span><span class="cm-number">48.667318</span> &nbsp;<span class="cm-number">199.982167</span> &nbsp;<span class="cm-number">13.175187</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">641.201011</span> &nbsp; <span class="cm-operator">&lt;--!!!</span><span class="cm-variable">潜在异常点</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1349</span> &nbsp;<span class="cm-number">196.122806</span> <span class="cm-operator">-</span><span class="cm-number">24.713540</span> &nbsp;<span class="cm-number">202.827806</span> &nbsp;<span class="cm-number">16.020826</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">395.931323</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1519</span> &nbsp;<span class="cm-number">199.913278</span> <span class="cm-operator">-</span><span class="cm-number">20.923068</span> &nbsp;<span class="cm-number">205.468583</span> &nbsp;<span class="cm-number">18.661604</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">390.458001</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">... &nbsp; &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp;  ... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">433</span> &nbsp; <span class="cm-number">220.878444</span> &nbsp; <span class="cm-number">0.042099</span> &nbsp;<span class="cm-number">181.535806</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">5.271174</span> &nbsp; &nbsp; <span class="cm-operator">-</span><span class="cm-number">0.221909</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">243</span> <span class="cm-variable">rows</span> <span class="cm-variable">x</span> <span class="cm-number">5</span> <span class="cm-variable">columns</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1219px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1219px;"></div></div></div></pre><p><span>好吧，我们不止找到了那些贡献了负相关性的样本，甚至通过这些样本发现了几个十分可疑的数据异常点，比如ID为1616的样本，分容容量只有172mAh，但在经历了15000次循环后，电池容量竟然反而有199mAh，这个结果从经验直觉上讲几乎是不可能发生的（但不是不可能发生，所以可以人工介入排查其它异常因素，比如工艺参数），那么我们有理由将其划分异常点。其实，通过相关系数来进行</span><a href='异常检测'><span>异常检测</span></a><span>或一致性检测，是pearson相关系数在机器学习领域的应用之一，关于</span><a href='异常检测'><span>异常检测</span></a><span>我们将会在下面章节进行详细论述。那为什么，相关系数可以用来进行异常检测呢？其实这是由于</span><strong><span>相关系数其实是向量相似度的一种度量</span></strong><span>，在数据标准化后，Pearson相关性系数、Cosine相似度、欧式距离的平方可认为是等价的。而异常值检测的最常用方法就是利用相似度（距离相似度、角度相似度、分类相似度……），所以自然而然，相关系数可以用来作为异常检测的算法。在人工智能实际应用中，相关系数还可以用来做协同过滤，用户推荐系统（淘宝、天猫等购物网站的产品推荐，视频网站的影视推荐，百度、google等搜索引擎的搜索推荐等），这些应用其实有一些部分就是基于利用相关系数度量不同对象的相似度，进而进行权重打分。当然相关系数只是作为评价标准之一，它会跟其它的算法一起构筑成复杂的集成算法。</span></p><p><span>扯得有点远，回到上面的计算结果，我们发现，当循环次数为10000和15000时，对两向量贡献了负相关的样本都是那些分容容量异常小，而循环寿命很长且剩余容量比较高的电池。那么这对电池技术人员其实提供了更多的研究思路：</span></p><ol start='' ><li><b><mark><span>这些电池是否来自同一类材料组合? 如果是，那么就很可能发现了一种材料特性，进而可以进行针对分析，得出某些理化解释和材料特性的经验总结；</span></mark></b></li><li><b><mark><span>是否可以利用这种头低尾高（分容容量小，随着测试的进行，电池容量会有上升的过程）的电池特性来进行某类特定用途的电池设计；</span></mark></b></li><li><b><mark><span>得出强负相关的样本组合，自然更要了解那些强正相关的样本组合（XY均远高于各自平均值或远低于各自平均值）。这些强正相关的样本组合其实就是在循环测试中表现优秀和头低尾低型电池，这也是实验优化的研究方向。对这些强正相关的样本研究，能为实验的设计进行有力指导。</span></mark></b></li></ol><p><span>以上面的第三个研究思路，来进行一些探索：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 找出强正相关的电池样本并按电池容量绝对值大小排序</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">std</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">beta</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mean</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span>[<span class="cm-string">'分容容量'</span>,<span class="cm-string">'t500'</span>,<span class="cm-string">'t5000'</span>,<span class="cm-string">'t10000'</span>,<span class="cm-string">'t15000'</span>]:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data_nonan</span> = <span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-variable">i</span>].<span class="cm-property">notna</span>()]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">std</span>[<span class="cm-variable">i</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>].<span class="cm-property">std</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">mean</span>[<span class="cm-variable">i</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">if</span> <span class="cm-variable">i</span><span class="cm-operator">!</span>=<span class="cm-string">'分容容量'</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'相关性'</span>]=(<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">&lt;</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()) == (<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>] <span class="cm-operator">&lt;</span> <span class="cm-variable">mean</span>[<span class="cm-variable">i</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'X-X`'</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>]<span class="cm-operator">-</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'分容容量'</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'Y-Y`'</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-variable">i</span>] <span class="cm-operator">-</span> <span class="cm-variable">mean</span>[<span class="cm-variable">i</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_nonan</span>[<span class="cm-string">'(X-X`)(Y-Y`)'</span>]=<span class="cm-variable">data_nonan</span>[<span class="cm-string">'X-X`'</span>]<span class="cm-operator">*</span><span class="cm-variable">data_nonan</span>[<span class="cm-string">'Y-Y`'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">data_nonan</span>[<span class="cm-variable">data_nonan</span>[<span class="cm-string">'相关性'</span>]==<span class="cm-keyword">True</span>][[<span class="cm-string">'材料组'</span>,<span class="cm-string">'分容容量'</span>,<span class="cm-variable">i</span>,<span class="cm-string">'(X-X`)(Y-Y`)'</span>]].<span class="cm-property">sort_values</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">by</span>=<span class="cm-variable">i</span>,<span class="cm-variable">ascending</span>=<span class="cm-keyword">False</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'-'</span><span class="cm-operator">*</span><span class="cm-number">80</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果（为缩减篇幅，只列出t15000的数据）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">材料组</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">分容容量</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">t15000</span> &nbsp;<span class="cm-error">\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">532</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">P2</span>,<span class="cm-variable">CP5</span>,<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">226.009444</span> &nbsp;<span class="cm-number">224.124833</span> &nbsp;<span class="cm-operator">-|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1573</span> &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">DY</span><span class="cm-operator">-</span><span class="cm-number">7</span>,<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-operator">+</span><span class="cm-variable">ACP</span><span class="cm-operator">-</span><span class="cm-variable">H</span>(<span class="cm-number">5</span>:<span class="cm-number">5</span>),<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">225.345194</span> &nbsp;<span class="cm-number">208.049806</span> &nbsp; <span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1599</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">DY</span><span class="cm-operator">-</span><span class="cm-number">7</span>,<span class="cm-variable">CP5</span>,<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">227.679778</span> &nbsp;<span class="cm-number">207.211333</span> &nbsp; <span class="cm-operator">|&lt;-</span><span class="cm-variable">优秀</span><span class="cm-operator">!</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1575</span> &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">DY</span><span class="cm-operator">-</span><span class="cm-number">7</span>,<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-operator">+</span><span class="cm-variable">ACP</span><span class="cm-operator">-</span><span class="cm-variable">H</span>(<span class="cm-number">5</span>:<span class="cm-number">5</span>),<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">221.996361</span> &nbsp;<span class="cm-number">205.535944</span> &nbsp; <span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1574</span> &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">DY</span><span class="cm-operator">-</span><span class="cm-number">7</span>,<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-operator">+</span><span class="cm-variable">ACP</span><span class="cm-operator">-</span><span class="cm-variable">H</span>(<span class="cm-number">5</span>:<span class="cm-number">5</span>),<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">224.115611</span> &nbsp;<span class="cm-number">205.444944</span> &nbsp;<span class="cm-variable">_</span><span class="cm-operator">|</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">... &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; &nbsp; &nbsp; &nbsp; ... &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">422</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">P2</span>,<span class="cm-variable">CP5</span>,<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">217.966583</span> &nbsp;<span class="cm-number">168.149083</span> &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">328</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">P2</span>,<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span>,<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">220.059222</span> &nbsp;<span class="cm-number">167.526194</span> &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">165</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">DY</span><span class="cm-operator">-</span><span class="cm-number">7</span>,<span class="cm-variable">CP5</span>,<span class="cm-variable">恩捷高孔9</span><span class="cm-operator">*</span><span class="cm-number">32.5</span> &nbsp;<span class="cm-number">215.496500</span> &nbsp;<span class="cm-number">167.420583</span> &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">167</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">DY</span><span class="cm-operator">-</span><span class="cm-number">7</span>,<span class="cm-variable">CP5</span>,<span class="cm-variable">恩捷高孔9</span><span class="cm-operator">*</span><span class="cm-number">32.5</span> &nbsp;<span class="cm-number">214.579222</span> &nbsp;<span class="cm-number">167.283083</span> &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">276</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span>,<span class="cm-variable">P2</span>,<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span>,<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp;<span class="cm-number">219.916750</span> &nbsp;<span class="cm-number">167.129528</span> &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 667px;"></div><div class="CodeMirror-gutters" style="display: none; height: 667px;"></div></div></div></pre><p><span>通过对强正相关的样本研究发现，电池能达到15000次寿命的电解液（上述表格没有显示完全）主要就是TC-E269-F4, 隔膜主要是恩捷高孔(9+3)*33。这个结果也符合现有的生产工艺，</span><b><mark><span>说明当前的生产工艺确实在[分容容量，循环寿命]（这里用循环15000次的电池容量作为循环寿命的衡量指标）这个分布空间内取得了较优解（范围仅在已有实验组合内），技术研究没有出现方向性问题</span></mark></b><span>。当然这个结论没有考虑测试参数的影响，具体情况还要结合具体的测试参数进行分析，这里就不展开了。</span></p><h4 id='3422--方差分析anova）'><span>3.4.2.2  方差分析（ANOVA）</span></h4><p><span>本节所要阐述的方差分析，不同于</span><a href='特征工程'><span>特征工程</span></a><span>章节里所使用的方差分析，主要是实现手段和应用有所不同。本章节将采用传统的统计学假设检验方法来进行方差分析，主要是用来对不同因素水平的差异显著性进行解释，而</span><a href='特征工程'><span>特征工程</span></a><span>里的方差检验将采用第三方集成算法，重在结果的输出和在</span><a href='特征选择'><span>特征选择</span></a><span>特征选择的应用上。</span></p><h5 id='34221-基本概念'><span>3.4.2.2.1 基本概念</span></h5><p><span>方差分析其实不是相关性分析的一种（相关分析是探究连续变量间的关系，方差分析探究的是分类变量和连续变量之间的关系），但它同相关性分析一样都可以对不同变量的关系做出判断解释，所以就把方差分析放在相关分析章节。方差分析主要用于两个及两个以上样本均数差别的显著性检验。</span></p><ul><li><p><strong><span>原理</span></strong></p><p><span>方差分析的原理通俗的解释就是将试验数据的总离散分解为来源于不同因素的离散，并作出数据估计，从而发现各个因素在总离散中所占的重要程度。有一部分代表随机误差，其余每个部分的变异分别代表了某个影响因素的作用(包括交互作用形成的因素)。通过比较因素所致的变异与随机误差的大小，借助F分布和F统计量做出推断：该因素对因变量的影响是否显著存在。</span></p></li><li><p><strong><span>差异来源</span></strong></p><ol start='' ><li><span>不可控的随机因素，比如测量误差。</span></li><li><span>研究中施加的对结果形成影响的可控因素，比如实验条件的不同。</span></li></ol></li><li><p><strong><span>种类</span></strong></p><p><span>常用的方差分析方法包括：单因素方差分析、多因素方差分析、协方差分析、多元方差分析、重复测量方差分析、方差成分分析等。因为行文重点和篇幅所限，本节将进行单因素方差分析。</span></p></li><li><p><strong><span>假定条件</span></strong></p><ol start='' ><li><span>各处理条件下的样本是随机的。</span></li><li><span>各处理条件下的样本是相互独立的，否则可能出现无法解析的输出结果。</span></li><li><span>各水平下的样本分布必须为正态分布，这是因为方差分析运用的是F分布，只有服从正态分布的总体才适用F分布进行假设检验，否则，检验结果是没有意义的。</span></li><li><mark><span>同一因素不同水平下的样本方差相同，即具有方差齐性。</span></mark></li></ol></li></ul><h6 id='342211-实施步骤'><span>3.4.2.2.1.1 实施步骤</span></h6><ol start='0' ><li><span>样本筛选</span></li><li><span>方差齐性检验</span></li><li><span>建立检验假设</span></li></ol><p><span>	</span><span>H0：无差异，多个样本总体均值相等；</span></p><p><span>	</span><span>H1：有显著差异，多个样本总体均值不相等或不全等。</span></p><ol start='2' ><li><p><span>进行F检验，计算检验统计量F值</span></p></li><li><p><span>确定P值并作出推断结果</span></p></li><li><p><span>事后多重比较 </span></p><div id="单因素方差分析流程">
</div><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart0" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="209.75" style="max-width: 1326px; height: 249.75px;" viewBox="0 0 1326 209.75" class="md-require-zoom-fix"><style>#mermaidChart0{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart0 .error-icon{fill:#552222;}#mermaidChart0 .error-text{fill:#552222;stroke:#552222;}#mermaidChart0 .edge-thickness-normal{stroke-width:2px;}#mermaidChart0 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart0 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart0 .marker{fill:#333333;}#mermaidChart0 .marker.cross{stroke:#333333;}#mermaidChart0 svg{font-family:sans-serif;font-size:16px;}#mermaidChart0 .label{font-family:sans-serif;color:#333;}#mermaidChart0 .label text{fill:#333;}#mermaidChart0 .node rect,#mermaidChart0 .node circle,#mermaidChart0 .node ellipse,#mermaidChart0 .node polygon,#mermaidChart0 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart0 .node .label{text-align:center;}#mermaidChart0 .node.clickable{cursor:pointer;}#mermaidChart0 .arrowheadPath{fill:#333333;}#mermaidChart0 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart0 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart0 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart0 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart0 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart0 .cluster text{fill:#333;}#mermaidChart0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart0:root{--mermaid-font-family:sans-serif;}#mermaidChart0:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart0 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M132,84.25L197,84.25L222,84.25" marker-end="url(#arrowhead47)" style="fill:none"></path><defs><marker id="arrowhead47" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M317.7647058823529,61.75L387,20.5L478,20.5L561,20.5L660,20.5L767,20.5L816,29.25" marker-end="url(#arrowhead48)" style="fill:none"></path><defs><marker id="arrowhead48" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-D" id="L-B-D" style="opacity: 1;"><path class="path" d="M338,99.83411214953271L387,113L436,113" marker-end="url(#arrowhead49)" style="fill:none"></path><defs><marker id="arrowhead49" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-E" id="L-C-E" style="opacity: 1;"><path class="path" d="M900,36.75L925,36.75L950,36.75" marker-end="url(#arrowhead50)" style="fill:none"></path><defs><marker id="arrowhead50" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;"><path class="path" d="M1050,36.75L1075,36.75L1100,36.75" marker-end="url(#arrowhead51)" style="fill:none"></path><defs><marker id="arrowhead51" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-I" id="L-D-I" style="opacity: 1;"><path class="path" d="M520,113L561,113L602,113" marker-end="url(#arrowhead52)" style="fill:none"></path><defs><marker id="arrowhead52" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-C" id="L-I-C" style="opacity: 1;"><path class="path" d="M710.6842105263158,90.5L767,65.5L816,50.019230769230774" marker-end="url(#arrowhead53)" style="fill:none"></path><defs><marker id="arrowhead53" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-I LE-H" id="L-I-H" style="opacity: 1;"><path class="path" d="M718,125.19626168224299L767,135.5L816,135.5" marker-end="url(#arrowhead54)" style="fill:none"></path><defs><marker id="arrowhead54" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-k" id="L-F-k" style="opacity: 1;"><path class="path" d="M1184,36.75L1209,36.75L1234,36.75" marker-end="url(#arrowhead55)" style="fill:none"></path><defs><marker id="arrowhead55" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(561,20.5)" style="opacity: 1;"><g transform="translate(-16,-12.5)" class="label"><rect rx="0" ry="0" width="32" height="25"></rect><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>通过</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(387,113)" style="opacity: 1;"><g transform="translate(-24,-12.5)" class="label"><rect rx="0" ry="0" width="48" height="25"></rect><foreignObject width="48" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>不通过</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(767,65.5)" style="opacity: 1;"><g transform="translate(-16,-12.5)" class="label"><rect rx="0" ry="0" width="32" height="25"></rect><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>通过</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(767,135.5)" style="opacity: 1;"><g transform="translate(-24,-12.5)" class="label"><rect rx="0" ry="0" width="48" height="25"></rect><foreignObject width="48" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>不通过</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-19" transform="translate(90,84.25)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">筛选样本</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-20" transform="translate(280,84.25)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">方差齐性检验</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-22" transform="translate(858,36.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">检验假设</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-24" transform="translate(478,113)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数值转换</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-26" transform="translate(1000,36.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-50" y="-22.5" width="100" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-40,-12.5)"><foreignObject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">计算统计量</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-28" transform="translate(1142,36.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">结果推断</div></foreignObject></g></g></g><g class="node default" id="flowchart-I-30" transform="translate(660,113)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">方差齐性检验</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-34" transform="translate(858,135.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">非参检验</div></foreignObject></g></g></g><g class="node default" id="flowchart-k-36" transform="translate(1276,36.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">多重比较</div></foreignObject></g></g></g><g class="node default" id="flowchart-M-37" transform="translate(90,179.25)" style="opacity: 1;"><rect rx="5" ry="5" x="-82" y="-22.5" width="164" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-72,-12.5)"><foreignObject width="144" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">单因素方差分析流程</div></foreignObject></g></g></g></g></g></g></svg></div><p>&nbsp;</p></li></ol><h5 id='34222-单因素方差分析'><span>3.4.2.2.2 单因素方差分析</span></h5><p><span>是用来研究一个控制变量的不同水平是否对观测变量产生了显著影响。这里，由于仅研究单个因素对观测变量的影响，因此称为单因素方差分析。比如，分析不同施肥量是否给农作物产量带来显著影响，考察地区差异是否影响妇女的生育率，研究学历对工资收入的影响，药物水平对病症的效果等（特别在医药学领域，单方差分析应用广泛）。这些问题都可以通过单因素方差分析得到答案。单因素方差分析很适合用在可控变量实验的研究上面。下面我就会以LFP10370C2-200mAh电池，</span><mark><span>2ex百分比是否对电池容量产生影响来举例说明。</span></mark></p><h6 id='342221-案例分析'><span>3.4.2.2.2.1 案例分析</span></h6><p><span>案例目的：</span><strong><mark><span>探究LFP10370C2-200mAh电池循环寿命测试中，2ex百分比是否对经历过5000次循环测试后的电池容量产生显著影响。</span></mark></strong></p><p>&nbsp;</p><p><strong><span>准备工作: 筛选目标样本</span></strong></p><p><span>因为单因素方差分析必须保证只有一个可控自变量，其它变量必须相同（分容容量和首次容量此时作为因变量看待，即标签变量看待，这个两个变量是可变的），为此必须在原数据筛选出一组特定材料特征、工艺参数的样本组合。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 先筛选符合要求的组合</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_com</span> = <span class="cm-variable">data</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,<span class="cm-string">'单次放电容量'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">'充电电流'</span>,<span class="cm-string">'充电后搁置时间'</span>,<span class="cm-string">'放电后搁置时间'</span>,<span class="cm-string">'温度'</span>,<span class="cm-string">'特殊工步'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_com</span>.<span class="cm-property">count</span>()[<span class="cm-string">'2ex百分比'</span>].<span class="cm-property">sort_values</span>(<span class="cm-variable">ascending</span>=<span class="cm-keyword">False</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液</span> &nbsp; &nbsp; <span class="cm-variable">正极材料</span> &nbsp;<span class="cm-variable">负极材料</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">隔膜纸</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">单次放电容量</span> <span class="cm-variable">充电电流</span> <span class="cm-variable">充电后搁置时间</span> <span class="cm-variable">放电后搁置时间</span> &nbsp;<span class="cm-variable">温度</span> &nbsp;<span class="cm-variable">特殊工步</span> <span class="cm-variable">样本数量</span> &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10.0</span> &nbsp; &nbsp; <span class="cm-number">40</span> &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">35</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">25</span> &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">32</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SS</span><span class="cm-operator">-</span><span class="cm-variable">ZZWB011</span> &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">EP7</span><span class="cm-operator">-</span><span class="cm-variable">M</span><span class="cm-operator">+</span><span class="cm-variable">PG09SC</span> &nbsp;<span class="cm-variable">恩捷</span>(<span class="cm-number">7</span><span class="cm-operator">+</span><span class="cm-number">2</span>)<span class="cm-operator">*</span><span class="cm-number">32.5</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10.0</span> &nbsp; &nbsp; <span class="cm-number">25</span> &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">30</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">40</span> &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">28</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10.0</span> &nbsp; &nbsp; <span class="cm-number">25</span> &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">26</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-property">SS</span><span class="cm-operator">-</span><span class="cm-variable">ZZWB086</span> &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">W</span><span class="cm-operator">-</span><span class="cm-variable">SCOPE</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">2</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10.0</span> &nbsp; &nbsp; <span class="cm-number">40</span> &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">2</span><span class="cm-variable">ex百分比</span>, <span class="cm-variable">Length</span>: <span class="cm-number">717</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 确定目标组，选取目标样本组</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">index</span>=<span class="cm-variable">grouped_com</span>.<span class="cm-property">count</span>()[<span class="cm-string">'2ex百分比'</span>].<span class="cm-property">sort_values</span>(<span class="cm-variable">ascending</span>=<span class="cm-keyword">False</span>).<span class="cm-property">index</span>[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_g</span>=<span class="cm-variable">grouped_com</span>.<span class="cm-property">get_group</span>(<span class="cm-variable">index</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'样本数量：{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">data_g</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_g</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,<span class="cm-string">'单次放电容量'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">'充电电流'</span>,<span class="cm-string">'充电后搁置时间'</span>,<span class="cm-string">'放电后搁置时间'</span>,<span class="cm-string">'温度'</span>]].<span class="cm-property">iloc</span>[<span class="cm-number">0</span>,:]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本数量：32</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">正极材料</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">P2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">负极材料</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CP5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜纸</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">单次放电容量</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">82</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电电流</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电后搁置时间</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0.5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">放电后搁置时间</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">温度</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">25</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 736px;"></div><div class="CodeMirror-gutters" style="display: none; height: 736px;"></div></div></div></pre><p><span>为了能对目标样本组合 ‘ 2ex百分比 ’ 因素里的不同水平的情况有更多地了解，可以借助条形图和带数据散点的箱型图看一下，不同水平的具体分布，如下：</span></p><div align="center">
    <img src="figure/2ex百分比2.png"><img src="figure/2ex百分比3.png">
</div><p><span>比较令人遗憾的是，除了1.05这个水平之外，其它水平的样本数量均太少，各自只有4个样本。样本的正态分布假设得不到保障（不过因为F检验对正态性的偏离具有一定的稳健性，可以不作过严要求），这样的样本组合很容易在方差分析时被异常值、极端值所影响，且样本代表性不足，无法完全推论到总体均值。但本案例是说明案例，可以不作过多考虑，如果想得到更为精确的结果，必须扩充样本容量，限于行文重点，本案例就以上述样本作为研究对象。</span></p><p><strong><span>step0: 方差齐性检验</span></strong></p><ul><li><span>概念：方差齐性检验是方差分析的基本假定之一，是方差可加性原则应用的一个条件。在方差分析的F检验中，是以各个实验组内总体方差齐性为前提的，因此，应该在方差分析之前，要对各个实验组内的总体方差先进行齐性检验。如果各个实验组内总体方差为齐性，而且经过F检验所得多个样本所属总体平均数差异显著，这时才可以将多个样本所属总体平均数的差异归因于各种实验处理的不同所致；如果各个总体方差不齐，那么经过F检验所得多个样本所属总体平均数差异显著的结果，可能有一部分归因于各个实验组内总体方差不同所致。在进行两组或多组数据进行比较时，各组数据要符合正态分布，各组数据要方差相等（齐性）。如果需要进行方差分析，就要进行方差齐性检验，即若组间方差不齐则不适用方差分析。但可通过对数变换、平方根变换、倒数变换、平方根反正弦变换等方法变换后再进行方差齐性检验，若还不行只能进行非参数检验。</span></li><li><span>过程：方差齐性检验是对两组样本的方差是否相同进行检验，检验思想与均值之间差异性检验（从下面step1开始往后的部分）是一样的。方差齐性检验跟其它统计检验有着相似的流程：检验假设（原假设H</span><sub><span>0</span></sub><span>，备择假设H</span><sub><span>1</span></sub><span>) —&gt; 计算统计量—&gt;结果推断。</span></li><li><span>常用的统计方法：Hartley检验、Levene检验、BF检验（Brown-Forsythe检验，改良后的Levene检验，在本案例中因为采用的第三方库中Levene检验默认使用Brown-Forsythe参数取值方法，所以可以认为两者等价）、Bartlett检验、修正的Bartlett检验、Fligner-Killeen检验……，因为重点所限，下面的分析就采用Levene检验、Bartlett检验、Fligner-Killeen检验三种。</span></li></ul><ol start='' ><li><p><span>原假设H0：无差异，多个样本总体方差相等，即</span><span class='math-in-toc'>$\sigma_{1}^{2}=\sigma_{2}^{2}=...=\sigma_{n}^{2}$</span><span>；</span></p><p><span>备择假设H1：有显著差异，多个样本总体均值不相等或不全等，即</span><span class='math-in-toc'>$\sigma_{1}^{2}，\sigma_{2}^{2}，…，\sigma_{n}^{2}$</span><span>不全相等。</span></p></li><li><p><strong><span>bartlett检验：</span></strong></p></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算bartlett统计检验量和p值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dic</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">para</span>: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">dic</span>[<span class="cm-variable">i</span>]=<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>]==<span class="cm-variable">i</span>][<span class="cm-string">'t5000'</span>].<span class="cm-property">to_list</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stat</span>, <span class="cm-variable">p</span> = <span class="cm-variable">bartlett</span>(<span class="cm-variable">dic</span>[<span class="cm-number">1.004</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.05</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.25</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.5</span>],<span class="cm-variable">dic</span>[<span class="cm-number">2.</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f'统计检验量={stat}, p={p}'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">统计检验量</span>=<span class="cm-number">6.7052574531428855</span>, <span class="cm-variable">p</span>=<span class="cm-number">0.15230826402987863</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><p><span>显著性水平α取0.05，从结果上看，p=0.15 &gt;  α=0.05，说明结果更倾向于接受原假设H</span><sub><span>0</span></sub><span>，即可以认为这些样本的总体方差相等，方差齐性检验通过。bartlett检验的核心思想是通过求取不同组之间的卡方统计量，然后根据卡方统计量的值来判断组间方差是否相等。该方法极度依赖于数据是正态分布，如果数据非正态分布，则的出来的结果偏差很大。本案例的个水平的样本数量太少（除了1.05这个水平），无法推断各样本组是否符合正态分布，所以用bartlett检验的误差较大。Levene检验对于数据正态性要求比bartlett检验来得低，对于正态偏离有一定的鲁棒性，所以我们可以看一下Levene检验：</span></p><p><span>Levene检验：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算Levene统计检验量和p值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dic</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">para</span>: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">dic</span>[<span class="cm-variable">i</span>]=<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>]==<span class="cm-variable">i</span>][<span class="cm-string">'t5000'</span>].<span class="cm-property">to_list</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stat</span>, <span class="cm-variable">p</span> = <span class="cm-variable">levene</span>(<span class="cm-variable">dic</span>[<span class="cm-number">1.004</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.05</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.25</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.5</span>],<span class="cm-variable">dic</span>[<span class="cm-number">2.</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f'统计检验量={stat}, p={p}'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">统计检验量</span>=<span class="cm-number">0.598875023267307</span>, <span class="cm-variable">p</span>=<span class="cm-number">0.6666043603710246</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 184px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><p><span>显著性水平α取0.05，从结果上看，p=0.66 &gt;&gt;  α=0.05，说明结果更倾向于接受原假设H</span><sub><span>0</span></sub><span>，即可以认为这些样本的总体方差相等，方差齐性检验通过。虽然Levene检验是一种无统计假定的检验，但还是要求数据是正态分布（虽然可以有一定的偏离），而Fligner-Killeen检验是一种无统计假定，无数据分布要求的方差齐性检验方法，所以虽然Levene检验、Bartlett检验已经给出了足够的证据可以验证数据的方差齐性，但还是可以加上Fligner-Killeen检验，增强说服力，下面就是Fligner-Killeen检验的过程：</span></p><p><strong><span>Fligner-Killeen检验：</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算F-K统计检验量和p值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">scipy</span> <span class="cm-keyword">import</span> <span class="cm-variable">stats</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dic</span>={}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">para</span>: </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">dic</span>[<span class="cm-variable">i</span>]=<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>]==<span class="cm-variable">i</span>][<span class="cm-string">'t5000'</span>].<span class="cm-property">to_list</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stat</span>, <span class="cm-variable">p</span> = <span class="cm-variable">stats</span>.<span class="cm-property">fligner</span>(<span class="cm-variable">dic</span>[<span class="cm-number">1.004</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.05</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.25</span>],<span class="cm-variable">dic</span>[<span class="cm-number">1.5</span>],<span class="cm-variable">dic</span>[<span class="cm-number">2.</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">f'统计检验量={stat}, p={p}'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">统计检验量</span>=<span class="cm-number">2.010902518818831</span>, <span class="cm-variable">p</span>=<span class="cm-number">0.7337534859828265</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p><span>显著性水平α取0.05，从结果上看，p=0.73 &gt;&gt;  α=0.05，说明结果更倾向于接受原假设H</span><sub><span>0</span></sub><span>，即可以认为这些样本的总体方差相等，方差齐性检验通过。</span></p><ol start='3' ><li><strong><span>结果推断</span></strong></li></ol><p><b><mark><span>这样通过三种不同的方差齐性检验，我们就可以确定样本数据是具有方差齐性的，可以推断目标样本的总体方差相等，即2ex百分比因素下不同水平的样本符合方差齐性要求，下面就可以作各水平的总体均值是否相等的方差分析。</span></mark></b></p><p>&nbsp;</p><p><strong><span>step1: 检验假设</span></strong></p><p><span>原假设H0：无差异，多个样本总体均值相等，即μ</span><sub><span>1</span></sub><span>=μ</span><sub><span>2</span></sub><span>=…=μ</span><sub><span>n</span></sub><span>；</span></p><p><span>备择假设H1：有显著差异，多个样本总体均值不相等或不全等，即μ1，μ2，…，μr不全相等。</span></p><p><strong><span>step2: 计算组间离差平方和（SSB）、组内离差平方和（SSE）、组间方差（MSB）、组内方差（MSE）、组内自由度、组间自由度等数值</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 定义</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">para</span> = <span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>].<span class="cm-property">unique</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mea</span> = {}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">var</span> = {}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fre</span> = {}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算样本总体均值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mea_all</span> = <span class="cm-variable">data_g</span>[<span class="cm-string">'t5000'</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">p</span> <span class="cm-keyword">in</span> <span class="cm-variable">para</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># 计算各组组内方差和各组自由度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">var</span>[<span class="cm-variable">p</span>] = <span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>]==<span class="cm-variable">p</span>][<span class="cm-string">'t5000'</span>].<span class="cm-property">var</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">fre</span>[<span class="cm-variable">p</span>] =<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>]==<span class="cm-variable">p</span>][<span class="cm-string">'t5000'</span>].<span class="cm-property">shape</span>[<span class="cm-number">0</span>] <span class="cm-operator">-</span> <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># 各组均值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">mea</span>[<span class="cm-variable">p</span>] = <span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>]==<span class="cm-variable">p</span>][<span class="cm-string">'t5000'</span>].<span class="cm-property">mean</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算组内离差平方和、组内自由度、组内方差</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sse</span> = <span class="cm-builtin">sum</span>([<span class="cm-variable">var</span> <span class="cm-operator">*</span> <span class="cm-variable">fre</span> <span class="cm-keyword">for</span> (<span class="cm-variable">var</span>,<span class="cm-variable">fre</span>) <span class="cm-keyword">in</span> <span class="cm-builtin">zip</span>(<span class="cm-variable">var</span>.<span class="cm-property">values</span>(),<span class="cm-variable">fre</span>.<span class="cm-property">values</span>())]) <span class="cm-operator">/</span> <span class="cm-builtin">sum</span>(<span class="cm-variable">fre</span>.<span class="cm-property">values</span>()) &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fre_e</span> = <span class="cm-builtin">sum</span>(<span class="cm-variable">fre</span>.<span class="cm-property">values</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mse</span> = <span class="cm-variable">sse</span> <span class="cm-operator">/</span> <span class="cm-variable">fre_e</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算组间离差平方和、组间自由度、组间方差</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ssb</span> = <span class="cm-builtin">sum</span>([(<span class="cm-variable">fre</span><span class="cm-operator">+</span><span class="cm-number">1</span>) <span class="cm-operator">*</span> (<span class="cm-variable">mea</span><span class="cm-operator">-</span><span class="cm-variable">mea_all</span>) <span class="cm-keyword">for</span> (<span class="cm-variable">mea</span>,<span class="cm-variable">fre</span>) <span class="cm-keyword">in</span> <span class="cm-builtin">zip</span>(<span class="cm-variable">mea</span>.<span class="cm-property">values</span>(),<span class="cm-variable">fre</span>.<span class="cm-property">values</span>())])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fre_b</span> = <span class="cm-builtin">len</span>(<span class="cm-variable">para</span>)<span class="cm-operator">-</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">msb</span> = <span class="cm-variable">ssb</span> <span class="cm-operator">/</span> <span class="cm-variable">fre_b</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'组内离差平方和:  sse={0:.6f}\n\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">组内自由度: &nbsp; &nbsp; dfe={1}\n\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">组内方差: &nbsp; &nbsp; &nbsp; mse={2:.6f}\n\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">组间离差平方和:  ssb={3:6f}\n\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">组间自由度: &nbsp; &nbsp; dfb={4}\n\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">组间方差: &nbsp; &nbsp; &nbsp; mse={5:.6f}\n\</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">总平均和: &nbsp; &nbsp; &nbsp; μ={6:.6f}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">sse</span>,<span class="cm-variable">fre_e</span>,<span class="cm-variable">mse</span>,<span class="cm-variable">ssb</span>,<span class="cm-variable">fre_b</span>,<span class="cm-variable">msb</span>,<span class="cm-variable">mea_all</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">组内离差平方和</span>: &nbsp;<span class="cm-variable">sse</span>=<span class="cm-number">78.623236</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">组内自由度</span>: &nbsp; &nbsp; <span class="cm-variable">dfe</span>=<span class="cm-number">27</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">组内均方</span>: &nbsp; &nbsp; &nbsp; <span class="cm-variable">mse</span>=<span class="cm-number">2.911972</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">组间离差平方和</span>: &nbsp;<span class="cm-variable">ssb</span>=<span class="cm-number">1249.109576</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">组间自由度</span>: &nbsp; &nbsp; <span class="cm-variable">dfb</span>=<span class="cm-number">4</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">组间均方</span>: &nbsp; &nbsp; &nbsp; <span class="cm-variable">msb</span>=<span class="cm-number">312.277394</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">总平均和</span>: &nbsp; &nbsp; &nbsp; <span class="cm-variable">μ</span>=<span class="cm-number">204.841444</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 828px;"></div><div class="CodeMirror-gutters" style="display: none; height: 828px;"></div></div></div></pre><p><strong><span>step3: 计算F值、P值</span></strong></p><ul><li><p><span>F值是F检验的统计量值，F=MSB/MSE,其中MSB=SSB/组间自由度,MSE=SSE/组内自由度。如果单个因素的不同水平对于数据总体没有影响，那么组间方差与组内方差没有显著性差异；如果单个因素的不同水平对于数据总体有影响，组间方差和组内方差就会有显著性的差异。即F值接近1，则说明各组均值间的差异没有统计学意义，若F值远大于1，则说明各组均值间的差异有统计学意义。F可以通过查询F分布临界值表获得。</span></p></li><li><p><span>p值是指F检验大于所求值时的概率,一般要小于于给定的显著性水平α就说明检验显著。一般显著性水平取α=0.05或α=0.01，本次分析取α=0.05。每一个F值都会对应一个p值，F值越大，p值越小，就越不可能接受假设，也就认为组间的特征差别大。</span></p><ul><li><span>如果P&lt;0.01，说明是较强的判定结果，拒绝假定的参数取值。</span></li><li><span>如果0.01&lt;P值&lt;0.05，说明较弱的判定结果，拒接假定的参数取值。</span></li><li><span>如果P值&gt;0.05，说明结果更倾向于接受假定的参数取值。</span></li></ul></li></ul><p><span>计算过程：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 方法一、手动计算F值、P值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">scipy</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">F</span> = <span class="cm-variable">msb</span> <span class="cm-operator">/</span> <span class="cm-variable">mse</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> = <span class="cm-variable">scipy</span>.<span class="cm-property">stats</span>.<span class="cm-property">f</span>.<span class="cm-property">sf</span>(<span class="cm-variable">F</span>,<span class="cm-variable">fre_b</span>,<span class="cm-variable">fre_e</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'F={} | p={}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">F</span>,<span class="cm-variable">p</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">F</span>=<span class="cm-number">107.23915786648887</span> <span class="cm-operator">|</span> <span class="cm-variable">p</span>=<span class="cm-number">3.6701353895298197e-16</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 方法二、引用第三方库一步到位</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">f</span>, <span class="cm-variable">p</span> = <span class="cm-variable">stats</span>.<span class="cm-property">f_oneway</span>(<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>] ==<span class="cm-number">1.004</span>][<span class="cm-string">'t5000'</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>] == <span class="cm-number">1.05</span>][<span class="cm-string">'t5000'</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>] == <span class="cm-number">1.25</span>][<span class="cm-string">'t5000'</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>] == <span class="cm-number">1.5</span>][<span class="cm-string">'t5000'</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_g</span>[<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>] == <span class="cm-number">2.</span>][<span class="cm-string">'t5000'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'F={} | p={}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">f</span>,<span class="cm-variable">p</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">F</span>=<span class="cm-number">107.23915786648894</span> <span class="cm-operator">|</span> <span class="cm-variable">p</span>=<span class="cm-number">3.6701353895297847e-16</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 391px;"></div><div class="CodeMirror-gutters" style="display: none; height: 391px;"></div></div></div></pre><p><span>通过两种方法计算的结果是一样，不过建议手写整个计算代码，增加对公式的理解。</span></p><p><strong><span>step4: 结果推断</span></strong></p><p><strong><span>方差分析表</span></strong></p><figure><table><thead><tr><th style='text-align:left;' >&nbsp;</th><th><span>DF</span></th><th><span>Sum of Squares</span></th><th><span>Mean Square</span></th><th><span>F Value</span></th><th><span>p Value</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><span>Model</span></td><td><span>4</span></td><td><span>1249.10958</span></td><td><span>312.27739</span></td><td><span>107.23916</span></td><td><span>3.67014E-16</span></td></tr><tr><td style='text-align:left;' ><span>Error</span></td><td><span>27</span></td><td><span>78.62324</span></td><td><span>2.91197</span></td><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td style='text-align:left;' ><span>Total</span></td><td><span>31</span></td><td><span>1327.73281</span></td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table></figure><p><span>查表F</span><sub><span>α</span></sub><span>(组间自由度，组间自由度)= F</span><sub><span>0.05</span></sub><span>(4，27)=4.74。因为F=107 &gt;&gt; 3.47= F</span><sub><span>0.05</span></sub><span>(4，27)，落在接受域。所以拒绝原假设H0，接受备择假设H1，即不同2ex百分比水平下，t5000均值不全相同。</span></p><p><span>p=3.6701353895298197x10</span><sup><span>-16</span></sup><span> &lt;&lt; 0.05，判定结果较强，2ex百分比的不同分组数据之间有显著区别，即</span><b><mark><span>电池使用不同的 ‘2ex百分比’ 参数作循环测试，电池容量在经历5000次循环后会有着显著差异。</span></mark></b><span>这也意味着 ‘ 2ex百分比 ’ 这个特征是影响t5000的重要特征，应当在</span><a href='#特征选择'><span>特征选择</span></a><span>时被保留，关于特征重要性和特征选择的问题，将在下章</span><a href='#特征工程'><span>特征工程</span></a><span>中更为深入地讨论。</span></p><p><strong><span>step5: 多重比较</span></strong></p><p><span>多重比较（multiple comparisons）是指方差分析后对各样本平均数间是否有显著差异的假设检验的统称。方差分析只能判断各总体平均数间是否有差异，多重比较可用来进一步确定哪两个平均数间有差异，哪两个平均数间没有差异。方差分析的结果只能检验出三个以上的总体均值是完全相同呢？还是不完全相同？注意是不完全相同，至于是哪个或哪些总体均值与其它总体均值不同则是不能获知的。因此方差分析结束以后还需要做事后多重检验，分析出到底是哪个或哪些总体均值与众不同。回到案例，</span><mark><span>多重比较就是为了确定不同 ’2ex百分比‘ 水平测试条件下经历5000次循环测试的电池容量是否存在差异。</span></mark></p><p><span>常见的多重比较方法：Turkey法、Dunnett法、Fisher法、Scheffé法……由于篇幅所限，这里就选取Turkey法做演示：</span></p><p><span>Turkey法</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算两两水平之间的统计检验量并分组显示</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">results</span>=<span class="cm-variable">pairwise_tukeyhsd</span>(<span class="cm-variable">data_g</span>[<span class="cm-string">'t5000'</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">data_g</span>[<span class="cm-string">'2ex百分比'</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">alpha</span>=<span class="cm-number">0.05</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">results</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">Multiple</span> <span class="cm-variable">Comparison</span> <span class="cm-variable">of</span> <span class="cm-variable">Means</span> <span class="cm-operator">-</span> <span class="cm-variable">Tukey</span> <span class="cm-variable">HSD</span>, <span class="cm-variable">FWER</span>=<span class="cm-number">0.05</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">======================================================</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group1</span> <span class="cm-variable">group2</span> <span class="cm-variable">meandiff</span> <span class="cm-variable">p</span><span class="cm-operator">-</span><span class="cm-variable">adj</span> &nbsp; <span class="cm-variable">lower</span> &nbsp; &nbsp;<span class="cm-variable">upper</span> &nbsp; <span class="cm-variable">reject</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">1.004</span> &nbsp; <span class="cm-number">1.05</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">2.8123</span> <span class="cm-number">0.0471</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">5.5985</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">0.0261</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">1.004</span> &nbsp; <span class="cm-number">1.25</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">9.1085</span> &nbsp;<span class="cm-number">0.001</span> <span class="cm-operator">-</span><span class="cm-number">12.6328</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">5.5842</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">1.004</span> &nbsp; &nbsp;<span class="cm-number">1.5</span> <span class="cm-operator">-</span><span class="cm-number">13.8084</span> &nbsp;<span class="cm-number">0.001</span> <span class="cm-operator">-</span><span class="cm-number">17.3327</span> <span class="cm-operator">-</span><span class="cm-number">10.2841</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">1.004</span> &nbsp; &nbsp;<span class="cm-number">2.0</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">18.973</span> &nbsp;<span class="cm-number">0.001</span> <span class="cm-operator">-</span><span class="cm-number">22.4973</span> <span class="cm-operator">-</span><span class="cm-number">15.4487</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">1.05</span> &nbsp; <span class="cm-number">1.25</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">6.2962</span> &nbsp;<span class="cm-number">0.001</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">9.0824</span> &nbsp; &nbsp;<span class="cm-operator">-</span><span class="cm-number">3.51</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-number cm-error">1.05</span> &nbsp; &nbsp;<span class="cm-number">1.5</span> <span class="cm-operator">-</span><span class="cm-number">10.9961</span> &nbsp;<span class="cm-number">0.001</span> <span class="cm-operator">-</span><span class="cm-number">13.7823</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">8.2099</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">1.05</span> &nbsp; &nbsp;<span class="cm-number">2.0</span> <span class="cm-operator">-</span><span class="cm-number">16.1607</span> &nbsp;<span class="cm-number">0.001</span> <span class="cm-operator">-</span><span class="cm-number">18.9469</span> <span class="cm-operator">-</span><span class="cm-number">13.3745</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-number cm-error">1.25</span> &nbsp; &nbsp;<span class="cm-number">1.5</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">4.6998</span> <span class="cm-number">0.0049</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">8.2241</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">1.1755</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">1.25</span> &nbsp; &nbsp;<span class="cm-number">2.0</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">9.8645</span> &nbsp;<span class="cm-number">0.001</span> <span class="cm-operator">-</span><span class="cm-number">13.3888</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">6.3402</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-number cm-error">1.5</span> &nbsp; &nbsp;<span class="cm-number">2.0</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">5.1646</span> <span class="cm-number">0.0018</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">8.6889</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">1.6403</span> &nbsp; <span class="cm-keyword">True</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">------------------------------------------------------</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 483px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><p><b><mark><span>从两两比较的结果上看，各水平组之间的p值均小于显著性水平α=0.05，可以拒绝原假设H</span><sub><span>0</span></sub><span>，接受备择假设H</span><sub><span>1</span></sub><span>，即可认为任意两组的 ’2ex百分比‘ 水平下，经历5000次循环测试的电池容量均存在统计学差异。换个说法就是不同 ’2ex百分比‘ 都会对经历5000次循环测试的电池容量产生显著影响。但要值得注意的是，1.004水平和1.05水平之间相比于其它两两组别的差异性较低，也就是经过这两个水平‘处理’的电池，在经历5000次循环测试的电池容量差异显著性最低。</span></mark></b></p><h5 id='bonussa软件上的anova分析'><span>BONUS：SA软件上的ANOVA分析</span></h5><p><span>之前的案例分析都是通过手写代码实现的（其实很多方法也是引用第三方库，不是完全的基础代码），这样可以更好地理解分析过程，也能对数据异常进行良好的管控。但也存在问题，就是不同统计方法都要手动输入，想要做到集成输入，集成输出比较麻烦，需要进行页面布局的设置，同时可视化部分也相对困难，另外也需要使用者有一定的编程基础。其实目前常见的SA（统计学分析）软件都能很好避开这些问题，虽然在导言里谈到，SA软件不适合高维空间的机器学习，但诸如处理单因素方差分析这类的统计学任务，SA软件还是异常强大的。这里还是以上面的案例来讲解，只不过工具换成了常见简单的SA软件，将会以minitab和Origin（严格来讲，Origin不是专门的SA软件，而是函数绘图软件，只不过它提供比较多的数据分析和统计检验模块）为分析工具。</span></p><p><span>虽然工具改成了SA软件，但统计检验的</span><a href ='#单因素方差分析流程'><span>流程</span></a><span>还是一致。</span></p><ul><li><strong><span>minitab</span></strong></li></ul><p><strong><span>准备工作：数据分组</span></strong></p><p><span>PS:由于minitab软件对于高维分组的支持较弱，所以不能直接挑选出目标组别（就是固定n-1维数据，对数据进行分组的能力），所以只能通过间接地建立条件列，然后子集化工作表和拆分工作表进行数据分组工作。由于这一步骤操作比较繁琐，具体流程可参考如下视频：</span></p><video width="320" height="240" controls="">
  <source src="videos/minitab筛选样本组.mp4" type="video/mp4">
您的浏览器不支持 video 标签。
</video><p><strong><span>方差齐性检验</span></strong></p><p><span>具体流程可参考如下视频：</span></p><video width="320" height="240" controls="">
  <source src="videos/方差齐性检验.mp4" type="video/mp4">
</video><p><span>使用minitab的bartlett检验和Levene检验计算得到的结果跟使用手动代码计算的结果一致，均支持H</span><sub><span>0</span></sub><span>假设。</span></p><p><strong><span>方差分析和多重比较</span></strong></p><p><span>SA软件将多重比较合并入方差分析步骤，其它流程跟我们用手动代码流程是一样的，具体流程可参考如下视频：</span></p><video width="320" height="240" controls="">  <source src="videos/方差分析.mp4" type="video/mp4"> 您的浏览器不支持 video 标签。</video><p><span>使用minitab的方差分析结果跟我们用手动代码计算的结果一致，均支持H</span><sub><span>1</span></sub><span>假设。使用minitab的Tukey多重检验结果跟手动代码的结果也是一致的，均支持H1假设。</span></p><ul><li><span>Origin</span></li></ul><p><strong><span>准备工作：数据分组</span></strong></p><p><span>Origin的数据分组工作需要一定的软件使用基础，相对minitab会更为复杂，因为其本身是函数绘图软件，几乎所有的数据分析操作都要使用函数完成，虽然新版origin增加了数据筛选模块，降低了操作难度，但很多工作还是要借助函数功能实现。具体流程可参考如下视频：</span></p><video width="320" height="240" controls="">  <source src="videos/origin筛选样本组.mp4" type="video/mp4"> 您的浏览器不支持 video 标签。</video><p><strong><span>方差分析</span></strong></p><p><span>Origin里ANOVA分析（方差分析）是将方差齐性检验和多重比较也一起合并在一起，使用起来更加方便，具体流程可参考如下视频：</span></p><video width="320" height="240" controls="">  
    <source src="videos/origin方差分析.mp4" type="video/mp4">  
您的浏览器不支持 video 标签。</video><p>&nbsp;</p><h2 id='35-本章总结'><span>3.5 本章总结</span></h2><ul><li><span>在这一章节里，我们介绍了探索性数据分析/数据预处理的大致流程，并利用软件工具对原始数据进行了统计报告汇总。</span></li><li><span>介绍了分布分析在实际案例中的应用，特别是多变量分析里，运用可视化和条件概率以分容容量为先验条件对电池容量进行了条件概率预测，对分容容量的</span><span class='math-in-toc'>$N_{200}$</span><span> 分布做出解释性分析。</span></li><li><span>介绍了相关分析在具体案例中的应用，并利用相关系数、回归系数对电池的分容容量和循环剩余容量之间的关系做出了解释性分析；介绍了方差分析的流程，并利用单因素方差分析方法分析了对‘2ex百分比’ 因素对电池容量是否产生显著影响，同时对手动代码和SA软件结果进行比较。</span></li></ul><p>&nbsp;</p><h1 id='4-探索性数据分析数据预处理下）'><span>4. 探索性数据分析/数据预处理（下）</span></h1><p><span>上一章节，我们介绍了探索性数据分析/数据预处理的实施流程，并对分布分析、相关分析进行了介绍。这一章节，将对缺失值分析和异常检测这两个步骤进行着重介绍。</span></p><h2 id='41-缺失值分析'><span>4.1 缺失值分析</span></h2><p><span>机器学习和数据挖掘中所使用的数据，永远不可能是完美的。很多特征，对于分析和建模来说意义非凡，但对于实际收集数据的人却不是如此，因此数据挖掘之中，常常会有重要的字段缺失值很多，但又不能舍弃字段的情况。因此，数据预处理中非常重要的一项就是处理缺失值。训练数据中的缺失值会降低模型的泛化能力，或者得到一个有偏差的(biased)模型，这是因为我们没有能够准确地分析变量之间的关系。这会导致预测或分类错误。下面是一个例子，左右两边显示了未处理缺失值和处理缺失值的两种情况，它们会得到完全不一样的结论。</span></p><div align="center">
    <img src="pic/缺失值影响.webp">
</div><p>&nbsp;</p><h3 id='411-缺失值来源'><span>4.1.1 缺失值来源</span></h3><ol start='' ><li><p><strong><span>数据抽取</span></strong><span>: 数据抽取过程中的错误容易产生缺失值。但这类产生缺失值错误相对比较容易被发现并被正确的处理过程代替。</span><strong><span>以电池循环测试为例，如果测试人员在填写实验信息时，将材料参数漏填，这样的缺失对于实验设计者而言相对比较容易发现纠正</span></strong><span>。</span></p></li><li><p><strong><span>数据采集</span></strong><span>: 数据采集阶段产生的错误很难被修正，可以将其概括为以下四类：</span></p><ul><li><strong><span>完全随机缺失（missing completely at random,MCAR）</span></strong>
<span>当样本缺失的概率和所有观测值一样时，缺失的产生不依赖于任何不完全变量或完全变量，不影响样本的无偏性。比如在调研过程中，受访者随机的回答问题，</span><strong><span>又如在电池循环测试中，中位机因随机扰动出现的某一处数据缺失。</span></strong></li><li><strong><span>随机缺失（missing at random,MAR)</span></strong>
<span>有时候变量缺失值产生是随机的，并且缺失频率在不同的值之间又是不一样的，即该类数据的缺失依赖于其他完全变量。例如有些情况，在女性样本中年龄和性别的缺失值会比男性的多，</span><strong><span>又比如在电池测试中，因为高/低温测试容易导致传感器随机失效进而导致比常温测试的缺失频率要高。</span></strong></li><li><strong><span>缺失值依赖于某些未观察到的变量（missing not at random,MNAR)</span></strong>
<span>在这种情况下缺失值的产生不是随机的，而是依赖于某些我们未能观察到的(输入)变量。例如：“身体不适”会是某些特别的诊断的原因，但除非我们能把“身体不适”加入输入变量当中，否则就有可能产生“随机”的缺失。</span><strong><span>以电池循环测试为例 ，比如有一台中位机因为制造时产生的隐形缺陷，导致其在某一特定条件（比如特定时间点）容易诱发数据缺失，这种隐形缺陷也是很难捕捉的。</span></strong></li><li><strong><span>缺失值依赖于缺失值本身，非随机缺失(missing not at random,MNAR)</span></strong>
<span>指的是数据的缺失与不完全变量自身的取值有关。比如那些收入很高或者非常低的人通常不会提供自己的收入信息。</span><strong><span>在电池测试过程中，如果实验设计人员决定提前中止测试，对于电池后续的容量数据就无法获取，这种缺失就是人为控制的。</span></strong></li></ul></li></ol><h3 id='412-缺失值检测'><span>4.1.2 缺失值检测</span></h3><p><span>本文所使用的数据在</span><a href='数据收集、清洗'><span>数据收集、清洗</span></a><span>阶段，自动化程序已经进行了部分校验和缺失值填补工作，这章的缺失值是指那些通过自动化程序进行数据收集、清洗后仍遗留的缺失值部分。下面是查看缺失值的方法：</span></p><ul><li><span>先查看整体情况</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 使用dataframe.info()命令查看整体数据情况</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">info</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&lt;</span><span class="cm-keyword">class</span> <span class="cm-string">'pandas.core.frame.DataFrame'</span><span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">RangeIndex</span>: <span class="cm-number">2659</span> <span class="cm-variable">entries</span>, <span class="cm-number">0</span> <span class="cm-variable">to</span> <span class="cm-number">2658</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Data</span> <span class="cm-variable">columns</span> (<span class="cm-variable">total</span> <span class="cm-number">49</span> <span class="cm-variable">columns</span>):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment"># &nbsp; Column &nbsp;  Non-Null Count  Dtype &nbsp;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">---</span> &nbsp;<span class="cm-operator">------</span> &nbsp; &nbsp;<span class="cm-operator">--------------</span> &nbsp;<span class="cm-operator">-----</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">0</span> &nbsp; <span class="cm-variable">试产单号</span><span class="cm-operator">/</span><span class="cm-variable">批次号</span> &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">1</span> &nbsp; <span class="cm-variable">电解液</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">2</span> &nbsp; <span class="cm-variable">正极材料</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">3</span> &nbsp; <span class="cm-variable">负极材料</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">4</span> &nbsp; <span class="cm-variable">隔膜纸</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"> <span class="cm-number cm-error">5</span> &nbsp; <span class="cm-variable">隔膜纸品牌</span> &nbsp; &nbsp; <span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-builtin">object</span> <span class="cm-tab" role="presentation" cm-text="	">  </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">6</span> &nbsp; <span class="cm-variable">是否高孔</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">int64</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">7</span> &nbsp; <span class="cm-variable">隔膜基材厚度</span> &nbsp; &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">8</span> &nbsp; <span class="cm-variable">隔膜涂层厚度</span> &nbsp; &nbsp;<span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">9</span> &nbsp; <span class="cm-number">2</span><span class="cm-variable">ex百分比</span> &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">10</span> &nbsp;<span class="cm-variable">单次放电容量</span> &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">int64</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">11</span> &nbsp;<span class="cm-variable">充电电流</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">12</span> &nbsp;<span class="cm-variable">充电后搁置时间</span> &nbsp; <span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number cm-error">13</span> &nbsp;<span class="cm-variable">放电后搁置时间</span> &nbsp; <span class="cm-number">2656</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">14</span> &nbsp;<span class="cm-variable">温度</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2659</span> <span class="cm-variable">non</span><span class="cm-operator">-</span><span class="cm-variable">null</span> &nbsp; <span class="cm-variable">int64</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-null cm-error">.</span>.....</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 575px;"></div><div class="CodeMirror-gutters" style="display: none; height: 575px;"></div></div></div></pre><p><span>从数据结构上看，有2659个样本（行），那么如果各列非空元素数量小于2659，即证明该列中存在缺失值，如电解液只有2656个非空元素，则证明有3个缺失值，但这样的操作不直观，还得人为计算。其实可以用函数直接求解各列缺失值。</span></p><ul><li><span>各列缺失值统计</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 直接函数求解缺失值统计</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">missing_col</span> = <span class="cm-variable">data</span>.<span class="cm-property">columns</span>[<span class="cm-variable">data</span>.<span class="cm-property">isnull</span>().<span class="cm-property">any</span>()]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[<span class="cm-variable">missing_col</span>].<span class="cm-property">isna</span>().<span class="cm-property">sum</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">试产单号</span><span class="cm-operator">/</span><span class="cm-variable">批次号</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">正极材料</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">负极材料</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜纸</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜纸品牌</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜基材厚度</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜涂层厚度</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电后搁置时间</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">放电后搁置时间</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">循环寿命</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1108</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1000</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1500</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">28</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t2000</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">220</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t2500</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">409</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-property">t14500</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2172</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t15000</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">2246</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 506px;"></div><div class="CodeMirror-gutters" style="display: none; height: 506px;"></div></div></div></pre><p><span>可以看到特征列中每列都有3个缺失值，那就很有可能这这些缺失值来自相同的3个样本。另外随着循环次数的增加，标签列的缺失值逐渐增多，这也很好理解，因为很多电池在实验过程中间已经达到寿命，实验停止，自然没有后面的数据，这些标签列的缺失值是正常的，不用处理。那么下一步我们来验证特征列的3个缺失值是否来自相同的3个样本：</span></p><ul><li><span>检验缺失的样本编号</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 寻找各特征列的缺失值样本编号并显示</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'{}特征列的缺失值样本编号为{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">i</span>,<span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-variable">i</span>].<span class="cm-property">isna</span>()].<span class="cm-property">index</span>.<span class="cm-property">to_list</span>()))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">试产单号</span><span class="cm-operator">/</span><span class="cm-variable">批次号特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">正极材料特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">负极材料特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜纸特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜纸品牌特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜基材厚度特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">隔膜涂层厚度特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">充电后搁置时间特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">放电后搁置时间特征列的缺失值样本编号为</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1431</span>, <span class="cm-number">1551</span>, <span class="cm-number">1565</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 552px;"></div><div class="CodeMirror-gutters" style="display: none; height: 552px;"></div></div></div></pre><p><span>从结果可以看出，这些缺失值确实来自相同的3个样本。那么接下来就是对这些缺失值进行处理。</span></p><h3 id='413-缺失值处理'><span>4.1.3 缺失值处理</span></h3><p><span>对缺失值的处理，主要是考虑缺失值本身的数量和对后续建模的影响。主要包括：</span></p><p><strong><span>缺失率比较低但重要性高：</span></strong><span>可以通过经验或知识估计。</span></p><p><strong><span>少量缺失且重要性不高：</span></strong><span>考虑</span><strong><span>不处理</span></strong><span>或</span><strong><span>删除缺失数据</span></strong><span>或者</span><strong><span>采用均值、中位数、众数、同类均值简单填充。</span></strong></p><p><strong><span>当缺失值对模型影响比较大，存在比较多的不缺失数据的情况下：</span></strong><span>可以采用</span><strong><span>模型预测</span></strong><span>或者</span><strong><span>插值</span></strong><span>的方式。</span></p><p><strong><span>当缺失值过多时：</span></strong><span>可以对缺失值进行</span><strong><span>编码操作</span></strong><span>，即将缺失值看作一种特征水平。</span></p><p><strong><span>一般缺失值处理流程：</span></strong><span>对每个字段都计算其缺失值比例，然后按照缺失比例和字段重要性，分别制定策略，可用下图表示：</span></p><div align="center">
    <img src="pic/缺失值处理原则.png">
</div><h4 id='4131-人工填充'><span>4.1.3.1 人工填充</span></h4><p><span>在本案例中，只有3个样本有缺失值，我们大可以直接删除这3个样本或者直接查找原始实验数据，查找对比同一实验批次的电芯实验信息，然后进行缺失值人工填补，思路如下：</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="143.5" style="max-width: 1170px; height: 183.5px;" viewBox="0 0 1170 143.5" class="md-require-zoom-fix"><style>#mermaidChart1{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart1 .error-icon{fill:#552222;}#mermaidChart1 .error-text{fill:#552222;stroke:#552222;}#mermaidChart1 .edge-thickness-normal{stroke-width:2px;}#mermaidChart1 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart1 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart1 .marker{fill:#333333;}#mermaidChart1 .marker.cross{stroke:#333333;}#mermaidChart1 svg{font-family:sans-serif;font-size:16px;}#mermaidChart1 .label{font-family:sans-serif;color:#333;}#mermaidChart1 .label text{fill:#333;}#mermaidChart1 .node rect,#mermaidChart1 .node circle,#mermaidChart1 .node ellipse,#mermaidChart1 .node polygon,#mermaidChart1 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart1 .node .label{text-align:center;}#mermaidChart1 .node.clickable{cursor:pointer;}#mermaidChart1 .arrowheadPath{fill:#333333;}#mermaidChart1 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart1 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart1 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart1 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart1 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart1 .cluster text{fill:#333;}#mermaidChart1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart1:root{--mermaid-font-family:sans-serif;}#mermaidChart1:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart1 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M124,71.75L149,71.75L174,71.75" marker-end="url(#arrowhead92)" style="fill:none"></path><defs><marker id="arrowhead92" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M286.9756097560976,49.25L347,20.5L486,20.5L617,20.5L650,24.859756097560975" marker-end="url(#arrowhead93)" style="fill:none"></path><defs><marker id="arrowhead93" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-D" id="L-B-D" style="opacity: 1;"><path class="path" d="M306,93.33878504672897L347,106.75L388,106.75" marker-end="url(#arrowhead94)" style="fill:none"></path><defs><marker id="arrowhead94" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-E" id="L-C-E" style="opacity: 1;"><path class="path" d="M830,36.75L855,36.75L890.3571428571429,49.25" marker-end="url(#arrowhead95)" style="fill:none"></path><defs><marker id="arrowhead95" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;"><path class="path" d="M1028,71.75L1053,71.75L1078,71.75" marker-end="url(#arrowhead96)" style="fill:none"></path><defs><marker id="arrowhead96" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-C" id="L-D-C" style="opacity: 1;"><path class="path" d="M570.2142857142857,84.25L617,71.75L660.9285714285714,59.25" marker-end="url(#arrowhead97)" style="fill:none"></path><defs><marker id="arrowhead97" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;"><path class="path" d="M584,118.90648854961832L617,123L740,123L855,123L910.5365853658536,94.25" marker-end="url(#arrowhead98)" style="fill:none"></path><defs><marker id="arrowhead98" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(486,20.5)" style="opacity: 1;"><g transform="translate(-8,-12.5)" class="label"><rect rx="0" ry="0" width="16" height="25"></rect><foreignObject width="16" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>有</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(347,106.75)" style="opacity: 1;"><g transform="translate(-16,-12.5)" class="label"><rect rx="0" ry="0" width="32" height="25"></rect><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>没有</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(617,71.75)" style="opacity: 1;"><g transform="translate(-8,-12.5)" class="label"><rect rx="0" ry="0" width="16" height="25"></rect><foreignObject width="16" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>有</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(740,123)" style="opacity: 1;"><g transform="translate(-16,-12.5)" class="label"><rect rx="0" ry="0" width="32" height="25"></rect><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>没有</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-52" transform="translate(66,71.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">查找原始数据</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-53" transform="translate(240,71.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">是否有批次信息</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-55" transform="translate(740,36.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-90" y="-22.5" width="180" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-80,-12.5)"><foreignObject width="160" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">直接查找原始实验登记</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-57" transform="translate(486,106.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-98" y="-22.5" width="196" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-88,-12.5)"><foreignObject width="176" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">寻找上柜日期和柜点信息</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-59" transform="translate(954,71.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-74" y="-22.5" width="148" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-64,-12.5)"><foreignObject width="128" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">无法找到实验登记</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-61" transform="translate(1120,71.75)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">删除样本</div></foreignObject></g></g></g></g></g></g></svg></div><p><span>通过人工查找，我们获取了缺失信息，并进行数据录入:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 根据查到的信息填补缺失值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">loc</span>[<span class="cm-number">1431</span>,<span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]] = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'试产单号/批次号'</span>]==<span class="cm-string">'20070812-4'</span>) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>]==<span class="cm-string">'BTP:07046'</span>)][<span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]].<span class="cm-property">iloc</span>[<span class="cm-number">0</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">loc</span>[<span class="cm-number">1431</span>,<span class="cm-string">'是否高孔'</span>] = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'试产单号/批次号'</span>]==<span class="cm-string">'20070812-4'</span>) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>]==<span class="cm-string">'BTP:07046'</span>)][<span class="cm-string">'是否高孔'</span>].<span class="cm-property">iloc</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">loc</span>[<span class="cm-number">1551</span>,<span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]] = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'试产单号/批次号'</span>]==<span class="cm-string">'20070812-5'</span>) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>]==<span class="cm-string">'BTP:07046'</span>)][<span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]].<span class="cm-property">iloc</span>[<span class="cm-number">0</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">loc</span>[<span class="cm-number">1551</span>,<span class="cm-string">'是否高孔'</span>] = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'试产单号/批次号'</span>]==<span class="cm-string">'20070812-5'</span>) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>]==<span class="cm-string">'BTP:07046'</span>)][<span class="cm-string">'是否高孔'</span>].<span class="cm-property">iloc</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">loc</span>[<span class="cm-number">1565</span>,<span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]] = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'试产单号/批次号'</span>]==<span class="cm-string">'20071427-1'</span>) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>]==<span class="cm-string">'BTP:07046'</span>)][<span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]].<span class="cm-property">iloc</span>[<span class="cm-number">0</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">loc</span>[<span class="cm-number">1565</span>,<span class="cm-string">'是否高孔'</span>] = <span class="cm-variable">data</span>[(<span class="cm-variable">data</span>[<span class="cm-string">'试产单号/批次号'</span>]==<span class="cm-string">'20071427-1'</span>) <span class="cm-operator">&amp;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (<span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>]==<span class="cm-string">'BTP:07046'</span>)][<span class="cm-string">'是否高孔'</span>].<span class="cm-property">iloc</span>[<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 检验缺失值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-variable">missing_col</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'{}特征列的缺失值样本编号为:{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">i</span>,<span class="cm-variable">data</span>[<span class="cm-variable">data</span>[<span class="cm-variable">i</span>].<span class="cm-property">isna</span>()].<span class="cm-property">index</span>.<span class="cm-property">to_list</span>()))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 缺失值填充结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">试产单号</span><span class="cm-operator">/</span><span class="cm-variable">批次号</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">电解液</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">正极材料</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">负极材料</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">隔膜纸</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">隔膜纸品牌</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">隔膜基材厚度</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">隔膜涂层厚度</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">充电后搁置时间</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">放电后搁置时间</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1431</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">20070812</span><span class="cm-operator">-</span><span class="cm-number">4</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">P2S</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">W</span><span class="cm-operator">-</span><span class="cm-variable">SCOPE高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">32.75</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">W</span><span class="cm-operator">-</span><span class="cm-variable">SCOPE</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">0.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1551</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">20070812</span><span class="cm-operator">-</span><span class="cm-number">5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">SS</span><span class="cm-operator">-</span><span class="cm-variable">ZZWB011</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">P2S</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">W</span><span class="cm-operator">-</span><span class="cm-variable">SCOPE高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">32.75</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">W</span><span class="cm-operator">-</span><span class="cm-variable">SCOPE</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">0.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1565</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">20071427</span><span class="cm-operator">-</span><span class="cm-number">1</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">DY</span><span class="cm-operator">-</span><span class="cm-number">7</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">CP5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">恩捷</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">9.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">0.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10.0</span> &nbsp; </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 506px;"></div><div class="CodeMirror-gutters" style="display: none; height: 506px;"></div></div></div></pre><p><span>通过人工介入，我们完成了这3个样本的缺失值填补工作。实际在大规模数据处理时，如果缺失率很低（像本案例缺失率=3/2659≈0.1%），一般是直接删除缺失样本的，特别是大数据环境下（比如互联网上收集的数据，都是以TB、PB级数据容量），这主要考虑的是人力成本和时间成本。但作为面向工业生产、实验领域，更看重的数据质量和可靠性，所以采取人力调查、人力填充这样的缺失值处理方式。</span></p><h4 id='4132-特殊值填充'><span>4.1.3.2 特殊值填充</span></h4><p><span>如果将缺失值看作一种特征水平，带入后面的建模过程，即为特殊值填充，</span><strong><span>一般这种填充方式适合文本型特征，不适合数值型特征</span></strong><span>，因为不同的数值特征取值范围，单位量纲一般不同。还是以本项目的原始数据为例，方法如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># step1:筛选文本特征</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tar_col</span> = <span class="cm-variable">missing_col</span>[<span class="cm-variable">data</span>[<span class="cm-variable">missing_col</span>].<span class="cm-property">dtypes</span>==<span class="cm-string">'object'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tar_col</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 文本特征</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Index</span>([<span class="cm-string">'试产单号/批次号'</span>, <span class="cm-string">'电解液'</span>, <span class="cm-string">'正极材料'</span>, <span class="cm-string">'负极材料'</span>, <span class="cm-string">'隔膜纸'</span>, <span class="cm-string">'隔膜纸品牌'</span>], <span class="cm-variable">dtype</span>=<span class="cm-string">'object'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># step2:用‘unkown'填充缺失值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[<span class="cm-variable">tar_col</span>] = <span class="cm-variable">data</span>[<span class="cm-variable">tar_col</span>].<span class="cm-property">fillna</span>(<span class="cm-string">'unkown'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">loc</span>[[<span class="cm-number">1431</span>,<span class="cm-number">1551</span>,<span class="cm-number">1565</span>],<span class="cm-variable">tar_col</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">试产单号</span><span class="cm-operator">/</span><span class="cm-variable">批次号</span> <span class="cm-variable">电解液</span> <span class="cm-variable">正极材料</span> <span class="cm-variable">负极材料</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">隔膜纸</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">隔膜纸品牌</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1431</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1551</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1565</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">unkown</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 299px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><p><strong><span>以特殊值填充缺失值，实际上为每个特征新增加了一个特征取值，后面如果特征进行</span><a href='独热编码/哑变量'><span>独热编码/哑变量</span></a><span>操作时，将会增加数据维度，每对一个特征使用特殊值填补，将会额外增加一个数据维度，本例中总共为6个特征引入特殊值填充，总共将会增加6个数据维度。如果对过多的特征引入特殊值，将有可能增加后期建模成本和运算开销。同时，特殊值填充没有考虑不同缺失值之间的差异，势必会降低模型精度。</span></strong></p><h4 id='4133-统计量填充'><span>4.1.3.3 统计量填充</span></h4><p><span>统计量填充实质上也是一种特殊值填充，但因为增加了统计学背景，所以相对会有一定解释性。常见用来填充缺失值的统计量有：</span><strong><span>平均值、中位数、众数</span></strong><span>等。统计量填充一般适合数值型特征，对文本型特征不太适合（众数填充除外）。</span></p><p><span>还是以本项目数据作为统计量填充的例子，我们来对比一下，不同的统计量填充缺失值后的差异，过程如下:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># step1:筛选数值特征</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tar_col</span> = <span class="cm-variable">missing_col</span>[<span class="cm-variable">data</span>[<span class="cm-variable">missing_col</span>].<span class="cm-property">dtypes</span><span class="cm-operator">!</span>=<span class="cm-string">'object'</span>][:<span class="cm-operator">-</span><span class="cm-number">30</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tar_col</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 数值特征</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Index</span>([<span class="cm-string">'隔膜基材厚度'</span>, <span class="cm-string">'隔膜涂层厚度'</span>, <span class="cm-string">'充电后搁置时间'</span>, <span class="cm-string">'放电后搁置时间'</span>], <span class="cm-variable">dtype</span>=<span class="cm-string">'object'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># step2:计算不同统计量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data1</span>=<span class="cm-variable">data</span>[<span class="cm-variable">tar_col</span>].<span class="cm-property">agg</span>([<span class="cm-string">'mean'</span>,<span class="cm-string">'median'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data2</span>=<span class="cm-variable">data</span>[<span class="cm-variable">tar_col</span>].<span class="cm-property">agg</span>(<span class="cm-string">'mode'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data3</span>=<span class="cm-variable">pd</span>.<span class="cm-property">concat</span>([<span class="cm-variable">data1</span>,<span class="cm-variable">data2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data3</span>.<span class="cm-property">index</span>=[<span class="cm-string">'平均值'</span>,<span class="cm-string">'中位数'</span>,<span class="cm-string">'众数'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">隔膜基材厚度</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">隔膜涂层厚度</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">充电后搁置时间</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">放电后搁置时间</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">平均值</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">8.608434</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">2.137801</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">1.388554</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">12.304217</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">中位数</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9.000000</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">3.000000</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">0.500000</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10.000000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">众数</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">9.000000</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">3.000000</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">0.500000</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10.000000</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></pre><p><span>从结果上，这4个特征的中位数跟众数是一致的，而平均值因为对数据进行除法计算进而产生小数位。</span><strong><span>一般对于连续性数值特征，可以采用平均值和中位数，而众数不适合；而对于离散型数值特征，特征一般是分类特征，一般采用中位数或众数，平均值不适合。与人工填充的真实缺失值进行对比，</span><mark><span>发现采用中位数和众数填充，结果与真实数据一致，这说明这两种方法是具有一定可取性的，特别是针对具有倾斜分布的数据，即某一水平（或某一区间）数值占据整体比例较大的情况。</span></mark></strong></p><p><span>实际操作可以参照如下策略：</span></p><p><strong><span>平均值</span></strong><span>：对于数据符合均匀分布，用该变量的均值填补缺失值。</span>
<strong><span>中位数</span></strong><span>：对于数据存在倾斜分布的情况，采用中位数、众数填补缺失值。</span>
<strong><span>众数</span></strong><span>：离散特征可使用众数进行填充缺失值</span></p><h4 id='4134-相似填充'><span>4.1.3.4 相似填充</span></h4><p><span>上面的统计量填充策略是不考虑各个样本组合的，这样即使采用了统计量填充，正确率还是偏低。为此我们可以采用同组别填充的方式，具体来说，</span><strong><span>就是根据一致的分组，如果落在相同的组别里，就用这个组别的众数、均值、中位数填充。</span></strong><span>相似填充相对来说没什么特别难以操作的地方，但会受到样本数量的限制，特别是如果没有n维同组别数据，只能退而求其次用（n-1)维数据，如果还没有再继续降维寻找相同组别样本。因为操作相对简单，这里就不做案例解析了。</span></p><h4 id='4135-插值法填充'><span>4.1.3.5 插值法填充</span></h4><p><span>插值法的核心在于寻找拟合数据，拟合是通过其他特征建模来填补，包括线性插值法，多重插补法，热平台插补，拉格朗日插值，牛顿插值等。下面将以线性插值法进行案例分析。</span></p><ul><li><strong><span>线性插值法</span></strong></li></ul><p><span>使用插值法可以计算缺失值的估计值，所谓的插值法就是通过两点（x0，y0），（x1，y1）估计中间点的值。假设 y=f(x)是一条直线，通过已知的两点来计算函数 f(x)，然后只要知道 x 就能求出 y，以此方法来估计缺失值，这种假定数据是线性变化并填补缺失值的方法就叫做线性插值法。因为此次案例的缺失值属于文本型特征和离散型分类特征，而线性插值法适用的是连续型变量，用线性插值法并不合适。不过，我们可以人为的制造数据缺失，并使用线性插值法观察效果。同时因为特征变量只有分容容量和首次容量是连续型变量，且相邻样本之间并无逻辑的顺序，所以采用标签变量来做线性插值法演示，即对</span><strong><span>电池循环容量进行线性插值法</span></strong><span>。又因为同一样本不同的循环次数后电池容量之间存在时间序列关系，所以线性插值方向为行方向。具体过程如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 随机挑选3个样本</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rng</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">RandomState</span>(<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">missing_row</span> = <span class="cm-variable">rng</span>.<span class="cm-property">randint</span>(<span class="cm-variable">data</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>],<span class="cm-variable">size</span>=<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">missing_row</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 样本ID</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">array</span>([<span class="cm-number">2607</span>, <span class="cm-number">1653</span>, &nbsp;<span class="cm-number">835</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 从每个样本的标签变量随机挑选1列</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">col_lis</span>=[]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">c</span> <span class="cm-keyword">in</span> <span class="cm-variable">missing_row</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">rng</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">RandomState</span>(<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">col_lis</span>.<span class="cm-property">append</span>(<span class="cm-variable">rng</span>.<span class="cm-property">randint</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[<span class="cm-variable">c</span>][<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[<span class="cm-variable">c</span>].<span class="cm-property">notna</span>()].</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-property">index</span>[<span class="cm-number">20</span>:<span class="cm-operator">-</span><span class="cm-number">1</span>]),<span class="cm-variable">size</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">col_lis</span>=<span class="cm-variable">np</span>.<span class="cm-property">array</span>(<span class="cm-variable">col_lis</span>)<span class="cm-operator">+</span><span class="cm-number">20</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 设置缺失值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">missing_row</span>)):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'替换前的值：\n'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[<span class="cm-variable">missing_row</span>[<span class="cm-variable">i</span>],<span class="cm-variable">col_lis</span>[<span class="cm-variable">i</span>]<span class="cm-operator">-</span><span class="cm-number">1</span>:<span class="cm-variable">col_lis</span>[<span class="cm-variable">i</span>]<span class="cm-operator">+</span><span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[<span class="cm-variable">missing_row</span>[<span class="cm-variable">i</span>],<span class="cm-variable">col_lis</span>[<span class="cm-variable">i</span>]]=<span class="cm-variable">np</span>.<span class="cm-property">nan</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'替换成缺失值：\n'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[<span class="cm-variable">missing_row</span>[<span class="cm-variable">i</span>],<span class="cm-variable">col_lis</span>[<span class="cm-variable">i</span>]<span class="cm-operator">-</span><span class="cm-number">1</span>:<span class="cm-variable">col_lis</span>[<span class="cm-variable">i</span>]<span class="cm-operator">+</span><span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">替换前的值</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t6500</span> &nbsp; &nbsp;<span class="cm-number">200.283389</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t7000</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">198.5375</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t7500</span> &nbsp; &nbsp;<span class="cm-number">197.429278</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">2607</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">替换成缺失值</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t6500</span> &nbsp; &nbsp;<span class="cm-number">200.283389</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t7000</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t7500</span> &nbsp; &nbsp;<span class="cm-number">197.429278</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">2607</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">替换前的值</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t2500</span> &nbsp; &nbsp;<span class="cm-number">209.286694</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t3000</span> &nbsp; &nbsp;<span class="cm-number">206.942306</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t3500</span> &nbsp; &nbsp;<span class="cm-number">204.382778</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">1653</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">替换成缺失值</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t2500</span> &nbsp; &nbsp;<span class="cm-number">209.286694</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t3000</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t3500</span> &nbsp; &nbsp;<span class="cm-number">204.382778</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">1653</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">替换前的值</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t500</span> &nbsp; &nbsp; <span class="cm-number">202.6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1000</span> &nbsp; &nbsp;<span class="cm-number">199.3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1500</span> &nbsp; &nbsp;<span class="cm-number">194.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">835</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">替换成缺失值</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t500</span> &nbsp; &nbsp; <span class="cm-number">202.6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1000</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">NaN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1500</span> &nbsp; &nbsp;<span class="cm-number">194.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">835</span>, <span class="cm-variable">dtype</span>: <span class="cm-builtin">object</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1173px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1173px;"></div></div></div></pre><p><span>这样我们就从ID为[2607, 1653,  835]的三个样本里在循环容量里随机设置了3个缺失值，接下来我们就要用线性插值法，求出拟合出的线性插值：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 线性插值并输出</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">missing_row</span>)):</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'线性插值处理后:'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[:,<span class="cm-number">19</span>:].<span class="cm-property">iloc</span>[<span class="cm-variable">missing_row</span>[<span class="cm-variable">i</span>]].<span class="cm-property">interpolate</span>(<span class="cm-variable">method</span>=<span class="cm-string">'linear'</span>).</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-property">iloc</span>[<span class="cm-variable">col_lis</span>[<span class="cm-variable">i</span>]<span class="cm-operator">-</span><span class="cm-number">20</span>:<span class="cm-variable">col_lis</span>[<span class="cm-variable">i</span>]<span class="cm-operator">-</span><span class="cm-number">17</span>]) &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">线性插值处理后</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t6500</span> &nbsp; &nbsp;<span class="cm-number">200.283389</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t7000</span> &nbsp; &nbsp;<span class="cm-number">198.856333</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t7500</span> &nbsp; &nbsp;<span class="cm-number">197.429278</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">2607</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">线性插值处理后</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t2500</span> &nbsp; &nbsp;<span class="cm-number">209.286694</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t3000</span> &nbsp; &nbsp;<span class="cm-number">206.834736</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t3500</span> &nbsp; &nbsp;<span class="cm-number">204.382778</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">1653</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">线性插值处理后</span>:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t500</span> &nbsp; &nbsp; <span class="cm-number">202.6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1000</span> &nbsp; &nbsp;<span class="cm-number">198.3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">t1500</span> &nbsp; &nbsp;<span class="cm-number">194.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">835</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">float64</span> &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 483px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><p><span>下表是关于线性插值拟合的数据与原始数据的对比，可以发现对于</span><strong><mark><span>循环测试的电池（只针对LFP10370C2-200mAh，且不适用低温测试），电池容量在相邻区间（本案例是相隔500次循环）内采用线性插值，跟实际结果相差能控制在1%以内。说明即使在全寿命循环中，电池容量不是线性变化，但在一定相邻区间内（至少间隔不少于500次循环）可以近似为线性模型。</span></mark></strong></p><figure><table><thead><tr><th><span>样本ID</span></th><th><span>原数据</span></th><th><span>线性插值拟合的数据</span></th><th><span>相差</span></th></tr></thead><tbody><tr><td><span>2607</span></td><td><span>198.5375</span></td><td><span>198.856333</span></td><td><span>0.2%</span></td></tr><tr><td><span>1653</span></td><td><span>206.942306</span></td><td><span>206.834736</span></td><td><span>0.05%</span></td></tr><tr><td><span>835</span></td><td><span>199.3</span></td><td><span>198.3</span></td><td><span>0.5%</span></td></tr></tbody></table></figure><p><strong><span>当然，插值法（包括线性插值法）比较明显的缺陷就是，必须要求数值前后的数据是具有一定的序列关系的（比如案例中，电池容量是随着循环次数的递增而逐渐变化的），同时缺失值位置不能处于序列两端和数值突变位置（隐含要求连续性数值在缺失值附近是可导的），这些条件会限制插值法的实际应用。</span></strong></p><h4 id='4136-使用模型预测缺失值'><span>4.1.3.6 使用模型预测缺失值</span></h4><ul><li><strong><span>原理</span></strong></li></ul><p><span>使用待填充字段作为标签（预测结果，因变量），没有缺失的数据作为特征（训练数据，自变量），建立分类/回归模型，对待填充的缺失字段进行预测并进行填充，利用预测模型对缺失值进行估计的方法。采用模型预测，结果根据算法的不同，会产生不同的解释，相比单纯统计量填充会更具解释性，但也会存在下列问题：</span></p><ol start='' ><li><span>模型估计值通常会比实际值更加整齐(well-behaved)</span></li><li><span>如果变量间并没有关系，那么模型的预测值可能是不准确的</span></li></ol><ul><li><strong><span>方法</span></strong></li></ul><p><span>可以使用常规回归，如线性回归、ANOVA，logistic回归等方法进行预测（上面的线性插值就是线性模型预测的结果），也可以使用复杂回归，如树模型（如</span><a href='决策树'><span>决策树</span></a><span>、</span><a href='随机森林'><span>随机森林</span></a><span>等）、</span><a href='KNN'><span>KNN</span></a><span>（K最近邻）等机器学习算法。本案例将采用</span><strong><span>随机森林</span></strong><span>模型对缺失值进行预测。</span></p><h4 id='案例分析随机森林预测缺失值'><strong><a id='案例分析：随机森林预测缺失值'><span>案例分析：随机森林预测缺失值</span></a></strong></h4><p><strong><span>案例目的：利用随机森林预测样本缺失值中的负极材料类型</span></strong></p><p><span>注：原始数据中3个样本的缺失值不单只有负极材料（详情请查看之前的</span><a href='缺失值检测'><span>缺失值检测</span></a><span>)，还有其它材料组和测试条件，之所以只选择用负极材料作为预测标签，主要是有以下两个原因：</span></p><p><span>1、作为文本型数据，负极材料共有11种取值，经过</span><a href='#Onehot编码'><span>独热编码（One-Hot编码）</span></a><span>操作后将产生11维数据，即额外产生10个维度的数据，对于负极材料缺失的样本，相当于缺失了11维数据。这种情况下，采用模型预测的准确性将大大降低。如果再加上电解液（28个取值，28维独热编码）、负极材料（7个取值，7维独热编码）……这将使模型几乎无法应用，因为对于多特征缺失问题，模型是采用逐一建模的方式（可以参照下面的</span><a href='#question'><span>建模过程</span></a><span>)，如果缺失维度太高，比如n维，假设每一维的预测准确率为p</span><sub><span>i</span></sub><span>，则n维准确率为：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n935" cid="n935" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="9.624ex" viewBox="0 -2307.6 59683.7 4143.6" role="img" focusable="false" style="vertical-align: -4.264ex; max-width: 100%;"><defs><path stroke-width="0" id="E12-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E12-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E12-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E12-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E12-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E12-MJMATHI-70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path stroke-width="0" id="E12-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E12-MJMATHI-63" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path stroke-width="0" id="E12-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E12-MJSZ2-220F" d="M220 812Q220 813 218 819T214 829T208 840T199 853T185 866T166 878T140 887T107 893T66 896H56V950H1221V896H1211Q1080 896 1058 812V-311Q1076 -396 1211 -396H1221V-450H725V-396H735Q864 -396 888 -314Q889 -312 889 -311V896H388V292L389 -311Q405 -396 542 -396H552V-450H56V-396H66Q195 -396 219 -314Q220 -312 220 -311V812Z"></path><path stroke-width="0" id="E12-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E12-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-4.1" transform="translate(0,689)"><use xlink:href="#E12-MJMAIN-28"></use><use xlink:href="#E12-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E12-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E12-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E12-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(26861,0)"><g transform="translate(-15,0)"><g transform="translate(0,689)"><use xlink:href="#E12-MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-63" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-63" x="962" y="0"></use></g><use xlink:href="#E12-MJMAIN-3D" x="1867" y="0"></use><g transform="translate(2922,0)"><use xlink:href="#E12-MJSZ2-220F" x="0" y="0"></use><g transform="translate(65,-1088)"><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMAIN-31" x="1123" y="0"></use></g><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-6E" x="603" y="1626"></use></g><g transform="translate(4367,0)"><use xlink:href="#E12-MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E12-MJMATHI-69" x="711" y="-213"></use></g><g transform="translate(0,-2326)"><use xlink:href="#E12-MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">：</text></g><g transform="translate(1415,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">缺</text></g><g transform="translate(2230,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">失</text></g><g transform="translate(3046,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">维</text></g><g transform="translate(3861,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">度</text></g><g transform="translate(4677,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">总</text></g><g transform="translate(5492,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">数</text></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">p_{acc}=\prod_{i=1}^{n}p_{i}\tag{4.1} \\
n：缺失维度总数</script></div></div><p><span>假设模型表现很好，缺失维度为50，单次预测准确率保证 p</span><sub><span>i</span></sub><span> 稳定在0.95左右，那么总的准确率p</span><sub><span>acc</span></sub><span>=(0.95)</span><sup><span>50</span></sup><span>≈7.7%，如果缺失维度为11，那么总的准确率</span><a id ='准确率'><span>p</span><sub><span>acc</span></sub><span>=(0.95)</span><sup><span>11</span></sup><span>≈56.9%</span></a><span>。</span><strong><span>可见缺失数据维度越多，总体准确率越低</span></strong><span>，况且也很难保证每个维度的模型准确度能达到0.95</span></p><p><span>2、</span><strong><span>计算开销太大，数据维度太高</span></strong><span>，比如50维，那么相当于建立50个随机森林模型，而每个随机森林模型又包含成百上千个决策树模型，这样的计算开销太大，对计算机算力要求很高。以笔者目前使用的计算机来看，没有办法支撑起这样的运算。</span></p><ul><li><strong><span>原理</span></strong></li></ul><p><span>任何分类、回归都是从特征矩阵中学习，然后求解离散型、连续型标签y的过程，之所以能够实现这个过程，是因为算法认为，特征矩阵和标签之前存在着某种联系。</span><mark><strong><span>实际上，标签和特征是可以相互转换的，比如当我们想要预测电池在循环5000次后的剩余容量时，此时的电池容量就是标签y，而电池的材料特征和测试条件就是特征x；当然也可以反过来，如果想要预测电池的负极材料，那么负极材料就是标签y，电池各阶段的容量、寿命、其它材料组合和测试条件就是特征x。</span></strong></mark></p><p><span>对于一个有n个特征的数据来说，其中某一特征T有缺失值，我们就把特征T当作标签，其他的n-1个特征和原本的标签组成新的特征矩阵。那对于T来说，它没有缺失的部分，就是我们的测试集，这部分数据既有标签也有特征；而它缺失的部分，只有特征没有标签，就是我们需要预测的部分，也就是测试集。即：</span></p><ul><li><span>特征T不缺失的值对应的其他n-1个特征 + 本来的标签：X_train（训练集中特征部分数据，已知）</span><span>	</span></li><li><span>特征T不缺失的值：Y_train（训练集中标签部分数据，已知）；</span></li><li><span>特征T缺失的值对应的其他n-1个特征 + 本来的标签：X_test（测试集中特征部分数据，已知）；</span></li><li><span>特征T缺失的值：未知，我们需要预测的Y_test（测试集中标签部分数据，未知，本案例中即是</span><strong><span>待预测缺失值</span></strong><span>）。</span></li></ul><p><span>这种做法，对于某一个特征大量缺失，其他特征却很完整的情况，非常适用。</span></p><p><a id='question'><span>那如果数据中除了特征T之外，其他特征也有缺失值怎么办？</span></a></p><p><span>答案是遍历所有的特征，从缺失最少的开始进行填补（因为填补缺失最少的特征所需要的准确信息最少）。填补一个特征时，先将其他特征的缺失值用0代替，每完成一次回归预测，就将预测值放到原本的特征矩阵中，再继续填补下一个特征。每一次填补完毕，有缺失值的特征会减少一个，所以每次循环后，需要用0来填补的特征就越来越少。当进行到最后一个特征时（这个特征应该是所有特征中缺失值最多的），已经没有任何的其他特征需要用0来进行填补了，而我们已经使用回归为其他特征填补了大量有效信息，可以用来填补缺失最多的特征。遍历所有的特征后，数据就完整，不再有缺失值了。</span></p><p><span>在本案例中因为只选取负极材料作为预测值，虽然经过独热编码后的负极材料维度为11维，但本质上这11维数据只是标记了负极材料这一个特征，我们可以采用将这11维数据同时作为预测标签的方式进行建模，即采用多标签输出建模。具体过程如下（限于篇幅，代码已经经过极大地简略，实际操作过程更为复杂）：</span></p><p><strong><span>step1： 建模</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 选择需要的特征和标签</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>=<span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>, <span class="cm-string">'正极材料'</span>, <span class="cm-string">'隔膜纸品牌'</span>, &nbsp;<span class="cm-string">'是否高孔'</span>, <span class="cm-string">'隔膜基材厚度'</span>,<span class="cm-string">'隔膜涂层厚度'</span>, <span class="cm-string">'2ex百分比'</span>, <span class="cm-string">'单次放电容量'</span>, <span class="cm-string">'充电电流'</span>, <span class="cm-string">'充电后搁置时间'</span>, <span class="cm-string">'放电后搁置时间'</span>, <span class="cm-string">'温度'</span>,<span class="cm-string">'特殊工步'</span>, <span class="cm-string">'负极材料'</span>,<span class="cm-string">'分容容量'</span>, <span class="cm-string">'首次容量'</span>, <span class="cm-string">'循环寿命'</span>, <span class="cm-string">'t500'</span>, <span class="cm-string">'t1000'</span>, <span class="cm-string">'t1500'</span>, <span class="cm-string">'t2000'</span>,<span class="cm-string">'t2500'</span>, <span class="cm-string">'t3000'</span>, <span class="cm-string">'t3500'</span>, <span class="cm-string">'t4000'</span>, <span class="cm-string">'t4500'</span>, <span class="cm-string">'t5000'</span>, <span class="cm-string">'t5500'</span>, <span class="cm-string">'t6000'</span>, <span class="cm-string">'t6500'</span>, <span class="cm-string">'t7000'</span>, <span class="cm-string">'t7500'</span>, <span class="cm-string">'t8000'</span>, <span class="cm-string">'t8500'</span>, <span class="cm-string">'t9000'</span>, <span class="cm-string">'t9500'</span>, <span class="cm-string">'t10000'</span>,<span class="cm-string">'t10500'</span>, <span class="cm-string">'t11000'</span>, <span class="cm-string">'t11500'</span>, <span class="cm-string">'t12000'</span>, <span class="cm-string">'t12500'</span>, <span class="cm-string">'t13000'</span>, <span class="cm-string">'t13500'</span>,<span class="cm-string">'t14000'</span>, <span class="cm-string">'t14500'</span>, <span class="cm-string">'t15000'</span>]]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看数据维度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(<span class="cm-number">2659</span>, <span class="cm-number">47</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 对分类特征进行独热编码</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_fullcode</span>=<span class="cm-variable">pd</span>.<span class="cm-property">get_dummies</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看编码后的数据维度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_code</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(<span class="cm-number">2659</span>, <span class="cm-number">102</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分割训练集、测试集数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">train</span> = <span class="cm-variable">data_fullcode</span>.<span class="cm-property">drop</span>(<span class="cm-variable">labels</span>=[<span class="cm-number">1431</span>,<span class="cm-number">1551</span>,<span class="cm-number">1565</span>],<span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x_train</span> = <span class="cm-variable">train</span>.<span class="cm-property">iloc</span>[:,:<span class="cm-operator">-</span><span class="cm-number">11</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_train</span> = <span class="cm-variable">train</span>.<span class="cm-property">iloc</span>[:,<span class="cm-operator">-</span><span class="cm-number">11</span>:]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">test</span> = <span class="cm-variable">data_fullcode</span>.<span class="cm-property">iloc</span>[[<span class="cm-number">1431</span>,<span class="cm-number">1551</span>,<span class="cm-number">1565</span>],:]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">x_test</span> = <span class="cm-variable">test</span>.<span class="cm-property">iloc</span>[:,:<span class="cm-operator">-</span><span class="cm-number">11</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_test</span> = <span class="cm-variable">test</span>.<span class="cm-property">iloc</span>[:,<span class="cm-operator">-</span><span class="cm-number">11</span>:]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 为每个样本建立一个随机森林模型</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ind</span> = <span class="cm-variable">data</span>.<span class="cm-property">columns</span>.<span class="cm-property">get_indexer</span>([<span class="cm-string">'t5000'</span>,<span class="cm-string">'t15000'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ind</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> [<span class="cm-number">1431</span>,<span class="cm-number">1551</span>,<span class="cm-number">1565</span>]:</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data_dropna</span> = <span class="cm-variable">data_fullcode</span>.<span class="cm-property">dropna</span>(<span class="cm-variable">subset</span>=[<span class="cm-variable">i</span>],<span class="cm-variable">how</span>=<span class="cm-string">'any'</span>,<span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data_dropna</span> = <span class="cm-variable">data_fullcode</span>.<span class="cm-property">drop</span>(<span class="cm-variable">labels</span>=<span class="cm-variable">data</span>.<span class="cm-property">columns</span>[<span class="cm-variable">ind</span>[<span class="cm-number">0</span>]:<span class="cm-variable">ind</span>[<span class="cm-number">1</span>]<span class="cm-operator">+</span><span class="cm-number">1</span>],<span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data_dropna</span> = <span class="cm-variable">data_dropna</span>.<span class="cm-property">dropna</span>(<span class="cm-variable">how</span>=<span class="cm-string">'any'</span>,<span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">train</span> = <span class="cm-variable">data_dropna</span>.<span class="cm-property">drop</span>(<span class="cm-variable">labels</span>=[<span class="cm-number">1431</span>,<span class="cm-number">1551</span>,<span class="cm-number">1565</span>],<span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">train</span>.<span class="cm-property">columns</span>.<span class="cm-property">insert</span>(<span class="cm-operator">-</span><span class="cm-number">12</span>,<span class="cm-string">'循环寿命'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">train</span>[<span class="cm-string">'循环寿命'</span>]=<span class="cm-variable">data_fullcode</span>.<span class="cm-property">loc</span>[<span class="cm-variable">train</span>.<span class="cm-property">index</span>,<span class="cm-string">'循环寿命'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'训练集维度：{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">data_dropna</span>.<span class="cm-property">shape</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">x_train</span> = <span class="cm-variable">train</span>.<span class="cm-property">iloc</span>[:,:<span class="cm-operator">-</span><span class="cm-number">11</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">y_train</span> = <span class="cm-variable">train</span>.<span class="cm-property">iloc</span>[:,<span class="cm-operator">-</span><span class="cm-number">11</span>:]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">test</span> = <span class="cm-variable">data_dropna</span>.<span class="cm-property">loc</span>[<span class="cm-variable">i</span>,:]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">x_test</span> = <span class="cm-variable">test</span>.<span class="cm-property">iloc</span>[:<span class="cm-operator">-</span><span class="cm-number">11</span>].<span class="cm-property">to_numpy</span>().<span class="cm-property">reshape</span>(<span class="cm-number">1</span>,<span class="cm-operator">-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">y_test</span> = <span class="cm-variable">test</span>.<span class="cm-property">iloc</span>[<span class="cm-operator">-</span><span class="cm-number">11</span>:].<span class="cm-property">to_numpy</span>().<span class="cm-property">reshape</span>(<span class="cm-number">1</span>,<span class="cm-operator">-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">rfr</span> = <span class="cm-variable">RandomForestClassifier</span>(<span class="cm-variable">random_state</span>=<span class="cm-variable">i</span>, <span class="cm-variable">n_estimators</span>=<span class="cm-number">2000</span>, <span class="cm-variable">n_jobs</span>=<span class="cm-operator">-</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">rfr</span>.<span class="cm-property">fit</span>(<span class="cm-variable">x_train</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">y_pred</span> = <span class="cm-variable">rfr</span>.<span class="cm-property">predict</span>(<span class="cm-variable">x_test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">argmax</span> = <span class="cm-variable">y_pred</span>.<span class="cm-property">argmax</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'样本编号为{}的负极材料预测值为：'</span>.<span class="cm-property">format</span>(<span class="cm-variable">i</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">y_pred</span>,<span class="cm-string">'即：'</span>,(<span class="cm-variable">y_train</span>.<span class="cm-property">columns</span>[<span class="cm-variable">argmax</span>] <span class="cm-keyword">if</span> <span class="cm-variable">argmax</span> <span class="cm-keyword">else</span> <span class="cm-string">'无法预测负极材料'</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'样本编号为{}的负极材料实际为：'</span>,<span class="cm-variable">data</span>.<span class="cm-property">loc</span>[<span class="cm-variable">i</span>,<span class="cm-string">'负极材料'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">'-'</span><span class="cm-operator">*</span><span class="cm-number">80</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 预测结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1431的训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">81</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1431的负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[[<span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">1</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span>]] <span class="cm-variable">即：</span> <span class="cm-variable">负极材料_CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1431的负极材料实际为：CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1551的训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">81</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1551的负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[[<span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">1</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span>]] <span class="cm-variable">即：</span> <span class="cm-variable">负极材料_CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1551的负极材料实际为：CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1565的训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">81</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1565的负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[[<span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span>]] <span class="cm-variable">即：</span> <span class="cm-variable">无法预测负极材料</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1565的负极材料实际为：CP5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1426px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1426px;"></div></div></div></pre><p><span>从结果上看，前两个样本的缺失值都预测准确，但第三个样本的却预测错误（或者可以说无法预测）。那会不会是模型参数没设置好，导致模型预测精度不足呢？为此，我们可以进行调参：</span></p><p><strong><span>step2：调参</span></strong></p><p><span>上面的模型是没有调整参数的，正确率只有2/3≈0.67，那这样的情况到底是模型本身精度就不行，还是预测样本不适配模型呢？我们可以先看一下，模型采用10折</span><a href='交叉验证'><span>交叉验证</span></a><span>（可点击链接查看交叉验证概念）时的预测准确率如何：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 使用10折交叉验证并绘图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rfr_s</span> = <span class="cm-variable">cross_val_score</span>(<span class="cm-variable">rfr</span>,<span class="cm-variable">data_dropna</span>.<span class="cm-property">iloc</span>[:,:<span class="cm-operator">-</span><span class="cm-number">11</span>],<span class="cm-variable">data_dropna</span>.<span class="cm-property">iloc</span>[:,<span class="cm-operator">-</span><span class="cm-number">11</span>:],<span class="cm-variable">cv</span>=<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fig</span>, <span class="cm-variable">ax</span> = <span class="cm-variable">plt</span>.<span class="cm-property">subplots</span>(<span class="cm-variable">figsize</span>=(<span class="cm-number">10</span>, <span class="cm-number">6</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">plot</span>(<span class="cm-builtin">range</span>(<span class="cm-number">1</span>,<span class="cm-number">11</span>),<span class="cm-variable">rfr_s</span>,<span class="cm-variable">label</span> = <span class="cm-string">"RandomForest"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">text</span>(<span class="cm-number">0.3</span>,<span class="cm-number">0.2</span>,<span class="cm-string">'平均得分：{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">np</span>.<span class="cm-property">mean</span>(<span class="cm-variable">rfr_s</span>)),<span class="cm-variable">transform</span>=<span class="cm-variable">ax</span>.<span class="cm-property">transAxes</span>,<span class="cm-variable">fontsize</span>=<span class="cm-number">12</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xticks</span>(<span class="cm-variable">fontsize</span>=<span class="cm-number">12</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">'交叉验证'</span>,<span class="cm-variable">fontsize</span>=<span class="cm-number">12</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">yticks</span>(<span class="cm-variable">fontsize</span>=<span class="cm-number">12</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">ylabel</span>(<span class="cm-string">'预测准确率'</span>,<span class="cm-variable">fontsize</span>=<span class="cm-number">12</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">legend</span>(<span class="cm-variable">fontsize</span>=<span class="cm-number">12</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 253px;"></div><div class="CodeMirror-gutters" style="display: none; height: 253px;"></div></div></div></pre><div align="center">
    <img src="figure/missing_random_cv.png">
</div><p>&nbsp;</p><p><span>从图像可以看出，未调参前的模型在10折交叉验证中，预测准确率最高有80%左右，最低甚至小于30%，平均预测准确率只有57.1%。这样的模型精度肯定无法满足我们填充缺失值的要求。那么下一步，我们可以进行调参处理，通过调整参数，使模型的准确率有所提升。</span></p><p><span>因为</span><a href='随机森林'><span>随机森林</span></a><span>是以决策树为基评估器的集成算法，其算法参数也继承了决策树的参数，同时集成算法本身也有参数，以及应用中的其他过程也会引进各种参数。粗略下来，起码有20种参数。如果采用逐一调参的方法，既费时又不能保证取得最优解。所以我们可以利用算法自带的网格搜索方法进行参数的优化寻找，同时为降低计算开销，只选取了重要的5个参数参与网格搜索（至于为什么选择这个5个参数的具体原因可以查看后面</span><a href='随机森林'><span>随机森林</span></a><span>章节内容）。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 网格搜索寻找合适参数</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">parameters</span> = {<span class="cm-string">'criterion'</span>:(<span class="cm-string">"gini"</span>,<span class="cm-string">"entropy"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ,<span class="cm-string">'n_estimators'</span>:[<span class="cm-operator">*</span><span class="cm-builtin">range</span>(<span class="cm-number">100</span>,<span class="cm-number">500</span>,<span class="cm-number">100</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ,<span class="cm-string">"max_depth"</span>:[<span class="cm-operator">*</span><span class="cm-builtin">range</span>(<span class="cm-number">1</span>,<span class="cm-number">10</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ,<span class="cm-string">'min_samples_leaf'</span>:[<span class="cm-operator">*</span><span class="cm-builtin">range</span>(<span class="cm-number">1</span>,<span class="cm-number">10</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ,<span class="cm-string">'min_impurity_decrease'</span>:[<span class="cm-operator">*</span><span class="cm-variable">np</span>.<span class="cm-property">linspace</span>(<span class="cm-number">0</span>,<span class="cm-number">0.5</span>,<span class="cm-number">5</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GS</span> = <span class="cm-variable">GridSearchCV</span>(<span class="cm-variable">rfr</span>, <span class="cm-variable">parameters</span>, <span class="cm-variable">cv</span>=<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GS</span>.<span class="cm-property">fit</span>(<span class="cm-variable">x_train</span>,<span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GS</span>.<span class="cm-property">best_params_</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GS</span>.<span class="cm-property">best_score_</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 网格搜索寻找出的最合适参数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{<span class="cm-string">'criterion'</span>: <span class="cm-string">'entropy'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'max_depth'</span>: <span class="cm-number">9</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'min_impurity_decrease'</span>: <span class="cm-number">0.0</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'min_samples_leaf'</span>: <span class="cm-number">1</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'n_estimators'</span>: <span class="cm-number">100</span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 使用网格搜索得到的参数后，模型的平均预测准确率</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0.5692872807017544</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 437px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></pre><p><span>从网格搜索的结果来看，即使在较大范围得到的局部最优模型，其模型准确率也只有</span><mark><strong><span>56.9%，结果与没有调参之前相差无几，说明模型本身预测准确率上限就比较低。凑巧的是，这个</span><a href='#准确率'><span>准确率</span></a><span>与案例开头以单个标签准确率为95%计算出的总准确率是几乎一致的，这说明对于11维输出标签的该案例数据，采用随机森林算法在单个维度能得到比较高的预测准确率，但累乘后的总体准确率，模型无法取得理想准确率。</span></strong></mark></p><p><span>抛开模型整体表现不论，我们想知道采用调参后的模型是否能准确预测本案例，结果如下（省略源代码）：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 调参后的随机森林模型预测的缺失值结果</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1431的训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">81</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1431的负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[[<span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">1</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span>]] <span class="cm-variable">即：</span> <span class="cm-variable">负极材料_CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1431的负极材料实际为：CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1551的训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">81</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1551的负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[[<span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">1</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span>]] <span class="cm-variable">即：</span> <span class="cm-variable">负极材料_CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1551的负极材料实际为：CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1565的训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">81</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1565的负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[[<span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span> <span class="cm-number">0</span>]] <span class="cm-variable">即：</span> <span class="cm-variable">无法预测负极材料</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">样本编号为1565的负极材料实际为：CP5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">--------------------------------------------------------------------------------</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></pre><p><span>令人遗憾的是，即使只看3个样本的预测结果，调参后的模型与调参前的模型是一样的，也一样无法预测第三个样本的负极材料种类。</span></p><p><span>那么该怎么构建预测准确率比较高的模型呢？一个思路就是减少标签维度，从上面的公式10和结果可以看出，</span><strong><span>11维标签的预测准确率比单个维度的预测群准率来得低得多。如果不对负极材料这个标签进行独热编码，只进行负极材料这个标签进行序列编码（即11个负极材料，其对应的编码为诸如1-11之间的整数），这个标签的维度不会增加，但模型会从</span><mark><span>二分类多标签问题转换为多分类单标签问题</span></mark><span>，这样就能减小输出维度，进而提升模型整体预测准确率。</span></strong></p><p><strong><span>ste1:</span><a href='#序列编码'><span>序列编码</span></a></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 对负极材料特征进行分类数值编码</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">le</span> = <span class="cm-variable">LabelEncoder</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">label</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">data</span>[<span class="cm-string">'负极材料'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">le</span>.<span class="cm-property">classes_</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[<span class="cm-string">'负极材料'</span>] </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 编码结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; ..</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2654</span> &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2657</span> &nbsp; &nbsp;<span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2658</span> &nbsp; &nbsp;<span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">负极材料</span>, <span class="cm-variable">Length</span>: <span class="cm-number">2659</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">int32</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 对其它文本型特征进行分类编码</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>]=<span class="cm-variable">data</span>[<span class="cm-string">'特殊工步'</span>].<span class="cm-property">map</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'无'</span> <span class="cm-keyword">if</span> <span class="cm-variable">x</span>==<span class="cm-number">0</span> <span class="cm-keyword">else</span> <span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'隔膜纸品牌'</span>,<span class="cm-string">'特殊工步'</span>]]=<span class="cm-variable">OrdinalEncoder</span>().<span class="cm-property">fit_transform</span>(<span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'隔膜纸品牌'</span>,<span class="cm-string">'特殊工步'</span>]])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'隔膜纸品牌'</span>,<span class="cm-string">'特殊工步'</span>]] </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 编码结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">电解液</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">正极材料</span> &nbsp;<span class="cm-variable">隔膜纸品牌</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">特殊工步</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0</span><span class="cm-tab" role="presentation" cm-text="	">   </span> &nbsp; &nbsp;<span class="cm-number">21.0</span> &nbsp; &nbsp;<span class="cm-number">3.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span> &nbsp; &nbsp; <span class="cm-number">2.0</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">7.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span><span class="cm-tab" role="presentation" cm-text="	">   </span> &nbsp; &nbsp;<span class="cm-number">21.0</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">3.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span> &nbsp; &nbsp; <span class="cm-number">2.0</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">7.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">...<span class="cm-tab" role="presentation" cm-text="	"> </span>...<span class="cm-tab" role="presentation" cm-text="	"> </span>...<span class="cm-tab" role="presentation" cm-text="	"> </span>...<span class="cm-tab" role="presentation" cm-text="	"> </span>...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2657</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">19.0</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">4.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span> &nbsp; &nbsp; <span class="cm-number">1.0</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">7.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2658</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">19.0</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">4.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span> &nbsp; &nbsp; <span class="cm-number">1.0</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">7.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 621px;"></div><div class="CodeMirror-gutters" style="display: none; height: 621px;"></div></div></div></pre><p><strong><span>step2: 建模</span></strong></p><p><span>因为源码比较复杂和篇幅很长，所以就不作展示，结果如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 采用分类数值编码的随机森林预测结果</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">26</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5-H'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">负极材料实际值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5'</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 138px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></pre><div align="center">
    <img src="figure/改进rf.png">
</div><p><b><mark><span>单纯从3个样本的缺失值预测结果来看，第三个样本的预测结果还是错误的，但相比于之前的模型，起码有了预测结果，而不是无法预测。对于模型整体，采用10折交叉检验的平均得分也能达到81.9%，相比于之前的57.1%，也有了长足的进步。</span></mark></b><span>当然这个结果还是没有调参的情况下得到的，我们还是利用网格搜索技术进行参数寻找，过程如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 源代码省略，结果如下</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GS</span>.<span class="cm-property">best_params_</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{<span class="cm-string">'criterion'</span>: <span class="cm-string">'entropy'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'max_depth'</span>: <span class="cm-number">9</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'min_impurity_decrease'</span>: <span class="cm-number">0.0</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'min_samples_leaf'</span>: <span class="cm-number">1</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'n_estimators'</span>: <span class="cm-number">100</span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GS</span>.<span class="cm-property">best_score_</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0.8272039473684212</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 207px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p><span>从结果上，调参后的模型预测准确率达到82.7%，比未调参前的结果提升有限。那再看一下，实际预测结果如何：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 预测结果</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">训练集维度：</span>(<span class="cm-number">957</span>, <span class="cm-number">26</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">负极材料预测值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">2</span> <span class="cm-number">2</span> <span class="cm-number">1</span>] </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">负极材料实际值为：</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5-H'</span> <span class="cm-string">'CP5'</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 161px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><p><span>结果发现，虽然整体预测准确率未比调参前有明显提升，但在实际预测3个样本缺失值时，</span><mark><strong><span>预测值均是正确的，这说明了利用随机森林模型预测缺失值的方法是可行的</span></strong><span>。</span></mark></p><ul><li><strong><span>思考</span></strong></li></ul><p><span>那为什么即使采用分类数值编码模型整体准确率还是不高？又为什么采用分类数值编码会比采用独热编码的准确率提升不少呢？由于这涉及到随机森林（实际是决策树）的算法原理和样本构成问题，这边就不详细解释，只做简单地分析。</span></p><p><span>针对第一个问题，即为什么模型（包括采用独热编码和分类数值编码的模型，也包括调参前和调参后的模型）准确率不高，原因如下：</span></p><ol start='' ><li><b><mark><span>随机森林是由决策树弱评估器组成的bagging算法，其模型上限是受到决策树算法原理限制的。对于特征分类多，样本数量相对较少的模型，如本案例中957个样本，特征维度空间远大于20，单个特征的取值水平又比较多，如光一个电解液就有20多种，实际组成的决策树分支节点就会很多（可以理解，1组或几组特征水平组合，比如 [电解液F4，正极材料P2……温度25℃] 就有可能是一个分支节点），这样组成的决策树分支深度（就是分支层数）就会很多，而分到叶节点上的样本数量就会很少，导致模型泛化能力就很差，同时很容易受到叶节点上个别 ‘异常样本’ 的污染（因为叶节点上样本少，模型会尽量记住这些少量样本的特征，进而很可能将背景噪声和错误都学习进模型里）。而这一点可以从网格搜索的结果可以看出，在参数列表里，不管是采用独热编码或者是采用分类数值编码的随机森林模型，其网格搜索的最终参数都是一样的，其中max_depth（即决策树深度）都为9，而min_samples_leaf（即叶节点最小样本数量）都为1，这证明了为了保证比较好的拟合，决策树必须将特征信息划分到1个样本数量。这其实就说明对于特征水平数量，样本数量是远远不足的，即原始数据无法提供足够的样本学习数据让随机森林获得较高泛化能力。简单总结一句话，就是样本太少，特征数目太多，样本代表性不足，模型泛化能力就不足，自然单棵树的准确率就不足。</span></mark></b><span>实际上看一下这957样本，总共的特征组合数量就一目了然了：</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 特征分组</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_com</span> = <span class="cm-variable">data_dropna</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸品牌'</span>,<span class="cm-string">'是否高孔'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'隔膜基材厚度'</span>,<span class="cm-string">'隔膜涂层厚度'</span>,<span class="cm-string">'单次放电容量'</span>,<span class="cm-string">'充电电流'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">'充电后搁置时间'</span>,<span class="cm-string">'放电后搁置时间'</span>,<span class="cm-string">'温度'</span>,<span class="cm-string">'特殊工步'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_com</span>.<span class="cm-property">count</span>()[<span class="cm-string">'2ex百分比'</span>].<span class="cm-property">sort_values</span>(<span class="cm-variable">ascending</span>=<span class="cm-keyword">False</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液</span> <span class="cm-variable">正极材料</span> <span class="cm-variable">负极材料</span> <span class="cm-variable">隔膜纸品牌</span> <span class="cm-variable">是否高孔</span> <span class="cm-variable">隔膜基材厚度</span> <span class="cm-variable">隔膜涂层厚度</span> <span class="cm-variable">单次放电容量</span> <span class="cm-variable">…………</span> &nbsp; &nbsp;<span class="cm-variable">温度</span> <span class="cm-variable">特殊工步</span> <span class="cm-variable">样本数量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">21.0</span> &nbsp;<span class="cm-number">4.0</span> &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">2.0</span> &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">9</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">40</span> &nbsp;<span class="cm-number">7.0</span> &nbsp; &nbsp; <span class="cm-number">28</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0.0</span> &nbsp; <span class="cm-number">4.0</span> &nbsp; <span class="cm-number">8</span> &nbsp; &nbsp; <span class="cm-number">2.0</span> &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">7</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">40</span> &nbsp;<span class="cm-number">7.0</span> &nbsp; &nbsp; <span class="cm-number">23</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">19.0</span> &nbsp;<span class="cm-number">4.0</span> &nbsp; <span class="cm-number">6</span> &nbsp; &nbsp; <span class="cm-number">3.0</span> &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; <span class="cm-number">7</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">40</span> &nbsp;<span class="cm-number">3.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">14.0</span> &nbsp;<span class="cm-number">4.0</span> &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">2.0</span> &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; <span class="cm-number">9</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">82</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1.6</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">40</span> &nbsp;<span class="cm-number">7.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-number">2</span><span class="cm-variable">ex百分比</span>, <span class="cm-variable">Length</span>: <span class="cm-number">318</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><p><span>从结果看，957个训练样本就有318种分组，平均每组特征组合的样本数量才3个，而实际上由于样本不均衡（有些特征组合样本数量多，比如生产工艺的特征组合；有些很少，比如只做过一次实验的样本组合）加剧了在很多叶节点的样本数量不足。</span><strong><span>综合这些因素就导致了单棵决策树的模型泛化能力差，精度自然就差</span></strong><span>。同时由于随机森林的每棵决策树所使用的样本是从这957样本里随机抽样的，不是所有样本都会拿去建模，样本数量自然更是小于957，</span><strong><span>这就加剧了样本数量不足导致的模型泛化能力不足的问题</span></strong><span>。</span></p><ol start='2' ><li><span>由于随机森林属于集成算法中的bagging算法，而bagging算法的投票机制（本案例为分类随机森林，即从森林中每棵决策树选取最优结果）是受到森林每棵树结果影响的，假设对于某类特征组合g，森林中每棵树都无法构建有效叶节点（特征组合的样本数量太少，比如只有1个），那么bagging投票的选择的结果也是无法反应这个特征组合的信息的，自然预测准确率也低。</span></li></ol><p><span>解决这种特征组合多而样本数量少的问题，有两个思路：</span><strong><span>1、</span><a href='特征选择'><span>特征选择</span></a><span>；2、扩充样本</span></strong><span>。这里就不详细讲了，有兴趣的可以查看下面的</span><a href='特征工程章节'><span>特征工程</span></a><span>章节。</span></p><p><span>针对第二个问题，即为什么模型采用分类数值编码会比采用独热编码的准确率提升不少?</span></p><ol start='' ><li><strong><span>其实原因在解答第一个问题的时候就已经提到了，分类数值编码不产生额外维度，独热编码会产生额外数据维度，即采用分类数值编码的特征组合数量要远远小于采用独热编码的特征组合数量，自然因为特征组合的样本数量不足导致的泛化能力较差的程度就比较轻。</span></strong></li><li><span>因为决策树采用</span><strong><span>信息熵、基尼系数</span></strong><span>等这些信息度量作为衡量不同分类间的指标，跟采用距离度量的算法（逻辑回归、支持向量机、神经网络……）不同，对于模型中特征数值是不需要进行归一化和标准化操作的，所以分类编码更适合（毕竟不用产生额外维度）。</span></li></ol><p><span>关于这个问题的详细解释，可以参见下面章节</span><a href='#OneHot编码缺点'><span>One-Hot编码缺点</span></a><span>。</span></p><p>&nbsp;</p><h2 id='42-异常检测'><span>4.2 异常检测</span></h2><h3 id='421-基本概念'><span>4.2.1 基本概念</span></h3><p><strong><span>定义</span></strong></p><ul><li><strong><span>异常检测</span></strong><span>（又称outlier detection、anomaly detection）是一种重要的数据挖掘方法，它可以找到与“主要数据分布”不同的异常值（deviant from the general data distribution），可以识别与正常数据不同的数据，与预期行为差异大的数据。比如从信用卡交易中找出诈骗案例，从正常的网络数据流中找出入侵，异常检测有着非常广泛的商业应用价值。同时它也被用于机器学习任务中的预处理（preprocessing），防止因为少量异常点存在而导致的训练或预测失败。对于项目所涉及到锂电池制造领域，</span><strong><span>异常检测可以用来对电池异常指标进行检测，比如寿命异常，容量异常等</span></strong><span>。</span></li></ul><p>&nbsp;</p><p><strong><span>分类</span></strong></p><p><span>异常检测在不同的语境下，可以分为两种：</span></p><ul><li><strong><span>离群点检测:</span></strong><span> 训练数据包含离群点,即远离其它内围点，此时的异常检测会拟合出训练数据中内围点聚集的区域，忽略有偏离的观测值。简单地说，就是从总体中寻找内部的异常值。</span></li><li><strong><span>新奇点检测:</span></strong><span> 训练数据未被离群点污染，此时的异常检测就是判断新观测值是否为异常点。简单地说，就是对总体外的数据是否在总体中属于异常点进行检测。</span></li></ul><p><span>离群点检测也被称之为</span><strong><span>无监督异常检测</span></strong><span>; 而新奇点检测被称之为</span><strong><span>半监督异常检测</span></strong><span>。</span></p><p><span>根据数据特征数量的多少又可以将异常检测区分为</span><strong><span>单变量（univariate）</span></strong><span>和</span><strong><span>多变量（multivariate）</span></strong><span>异常检测问题，但由于客观世界的复杂性，绝大多数情况下我们面对的都是多变量问题。</span></p><p><strong><span>应用</span></strong></p><ul><li><span>金融欺诈，如信用卡欺诈，信用评级等。</span></li><li><span>工业生产异常检测，比如本章节案例中对循环测试中电池容量异常的检测。</span></li><li><span>故障异常检测，如大规模设备节点中的异常检测。</span></li><li><span>网络流里的异常（网络入侵）。</span></li><li><span>医学病例的检测、筛选。</span></li></ul><p><span> 异常检测主要用于样本中少数类事件的检测，</span></p><p><strong><span>基本假设</span></strong></p><p><span>异常检测需要满足两个基本的假设：</span></p><ul><li><span>异常在整个数据集中发生频率是很小的，即异常样本不能是多数类，必须是少数类，不然就无法检测；</span></li><li><span>异常数据的特征显著区别于正常数据；</span></li></ul><p><strong><span>异常点来源</span></strong></p><p><span>异常值产生的具体原因有：</span></p><ul><li><strong><span>数据录入错误</span></strong><span>：数据采集过程中的录入错误，比如填写实验登记时将材料填错。</span></li><li><strong><span>测量错误</span></strong><span>：比如电芯测试柜的传感器异常。</span></li><li><strong><span>实验误差</span></strong><span>：比如电池测试环境温度由于空调故障造成的异常进而导致电池数据异常。</span></li><li><strong><span>有意的异常</span></strong><span>：在个别实验设计时，故意采用极端条件测试，如极低/高温、非常长的充放电搁置时间等。这样产生的数据对于同类条件实验不是异常值，但对于总体实验样本却是异常值。</span></li><li><strong><span>数据处理误差</span></strong><span>：如在数据导出阶段，由于不同实验数据的单位不一致却又放在同一单位量纲下进行比较，此时就会产生异常数据。</span></li><li><strong><span>自然异常（Natural Outlier）</span></strong><span>：这些离群点是真实的而不是由其他错误产生的。</span></li></ul><p><span>不管在什么情形下碰到异常值，理想的处理方法都是找到产生异常值的原因，异常值的处理方法也依赖于异常值产生的原因。异常值产生的原因可以分为两大类：</span></p><ol start='' ><li><strong><span>非自然条件的异常 / Non-Natural：</span></strong><span>在本例中，非自然产生的异常主要有：</span><mark><strong><span>数据录入异常、测量错误、实验误差等。这类异常会影响结论的正确性，所以必须在建模之前予以检测纠正</span></strong></mark><span>。</span></li><li><strong><span>自然产生的异常 / Natural：</span></strong><span>在本案例中，自然异常主要有：</span><b><mark><span>实验材料组合本身导致电池性能偏离正常值、实验参数的设置导致的电池性能偏离正常值。这类异常其实有利于实验设计的，研究这类异常产生的背后原因，掌握规律和丰富实验经验，并在以后的实验设计中加以运用。所以这类异常本身就是一种‘’好的异常‘’ 。</span></mark></b></li></ol><p>&nbsp;</p><p><strong><span>异常值的影响</span></strong></p><p><span>异常值会显著地改变数据分析和统计建模的结果</span></p><ul><li><span>增加了错误的误差，降低了统计检验的效果(power of statistical tests)</span></li><li><span>如果异常值不是随机分布的，会降低Normality</span></li><li><span>异常值会对数据集本身的性质产生影响</span></li><li><span>异常值会影响回归分析，ANOVA以及其他统计模型的基本假设</span></li></ul><p>&nbsp;</p><p><strong><span>异常检测任务分类</span></strong></p><p><strong><span>有监督</span></strong><span>：训练集的正例和反例均有标签。这种情况比较少，</span><strong><span>即已知正常数据分布、异常数据分布的情况下，去寻找异常</span></strong><span>。</span></p><p><strong><span>半监督</span></strong><span>：在训练集中只有单一类别（正常实例）的实例，没有异常实例参与训练，新奇点检测就是半监督检测，</span><strong><span>即已知正常数据分布、未知异常数据分布的情况下，去寻找异常。</span></strong></p><p><strong><span>无监督</span></strong><span>：很多情况下，异常检测都是无监督的，训练集无标签的，离群点检测就是无监督检测，</span><strong><span>即未知正常数据分布、未知异常数据分布的情况下，去寻找异常。</span></strong></p><p>&nbsp;</p><p><a id='异常检测分类'><strong><span>异常检测算法分类</span></strong></a></p><p><span>异常检测算法有很多种，按照算法思路大致可以分为以下四类：</span></p><ul><li><span>基于统计学的算法：例如之前相关分析运用</span><a href='#解释性分析'><span>相关系数</span></a><span>进行的异常检测，还有箱线图中的四分位法，质量控制里的3σ法、公差法等。</span></li><li><span>基于邻近度、密度的算法：k-NN（k近邻）算法、LOF（局部离群因子）算法等。</span></li><li><span>基于聚类的算法：基于集群（簇）的检测，如DBSCAN等聚类算法，以及LOF的优化算法。</span></li><li><span>基于分类的算法：如决策树，贝叶斯网络、Isolation Forest（孤立森林）等。</span></li></ul><div align="center">
    <img src="figure/异常检测算法分类.jpg" style="zoom:36%">
</div><p>&nbsp;</p><p>&nbsp;</p><h3 id='422-单变量异常检测'><span>4.2.2 单变量异常检测</span></h3><p><span>单变量异常检测是异常检测最为基本的一种应用，相比于多变量的异常检测，其实施难度、复杂度、成本花销都比较小，但在实际的工业领域却是应用比较多的一种检测。例如，流水线上电池端电压的异常检测，变量只有电压一个，只要设定好控制上下限，剩下的就可以交给机器自动完成测量判断。这种设置好质量控制限的检测属于有监督检测，相对来说，这方面的内容属于品质管控范畴，跟本文的语境含义不同。我们下面将要讨论的单变量异常检测属于无监督、半监督异常检测，即不知道异常分布而去寻找异常点的过程。</span><strong><span>因为异常分布未知（即异常具体定义未知），而不同算法对异常的定义不尽相同，异常理解也依赖于具体的实际问题（比如某低温电池的容量在同工艺下是正常值，但跟常温下的电池容量相比就是异常值），所以就会出现算法检测异常的结果出现差异分化。</span></strong><span>下面将以具体案例来进行讲解。</span></p><h4 id='4221-案例分析电池寿命异常检测'><span>4.2.2.1 案例分析：电池寿命异常检测</span></h4><p><span>在电池性能中，循环寿命是非常重要的一个指标。不同变量组合的电池，循环寿命也有着不一样的分布。</span><strong><span>那么设想一个业务场景：有一颗已知工艺参数和测试条件的电池，经过循环测试后的寿命也已知，那作为技术人员怎么判断这颗电池的循环寿命是不是异常值？</span></strong></p><p><span>憨厚的技术人员甲说：“那不简单，直接找出跟这块电池同样工艺、同样测试条件的电池寿命数据，比较一下不就知道了吗！”</span></p><p><span>呆萌的技术人员乙说：“那要怎么对比呢？样本数量要多少呢？判断标准又怎么定呢？”</span></p><p><span>甲：“ 样本数量就取手头跟这颗电池同样条件的电池数据，至于对比方法就采用3σ控制，如果这颗电池落入总样本的3σ控制限外，就判定是异常。”</span></p><p><span>乙：“ 可我们手头的数据之前都没有系统整理啊，况且实验数据那么多，单要找到跟这颗电池一样的条件的数据就要分不同的文件查找，可数据文件那么多，这得找多久啊？”</span></p><p><span>甲：“ 这.......&quot;</span></p><p><span>乙：”还有，怎么保证之前的数据是纯净的？也许，之前的数据里本来就有很多异常值，那计算出的3σ值肯定也不合理啊。“</span></p><p><span>甲：”这.......&quot;</span></p><p><span>上面的情景大家是否深有体会?其实，这里面涉及到异常检测的几个核心问题：</span><mark><strong><span>异常评判标准、检测成本（例子中寻找原始数据的时间成本、人力成本和计算成本）、结果可靠性。</span></strong></mark></p><p><span>接下来，我将会应用不同的算法（即异常评判标准）对</span><strong><span>LFP10370C2-200mAh电池进行循环寿命异常检测</span></strong><span>，并讨论各种算法的检测成本、可靠性等优缺点。</span></p><p><span>实验样本还是选取本项目收集到的电池数据样本。</span></p><h5 id='42211-基于特征重要性的数据分组'><span>4.2.2.1.1 基于特征重要性的数据分组</span></h5><p><span>显然，如果不分组而直接对数据中的循环寿命寻找异常值是不合适的，</span><strong><span>因为不同的材料组合、测试条件组合，电池的循环寿命存在显著的差异。</span></strong><span>比如拿0℃测试条件下的电池跟25℃电池的循环寿命组成一组来寻找异常值显然是不合适的，所以，在单变量的异常检测前还是要对数据进行分组。但如果将每个特征都作为分组依据，那将分出很多组样本数量很小的组合（就像</span><a href='#随机森立预测缺失值'><span>随机森立预测缺失值</span></a><span>章节中计算的样本组合数量那样，样本总数957，样本组合却有318种之多），这样单个组合的样本数量太少，样本的正态分布得不到保障，算法也会受个别异常点很大的影响，异常值检测显然是会有问题的。那怎么解决这个问题呢？其实也很简单，</span><strong><span>减少参与分组的特征数量，放宽分组标准</span></strong><span>。那要怎么保证减少分组数量的同时保障分组的合理性呢？</span><strong><span>其实这涉及到 </span><a href='#特征选择'><span>特征选择</span></a><span>中特征重要性的问题，举个例子，假设通过某些特定的算法计算出各个特征对于循环寿命的重要性分数和排名，如排名第一的是电解液，其特征重要性为0.05，而排名第十的是‘2ex百分比‘，数值为0.001，那么我们当然可以舍弃掉 ‘2ex百分比’这个特征，只取排名靠前的几个特征来做分组。因为这意味着对于电池的循环寿命而言，电解液对循环寿命的影响远高于 &#39;2ex百分比&#39;，’2ex百分比‘对循环寿命的影响是可以忽略的，即可以不参与分组</span></strong><span>（当然这只是随便的举例，实际情况不见得是如此）。好吧，那么正常的分组流程就要分生变化，具体如下：</span></p><p>&nbsp;</p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart2" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="181" style="max-width: 1188px; height: 221px;" viewBox="0 0 1188 181" class="md-require-zoom-fix"><style>#mermaidChart2{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart2 .error-icon{fill:#552222;}#mermaidChart2 .error-text{fill:#552222;stroke:#552222;}#mermaidChart2 .edge-thickness-normal{stroke-width:2px;}#mermaidChart2 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart2 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart2 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart2 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart2 .marker{fill:#333333;}#mermaidChart2 .marker.cross{stroke:#333333;}#mermaidChart2 svg{font-family:sans-serif;font-size:16px;}#mermaidChart2 .label{font-family:sans-serif;color:#333;}#mermaidChart2 .label text{fill:#333;}#mermaidChart2 .node rect,#mermaidChart2 .node circle,#mermaidChart2 .node ellipse,#mermaidChart2 .node polygon,#mermaidChart2 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart2 .node .label{text-align:center;}#mermaidChart2 .node.clickable{cursor:pointer;}#mermaidChart2 .arrowheadPath{fill:#333333;}#mermaidChart2 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart2 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart2 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart2 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart2 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart2 .cluster text{fill:#333;}#mermaidChart2 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart2:root{--mermaid-font-family:sans-serif;}#mermaidChart2:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart2 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-AA" id="L-A-AA" style="opacity: 1;"><path class="path" d="M92,103L117,103L142,103" marker-end="url(#arrowhead138)" style="fill:none"></path><defs><marker id="arrowhead138" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-AA LE-B" id="L-AA-B" style="opacity: 1;"><path class="path" d="M194,103L219,103L244,103" marker-end="url(#arrowhead139)" style="fill:none"></path><defs><marker id="arrowhead139" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M344,84.87022900763358L425,55.5L506,55.5" marker-end="url(#arrowhead140)" style="fill:none"></path><defs><marker id="arrowhead140" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-D" id="L-B-D" style="opacity: 1;"><path class="path" d="M344,121.12977099236642L425,150.5L506,150.5" marker-end="url(#arrowhead141)" style="fill:none"></path><defs><marker id="arrowhead141" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-E" id="L-C-E" style="opacity: 1;"><path class="path" d="M590,66.72137404580153L679,90.5L774,90.5" marker-end="url(#arrowhead142)" style="fill:none"></path><defs><marker id="arrowhead142" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-F" id="L-C-F" style="opacity: 1;"><path class="path" d="M590,44.278625954198475L679,20.5L840,20.5L937,20.5L962,33.559701492537314" marker-end="url(#arrowhead143)" style="fill:none"></path><defs><marker id="arrowhead143" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;"><path class="path" d="M906,90.5L937,90.5L962,77.44029850746269" marker-end="url(#arrowhead144)" style="fill:none"></path><defs><marker id="arrowhead144" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-H" id="L-F-H" style="opacity: 1;"><path class="path" d="M1046,55.5L1071,55.5L1096,55.5" marker-end="url(#arrowhead145)" style="fill:none"></path><defs><marker id="arrowhead145" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(425,55.5)" style="opacity: 1;"><g transform="translate(-48,-12.5)" class="label"><rect rx="0" ry="0" width="96" height="25"></rect><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>符合设定阈值</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(425,150.5)" style="opacity: 1;"><g transform="translate(-56,-12.5)" class="label"><rect rx="0" ry="0" width="112" height="25"></rect><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>不符合设定阈值</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(679,90.5)" style="opacity: 1;"><g transform="translate(-64,-12.5)" class="label"><rect rx="0" ry="0" width="128" height="25"></rect><foreignObject width="128" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>含有连续数值特征</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(840,20.5)" style="opacity: 1;"><g transform="translate(-72,-12.5)" class="label"><rect rx="0" ry="0" width="144" height="25"></rect><foreignObject width="144" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>未含有连续数值特征</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-82" transform="translate(50,103)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">选择模型</div></foreignObject></g></g></g><g class="node default" id="flowchart-AA-83" transform="translate(168,103)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">建模</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-84" transform="translate(294,103)" style="opacity: 1;"><rect rx="0" ry="0" x="-50" y="-22.5" width="100" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-40,-12.5)"><foreignObject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">特征重要性</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-86" transform="translate(548,55.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">保留特征</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-88" transform="translate(548,150.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">剔除特征</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-90" transform="translate(840,90.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">连续变量离散化</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-92" transform="translate(1004,55.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据分组</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-96" transform="translate(1138,55.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">异常检测</div></foreignObject></g></g></g></g></g></g></svg></div><p><strong><span>step1：选择模型</span></strong></p><p><span>因为本案例特征中分类特征占据主要部分，如果采用距离度量的算法，就要对这些变量进行独热编码处理，会额外增加非常多的特征维度，跟我们减少分组特征数量的想法相背离。那比较好的选择就是采用信息度量的模型，比如决策树、随机森林等。简单起见，就选用</span><strong><span>决策树模型</span></strong><span>。</span></p><p><strong><span>step2：建模，筛选特征</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 对特征进行分类数值编码</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">oe</span>=<span class="cm-variable">OrdinalEncoder</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,<span class="cm-string">'特殊工步'</span>]]=<span class="cm-variable">oe</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,<span class="cm-string">'特殊工步'</span>]])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>.<span class="cm-property">dropna</span>(<span class="cm-variable">subset</span>=[<span class="cm-string">'循环寿命'</span>],<span class="cm-variable">inplace</span>=<span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分割训练集和测试集，建立决策树模型</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">xtrain</span>,<span class="cm-variable">xtest</span>,<span class="cm-variable">ytrain</span>,<span class="cm-variable">ytest</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[:,:<span class="cm-operator">-</span><span class="cm-number">1</span>],<span class="cm-variable">data</span>.<span class="cm-property">iloc</span>[:,<span class="cm-operator">-</span><span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgr</span>=<span class="cm-variable">tree</span>.<span class="cm-property">DecisionTreeRegressor</span>(<span class="cm-variable">random_state</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgr</span>.<span class="cm-property">fit</span>(<span class="cm-variable">xtrain</span>,<span class="cm-variable">ytrain</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">score</span>=<span class="cm-variable">rgr</span>.<span class="cm-property">score</span>(<span class="cm-variable">xtest</span>,<span class="cm-variable">ytest</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 得到模型评分结果score（score值是线性回归的R平方值）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">0.8947158295271704</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 得到特征重要性并排名</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lis</span>=[<span class="cm-operator">*</span><span class="cm-builtin">zip</span>(<span class="cm-variable">data</span>.<span class="cm-property">columns</span>[:<span class="cm-operator">-</span><span class="cm-number">1</span>],<span class="cm-variable">rgr</span>.<span class="cm-property">feature_importances_</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">ord</span>=<span class="cm-builtin">sorted</span>(<span class="cm-variable">lis</span>,<span class="cm-variable">key</span>=<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>:<span class="cm-variable">x</span>[<span class="cm-number">1</span>],<span class="cm-variable">reverse</span>=<span class="cm-keyword">True</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[(<span class="cm-string">'首次容量'</span>, <span class="cm-number">0.5623051353837523</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'正极材料'</span>, <span class="cm-number">0.12030717548570205</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'负极材料'</span>, <span class="cm-number">0.09486085366562567</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'隔膜纸'</span>, <span class="cm-number">0.0634849784159944</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'充电后搁置时间'</span>, <span class="cm-number">0.04970072998117188</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'电解液'</span>, <span class="cm-number">0.03304229819548782</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'温度'</span>, <span class="cm-number">0.02778732238543841</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'分容容量'</span>, <span class="cm-number">0.01780163249194731</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'特殊工步'</span>, <span class="cm-number">0.013558709492314637</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'放电后搁置时间'</span>, <span class="cm-number">0.007418026867104696</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'2ex百分比'</span>, <span class="cm-number">0.004639405776731557</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'充电电流'</span>, <span class="cm-number">0.0029060595477287277</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'单次放电容量'</span>, <span class="cm-number">0.002187672311000505</span>)]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 644px;"></div><div class="CodeMirror-gutters" style="display: none; height: 644px;"></div></div></div></pre><p><b><mark><span>从结果上看，首次容量特征对循环寿命的影响对于最为明显，而正极材料、负极材料、隔膜纸、充电后搁置时间、电解液、温度……的影响则逐渐降低。</span></mark></b><span>同样的，为保障结果可靠，我们可以对参数进行网格搜索：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 网格搜索</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">parameters</span> = {<span class="cm-string">'splitter'</span>:(<span class="cm-string">'best'</span>,<span class="cm-string">'random'</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ,<span class="cm-string">"max_depth"</span>:[<span class="cm-operator">*</span><span class="cm-builtin">range</span>(<span class="cm-number">1</span>,<span class="cm-number">10</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ,<span class="cm-string">'min_samples_leaf'</span>:[<span class="cm-operator">*</span><span class="cm-builtin">range</span>(<span class="cm-number">1</span>,<span class="cm-number">50</span>,<span class="cm-number">5</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ,<span class="cm-string">'min_impurity_decrease'</span>:[<span class="cm-operator">*</span><span class="cm-variable">np</span>.<span class="cm-property">linspace</span>(<span class="cm-number">0</span>,<span class="cm-number">0.5</span>,<span class="cm-number">5</span>)] </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgr</span>=<span class="cm-variable">tree</span>.<span class="cm-property">DecisionTreeRegressor</span>(<span class="cm-variable">random_state</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgrcv</span>=<span class="cm-variable">GridSearchCV</span>(<span class="cm-variable">rgr</span>,<span class="cm-variable">parameters</span>,<span class="cm-variable">cv</span>=<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgrcv</span>.<span class="cm-property">fit</span>(<span class="cm-variable">xtrain</span>,<span class="cm-variable">ytrain</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgrcv</span>.<span class="cm-property">best_params_</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgrcv</span>.<span class="cm-property">best_score_</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgrbest</span>=<span class="cm-variable">rgrcv</span>.<span class="cm-property">best_estimator_</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rgrbest</span>.<span class="cm-property">fit</span>(<span class="cm-variable">xtrain</span>,<span class="cm-variable">ytrain</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">scorebest</span>=<span class="cm-variable">rgrbest</span>.<span class="cm-property">score</span>(<span class="cm-variable">xtest</span>,<span class="cm-variable">ytest</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 得到特征重要性并排名</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[(<span class="cm-string">'首次容量'</span>, <span class="cm-number">0.5879855070135457</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'正极材料'</span>, <span class="cm-number">0.12748124892307872</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'负极材料'</span>, <span class="cm-number">0.09392744921577624</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'隔膜纸'</span>, <span class="cm-number">0.06642474453720043</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'充电后搁置时间'</span>, <span class="cm-number">0.052731286009161854</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'温度'</span>, <span class="cm-number">0.02447788107558011</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'电解液'</span>, <span class="cm-number">0.014121847120938686</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'特殊工步'</span>, <span class="cm-number">0.013552396524402613</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'放电后搁置时间'</span>, <span class="cm-number">0.008033643216860653</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'分容容量'</span>, <span class="cm-number">0.00603617034685985</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'充电电流'</span>, <span class="cm-number">0.003019728382045844</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'2ex百分比'</span>, <span class="cm-number">0.0022080976345494126</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> (<span class="cm-string">'单次放电容量'</span>, <span class="cm-number">0.0</span>)]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 644px;"></div><div class="CodeMirror-gutters" style="display: none; height: 644px;"></div></div></div></pre><p><span>得到的结果与未调参前的模型结果几乎一致，特征重要性排名也是类似（仅仅只是温度和电解液调换了位置）。</span><b><mark><span>那么就说明，对于电池的循环寿命，首次容量、正极材料、负极材料、隔膜纸、充电后搁置时间、电解液、温度确实是最为重要的影响特征。</span></mark></b><span>下面的特征重要性动态漏斗图更为直观地展现出特征重要性的相对大小和排名，可以点击具体特征查看特征重要性数值。</span></p><p>&nbsp;</p><iframe src="pyecharts/特征重要性排名1.html" height="450"></iframe><p><strong><span>step3：数据分组</span></strong></p><p><span>为了保障数据分组后的合理性，也同时保障数据分组后的各组数据不至于太少。我们就选择前7个重要特征作为分组依据，又因为首次容量为连续性变量无法参与分组，必须对其进行离散化操作，选择对其进行分箱处理，则分组过程如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 数据解码</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,<span class="cm-string">'特殊工步'</span>]]=<span class="cm-variable">oe</span>.<span class="cm-property">inverse_transform</span>(<span class="cm-variable">data</span>[[<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,<span class="cm-string">'特殊工步'</span>]])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 首次容量特征分箱，采用等宽分箱，分为3箱</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">X</span> = <span class="cm-variable">data</span>[<span class="cm-string">'首次容量'</span>].<span class="cm-property">values</span>.<span class="cm-property">reshape</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>,<span class="cm-number">1</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">kbd</span> = <span class="cm-variable">KBinsDiscretizer</span>(<span class="cm-variable">n_bins</span>=<span class="cm-number">3</span>, <span class="cm-variable">encode</span>=<span class="cm-string">'ordinal'</span>, <span class="cm-variable">strategy</span>=<span class="cm-string">'uniform'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_kbd</span>= <span class="cm-variable">data</span>.<span class="cm-property">copy</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_kbd</span>[<span class="cm-string">'首次容量'</span>]=<span class="cm-variable">kbd</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">X</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_kbd</span>[<span class="cm-string">'首次容量'</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 数据分组</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_com</span> = <span class="cm-variable">data_kbd</span>.<span class="cm-property">groupby</span>([<span class="cm-string">'电解液'</span>,<span class="cm-string">'正极材料'</span>,<span class="cm-string">'负极材料'</span>,<span class="cm-string">'隔膜纸'</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">'充电后搁置时间'</span>,<span class="cm-string">'温度'</span>,<span class="cm-string">'首次容量'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">grouped_com</span>.<span class="cm-property">count</span>()[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">sort_values</span>(<span class="cm-variable">ascending</span>=<span class="cm-keyword">False</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分组结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">正极材料</span> &nbsp;<span class="cm-variable">负极材料</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">隔膜纸</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">电后搁置时间</span> &nbsp; &nbsp;<span class="cm-variable">温度</span> <span class="cm-variable">首次容量</span> &nbsp;<span class="cm-variable">样本数量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">7.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">40</span> &nbsp;<span class="cm-number">2.0</span> &nbsp; &nbsp; <span class="cm-number">39</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">7.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">25</span> &nbsp;<span class="cm-number">2.0</span> &nbsp; &nbsp; <span class="cm-number">37</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">7.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">25</span> &nbsp;<span class="cm-number">2.0</span> &nbsp; &nbsp; <span class="cm-number">27</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-property">SS</span><span class="cm-operator">-</span><span class="cm-variable">ZZWB083</span> &nbsp;<span class="cm-variable">P2S</span> &nbsp; <span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">W</span><span class="cm-operator">-</span><span class="cm-variable">SCOPE高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">32.75</span> &nbsp; <span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">25</span> &nbsp;<span class="cm-number">2.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">ZH</span><span class="cm-operator">-</span><span class="cm-variable">T7H</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">日本东丽DGI</span>(<span class="cm-number">7</span><span class="cm-operator">+</span><span class="cm-number">2</span>)<span class="cm-operator">*</span><span class="cm-number">32.75</span> &nbsp; &nbsp;<span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">40</span> &nbsp;<span class="cm-number">1.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SS</span><span class="cm-operator">-</span><span class="cm-variable">ZZWB086</span> &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">恩捷高孔9</span><span class="cm-operator">*</span><span class="cm-number">32.5</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0.5</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">25</span> &nbsp;<span class="cm-number">1.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Name</span>: <span class="cm-variable">循环寿命</span>, <span class="cm-variable">Length</span>: <span class="cm-number">500</span>, <span class="cm-variable">dtype</span>: <span class="cm-variable">int64</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 506px;"></div><div class="CodeMirror-gutters" style="display: none; height: 506px;"></div></div></div></pre><p><span>通过上面的操作，我们就得到了关于循环寿命的各组电池样本，接下来我们就要使用不同方法检测样本中的异常值。</span></p><p>&nbsp;</p><h5 id='42211-基于统计学的算法'><span>4.2.2.1.1 基于统计学的算法</span></h5><p><span>统计学方法对数据的正常性做出假定。它们假定正常的数据对象由一个统计模型产生，而不遵守该模型的数据是异常点。</span><strong><span>统计学方法的有效性高度依赖于对给定数据所做的统计模型假定是否成立</span></strong><span>。</span></p><h6 id='422111-3σ原则'><span>4.2.2.1.1.1 3σ原则</span></h6><p><span>若数据存在正态分布，在 3σ原则下，异常值为一组测定值中与平均值的偏差超过3倍标准差的值。如果数据服从正态分布，距离平均值3σ之外的值出现的概率为P(|x - μ| &gt; 3σ) &lt; 0.003，属于极个别的小概率事件，即判定其为异常值。</span></p><div align="center">
    <img src="pic/3σ.png" style="zoom:60%">
</div><p><span>了解了3σ原则的内容，下面就开始对异常值进行检测。上一小节</span><a hrfe='#基于特征重要性的数据分组'><span>基于特征重要性的数据分组</span></a><span>中我们已经对循环寿命进行了数据分组工作，接下来我们就以分组结果中样本数量最多的一组进行3σ法的异常值检测，具体过程如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分组名称和样本数量</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液</span> &nbsp; &nbsp; <span class="cm-variable">正极材料</span> &nbsp;<span class="cm-variable">负极材料</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">隔膜纸</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">电后搁置时间</span> &nbsp; &nbsp; <span class="cm-variable">温度</span> &nbsp;<span class="cm-variable">首次容量</span> &nbsp;<span class="cm-variable">样本数量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span> &nbsp;<span class="cm-variable">P2</span> &nbsp; &nbsp;<span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">7.0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">40</span> &nbsp;<span class="cm-number">2.0</span> &nbsp; &nbsp; <span class="cm-number">39</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># (源码省略）查看结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[[<span class="cm-string">'循环寿命'</span>,<span class="cm-string">'3σ'</span>,<span class="cm-string">'μ'</span>,<span class="cm-string">'μ-3σ'</span>,<span class="cm-string">'u+3σ'</span>,<span class="cm-string">'是否异常值'</span>]]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">循环寿命</span> &nbsp;<span class="cm-number">3</span><span class="cm-variable">σ</span><span class="cm-tab" role="presentation" cm-text="	">    </span> &nbsp; <span class="cm-variable">μ</span><span class="cm-tab" role="presentation" cm-text="	">    </span> &nbsp;<span class="cm-variable">μ</span><span class="cm-operator">-</span><span class="cm-number">3</span><span class="cm-variable">σ</span><span class="cm-tab" role="presentation" cm-text="	">  </span> &nbsp;<span class="cm-variable">u</span><span class="cm-operator">+</span><span class="cm-number">3</span><span class="cm-variable">σ</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">是否异常值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">340</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9934.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">3714</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10239</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">6525</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">13953</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">341</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10459.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3714</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10239</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">6525</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">13953</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">342</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">11153.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3714</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10239</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">6525</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">13953</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">343</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10124.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3714</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10239</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">6525</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">13953</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">344</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10166.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3714</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10239</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">6525</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">13953</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">378</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12286.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3714</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10239</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">6525</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">13953</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">379</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">11551.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">3714</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">10239</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">6525</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">13953</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-keyword">False</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 368px;"></div></div></div></pre><p><span>从代码得到的结果（篇幅太长，没有显示完全），</span><strong><span>没有发现异常值</span></strong><span>。但实际得到的3σ（3倍标准差）达3714，判断区间为 [ 6525，13925] ，这么大的标准差是不是数据分布出现异常呢？可以结合图像来看:</span></p><p>&nbsp;</p><div align="center">
    <img src="figure/循环寿命2.png" ,height="400">
</div><p><span>从图像上，我们发现数据在空间内呈现一定的正态分布，但明显其中最小值距离分布聚集中心较远。根据标准差计算公式:</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1138" cid="n1138" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="7.798ex" viewBox="0 -1940.8 59683.7 3357.6" role="img" focusable="false" style="vertical-align: -3.291ex; max-width: 100%;"><defs><path stroke-width="0" id="E13-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E13-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E13-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E13-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E13-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E13-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path><path stroke-width="0" id="E13-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E13-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E13-MJMATHI-4E" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path stroke-width="0" id="E13-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E13-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E13-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E13-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E13-MJMAIN-AF" d="M69 544V590H430V544H69Z"></path><path stroke-width="0" id="E13-MJSZ4-E001" d="M702 589Q706 601 718 605H1061Q1076 597 1076 585Q1076 572 1061 565H742V0Q734 -14 724 -14H722H720Q708 -14 702 0V589Z"></path><path stroke-width="0" id="E13-MJSZ4-23B7" d="M742 -871Q740 -873 737 -876T733 -880T730 -882T724 -884T714 -885H702L222 569L180 484Q138 399 137 399Q131 404 124 412L111 425L265 736L702 -586V168L703 922Q713 935 722 935Q734 935 742 920V-871Z"></path><path stroke-width="0" id="E13-MJSZ4-E000" d="M722 -14H720Q708 -14 702 0V306L703 612Q713 625 722 625Q734 625 742 610V0Q734 -14 724 -14H722Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-4.2" transform="translate(0,-163)"><use xlink:href="#E13-MJMAIN-28"></use><use xlink:href="#E13-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E13-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E13-MJMAIN-32" x="1167" y="0"></use><use xlink:href="#E13-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(25134,0)"><g transform="translate(-15,0)"><g transform="translate(0,-163)"><use xlink:href="#E13-MJMATHI-3C3" x="0" y="0"></use><use xlink:href="#E13-MJMAIN-3D" x="849" y="0"></use><g transform="translate(1905,0)"><g transform="translate(0,1960)"><use xlink:href="#E13-MJSZ4-E001" x="0" y="-605"></use><g transform="translate(0,-1368.0705422669257) scale(1,1.2785128676270812)"><use xlink:href="#E13-MJSZ4-E000"></use></g><use xlink:href="#E13-MJSZ4-23B7" x="0" y="-2271"></use></g><rect stroke="none" width="6800" height="60" x="1056" y="1900"></rect><g transform="translate(1056,0)"><g transform="translate(120,0)"><rect stroke="none" width="1008" height="60" x="0" y="220"></rect><use xlink:href="#E13-MJMAIN-31" x="254" y="676"></use><use xlink:href="#E13-MJMATHI-4E" x="60" y="-686"></use></g><g transform="translate(1414,0)"><use xlink:href="#E13-MJSZ2-2211" x="0" y="0"></use><g transform="translate(148,-1088)"><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-31" x="1123" y="0"></use></g><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-4E" x="577" y="1626"></use></g><use xlink:href="#E13-MJMAIN-28" x="2858" y="0"></use><g transform="translate(3247,0)"><use xlink:href="#E13-MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMATHI-69" x="808" y="-213"></use></g><use xlink:href="#E13-MJMAIN-2212" x="4385" y="0"></use><g transform="translate(5386,0)"><use xlink:href="#E13-MJMATHI-78" x="0" y="0"></use><use xlink:href="#E13-MJMAIN-AF" x="63" y="-24"></use></g><g transform="translate(5958,0)"><use xlink:href="#E13-MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E13-MJMAIN-32" x="550" y="583"></use></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-13">\sigma=\sqrt{\frac{1}{N}\sum_{i=1}^{N}(x_i-\bar{x})^2}\tag{4.2}</script></div></div><p><span>由公式可知，σ值是受各点的离差平方和影响的，如果有某些值（异常点）的离差平方和过大或过小，是很容易造成σ值得偏大或偏小的。在该案例中，</span><strong><span>明显数据中的最小值远离分布聚集位置，离差平方和肯定远大于其它值。但又因为σ值也随之变大，|u±3σ|的区间范围变大，最终导致最小值没有落在|u±3σ|区间之外，无法被判定为异常点</span></strong><span>。这其实是3σ法判定异常值一个最大缺陷，即：</span><b><mark><span>异常值判定区间容易受到异常值干扰</span></mark></b><span>。</span></p><p><span>为了验证样本中的最小值是否为异常值，我们可以寻找与其相同工艺的电池进行对比：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 找出与最小值工艺完全一致的分组</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">index_tar</span>=<span class="cm-variable">data_tar</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=<span class="cm-string">'循环寿命'</span>).<span class="cm-property">iloc</span>[<span class="cm-number">0</span>].<span class="cm-property">index</span>[:<span class="cm-number">11</span>].<span class="cm-property">to_list</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">values_tar</span>=<span class="cm-variable">data_tar</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=<span class="cm-string">'循环寿命'</span>).<span class="cm-property">iloc</span>[<span class="cm-number">0</span>].<span class="cm-property">values</span>[:<span class="cm-number">11</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">values_tar</span>=<span class="cm-builtin">tuple</span>(<span class="cm-variable">values_tar</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">index_tar</span>,<span class="cm-variable">values_tar</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group</span>=<span class="cm-variable">data_kbd</span>.<span class="cm-property">groupby</span>(<span class="cm-variable">index_tar</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_min</span>=<span class="cm-variable">group</span>.<span class="cm-property">get_group</span>(<span class="cm-variable">values_tar</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">电解液</span><span class="cm-operator">|</span><span class="cm-variable">正极</span><span class="cm-operator">|</span><span class="cm-variable">负极</span><span class="cm-operator">|</span><span class="cm-variable">隔膜</span><span class="cm-operator">|</span><span class="cm-number">2</span><span class="cm-variable">ex百分比</span><span class="cm-operator">|</span><span class="cm-variable">单次放电容量</span><span class="cm-operator">|</span><span class="cm-variable">充电电流</span><span class="cm-operator">|</span><span class="cm-variable">充电后搁置时间</span><span class="cm-operator">|</span><span class="cm-variable">放电后搁置时间</span><span class="cm-operator">|</span><span class="cm-variable">温度</span><span class="cm-operator">|</span><span class="cm-variable">特殊工步</span><span class="cm-operator">|</span><span class="cm-variable">循环寿命</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">356</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">P2</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">1.05</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">82</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">0.8</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">40</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">无</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">8170.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">357</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">P2</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">1.05</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">82</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">0.8</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">40</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">无</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">7162.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">358</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">P2</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">1.05</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">82</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">0.8</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">40</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">无</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">8107.0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">359</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">TC</span><span class="cm-operator">-</span><span class="cm-variable">E269</span><span class="cm-operator">-</span><span class="cm-variable">F4</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">P2</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">CP5</span><span class="cm-operator">-</span><span class="cm-variable">H</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">恩捷高孔</span>(<span class="cm-number">9</span><span class="cm-operator">+</span><span class="cm-number">3</span>)<span class="cm-operator">*</span><span class="cm-number">33</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">1.05</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">82</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">0.8</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">40</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">无</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">8653.0</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 299px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><p><span>从数据中找出跟寿命最小值电池工艺完全一致的其它3个电池，从循环寿命值看其它3个值均大于8000,而最小值与它们相差巨大。这其实</span><mark><strong><span>证明了最小值是异常值的结论，3σ法在本案例中无法找出异常值。</span></strong></mark></p><p><span>从上面的分析中，我们对3σ法用于异常检测有了直观的感受，对于3σ法，有下特点：</span></p><ul><li><mark><strong><span>算法简单，检测成本低（只需计算标准差σ，和判断区间即可）</span></strong></mark></li><li><mark><strong><span>算法检测精度低，判断区间容易受异常极值影响，缺乏鲁棒性</span></strong></mark></li></ul><p>&nbsp;</p><h6 id='422112-四分位法箱线图分析法）'><span>4.2.2.1.1.2 四分位法（箱线图分析法）</span></h6><p><span>箱线图提供了识别异常值的一个标准：如果一个值小于 Q1-1.5IQR 或大于 Q3+1.5IQR 的值，则被称为异常值。</span>
<span>Q1 为下四分位数，表示全部观察值中有四分之一的数据取值比它小；</span>
<span>Q3 为上四分位数，表示全部观察值中有四分之一的数据取值比它大；</span>
<span>IQR 为四分位数间距，是上四分位数 Q1 与下四分位数 Q3 的差值，包含了全部观察值的一半。</span>
<span>箱型图判断异常值的方法以四分位数和四分位距为基础。</span></p><div align="center">
    <img src="figure/四分位法.png" style="zoom:85%">
</div><p><span>本案例计算过程和结果如下：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算统计量</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'中位数'</span>] = <span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">median</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'Q1'</span>] = <span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">quantile</span>(<span class="cm-variable">q</span>=<span class="cm-number">0.25</span>,<span class="cm-variable">interpolation</span>=<span class="cm-string">'nearest'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'Q3'</span>] = <span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">quantile</span>(<span class="cm-variable">q</span>=<span class="cm-number">0.75</span>,<span class="cm-variable">interpolation</span>=<span class="cm-string">'nearest'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'Q1-1.5IQR'</span>]=<span class="cm-variable">data_tar</span>[<span class="cm-string">'Q1'</span>] <span class="cm-operator">-</span> <span class="cm-number">1.5</span> <span class="cm-operator">*</span> (<span class="cm-variable">data_tar</span>[<span class="cm-string">'Q3'</span>]<span class="cm-operator">-</span><span class="cm-variable">data_tar</span>[<span class="cm-string">'Q1'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'Q3+1.5IQR'</span>]=<span class="cm-variable">data_tar</span>[<span class="cm-string">'Q3'</span>] <span class="cm-operator">+</span> <span class="cm-number">1.5</span> <span class="cm-operator">*</span> (<span class="cm-variable">data_tar</span>[<span class="cm-string">'Q3'</span>]<span class="cm-operator">-</span><span class="cm-variable">data_tar</span>[<span class="cm-string">'Q1'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'是否异常值'</span>] = (<span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>] &nbsp;<span class="cm-operator">&lt;</span> <span class="cm-variable">data_tar</span>[<span class="cm-string">'Q1-1.5IQR'</span>]) <span class="cm-operator">|</span> (<span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>] <span class="cm-operator">&gt;</span> <span class="cm-variable">data_tar</span>[<span class="cm-string">'Q3+1.5IQR'</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">循环寿命</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">Q1</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">Q3</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-variable">Q1</span><span class="cm-operator">-</span><span class="cm-number">1.5</span><span class="cm-variable">IQR</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">Q3</span><span class="cm-operator">+</span><span class="cm-number">1.5</span><span class="cm-variable">IQR</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是否异常值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">340</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9934.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">9388.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">10963.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7025.5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">13325.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">341</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10459.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9388.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">10963.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7025.5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">13325.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">342</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">11153.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9388.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">10963.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7025.5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">13325.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">343</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10124.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9388.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">10963.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7025.5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">13325.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">378</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12286.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9388.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">10963.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7025.5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">13325.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-keyword">False</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">379</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">11551.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">9388.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">10963.0</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7025.5</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">13325.5</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-keyword">False</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 391px;"></div><div class="CodeMirror-gutters" style="display: none; height: 391px;"></div></div></div></pre><p><span>遗憾的是，通过四分位法仍然无法锁定最小值这个差异点，但</span><mark><strong><span>判断区间 [ 7025.5，13325.5 ]相比于3σ法的 [6525，13925 ]  已经有了一定的收缩，即异常值判断区间有了一定的延展，捕捉异常值的能力有了一定的提高。</span></strong></mark><span>下面的箱线图、分布图也很好地展示了3σ法判断区间和四分卫法判断区间的差异：</span></p><div align="center">
    <img src="figure/循环寿命3.png" style="zoom:80%">
</div><p>&nbsp;</p><p><span>从上面的分析中，可以总结出四分位法的特点：</span></p><ul><li><mark><strong><span>跟3σ一样，算法简单，检测成本低（只需计算标准差σ，下四分位数Q1，上四分位数Q3）</span></strong></mark></li><li><mark><strong><span>算法检测精度较3σ法有了一定的提升，四分位数具有鲁棒性：25%的数据可以变得任意远并且不会干扰四分位数，所以异常值不能对这个标准施加影响。因此箱型图识别异常值比较客观，在识别异常值时有一定的优越性。</span></strong></mark></li><li><mark><strong><span>对于离群点异常的检测精度不是很高。</span></strong></mark></li></ul><p>&nbsp;</p><h5 id='42212-基于孤立森林的异常检测'><span>4.2.2.1.2 基于孤立森林的异常检测</span></h5><p><strong><span>孤立森林（Isolation Forest)</span></strong><span>是南京大学周志华教授等人在2008年在第八届IEEE数据挖掘国际会议上提出的一个异常检测算法，在工业界很实用，算法效果好，时间效率高，能有效处理高维数据和海量数据。在孤立森林中，异常被定义为“容易被孤立的离群点 (more likely to be separated)”，可以将其理解为分布稀疏且离密度高的群体较远的点。 在特征空间里，分布稀疏的区域表示事件发生在该区域的概率很低，因而可以认为落在这些区域里的数据是异常的。孤立森林是一种适用于连续数据(Continuous numerical data)的无监督异常检测方法，即不需要有标记的样本来训练，但特征需要是连续的。于如何查找哪些点容易被孤立(isolated)，iForest使用了一套非常高效的策略。在孤立森林中，递归地随机分割数据集，直到所有的样本点都是孤立的。在这种随机分割的策略下，异常点通常具有较短的路径。直观上来讲，</span><strong><span>那些密度很高的簇是需要被切很多次才能被孤立，但是那些密度很低的点很容易就可以被孤立。</span></strong></p><p><span>理论上，孤立森林在</span><strong><span>样本量比较大，特征维度高</span></strong><span>的异常检测中效果会更好，但是鉴于本案例只是作为演示案例，不作过多要求。</span></p><p><span>定义：假设T是孤立树的一个节点，它要么是没有子节点的叶子节点，要么是只有两个子节点(T</span><sub><span>l</span></sub><span>，T</span><sub><span>r</span></sub><span>)的内部节点。每一步分割，都包含特征q和分割值p，将q&lt;p的数据分到T</span><sub><span>l</span></sub><span>，将q≥p的数据分到T</span><sub><span>r</span></sub><span>。</span></p><p><span>给定n个样本数据X={x</span><sub><span>1</span></sub><span>,⋯,x</span><sub><span>n</span></sub><span>}，特征的维度为d。为了构建一棵孤立树，需要随机选择一个特征q及其分割值p，递归地分割数据集X，直到满足以下任意一个条件：(1)树达到了限制的高度；(2)节点上只有一个样本；(3)节点上的样本所有特征都相同。</span>
<a href='https://blog.csdn.net/extremebingo/article/details/80108247'><span>可点击链接查看详细解释</span></a></p><ul><li><span>检测流程</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 定义异常</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rng</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">RandomState</span>(<span class="cm-number">0</span>) <span class="cm-comment"># 定义随机状态</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">outliers_fraction</span> = <span class="cm-number">0.02</span> <span class="cm-comment"># 定义异常比例</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">xtrain</span> = <span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">to_numpy</span>().<span class="cm-property">reshape</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 构造模型并拟合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clf</span> = <span class="cm-variable">IsolationForest</span>(<span class="cm-variable">random_state</span>=<span class="cm-variable">rng</span>, <span class="cm-variable">contamination</span>=<span class="cm-variable">outliers_fraction</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">xtrain</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>]=<span class="cm-variable">clf</span>.<span class="cm-property">predict</span>(<span class="cm-variable">xtrain</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">scores_pred</span> = <span class="cm-variable">clf</span>.<span class="cm-property">decision_function</span>(<span class="cm-variable">xtrain</span>) <span class="cm-comment"># 返回未知数据上的异常程度 (负值绝对值越大越异常，正值越小越异常)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 预测结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">循环寿命</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">异常预测值</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是否异常</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">357</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7162</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-operator">-</span><span class="cm-number">0.090105</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">372</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12391</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0.028454</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">378</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12286</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0.072254</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">358</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">8107</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">0.074214</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">371</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10753</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0.247291</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">346</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10753</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0.247291</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 414px;"></div><div class="CodeMirror-gutters" style="display: none; height: 414px;"></div></div></div></pre><p><span>相比于之前的3σ和四分位法，</span><b><mark><span>孤立森林算法不仅能直接判断出异常点，还能为每个样本进行异常程度的打分排名</span></mark></b><span>。</span></p><p><span>下面这张图，是对单维变量进行增维（y轴为变量值，x轴为样品序号）后的分布图：</span></p><div align="center">
    <img src="figure/孤立森林单变量2.png">
</div><p>&nbsp;</p><p><span>但是如果细心点就会发现，在进行模型构造前需要预设样本的异常比例，那本来就是无监督检测，未知异常分布，怎么可能提前给出异常比例呢？</span></p><p><mark><span>其实，这个问题对于异常检测来讲并不是一个影响非常大的问题，因为异常比例是人为规定的，而对于定义未知的异常值（比如本案例中，现实世界并没有具体定义异常值是怎么样的，即电池寿命异常的标准是什么），如果要判定其是异常，就必须结合具体的任务，即人为判定。比如本案例中寿命为7162的电池之所以判定异常，是因为我们通过跟其相同材料、相同测试条件的电池进行对比，才得出异常的结论，算法只是告诉我们在算法判定里，这颗电池是否异常，并不意味着算法判定的异常值就一定是现实世界中的异常值。同样的，对于孤立森林给出的异常值，我们其实更关心地是样本的异常程度，异常程度排名最靠前的样本在现实中是异常值的可能最大，至于是否是真实的异常就需要结合任务实际环境进行人为标定。不管我们在算法开始规定的异常比例是多少，算法对于每个样本的异常程度评估是不会发生改变的！</span></mark><span>比如，我们将异常比例提升至10%，再看一下算法结果：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 定义异常</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rng</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">RandomState</span>(<span class="cm-number">0</span>) <span class="cm-comment"># 定义随机状态</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">outliers_fraction</span> = <span class="cm-number">0.1</span> <span class="cm-comment"># 定义异常比例为10%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">xtrain</span> = <span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">to_numpy</span>().<span class="cm-property">reshape</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>,<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 构造模型并拟合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clf</span> = <span class="cm-variable">IsolationForest</span>(<span class="cm-variable">random_state</span>=<span class="cm-variable">rng</span>, <span class="cm-variable">contamination</span>=<span class="cm-variable">outliers_fraction</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">xtrain</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'循环寿命'</span>]=<span class="cm-variable">clf</span>.<span class="cm-property">predict</span>(<span class="cm-variable">xtrain</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">scores_pred</span> = <span class="cm-variable">clf</span>.<span class="cm-property">decision_function</span>(<span class="cm-variable">xtrain</span>) <span class="cm-comment"># 返回未知数据上的异常程度 (负值绝对值越大越异常，正值越小越异常)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 预测结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">循环寿命</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-variable">异常预测值</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是否异常</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">357</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7162</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-operator">-</span><span class="cm-number">0.166536</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">372</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12391</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-operator">-</span><span class="cm-number">0.047977</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">378</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12286</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-operator">-</span><span class="cm-number">0.004177</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">358</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">8107</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-operator">-</span><span class="cm-number">0.002217</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">是</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">376</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12076</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0.000554</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">371</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10753</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0.170860</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">346</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10753</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0.170860</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">否</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 437px;"></div><div class="CodeMirror-gutters" style="display: none; height: 437px;"></div></div></div></pre><p><span>可以看到，</span><mark><strong><span>将异常比例提升至10%，即人为规定样本中的异常数为37*10%≈4，虽然异常点多出来了3个，但实际上异常程度的排名是没有变化，这就意味着算法算出来每个样本是否为异常值的概率排名是没有变化的。而不管异常比例定义为多少，都需要结合具体任务人为定义异常，所以算法的有效性是不会改变的！</span></strong></mark></p><p><span>通过利用实例进行孤立森林异常检测，可以知道孤立森林的特点:</span></p><ul><li><mark><strong><span>算法预测精度高，并且可以进行置信度评估，排名。</span></strong></mark></li><li><mark><strong><span>算法计算成本较低（相对于以距离作为度量的算法，比如SVM，KNN等），这主要是得力于孤立森立进行分类的原理。</span></strong></mark></li><li><mark><strong><span>具有一定的解释性（从算法原理层面），但解释性跟3σ、四分位比较起来会差不少，这主要因为集成算法的原理较为复杂，不像3σ或四分位数那样简单直观。</span></strong></mark></li></ul><h5 id='42213-基于knn-的异常检测'><span>4.2.2.1.3 </span><strong><span>基于KNN 的异常检测</span></strong></h5><p><strong><span>KNN（K-Nearest Neighbor）最邻近分类算法</span></strong><span>是数据挖掘</span><strong><span>分类</span></strong><span>（classification）技术中最简单的算法之一，其指导思想是”近朱者赤，近墨者黑“，即由你的邻居来推断出你的类别。</span><strong><span>其实，KNN的原理就是当预测一个新的值x的时候，根据它距离最近的K个点是什么类别来判断x属于哪个类别</span></strong><span>。</span></p><div align="center">
    <img src="figure/KNN.png">
</div><p><span>图中绿色的点就是我们要预测的那个点，假设K=3。那么KNN算法就会找到与它距离最近的三个点（这里用圆圈把它圈起来了），看看哪种类别多一些，比如这个例子中是蓝色三角形多一些，新来的绿色点就归类到蓝三角了。</span></p><p><span>KNN是一种</span><strong><span>非参的</span></strong><span>，</span><strong><span>惰性</span></strong><span>的算法模型。什么是非参，什么是惰性呢？</span><strong><span>非参</span></strong><span>的意思并不是说这个算法不需要参数，而是意味着这个模型不会对数据做出任何的假设（分布假设，相关性假设）。也就是说KNN建立的模型结构是根据数据来决定的，这也比较符合现实的情况，毕竟在现实中的情况往往与理论上的假设是不相符的。</span><strong><span>惰性</span></strong><span>又是什么意思呢？同样是分类算法，</span><a href='逻辑回归'><span>逻辑回归</span></a><span>需要先对数据进行大量训练（tranning），最后才会得到一个算法模型。而KNN算法却不需要，它没有明确的训练数据的过程，或者说这个过程很快。Neighbors-based（基于邻居的）方法被称为 </span><strong><span>非泛化</span></strong><span> 机器学习方法， 因为它们只是简单地”记住”了其所有的训练数据，如果拿到新数据，还是必须让算法重新把数据总体再走一遍，所以它非泛化算法。</span></p><p><span>上面讲的是KNN在</span><strong><span>有监督分类算法</span></strong><span>中的应用。那KNN是如何应用在</span><strong><span>无监督的异常检测</span></strong><span>中的呢？基本思路是对</span><mark><strong><span>每一个点，计算其与最近k个相邻点的距离，通过距离的大小来判断它是否为离群点</span></strong></mark><span>，K-NN是最简单的异常检测算法之一，有着以下特点：</span></p><ul><li><span>算法简单，简洁明了，算法可解释性强；</span></li><li><span>基于邻近度的方法需要O(m2)时间，对内存要求较高，因为该算法存储了所有训练数据，计算成本较高，大数据集不适用；</span></li><li><span>对K-value参数的选择敏感；</span></li><li><span>不能处理具有不同密度区域的数据集，因为它使用全局阈值，不能考虑这种密度的变化。</span></li></ul><p>&nbsp;</p><p><span>计算过程（未调参，近邻数k_values默认为5）：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">contamination</span> = <span class="cm-number">0.02</span> &nbsp;<span class="cm-comment"># percentage of outliers</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 训练KNN模型</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clf_name</span> = <span class="cm-string">'KNN'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clf</span> = <span class="cm-variable">KNN</span>(<span class="cm-variable">contamination</span>=<span class="cm-variable">contamination</span>) <span class="cm-comment"># k_values=5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">xtrain</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 得到训练标签和训练分数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_train_pred</span> = <span class="cm-variable">clf</span>.<span class="cm-property">labels_</span> &nbsp; <span class="cm-comment"># 0正常，1异常</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_train_scores</span> = <span class="cm-variable">clf</span>.<span class="cm-property">decision_scores_</span> &nbsp;<span class="cm-comment"># 数值越大越异常</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 用训练好的模型预测测试数据的标签和分数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_test_pred</span> = <span class="cm-variable">clf</span>.<span class="cm-property">predict</span>(<span class="cm-variable">xtrain</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y_test_scores</span> = <span class="cm-variable">clf</span>.<span class="cm-property">decision_function</span>(<span class="cm-variable">xtrain</span>) &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'knn_pred'</span>]= <span class="cm-variable">y_test_pred</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'knn_pred'</span>]= <span class="cm-variable">data_tar</span>[<span class="cm-string">'knn_pred'</span>].<span class="cm-property">map</span>({<span class="cm-number">0</span>:<span class="cm-string">'否'</span>,<span class="cm-number">1</span>:<span class="cm-string">'是'</span>})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[<span class="cm-string">'异常程度'</span>]= <span class="cm-variable">y_test_scores</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 按异常程度从大到小排列</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_tar</span>[[<span class="cm-string">'循环寿命'</span>,<span class="cm-string">'异常程度'</span>,<span class="cm-string">'knn_pred'</span>]].<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=<span class="cm-string">'异常程度'</span>, <span class="cm-variable">ascending</span>=<span class="cm-keyword">False</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">循环寿命</span><span class="cm-tab" role="presentation" cm-text="	"> </span> <span class="cm-variable">异常程度</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-variable">knn_pred</span> <span class="cm-comment"># 是否为异常，0正常，1异常</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">357</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">7162</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">1554.0</span><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">372</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12391</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">840.0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">378</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">12286</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">735.0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">358</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">8107</span><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-number">651.0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">......</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">377</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10312</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">147.0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">374</span><span class="cm-tab" role="presentation" cm-text="	"> </span><span class="cm-number">10879</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">126.0</span><span class="cm-tab" role="presentation" cm-text="	">   </span><span class="cm-number">0</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 575px;"></div><div class="CodeMirror-gutters" style="display: none; height: 575px;"></div></div></div></pre><p><span>从结果上看，</span><mark><strong><span>KNN算法对异常值的检测十分优秀，对异常值的区分能力很高。</span></strong></mark><span>前面我们说过，KNN算法效果依赖于近邻数k_values的选取，上面的模型默认设置k_values为5，那如果是其它取值，结果又如何呢？为此，需要对k_values进行学习曲线（就是不同的k_values与模型效果的曲线图）的探究，当然判断只有1个异常值的问题没有代表性，我们把上述异常程度排名前3（即编号为：357，372，378）的电池寿命均定义为异常值，看看不同的近邻数k_values对异常检测结果的影响：</span></p><div align="center">
    <img src="figure/准确率.png" style="zoom:100%">
</div><p><span>从结果上看，</span><strong><span>当近邻数取5时，预测准确率最高。</span></strong><span>在本案例中之所以在近邻数取5时，KNN效果最好。这主要是因为</span><strong><span>数据结构的影响（样本量少，样本里特征完全一致的样本组合数量大部分在5个左右）</span></strong><span>。</span></p><p>&nbsp;</p><h5 id='42214-基于dbscan的异常检测'><span>4.2.2.1.4 基于DBSCAN的异常检测</span></h5><ul><li><strong><span>定义</span></strong></li></ul><p><strong><span>DBSCAN（Density-Based Spatial Clustering of Applications with Noise)</span></strong><span>是一种</span><strong><span>基于密度的聚类算法</span></strong><span>，这类密度聚类算法一般假定类别可以通过样本分布的紧密程度决定。同一类别的样本，他们之间的紧密相连的，也就是说，在该类别任意样本周围不远处一定有同类别的样本存在。DBSCAN是一种出现得比较早（1996年），比较有代表性的基于密度的聚类算法。下面为算法描述定义：</span></p><p><span>ϵ描述了某一样本的邻域距离阈值，MinPts描述了某一样本的距离为ϵ的邻域中样本个数的阈值。考虑数据集合 X = {x</span><sup><span>(1)</span></sup><span>，x</span><sup><span>(2)</span></sup><span>，...，x</span><sup><span>(N)</span></sup><span>}：</span></p><ol start='' ><li><span>ϵ-邻域：对于x</span><sub><span>i</span></sub><span> ∈ X，其ϵ-邻域包含样本集X中与x</span><sub><span>i</span></sub><span>的距离不大于ϵ的子样本集，即Nϵ(x</span><sub><span>j</span></sub><span>)={x</span><sub><span>j</span></sub><span>∈X|distance(x</span><sub><span>i</span></sub><span>，x</span><sub><span>j</span></sub><span>) ≤ ϵ} ， 这个子样本集的个数记为|Nϵ(x</span><sub><span>i</span></sub><span>)|。</span></li><li><span>核心点：对于任一样本x</span><sub><span>i</span></sub><span>∈X，如果其ϵ-邻域对应的Nϵ(x</span><sub><span>i</span></sub><span>)至少包含MinPts个样本，即如果|Nϵ(x</span><sub><span>i</span></sub><span>)| ≥ MinPts，则x</span><sub><span>i</span></sub><span>是核心点。　</span></li><li><span>密度直达：如果x</span><sub><span>i</span></sub><span>位于x</span><sub><span>j</span></sub><span>的ϵ-邻域中，x</span><sub><span>j</span></sub><span>是核心对象，则称x</span><sub><span>i</span></sub><span>由x</span><sub><span>j</span></sub><span>密度直达。注意反之不一定成立，即此时不能说x</span><sub><span>j</span></sub><span>由x</span><sub><span>i</span></sub><span>密度直达, 除非且x</span><sub><span>i</span></sub><span>也是核心点。</span></li><li><span>密度可达：对于x</span><sub><span>i</span></sub><span>和x</span><sub><span>j</span></sub><span>，如果存在样本样本序列p</span><sub><span>1</span></sub><span>,p</span><sub><span>2</span></sub><span>,...,p</span><sub><span>T</span></sub><span>,满足p</span><sub><span>1</span></sub><span>=x</span><sub><span>i</span></sub><span>,p</span><sub><span>T</span></sub><span>=x</span><sub><span>j</span></sub><span>, 且p</span><sub><span>t+1</span></sub><span>由p</span><sub><span>t</span></sub><span>密度直达，则称xj由xi密度可达。也就是说，密度可达满足传递性。此时序列中的传递样本p</span><sub><span>1</span></sub><span>,p</span><sub><span>2</span></sub><span>,...,p</span><sub><span>T−1</span></sub><span>均为核心点，因为只有核心点才能使其他样本密度直达。注意密度可达也不满足对称性，这个可以由密度直达的不对称性得出。</span></li><li><span>密度相连：对于x</span><sub><span>i</span></sub><span>和x</span><sub><span>j</span></sub><span>，如果存在核心对象样本x</span><sub><span>k</span></sub><span>，使x</span><sub><span>i</span></sub><span>和x</span><sub><span>j</span></sub><span>均由x</span><sub><span>k</span></sub><span>密度可达，则称x</span><sub><span>i</span></sub><span>和x</span><sub><span>j</span></sub><span>密度相连。注意密度相连关系是满足对称性的。</span></li></ol><div align="center">
    <img src="pic/DBSCAN.png" style="zoom:80%">
</div><p>&nbsp;</p><p>&nbsp;</p><ul><li><p><span>算法流程</span></p><p><span>首选任意选取一个点，然后找到到这个点距离小于等于 eps 的所有的点。如果距起始点的距离在 eps 之内的数据点个数小于 min_samples，那么这个点被标记为</span><strong><span>噪音点。</span></strong><span>如果距离在 eps 之内的数据点个数大于 min_samples，则这个点被标记为</span><strong><span>核心样本</span></strong><span>，并被分配一个新的簇（cluster)标签。</span></p><p><span>然后访问该点的所有邻居（在距离 eps 以内）。如果它们还没有被分配一个簇，那么就将刚刚创建的新的簇标签分配给它们。如果它们是核心样本，那么就依次访问其邻居，以此类推。簇逐渐增大，直到在簇的 eps 距离内没有更多的核心样本为止。</span></p><p><span>选取另一个尚未被访问过的点，并重复相同的过程。</span></p></li></ul><p>&nbsp;</p><p><strong><span>DBSCAN优点：</span></strong></p><ol start='' ><li><span>DBSCAN不需要事先知道要形成的簇类的数量。</span></li><li><span>DBSCAN可以发现任意形状的簇类。</span></li><li><span>对数据集中的异常点不敏感，DBSCAN能够有效识别出噪声点（异常点）。</span></li><li><span>DBSCAN对于数据库中样本的顺序不敏感，即Pattern的输入顺序对结果的影响不大。但是，对于处于簇类之间边界样本，可能会根据哪个簇类优先被探测到而其归属有所摆动</span></li></ol><p><strong><span>DBSCAN缺点</span></strong></p><ol start='' ><li><span>DBScan不能很好反映高维数据。</span></li><li><span>DBScan不能很好反映数据集以变化的密度。</span></li><li><span>如果样本集的密度不均匀、聚类间距差相差很大时，聚类质量较差。</span></li><li><span>调参相对于传统的K-Means之类的聚类算法稍复杂，主要需要对距离阈值ϵϵ，邻域样本数阈值MinPts联合调参，不同的参数组合对最后的聚类效果有较大影响。</span></li></ol><p>&nbsp;</p><ul><li><p><span>计算过程</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart3" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="61" style="max-width: 684px; height: 101px;" viewBox="0 0 684 61" class="md-require-zoom-fix"><style>#mermaidChart3{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart3 .error-icon{fill:#552222;}#mermaidChart3 .error-text{fill:#552222;stroke:#552222;}#mermaidChart3 .edge-thickness-normal{stroke-width:2px;}#mermaidChart3 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart3 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart3 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart3 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart3 .marker{fill:#333333;}#mermaidChart3 .marker.cross{stroke:#333333;}#mermaidChart3 svg{font-family:sans-serif;font-size:16px;}#mermaidChart3 .label{font-family:sans-serif;color:#333;}#mermaidChart3 .label text{fill:#333;}#mermaidChart3 .node rect,#mermaidChart3 .node circle,#mermaidChart3 .node ellipse,#mermaidChart3 .node polygon,#mermaidChart3 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart3 .node .label{text-align:center;}#mermaidChart3 .node.clickable{cursor:pointer;}#mermaidChart3 .arrowheadPath{fill:#333333;}#mermaidChart3 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart3 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart3 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart3 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart3 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart3 .cluster text{fill:#333;}#mermaidChart3 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart3:root{--mermaid-font-family:sans-serif;}#mermaidChart3:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart3 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-AA" id="L-A-AA" style="opacity: 1;"><path class="path" d="M108,30.5L133,30.5L158,30.5" marker-end="url(#arrowhead167)" style="fill:none"></path><defs><marker id="arrowhead167" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-AA LE-B" id="L-AA-B" style="opacity: 1;"><path class="path" d="M290,30.5L315,30.5L340,30.5" marker-end="url(#arrowhead168)" style="fill:none"></path><defs><marker id="arrowhead168" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M424,30.5L449,30.5L474,30.5" marker-end="url(#arrowhead169)" style="fill:none"></path><defs><marker id="arrowhead169" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M558,30.5L583,30.5L608,30.5" marker-end="url(#arrowhead170)" style="fill:none"></path><defs><marker id="arrowhead170" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-106" transform="translate(58,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-50" y="-22.5" width="100" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-40,-12.5)"><foreignObject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据标准化</div></foreignObject></g></g></g><g class="node default" id="flowchart-AA-107" transform="translate(224,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">以不同参数建模</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-108" transform="translate(382,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">获得结果</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-110" transform="translate(516,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据还原</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-112" transform="translate(642,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-34" y="-22.5" width="68" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-24,-12.5)"><foreignObject width="48" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">可视化</div></foreignObject></g></g></g></g></g></g></svg></div><p>&nbsp;</p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 数据标准化编码及还原编码</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">scaler</span> = <span class="cm-variable">StandardScaler</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">scaler</span>.<span class="cm-property">fit</span>(<span class="cm-variable">data_dbs</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">to_numpy</span>().<span class="cm-property">reshape</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> = <span class="cm-variable">scaler</span>.<span class="cm-property">transform</span>(<span class="cm-variable">data_dbs</span>[<span class="cm-string">'循环寿命'</span>].<span class="cm-property">to_numpy</span>().<span class="cm-property">reshape</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>,<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_re</span> = <span class="cm-variable">scaler</span>.<span class="cm-property">inverse_transform</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 建模及可视化代码（篇幅太长，省略）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">邻域半径ε</span>=<span class="cm-number">0.1</span>,<span class="cm-variable">最小样本数为1下时聚类簇的个数为：13</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">邻域半径ε</span>=<span class="cm-number">0.2</span>,<span class="cm-variable">最小样本数为2下时聚类簇的个数为：5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">邻域半径ε</span>=<span class="cm-number">0.3</span>,<span class="cm-variable">最小样本数为3下时聚类簇的个数为：2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">邻域半径ε</span>=<span class="cm-number">0.4</span>,<span class="cm-variable">最小样本数为4下时聚类簇的个数为：2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">邻域半径ε</span>=<span class="cm-number">0.5</span>,<span class="cm-variable">最小样本数为5下时聚类簇的个数为：1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">邻域半径ε</span>=<span class="cm-number">0.6</span>,<span class="cm-variable">最小样本数为6下时聚类簇的个数为：1</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 322px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><p><mark><span>注：因为为单变量数据，为增强显示效果，对变量进行了增维处理，处理方法是将散点图的x变量和y变量均设置为循环寿命。</span></mark></p><div align="center">
    <img src="figure/DBSCAN2.png" style="zoom:90%">
</div><p>&nbsp;</p><p><span>从代码结果和可视化结果上看，</span><mark><strong><span>邻域半径ε取0.5，0.6时，异常检验结果已经完全正确，且正常类完全归为一簇。</span></strong></mark><span>实际上，DBSCAN使用了统一的邻域值ε和m值，在类中的数据分布密度不均匀时，ε较小时，密度小的cluster会被划分成多个性质相似的cluster；ε较大时，会使得距离较近且密度较大的cluster被合并成一个cluster。在高维数据时，因为维数灾难问题，ε的选取比较困难。</span><mark><strong><span>所以对高维数据用DBSCAN算法检测异常值，效果往往不是很理想。同时由于算法需要遍历整个数据空间，DBSCAN在检测成本（时间成本和计算成本）上会产生比较大的开销。</span></strong></mark></p><p>&nbsp;</p><h3 id='423-二变量异常检测'><span>4.2.3 二变量异常检测</span></h3><p><span>现实世界中，二变量的异常检测是很常见的，比如同一地区，对降水量和蒸发量是否异常进行检测；又比如，某一地区的某一时期，教育程度与收入水平是否存在分布异常。那对于电池领域来说，二变量的异常分析就很多了，比如已知电池压降k值与分容容量，探究电池是否异常，这个时候单独地看k值或分容容量是否异常是不行的，需要对其进行二变量的异常检测。</span></p><p>&nbsp;</p><h4 id='4231-常见异常检测算法'><span>4.2.3.1 常见异常检测算法</span></h4><p><span>之前在介绍异常检测算法概念时，有提到异常检测算法的</span><a href='#异常检测分类'><span>分类</span></a><span>，实际异常检测的分类不止一种，下面将以另外一种分类角度，对12种异常检测算法进行介绍。</span></p><ul><li><strong><em><span>线性模型（Linear Models）</span></em></strong><span>: 简单概括就是低维空间投射后表现不好的数据可以认为是异常点。主要算法有：</span></li></ul><ol start='' ><li><strong><a id='PCA'><span>主成分分析（Principal Component Analysis， PCA）</span></a></strong><span> ：寻找k个特征向量，计算每个样本经过这k个特征向量投影后的重建误差，重建误差越大，异常概率越大；或者将数据映射到低维特征空间，然后在特征空间不同维度上查看每个数据点跟其它数据的偏差。</span></li><li><strong><span>最小协方差行列式（Mininum Covariance Determinant，MCD）</span></strong><span> ：利用最小协方差行列式计算样本的均值和协方差估计量，再根据马氏距离计算，可以更精准地探测离群点。</span></li><li><strong><span>一类支持向量机（One-Class Support Vector Machines ，OCSVM）</span></strong><span>: 与二分类SVM略微不同，但依然很相似，这个方法创建了一个参数为</span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.663ex" height="1.41ex" viewBox="0 -504.6 716 607.1" role="img" focusable="false" style="vertical-align: -0.238ex;"><defs><path stroke-width="0" id="E43-MJMATHI-77" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E43-MJMATHI-77" x="0" y="0"></use></g></svg></span><script type="math/tex">w</script><span>（系数矩阵），</span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.201ex" height="1.877ex" viewBox="0 -504.6 517 808.1" role="img" focusable="false" style="vertical-align: -0.705ex;"><defs><path stroke-width="0" id="E44-MJMATHI-3C1" d="M58 -216Q25 -216 23 -186Q23 -176 73 26T127 234Q143 289 182 341Q252 427 341 441Q343 441 349 441T359 442Q432 442 471 394T510 276Q510 219 486 165T425 74T345 13T266 -10H255H248Q197 -10 165 35L160 41L133 -71Q108 -168 104 -181T92 -202Q76 -216 58 -216ZM424 322Q424 359 407 382T357 405Q322 405 287 376T231 300Q217 269 193 170L176 102Q193 26 260 26Q298 26 334 62Q367 92 389 158T418 266T424 322Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E44-MJMATHI-3C1" x="0" y="0"></use></g></svg></span><script type="math/tex">ρ</script><span>（偏置项）的超平面，该超平面与特征空间中的零点距离最大，并且将零点与所有的数据点分隔开。</span></li></ol><ul><li><strong><em><span>基于相似度衡量的模型（Proximity-Based Outlier Detection Models）</span></em></strong><span>: 异常点因为和正常点的分布不同，因此相似度较低，由此衍生了一系列算法通过相似度来识别异常点。大部分异常检测算法都可以被认为是一种估计相似度,无论是通过密度、距离、夹角或是划分超平面。通过聚类也可以被理解为一种相似度度量。主要算法有：</span></li></ul><ol start='4' ><li><strong><span>局部异常因子算法（Local Outlier Factor，LOF)</span></strong><span>：基本原理同上节基于聚类的DBSCAN算法相似，LOF算法通过比较每个点p和其邻域点的密度来判断该点是否为异常点，如果点p的密度越低，越可能被认定是异常点。至于密度，是通过点之间的距离来计算的，点之间距离越远，密度越低，距离越近，密度越高。因为LOF对密度的是通过点的第k邻域（就是p的第k距离即以内的所有点）来计算，而不是全局计算，因此得名为“局部”异常因子。</span></li><li><strong><span>基于聚类的本地异常因子（Clustering-Based Local Outlier Factor，CBLOF）</span></strong><span>：基本原理是：数据可能会在多个不同的地方聚集，形成簇。当一个点越接近大簇的时候，他是正常点的概率就越高，反之越低。一般，聚类分簇会用k-means算法，距离可以直接用欧氏距离。算法要计算CBLOF因子，也就是一个点到最近的大簇的距离。如果这个点是大簇里面的点，那么直接计算它到簇中心的距离即可。如果这个点不是大簇点，那么就要分别计算其到所有大簇的距离，选最小的那个作为因子。</span></li><li><strong><span>最近邻算法（ k Nearest Neighbors，KNN</span></strong><span>）：基本思路是对每一个点，计算其与最近k个相邻点的距离，通过距离的大小来判断它是否为离群点。</span></li><li><strong><span>平均最近邻算法（Average kNN）</span></strong><span>  : 采用距离最近的k个点的平均距离作为距离指标。</span></li></ol><ul><li><strong><em><span>基于概率的模型（Probabilistic Models for Outlier Detection）</span></em></strong><span>: 主要是对数据的分布做出假设，并找出假设下所定义的“异常”，因此往往会使用极值分析或者假设检验。主要算法有：</span></li></ul><ol start='8' ><li><p><strong><span>Angle-Based Outlier Detection（ABOD)</span></strong><span>：在</span><strong><span>高维空间</span></strong><span>中，</span><strong><span>角度比距离更具有可参考性</span></strong><span>（维度灾难）。在该算法中，对于一个样本，它的加权余弦分数对所有邻居的方差可以作为离群分数。</span></p><ul><li><p><span>O 点为离群点，则其他点在 O 点的</span><strong><span>同一方向</span></strong><span>上</span></p></li><li><p><span>O 点不是离群点，则其他点在 O 点的</span><strong><span>各个方向</span></strong><span>上</span></p><div align="center">
    <img src="figure/ABOD.png">
</div><p>&nbsp;</p></li></ul></li><li><p><strong><span>基于直方图的异常算法（ Histogram-based Outlier Score，HBOS）</span></strong><span>：HBOS算法基于多维数据各个维度的独立性假设，对于每个数据维度，先做出数据直方图。对于分类特征，统计每个值出现的次数，并计算相对频率；对于数值特征，将值域分箱操作（可以是等宽分箱，也可以是等位分箱），每个分箱的高度代表数据密度的估计。密度越高，异常评分越低。为了使得最大高度为1（确保了每个特征与异常值得分的权重相等），需对直方图进行归一化处理。最后，每一个实例的HBOS值由以下公式计算：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1317" cid="n1317" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="134.97ex" height="7.19ex" viewBox="0 -1783.6 58111.7 3095.6" role="img" focusable="false" style="vertical-align: -3.047ex; max-width: 100%;"><defs><path stroke-width="0" id="E14-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E14-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E14-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E14-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E14-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E14-MJMATHI-48" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path stroke-width="0" id="E14-MJMATHI-42" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path stroke-width="0" id="E14-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E14-MJMATHI-53" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path stroke-width="0" id="E14-MJMATHI-70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path stroke-width="0" id="E14-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E14-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E14-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E14-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E14-MJMATHI-64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path stroke-width="0" id="E14-MJMATHI-6C" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path stroke-width="0" id="E14-MJMATHI-6F" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path stroke-width="0" id="E14-MJMATHI-67" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path><path stroke-width="0" id="E14-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E14-MJMATHI-68" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path stroke-width="0" id="E14-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E14-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(56055,0)"><g id="mjx-eqn-4.3" transform="translate(0,-19)"><use xlink:href="#E14-MJMAIN-28"></use><use xlink:href="#E14-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E14-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E14-MJMAIN-33" x="1167" y="0"></use><use xlink:href="#E14-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(22701,0)"><g transform="translate(-15,0)"><g transform="translate(0,-19)"><use xlink:href="#E14-MJMATHI-48" x="0" y="0"></use><use xlink:href="#E14-MJMATHI-42" x="888" y="0"></use><use xlink:href="#E14-MJMATHI-4F" x="1647" y="0"></use><use xlink:href="#E14-MJMATHI-53" x="2410" y="0"></use><use xlink:href="#E14-MJMAIN-28" x="3055" y="0"></use><use xlink:href="#E14-MJMATHI-70" x="3444" y="0"></use><use xlink:href="#E14-MJMAIN-29" x="3947" y="0"></use><use xlink:href="#E14-MJMAIN-3D" x="4613" y="0"></use><g transform="translate(5669,0)"><use xlink:href="#E14-MJSZ2-2211" x="0" y="0"></use><g transform="translate(148,-1088)"><use transform="scale(0.707)" xlink:href="#E14-MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E14-MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="#E14-MJMAIN-30" x="1123" y="0"></use></g><use transform="scale(0.707)" xlink:href="#E14-MJMATHI-64" x="759" y="1626"></use></g><use xlink:href="#E14-MJMATHI-6C" x="7280" y="0"></use><use xlink:href="#E14-MJMATHI-6F" x="7578" y="0"></use><use xlink:href="#E14-MJMATHI-67" x="8063" y="0"></use><use xlink:href="#E14-MJMAIN-28" x="8543" y="0"></use><g transform="translate(8932,0)"><g transform="translate(120,0)"><rect stroke="none" width="3495" height="60" x="0" y="220"></rect><use xlink:href="#E14-MJMAIN-31" x="1497" y="676"></use><g transform="translate(60,-722)"><use xlink:href="#E14-MJMATHI-68" x="0" y="0"></use><use xlink:href="#E14-MJMATHI-69" x="576" y="0"></use><use xlink:href="#E14-MJMATHI-73" x="921" y="0"></use><g transform="translate(1390,0)"><use xlink:href="#E14-MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E14-MJMATHI-69" x="510" y="-213"></use></g><use xlink:href="#E14-MJMAIN-28" x="2094" y="0"></use><use xlink:href="#E14-MJMATHI-70" x="2483" y="0"></use><use xlink:href="#E14-MJMAIN-29" x="2986" y="0"></use></g></g></g><use xlink:href="#E14-MJMAIN-29" x="12668" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-14">HBOS(p)= \sum_{i=0}^{d}log(\frac{1}{hist_i(p)})\tag {4.3}</script></div></div><p>&nbsp;</p></li></ol><p><span>   </span></p><ul><li><strong><em><span>基于集成的方法 (Outlier Ensembles and Combination Frameworks)</span></em></strong><span>：在无监督学习时，提高模型的鲁棒性很重要，因此集成学习就大有用武之地。因为没有标签，异常检测往往是通过bagging和feature bagging比较多，而boosting相对较少。</span></li></ul><ol start='10' ><li><p><strong><span>孤立森林（Isolation Forest）</span></strong><span>：孤立森林通过划分超平面来计算“孤立”一个样本所需的超平面数量(可以想象成在想吃蛋糕上的樱桃所需的最少刀数)。</span></p></li><li><p><strong><span>集成检测框架（Feature Bagging）</span></strong><span>：集成检测框架feature bagging与分类问题中的随机森林（random forest）很像，先将训练数据随机划分（每次选取所有样本的d/2~d个特征，d代表特征数），得到多个子训练集，再在每个训练集上训练一个独立的模型（默认为LOF）并最终合并所有的模型结果（如通过平均）。</span></p></li><li><p><strong><span>LSCP（ Locally Selective Combination in Parallel Outlier Ensembles）</span></strong><span>：LSCP从一组要组合的检测器开始。对于每个测试实例，LSCP首先定义其局部区域，然后选择功能最强的局部检测器。所选检测器用于生成测试实例的离群值。它的根本思想就是，每当我们获得一个新的样本实例进行预测时，先评估一下哪些基学习器（base classifiers）在这个点附近的区域上表现良好（也就是在样本实例的邻近区域上），那我们就更可以相信它会在样本实例上表现良好。所以最简单的就是对于样本实例，找到在它附近的训练数据上表现最好的模型 ，然后输出模型预测结果作为最终预测结果即可。</span></p><p><span> 给定训练集 </span><span class='math-in-toc'>$ X_{t e s t}∈ \Bbb R^{n \times d } $</span><span> ，包含 n 个 d 维样本；R 个 base models：</span><span class='math-in-toc'>$C = \{ C_1, C_2 , … , C_R\}$</span><span> 。</span></p><p><span> 第一步：首先利用训练集</span><span class='math-in-toc'>$X_train$</span><span>分别训练 R 个模型；</span></p><p><span> 第二步：当测试数据 </span><span class='math-in-toc'>$ X_{t e s t}^j∈ \Bbb R^{1 \times d } $</span><span>到来时，首先生成该样本的局部空间</span><span class='math-in-toc'>$ \psi_j $</span><span>;</span></p><p><span> 第三步：得到测试数据</span><span class='math-in-toc'>$ X_{t e s t}^j∈ \Bbb R^{1 \times d } $</span><span>  的局部空间 </span><span class='math-in-toc'>$ \psi_j $</span><span>后，利用训练好的</span><span class='math-in-toc'>$\{ C_1, C_2 , … , C_R\}$</span><span>到该局部空间的局部异常分数矩阵 </span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.898ex" height="3.161ex" viewBox="0 -1007.2 6844.9 1361" role="img" focusable="false" style="vertical-align: -0.822ex;"><defs><path stroke-width="0" id="E46-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E46-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E46-MJMATHI-3C8" d="M161 441Q202 441 226 417T250 358Q250 338 218 252T187 127Q190 85 214 61Q235 43 257 37Q275 29 288 29H289L371 360Q455 691 456 692Q459 694 472 694Q492 694 492 687Q492 678 411 356Q329 28 329 27T335 26Q421 26 498 114T576 278Q576 302 568 319T550 343T532 361T524 384Q524 405 541 424T583 443Q602 443 618 425T634 366Q634 337 623 288T605 220Q573 125 492 57T329 -11H319L296 -104Q272 -198 272 -199Q270 -205 252 -205H239Q233 -199 233 -197Q233 -192 256 -102T279 -9Q272 -8 265 -8Q106 14 106 139Q106 174 139 264T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 299 34 333T82 404T161 441Z"></path><path stroke-width="0" id="E46-MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path stroke-width="0" id="E46-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E46-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E46-MJAMS-52" d="M17 665Q17 672 28 683H221Q415 681 439 677Q461 673 481 667T516 654T544 639T566 623T584 607T597 592T607 578T614 565T618 554L621 548Q626 530 626 497Q626 447 613 419Q578 348 473 326L455 321Q462 310 473 292T517 226T578 141T637 72T686 35Q705 30 705 16Q705 7 693 -1H510Q503 6 404 159L306 310H268V183Q270 67 271 59Q274 42 291 38Q295 37 319 35Q344 35 353 28Q362 17 353 3L346 -1H28Q16 5 16 16Q16 35 55 35Q96 38 101 52Q106 60 106 341T101 632Q95 645 55 648Q17 648 17 665ZM241 35Q238 42 237 45T235 78T233 163T233 337V621L237 635L244 648H133Q136 641 137 638T139 603T141 517T141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615T400 634T377 643Q374 643 339 648Q300 648 281 635Q271 628 270 610T268 481V346H284Q327 346 375 352Q421 364 439 392T457 496ZM492 537T492 496T488 427T478 389T469 371T464 361Q464 360 465 360Q469 360 497 370Q593 400 593 495Q593 592 477 630L457 637L461 626Q474 611 488 561Q492 537 492 496ZM464 243Q411 317 410 317Q404 317 401 315Q384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"></path><path stroke-width="0" id="E46-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E46-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path stroke-width="0" id="E46-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E46-MJMATHI-4F" x="0" y="0"></use><use xlink:href="#E46-MJMAIN-28" x="763" y="0"></use><g transform="translate(1152,0)"><use xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-6A" x="920" y="-213"></use></g><use xlink:href="#E46-MJMAIN-29" x="2194" y="0"></use><use xlink:href="#E46-MJMAIN-2208" x="2861" y="0"></use><g transform="translate(3805,0)"><use xlink:href="#E46-MJAMS-52" x="0" y="0"></use><g transform="translate(722,409)"><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="0" y="0"></use><g transform="translate(196,0)"><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="#E46-MJMATHI-6A" x="920" y="-340"></use></g><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="1320" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-D7" x="1598" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-52" x="2376" y="0"></use></g></g></g></svg></span><script type="math/tex">O (\psi_j )\in \Bbb R^{|\psi_j|\times R}</script><span>  ;</span></p><p><span> 第四步：得到局部空间的局部异常分数矩阵  </span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.898ex" height="3.161ex" viewBox="0 -1007.2 6844.9 1361" role="img" focusable="false" style="vertical-align: -0.822ex;"><defs><path stroke-width="0" id="E46-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E46-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E46-MJMATHI-3C8" d="M161 441Q202 441 226 417T250 358Q250 338 218 252T187 127Q190 85 214 61Q235 43 257 37Q275 29 288 29H289L371 360Q455 691 456 692Q459 694 472 694Q492 694 492 687Q492 678 411 356Q329 28 329 27T335 26Q421 26 498 114T576 278Q576 302 568 319T550 343T532 361T524 384Q524 405 541 424T583 443Q602 443 618 425T634 366Q634 337 623 288T605 220Q573 125 492 57T329 -11H319L296 -104Q272 -198 272 -199Q270 -205 252 -205H239Q233 -199 233 -197Q233 -192 256 -102T279 -9Q272 -8 265 -8Q106 14 106 139Q106 174 139 264T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 299 34 333T82 404T161 441Z"></path><path stroke-width="0" id="E46-MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path stroke-width="0" id="E46-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E46-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E46-MJAMS-52" d="M17 665Q17 672 28 683H221Q415 681 439 677Q461 673 481 667T516 654T544 639T566 623T584 607T597 592T607 578T614 565T618 554L621 548Q626 530 626 497Q626 447 613 419Q578 348 473 326L455 321Q462 310 473 292T517 226T578 141T637 72T686 35Q705 30 705 16Q705 7 693 -1H510Q503 6 404 159L306 310H268V183Q270 67 271 59Q274 42 291 38Q295 37 319 35Q344 35 353 28Q362 17 353 3L346 -1H28Q16 5 16 16Q16 35 55 35Q96 38 101 52Q106 60 106 341T101 632Q95 645 55 648Q17 648 17 665ZM241 35Q238 42 237 45T235 78T233 163T233 337V621L237 635L244 648H133Q136 641 137 638T139 603T141 517T141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615T400 634T377 643Q374 643 339 648Q300 648 281 635Q271 628 270 610T268 481V346H284Q327 346 375 352Q421 364 439 392T457 496ZM492 537T492 496T488 427T478 389T469 371T464 361Q464 360 465 360Q469 360 497 370Q593 400 593 495Q593 592 477 630L457 637L461 626Q474 611 488 561Q492 537 492 496ZM464 243Q411 317 410 317Q404 317 401 315Q384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"></path><path stroke-width="0" id="E46-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E46-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path stroke-width="0" id="E46-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E46-MJMATHI-4F" x="0" y="0"></use><use xlink:href="#E46-MJMAIN-28" x="763" y="0"></use><g transform="translate(1152,0)"><use xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-6A" x="920" y="-213"></use></g><use xlink:href="#E46-MJMAIN-29" x="2194" y="0"></use><use xlink:href="#E46-MJMAIN-2208" x="2861" y="0"></use><g transform="translate(3805,0)"><use xlink:href="#E46-MJAMS-52" x="0" y="0"></use><g transform="translate(722,409)"><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="0" y="0"></use><g transform="translate(196,0)"><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="#E46-MJMATHI-6A" x="920" y="-340"></use></g><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="1320" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-D7" x="1598" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-52" x="2376" y="0"></use></g></g></g></svg></span><script type="math/tex">O (\psi_j )\in \Bbb R^{|\psi_j|\times R}</script><span> 后，生成局部伪标签（pseudo ground truth）</span><span class='math-in-toc'>$ target^{\psi_j}\in \Bbb R^{|\psi_j|\times 1}$</span><span>；</span></p><p><span> 第五步：得到伪标签 </span><span class='math-in-toc'>$ target^{\psi_j}\in \Bbb R^{|\psi_j|\times 1}$</span><span>  后，计算局部异常分数矩阵</span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.898ex" height="3.161ex" viewBox="0 -1007.2 6844.9 1361" role="img" focusable="false" style="vertical-align: -0.822ex;"><defs><path stroke-width="0" id="E46-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E46-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E46-MJMATHI-3C8" d="M161 441Q202 441 226 417T250 358Q250 338 218 252T187 127Q190 85 214 61Q235 43 257 37Q275 29 288 29H289L371 360Q455 691 456 692Q459 694 472 694Q492 694 492 687Q492 678 411 356Q329 28 329 27T335 26Q421 26 498 114T576 278Q576 302 568 319T550 343T532 361T524 384Q524 405 541 424T583 443Q602 443 618 425T634 366Q634 337 623 288T605 220Q573 125 492 57T329 -11H319L296 -104Q272 -198 272 -199Q270 -205 252 -205H239Q233 -199 233 -197Q233 -192 256 -102T279 -9Q272 -8 265 -8Q106 14 106 139Q106 174 139 264T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 299 34 333T82 404T161 441Z"></path><path stroke-width="0" id="E46-MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path stroke-width="0" id="E46-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E46-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E46-MJAMS-52" d="M17 665Q17 672 28 683H221Q415 681 439 677Q461 673 481 667T516 654T544 639T566 623T584 607T597 592T607 578T614 565T618 554L621 548Q626 530 626 497Q626 447 613 419Q578 348 473 326L455 321Q462 310 473 292T517 226T578 141T637 72T686 35Q705 30 705 16Q705 7 693 -1H510Q503 6 404 159L306 310H268V183Q270 67 271 59Q274 42 291 38Q295 37 319 35Q344 35 353 28Q362 17 353 3L346 -1H28Q16 5 16 16Q16 35 55 35Q96 38 101 52Q106 60 106 341T101 632Q95 645 55 648Q17 648 17 665ZM241 35Q238 42 237 45T235 78T233 163T233 337V621L237 635L244 648H133Q136 641 137 638T139 603T141 517T141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615T400 634T377 643Q374 643 339 648Q300 648 281 635Q271 628 270 610T268 481V346H284Q327 346 375 352Q421 364 439 392T457 496ZM492 537T492 496T488 427T478 389T469 371T464 361Q464 360 465 360Q469 360 497 370Q593 400 593 495Q593 592 477 630L457 637L461 626Q474 611 488 561Q492 537 492 496ZM464 243Q411 317 410 317Q404 317 401 315Q384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"></path><path stroke-width="0" id="E46-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E46-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path stroke-width="0" id="E46-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E46-MJMATHI-4F" x="0" y="0"></use><use xlink:href="#E46-MJMAIN-28" x="763" y="0"></use><g transform="translate(1152,0)"><use xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-6A" x="920" y="-213"></use></g><use xlink:href="#E46-MJMAIN-29" x="2194" y="0"></use><use xlink:href="#E46-MJMAIN-2208" x="2861" y="0"></use><g transform="translate(3805,0)"><use xlink:href="#E46-MJAMS-52" x="0" y="0"></use><g transform="translate(722,409)"><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="0" y="0"></use><g transform="translate(196,0)"><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="#E46-MJMATHI-6A" x="920" y="-340"></use></g><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="1320" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-D7" x="1598" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-52" x="2376" y="0"></use></g></g></g></svg></span><script type="math/tex">O (\psi_j )\in \Bbb R^{|\psi_j|\times R}</script><span>  与伪标签 </span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.898ex" height="3.161ex" viewBox="0 -1007.2 6844.9 1361" role="img" focusable="false" style="vertical-align: -0.822ex;"><defs><path stroke-width="0" id="E46-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E46-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E46-MJMATHI-3C8" d="M161 441Q202 441 226 417T250 358Q250 338 218 252T187 127Q190 85 214 61Q235 43 257 37Q275 29 288 29H289L371 360Q455 691 456 692Q459 694 472 694Q492 694 492 687Q492 678 411 356Q329 28 329 27T335 26Q421 26 498 114T576 278Q576 302 568 319T550 343T532 361T524 384Q524 405 541 424T583 443Q602 443 618 425T634 366Q634 337 623 288T605 220Q573 125 492 57T329 -11H319L296 -104Q272 -198 272 -199Q270 -205 252 -205H239Q233 -199 233 -197Q233 -192 256 -102T279 -9Q272 -8 265 -8Q106 14 106 139Q106 174 139 264T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 299 34 333T82 404T161 441Z"></path><path stroke-width="0" id="E46-MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path stroke-width="0" id="E46-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E46-MJMAIN-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path stroke-width="0" id="E46-MJAMS-52" d="M17 665Q17 672 28 683H221Q415 681 439 677Q461 673 481 667T516 654T544 639T566 623T584 607T597 592T607 578T614 565T618 554L621 548Q626 530 626 497Q626 447 613 419Q578 348 473 326L455 321Q462 310 473 292T517 226T578 141T637 72T686 35Q705 30 705 16Q705 7 693 -1H510Q503 6 404 159L306 310H268V183Q270 67 271 59Q274 42 291 38Q295 37 319 35Q344 35 353 28Q362 17 353 3L346 -1H28Q16 5 16 16Q16 35 55 35Q96 38 101 52Q106 60 106 341T101 632Q95 645 55 648Q17 648 17 665ZM241 35Q238 42 237 45T235 78T233 163T233 337V621L237 635L244 648H133Q136 641 137 638T139 603T141 517T141 341Q141 131 140 89T134 37Q133 36 133 35H241ZM457 496Q457 540 449 570T425 615T400 634T377 643Q374 643 339 648Q300 648 281 635Q271 628 270 610T268 481V346H284Q327 346 375 352Q421 364 439 392T457 496ZM492 537T492 496T488 427T478 389T469 371T464 361Q464 360 465 360Q469 360 497 370Q593 400 593 495Q593 592 477 630L457 637L461 626Q474 611 488 561Q492 537 492 496ZM464 243Q411 317 410 317Q404 317 401 315Q384 315 370 312H346L526 35H619L606 50Q553 109 464 243Z"></path><path stroke-width="0" id="E46-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E46-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path stroke-width="0" id="E46-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E46-MJMATHI-4F" x="0" y="0"></use><use xlink:href="#E46-MJMAIN-28" x="763" y="0"></use><g transform="translate(1152,0)"><use xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-6A" x="920" y="-213"></use></g><use xlink:href="#E46-MJMAIN-29" x="2194" y="0"></use><use xlink:href="#E46-MJMAIN-2208" x="2861" y="0"></use><g transform="translate(3805,0)"><use xlink:href="#E46-MJAMS-52" x="0" y="0"></use><g transform="translate(722,409)"><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="0" y="0"></use><g transform="translate(196,0)"><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-3C8" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="#E46-MJMATHI-6A" x="920" y="-340"></use></g><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-7C" x="1320" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMAIN-D7" x="1598" y="0"></use><use transform="scale(0.707)" xlink:href="#E46-MJMATHI-52" x="2376" y="0"></use></g></g></g></svg></span><script type="math/tex">O (\psi_j )\in \Bbb R^{|\psi_j|\times R}</script><span>  之间的</span><a href='#皮尔森相关系数'><span>皮尔森相关系数</span></a><span>（Pearson Correlation Coefficient），通过相关系数，选择出与伪标签最相似的 x 个 models。</span></p><p><span> 第六步：最后根据选择的 x 个models，计算该测试数据 </span><span class="MathJax_SVG" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.877ex" height="3.278ex" viewBox="0 -1057.4 2099.7 1411.3" role="img" focusable="false" style="vertical-align: -0.822ex;"><defs><path stroke-width="0" id="E47-MJMATHI-58" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path><path stroke-width="0" id="E47-MJMATHI-6A" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path><path stroke-width="0" id="E47-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E47-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path stroke-width="0" id="E47-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E47-MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E47-MJMATHI-6A" x="1215" y="691"></use><g transform="translate(828,-279)"><use transform="scale(0.707)" xlink:href="#E47-MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E47-MJMATHI-65" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="#E47-MJMATHI-73" x="827" y="0"></use><use transform="scale(0.707)" xlink:href="#E47-MJMATHI-74" x="1296" y="0"></use></g></g></svg></span><script type="math/tex"> X_{t e s t}^j</script><span> 的异常分数，将这 x 个异常分数的最大值（平均值）作为该测试数据最后的异常分数。</span></p> <div align="center">
     <img src="figure/LSCP.png">
 </div></li></ol><p><span>  </span></p><h4 id='4232-异常检测在锂电池测试领域的具体含义'><span>4.2.3.2 异常检测在锂电池测试领域的具体含义  </span></h4><p><span>无监督的异常检测因为异常定义未知，所以需要人为定义异常。之前也提到过，对于</span><strong><span>锂电池测试</span></strong><span>来讲，异常是分为两种情况的：</span></p><ol start='' ><li><span>非自然异常：数据录入异常、测量错误、仪器故障等；</span></li><li><span>自然异常：验材料组合导致电池性能偏离样本总体正常值（即与其它实验组合相比）、实验参数的设置导致的电池性能偏离样本总体正常值。</span></li></ol><p><span>在</span><strong><span>批量产品生产测试</span></strong><span>时，异常检测一般是指检测非自然异常，比如从某生产批次的10万颗电池中找到异常电池；而对于</span><strong><span>设计实验阶段</span></strong><span>来讲，因为样本是由不同的实验组合构成的，不同样本的材料组合、测试条件都有可能存在差异，在这种语境下，异常检测更多地是指检测自然异常。本案例的样本都是非批量生产数据，包括DVT、EVT等阶段的实验数据，此时的异常检测语境指的的是无监督下检测非自然异常和自然异常的过程。算法得到的异常点数量依赖于设计者给定的异常比例。</span></p><h4 id='4233-异常检测评价'><span>4.2.3.3 异常检测评价</span></h4><p><span>为评价算法效果，需要对样本异常标签做出人工标定，然后跟算法得到的异常标签进行比较。至于异常标定标准，会随着不同技术人员的经验理解不同而产生差异，这就会导致算法效果的评价因人而异，无法统一，那该如何解决评价不统一的问题呢？</span></p><p><span>其实我们可以换个思路来考虑这个问题，</span><strong><span>将所有算法得到的每个样本预测结果（可以是异常预测标签，也可以是归一化后的异常预测分数）做求和，得到每个样本异常值排名，然后根据设定的异常比例（或者异常分数阈值）选取靠前的样本，这些样本即可人工标定为实际异常样本。最后根据每个算法的异常预测标签与前面得到的实际异常标签进行对比，来评价算法效果。</span></strong><span>这样的算法流程其实就是集成中的bagging过程，只不过此时的基评估器是每个不同的算法，而非不同的样本组合或参数。此时的集成算法类似于上文所介绍的LSCP集成算法。基本流程如下：</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart4" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="203.5" style="max-width: 1340px; height: 243.5px;" viewBox="0 0 1340 203.5" class="md-require-zoom-fix"><style>#mermaidChart4{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart4 .error-icon{fill:#552222;}#mermaidChart4 .error-text{fill:#552222;stroke:#552222;}#mermaidChart4 .edge-thickness-normal{stroke-width:2px;}#mermaidChart4 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart4 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart4 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart4 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart4 .marker{fill:#333333;}#mermaidChart4 .marker.cross{stroke:#333333;}#mermaidChart4 svg{font-family:sans-serif;font-size:16px;}#mermaidChart4 .label{font-family:sans-serif;color:#333;}#mermaidChart4 .label text{fill:#333;}#mermaidChart4 .node rect,#mermaidChart4 .node circle,#mermaidChart4 .node ellipse,#mermaidChart4 .node polygon,#mermaidChart4 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart4 .node .label{text-align:center;}#mermaidChart4 .node.clickable{cursor:pointer;}#mermaidChart4 .arrowheadPath{fill:#333333;}#mermaidChart4 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart4 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart4 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart4 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart4 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart4 .cluster text{fill:#333;}#mermaidChart4 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart4:root{--mermaid-font-family:sans-serif;}#mermaidChart4:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart4 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-AA LE-B" id="L-AA-B" style="opacity: 1;"><path class="path" d="M108,125.5L181,125.5L206,125.5" marker-end="url(#arrowhead196)" style="fill:none"></path><defs><marker id="arrowhead196" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-H" id="L-B-H" style="opacity: 1;"><path class="path" d="M434,125.5L459,125.5L484,125.5" marker-end="url(#arrowhead197)" style="fill:none"></path><defs><marker id="arrowhead197" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-C" id="L-H-C" style="opacity: 1;"><path class="path" d="M616,104.1734693877551L697,78L778,78" marker-end="url(#arrowhead198)" style="fill:none"></path><defs><marker id="arrowhead198" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-D" id="L-H-D" style="opacity: 1;"><path class="path" d="M616,146.8265306122449L697,173L778,173" marker-end="url(#arrowhead199)" style="fill:none"></path><defs><marker id="arrowhead199" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-E" id="L-C-E" style="opacity: 1;"><path class="path" d="M910,78L1063,78L1216,78" marker-end="url(#arrowhead200)" style="fill:none"></path><defs><marker id="arrowhead200" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(697,78)" style="opacity: 1;"><g transform="translate(-48,-12.5)" class="label"><rect rx="0" ry="0" width="96" height="25"></rect><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>符合设定阈值</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(697,173)" style="opacity: 1;"><g transform="translate(-56,-12.5)" class="label"><rect rx="0" ry="0" width="112" height="25"></rect><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>不符合设定阈值</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1063,78)" style="opacity: 1;"><g transform="translate(-128,-12.5)" class="label"><rect rx="0" ry="0" width="256" height="25"></rect><foreignObject width="256" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>与单个算法得到的异常标签进行对比</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-BB-126" transform="translate(82,30.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-74" y="-22.5" width="148" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-64,-12.5)"><foreignObject width="128" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">案例算法基本流程</div></foreignObject></g></g></g><g class="node default" id="flowchart-AA-127" transform="translate(82,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">建模</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-128" transform="translate(320,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-114" y="-22.5" width="228" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-104,-12.5)"><foreignObject width="208" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">每个算法归一化后的异常分数</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-130" transform="translate(550,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">得到总异常分数</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-132" transform="translate(844,78)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">标定为异常样本</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-134" transform="translate(844,173)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">标定为正常样本</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-136" transform="translate(1274,78)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">算法效果评价</div></foreignObject></g></g></g></g></g></g></svg></div><p>&nbsp;</p><p><span>至于如何评价算法效果，我们可以采用混淆矩阵、准确率、精确度、真正率、假正率、ROC曲线等评价指标。</span></p><p><span>这里稍微介绍一下混淆矩阵、准确率、精确度、真正率、假正率、ROC曲线的概念：</span></p><ul><li><strong><span>混淆矩阵</span></strong></li></ul><p><span>混淆矩阵是二分类问题的多维衡量指标体系，在样本不平衡时极其有用。在混淆矩阵中，我们将少数类认为是正例，多数类认为是负例。在本案例中，</span><strong><span>异常值为少数类，是1；正常值是多少类，是0</span></strong><span>。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1359" cid="n1359" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="47.288ex" height="11.693ex" viewBox="0 -2831.6 20359.8 5034.4" role="img" focusable="false" style="vertical-align: -5.116ex; max-width: 100%;"><defs><path stroke-width="0" id="E15-MJMAINB-3A" d="M74 359Q74 394 98 419T158 444Q200 444 222 417T245 358Q245 329 224 302T160 274Q116 274 95 301T74 359ZM74 85Q74 121 99 146T156 171Q200 171 222 143T245 85Q245 56 224 29T160 1Q118 1 96 27T74 85Z"></path><path stroke-width="0" id="E15-MJMAIN-2216" d="M56 731Q56 740 62 745T75 750Q85 750 92 740Q96 733 270 255T444 -231Q444 -239 438 -244T424 -250Q414 -250 407 -240Q404 -236 230 242T56 731Z"></path><path stroke-width="0" id="E15-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E15-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">混</text><g transform="translate(1119,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">淆</text></g><g transform="translate(2238,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">矩</text></g><g transform="translate(3357,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">阵</text></g><use transform="scale(1.2)" xlink:href="#E15-MJMAINB-3A" x="4008" y="0"></use><g transform="translate(7692,0)"><g transform="translate(385,0)"><g transform="translate(0,1570)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">真</text><g transform="translate(1119,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">实</text></g><g transform="translate(2238,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">值</text></g><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-2216" x="2797" y="0"></use><g transform="translate(3957,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">预</text></g><g transform="translate(5076,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">测</text></g><g transform="translate(6195,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" font-weight="bold" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">值</text></g></g><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-31" x="2797" y="-75"></use><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-30" x="2797" y="-1409"></use></g><line stroke-linecap="square" stroke-width="28.63" y1="14" x2="14" x1="14" y2="4876" transform="translate(8200,-2146)"></line><g transform="translate(8700,0)"><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-31" x="0" y="1308"></use><g transform="translate(0,-90)"><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-31"></use><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-31" x="500" y="0"></use></g><g transform="translate(0,-1690)"><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-30"></use><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-31" x="500" y="0"></use></g></g><g transform="translate(10900,0)"><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-30" x="250" y="1308"></use><g transform="translate(0,-90)"><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-31"></use><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-30" x="500" y="0"></use></g><g transform="translate(0,-1690)"><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-30"></use><use transform="scale(1.2)" xlink:href="#E15-MJMAIN-30" x="500" y="0"></use></g></g><line stroke-linecap="square" stroke-width="28.63" y2="14" y1="14" x1="14" x2="12485" transform="translate(0,1055)"></line></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-15">\large\bf混淆矩阵:\qquad
\begin{array}{c|lcr} \bf真实值\backslash预测值 & 1 & 0 \\ 
\hline 
1 & 11 & 10 \\
0 & 01 & 00 \\
\end{array}</script></div></div><ul><li><strong><span>模型整体效果：准确率</span></strong></li></ul><p><span>准确率（Accuracy）就是所有预测正确的所有样本除以总样本，通常来说越接近1越好。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1364" cid="n1364" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="5.243ex" viewBox="0 -1364.4 59683.7 2257.2" role="img" focusable="false" style="vertical-align: -1.87ex; margin-bottom: -0.203ex; max-width: 100%;"><defs><path stroke-width="0" id="E16-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E16-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E16-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E16-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E16-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E16-MJMATHI-63" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path stroke-width="0" id="E16-MJMATHI-75" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E16-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E16-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E16-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E16-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E16-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E16-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E16-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-4.4" transform="translate(0,-38)"><use xlink:href="#E16-MJMAIN-28"></use><use xlink:href="#E16-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E16-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E16-MJMAIN-34" x="1167" y="0"></use><use xlink:href="#E16-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(23286,0)"><g transform="translate(-15,0)"><g transform="translate(0,-38)"><use xlink:href="#E16-MJMATHI-41" x="0" y="0"></use><use xlink:href="#E16-MJMATHI-63" x="750" y="0"></use><use xlink:href="#E16-MJMATHI-63" x="1183" y="0"></use><use xlink:href="#E16-MJMATHI-75" x="1616" y="0"></use><use xlink:href="#E16-MJMATHI-72" x="2188" y="0"></use><use xlink:href="#E16-MJMATHI-61" x="2639" y="0"></use><use xlink:href="#E16-MJMATHI-63" x="3168" y="0"></use><use xlink:href="#E16-MJMATHI-79" x="3601" y="0"></use><use xlink:href="#E16-MJMAIN-3D" x="4375" y="0"></use><g transform="translate(5153,0)"><g transform="translate(397,0)"><rect stroke="none" width="7787" height="60" x="0" y="220"></rect><g transform="translate(2282,676)"><use xlink:href="#E16-MJMAIN-31"></use><use xlink:href="#E16-MJMAIN-31" x="500" y="0"></use><use xlink:href="#E16-MJMAIN-2B" x="1222" y="0"></use><g transform="translate(2222,0)"><use xlink:href="#E16-MJMAIN-30"></use><use xlink:href="#E16-MJMAIN-30" x="500" y="0"></use></g></g><g transform="translate(60,-686)"><use xlink:href="#E16-MJMAIN-31"></use><use xlink:href="#E16-MJMAIN-31" x="500" y="0"></use><use xlink:href="#E16-MJMAIN-2B" x="1222" y="0"></use><g transform="translate(2222,0)"><use xlink:href="#E16-MJMAIN-31"></use><use xlink:href="#E16-MJMAIN-30" x="500" y="0"></use></g><use xlink:href="#E16-MJMAIN-2B" x="3444" y="0"></use><g transform="translate(4444,0)"><use xlink:href="#E16-MJMAIN-30"></use><use xlink:href="#E16-MJMAIN-31" x="500" y="0"></use></g><use xlink:href="#E16-MJMAIN-2B" x="5667" y="0"></use><g transform="translate(6667,0)"><use xlink:href="#E16-MJMAIN-30"></use><use xlink:href="#E16-MJMAIN-30" x="500" y="0"></use></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">Accuracy=\frac{11+00}{11+10+01+00}\tag{4.4}</script></div></div><ul><li><strong><span>模型捕捉少数类的能力：精确度、真正率</span></strong></li></ul><p><span>精确度（Precision），又叫查准率，表示所有被我们预测为是少数类的样本中，真正的少数类所占的比例。精确度越高，代表我们捕捉正确的异常值越多，对少数类的预测越精确。精确度越低，则代表我们误伤了过多的多数类，即过多地将正常值判定为异常值。精确度是“将多数类判错后所需付出成本的衡量”。 </span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1369" cid="n1369" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="5.243ex" viewBox="0 -1364.4 59683.7 2257.2" role="img" focusable="false" style="vertical-align: -1.87ex; margin-bottom: -0.203ex; max-width: 100%;"><defs><path stroke-width="0" id="E17-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E17-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E17-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E17-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E17-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E17-MJMATHI-50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path stroke-width="0" id="E17-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E17-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path stroke-width="0" id="E17-MJMATHI-63" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path stroke-width="0" id="E17-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E17-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E17-MJMATHI-6F" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path stroke-width="0" id="E17-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E17-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E17-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E17-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E17-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-4.5" transform="translate(0,-38)"><use xlink:href="#E17-MJMAIN-28"></use><use xlink:href="#E17-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E17-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E17-MJMAIN-35" x="1167" y="0"></use><use xlink:href="#E17-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(25385,0)"><g transform="translate(-15,0)"><g transform="translate(0,-38)"><use xlink:href="#E17-MJMATHI-50" x="0" y="0"></use><use xlink:href="#E17-MJMATHI-72" x="751" y="0"></use><use xlink:href="#E17-MJMATHI-65" x="1202" y="0"></use><use xlink:href="#E17-MJMATHI-63" x="1668" y="0"></use><use xlink:href="#E17-MJMATHI-69" x="2101" y="0"></use><use xlink:href="#E17-MJMATHI-73" x="2446" y="0"></use><use xlink:href="#E17-MJMATHI-69" x="2915" y="0"></use><use xlink:href="#E17-MJMATHI-6F" x="3260" y="0"></use><use xlink:href="#E17-MJMATHI-6E" x="3745" y="0"></use><use xlink:href="#E17-MJMAIN-3D" x="4622" y="0"></use><g transform="translate(5400,0)"><g transform="translate(397,0)"><rect stroke="none" width="3342" height="60" x="0" y="220"></rect><g transform="translate(1171,676)"><use xlink:href="#E17-MJMAIN-31"></use><use xlink:href="#E17-MJMAIN-31" x="500" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="#E17-MJMAIN-31"></use><use xlink:href="#E17-MJMAIN-31" x="500" y="0"></use><use xlink:href="#E17-MJMAIN-2B" x="1222" y="0"></use><g transform="translate(2222,0)"><use xlink:href="#E17-MJMAIN-30"></use><use xlink:href="#E17-MJMAIN-31" x="500" y="0"></use></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-17">Precision=\frac{11}{11+01}\tag{4.5}</script></div></div><p><span>真正率（True Positive Rate，TPR），又叫敏感度（sensitivity），表示所有真实为1的样本中（即真实异常样本），被我们预测正确的样本所占的比例。真正率越高，代表模型捕捉出了越多的少数类（即异常值），召回率越低，代表模型捕捉的少数类越少。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1371" cid="n1371" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="5.243ex" viewBox="0 -1364.4 59683.7 2257.2" role="img" focusable="false" style="vertical-align: -1.87ex; margin-bottom: -0.203ex; max-width: 100%;"><defs><path stroke-width="0" id="E18-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E18-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E18-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E18-MJMAIN-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path stroke-width="0" id="E18-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E18-MJMATHI-54" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path stroke-width="0" id="E18-MJMATHI-50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path stroke-width="0" id="E18-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E18-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E18-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E18-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E18-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-4.6" transform="translate(0,-38)"><use xlink:href="#E18-MJMAIN-28"></use><use xlink:href="#E18-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E18-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E18-MJMAIN-36" x="1167" y="0"></use><use xlink:href="#E18-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(26451,0)"><g transform="translate(-15,0)"><g transform="translate(0,-38)"><use xlink:href="#E18-MJMATHI-54" x="0" y="0"></use><use xlink:href="#E18-MJMATHI-50" x="704" y="0"></use><use xlink:href="#E18-MJMATHI-52" x="1455" y="0"></use><use xlink:href="#E18-MJMAIN-3D" x="2491" y="0"></use><g transform="translate(3269,0)"><g transform="translate(397,0)"><rect stroke="none" width="3342" height="60" x="0" y="220"></rect><g transform="translate(1171,676)"><use xlink:href="#E18-MJMAIN-31"></use><use xlink:href="#E18-MJMAIN-31" x="500" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="#E18-MJMAIN-31"></use><use xlink:href="#E18-MJMAIN-31" x="500" y="0"></use><use xlink:href="#E18-MJMAIN-2B" x="1222" y="0"></use><g transform="translate(2222,0)"><use xlink:href="#E18-MJMAIN-31"></use><use xlink:href="#E18-MJMAIN-30" x="500" y="0"></use></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">TPR=\frac{11}{11+10}\tag{4.6}</script></div></div><p><span>真正率和精确度是此消彼长的，两者之间的平衡代表了捕捉少数类的需求和尽量不要误伤多数类的需求的平衡。究竟要偏向于哪一方，取决于我们的业务需求：究竟是误伤多数类的成本更高，还是无法捕捉少数类的代价更高。</span><strong><span>如果我们希望不计一切代价，找出少数类（比如利用模型找出潜在犯罪者，又比如航空航天行业的产品检测），那我们就会追求尽量高的真正率；相反如果我们考虑检测成本，当每一次将多数类判断错误的成本非常高昂的时候（比如大众召回车辆的例子），我们会追求高精确度，以期减少错误成本。</span></strong></p><ul><li><strong><span>模型捕捉多数类的能力：假正率</span></strong></li></ul><p><span>假正率（False Positive Rate，FPR），就是一个模型将多数类判断错误的比例。假正率其实类似于Precision的反向指标，Precision衡量有多少少数点被判断正确，而假正率FPR衡量有多少多数点被判断错误，性质是十分类似的。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1377" cid="n1377" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="5.243ex" viewBox="0 -1364.4 59683.7 2257.2" role="img" focusable="false" style="vertical-align: -1.87ex; margin-bottom: -0.203ex; max-width: 100%;"><defs><path stroke-width="0" id="E19-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E19-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E19-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E19-MJMAIN-37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path><path stroke-width="0" id="E19-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E19-MJMATHI-46" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path><path stroke-width="0" id="E19-MJMATHI-50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path stroke-width="0" id="E19-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="0" id="E19-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E19-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E19-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E19-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-4.7" transform="translate(0,-38)"><use xlink:href="#E19-MJMAIN-28"></use><use xlink:href="#E19-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E19-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E19-MJMAIN-37" x="1167" y="0"></use><use xlink:href="#E19-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(26428,0)"><g transform="translate(-15,0)"><g transform="translate(0,-38)"><use xlink:href="#E19-MJMATHI-46" x="0" y="0"></use><use xlink:href="#E19-MJMATHI-50" x="749" y="0"></use><use xlink:href="#E19-MJMATHI-52" x="1500" y="0"></use><use xlink:href="#E19-MJMAIN-3D" x="2536" y="0"></use><g transform="translate(3314,0)"><g transform="translate(397,0)"><rect stroke="none" width="3342" height="60" x="0" y="220"></rect><g transform="translate(1171,676)"><use xlink:href="#E19-MJMAIN-30"></use><use xlink:href="#E19-MJMAIN-31" x="500" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="#E19-MJMAIN-30"></use><use xlink:href="#E19-MJMAIN-30" x="500" y="0"></use><use xlink:href="#E19-MJMAIN-2B" x="1222" y="0"></use><g transform="translate(2222,0)"><use xlink:href="#E19-MJMAIN-30"></use><use xlink:href="#E19-MJMAIN-31" x="500" y="0"></use></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">FPR=\frac{01}{00+01}\tag{4.7}</script></div></div><ul><li><strong><span>ROC曲线</span></strong></li></ul><p><span>ROC曲线，全称The Receiver Operating Characteristic Curve，译为受试者操作特性曲线。这是一条以不同阈值下的假正率FPR为横坐标，不同阈值下的真正率TPR为纵坐标的曲线。</span></p><p><span>我们在追求较高的TPR的时候，Precision会下降，就是说随着更多的少数类被捕捉出来，会有更多的多数类被判断错误，但我们很好奇，随着TPR的逐渐增加，模型将多数类判断错误的能力如何变化呢？我们希望理解，当我每判断正确一个少数类，就有多少个多数类会被判断错误。FPR正好可以帮助我们衡量这个能力的变化。相对的，Precision无法判断这些判断错误的多数类在全部多数类中究竟占多大的比例，所以无法在提升TPR的过程中也顾及到模型整体的Accuracy。因此，我们可以使用TPR和FPR之间的平衡，来替代TPR和Precision之间的平衡，让我们衡量模型在尽量捕捉少数类的时候，误伤多数类的情况如何变化，这就是我们的ROC曲线衡量的平衡。</span></p><ul><li><strong><span>算法效果评价流程</span></strong></li></ul><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart5" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="156" style="max-width: 1148.05px; height: 196px;" viewBox="0 0 1148.046875 156" class="md-require-zoom-fix"><style>#mermaidChart5{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart5 .error-icon{fill:#552222;}#mermaidChart5 .error-text{fill:#552222;stroke:#552222;}#mermaidChart5 .edge-thickness-normal{stroke-width:2px;}#mermaidChart5 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart5 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart5 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart5 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart5 .marker{fill:#333333;}#mermaidChart5 .marker.cross{stroke:#333333;}#mermaidChart5 svg{font-family:sans-serif;font-size:16px;}#mermaidChart5 .label{font-family:sans-serif;color:#333;}#mermaidChart5 .label text{fill:#333;}#mermaidChart5 .node rect,#mermaidChart5 .node circle,#mermaidChart5 .node ellipse,#mermaidChart5 .node polygon,#mermaidChart5 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart5 .node .label{text-align:center;}#mermaidChart5 .node.clickable{cursor:pointer;}#mermaidChart5 .arrowheadPath{fill:#333333;}#mermaidChart5 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart5 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart5 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart5 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart5 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart5 .cluster text{fill:#333;}#mermaidChart5 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart5:root{--mermaid-font-family:sans-serif;}#mermaidChart5:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart5 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M252,125.5L277,125.5L302,125.5" marker-end="url(#arrowhead218)" style="fill:none"></path><defs><marker id="arrowhead218" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M498,125.5L523,125.5L548,125.5" marker-end="url(#arrowhead219)" style="fill:none"></path><defs><marker id="arrowhead219" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;"><path class="path" d="M763.859375,125.5L836.859375,125.5L909.859375,125.5" marker-end="url(#arrowhead220)" style="fill:none"></path><defs><marker id="arrowhead220" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(836.859375,125.5)" style="opacity: 1;"><g transform="translate(-48,-12.5)" class="label"><rect rx="0" ry="0" width="96" height="25"></rect><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>确定最优参数</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-BB-146" transform="translate(130,30.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-90" y="-22.5" width="180" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-80,-12.5)"><foreignObject width="160" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">算法效果评价基本流程</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-147" transform="translate(130,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-122" y="-22.5" width="244" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-112,-12.5)"><foreignObject width="224" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">基于算法得到各项指标并可视化</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-149" transform="translate(400,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-98" y="-22.5" width="196" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-88,-12.5)"><foreignObject width="176" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">确定综合效果最佳的算法</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-151" transform="translate(655.9296875,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-107.9296875" y="-22.5" width="215.859375" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-97.9296875,-12.5)"><foreignObject width="195.859375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">优化模型,通过学习曲线调参</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-153" transform="translate(1024.953125,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-115.09375" y="-22.5" width="230.1875" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-105.09375,-12.5)"><foreignObject width="210.1875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">建立不同异常比例的ROC曲线</div></foreignObject></g></g></g></g></g></g></svg></div><h4 id='4234-案例分析电池分容容量与首次容量的异常检测'><span>4.2.3.4 案例分析：电池分容容量与首次容量的异常检测</span></h4><p>&nbsp;</p><p><span>对于锂电池循环测试来说，分容容量是未经过工步循环对电池进行充放电而得到放电容量，首次容量是经过首轮工步循环后对电池进行充放电而得到的放电容量。从之前的</span><a href='案例2 分容容量与首次容量的二元分布'><span>分布分析</span></a><span>和相关性分析章节中，其实样本电池的分容容量和首次容量应该是有着极强的正相关性的。但是实际在有些实验中，会出现分容容量和首次容量出现较大偏差的异常情况，来看下面这个业务场景：</span></p><p><span>憨厚的技术人员甲在进行电池循环测试数据整理时发现，有一些电池的分容容量和首次容量出现比较大的偏差，但是不能确定到底是因为非自然条件的异常（数据异常，人为失误、制造异常……），还是因为电池本身的特性所产生的自然异常。 为此叫来呆萌的技术人员乙进行讨论。</span></p><p><span>乙说：“有些样本的分容容量比首次容量小很多，有些样本却又大很多，该怎么判断电池是否异常呢？”</span></p><p><span>甲：“ 要不对分容容量和首次容量各自进行3σ检测，如果有电池的这两个变量都在3σ控制限外，就判定是异常。”</span></p><p><span>乙：“ 可是有些电池特性本身就是分容容量和首次容量偏差较大啊，你这样操作会把这些电池误认为是异常的”</span></p><p><span>甲：“ 那就找出工艺完全相同的电池来比对。&quot;</span></p><p><span>乙：”这也不太行啊，有些电池实验就做一次，没有对比数据。“</span></p><p><span>甲：”……&quot;</span></p><p><span>乙：“而且有些电池数据异常只体现在分容容量或首次容量其中之一，比如测试柜刚开始工作时，分容容量结果输出错误，但后面的首次容量又是正确的，如果这时采用两变量各自进行3σ检测然后判定两变量都落在3σ控制限外的样本为异常，会遗漏掉这种异常的。&quot;</span></p><p><span>甲：”……“</span></p><p>&nbsp;</p><p><span>上面的例子其实背后隐藏的问题就是：</span><b><mark><span>关联的多变量（不完全独立）样本在进行异常检测时，一般是无法从单变量是否异常来推论出样本是否异常的。</span></mark></b><span>那么就必须采用多维角度进行检测，下面就开始对</span><strong><span>电池样本数据中分容容量和首次容量存在异常的电池样本进行检测</span></strong><span>，实施过程如下：</span></p><ul><li><span>建模</span></li></ul><p><span>本案例将采用上面介绍的12种异常检测算法对数据异常进行检测。模型为调参，模型参数均为默认值。异常比例设置为2%，则异常数量=样本数量×异常比例，即2%×2659≈54。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 源代码太长，省略</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 23px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><ul><li><span>结果可视化和评价指标输出</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 评价指标结果</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> <span class="cm-variable">Principal</span> <span class="cm-variable">Component</span> <span class="cm-variable">Analysis</span> (<span class="cm-variable">PCA</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.978</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.463</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.463</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.011</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> <span class="cm-variable">Minimum</span> <span class="cm-variable">Covariance</span> <span class="cm-variable">Determinant</span> (<span class="cm-variable">MCD</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.985</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.630</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.630</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.008</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-variable">One</span><span class="cm-operator">-</span><span class="cm-keyword">class</span> <span class="cm-def">SVM</span> (<span class="cm-variable">OCSVM</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.988</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.704</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.704</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.006</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> <span class="cm-variable">Local</span> <span class="cm-variable">Outlier</span> <span class="cm-variable">Factor</span> (<span class="cm-variable">LOF</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.992</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.824</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.778</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.003</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">5</span> <span class="cm-variable">Cluster</span><span class="cm-operator">-</span><span class="cm-variable">based</span> <span class="cm-variable">Local</span> <span class="cm-variable">Outlier</span> <span class="cm-variable">Factor</span> (<span class="cm-variable">CBLOF</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.990</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.759</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.759</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.005</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6</span> <span class="cm-variable">K</span> <span class="cm-variable">Nearest</span> <span class="cm-variable">Neighbors</span> (<span class="cm-variable">KNN</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.986</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.682</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.556</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.005</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7</span> <span class="cm-variable">Average</span> <span class="cm-variable">KNN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.988</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.818</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.500</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.002</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">8</span> <span class="cm-variable">Angle</span><span class="cm-operator">-</span><span class="cm-variable">based</span> <span class="cm-variable">Outlier</span> <span class="cm-variable">Detector</span> (<span class="cm-variable">ABOD</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.982</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.557</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.630</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.010</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">9</span> <span class="cm-variable">Histogram</span><span class="cm-operator">-</span><span class="cm-variable">base</span> <span class="cm-variable">Outlier</span> <span class="cm-variable">Detection</span> (<span class="cm-variable">HBOS</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.984</span><span class="cm-variable">，精确度：1</span><span class="cm-number">.000</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.222</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">10</span> <span class="cm-variable">Isolation</span> <span class="cm-variable">Forest</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.981</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.537</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.537</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.010</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">11</span> <span class="cm-variable">Feature</span> <span class="cm-variable">Bagging</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.994</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.882</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.833</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.002</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-variable">Locally</span> <span class="cm-variable">Selective</span> <span class="cm-variable">Combination</span> (<span class="cm-variable">LSCP</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">准确率：0</span><span class="cm-number">.992</span><span class="cm-variable">，精确度：0</span><span class="cm-number">.815</span><span class="cm-variable">，真正率</span>: <span class="cm-number">0.815</span><span class="cm-variable">，假正率：0</span><span class="cm-number">.004</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 575px;"></div><div class="CodeMirror-gutters" style="display: none; height: 575px;"></div></div></div></pre><p><span>下面为各项指标的动态折线图，图中标记点为单个指标的最小/最大值，可以点击折线图右上区域的工具选项将折线图转化为柱状图，也可以点击 ’数据试图‘ 按钮查看具体数据。</span></p><iframe src="pyecharts/不同算法下的各项指标.html" height="650"></iframe><p>&nbsp;</p><iframe src="JS/二变量结果指标.html" height="420"></iframe><p>&nbsp;</p><p><span>下面这张图为各种算法在 [分容容量，首次容量] 二维空间的异常检测算法决策边界、异常得分梯度分布及算法结果，其中橙色区域为算法得出的正常值区域，红色虚线为算法的决策边界。</span></p><div align="center">
    <img src="figure/12中异常检测算法效果-5.png">
</div><p>&nbsp;</p><p><span>从上述各项结果来看，</span><strong><span>LOF、CBLOF、集成算法Feature Bagging 、LSCP能保证较高精确度的同时，也能保证真正率也较高。</span></strong><span>实际上后两种集成算法都是采用LOF作为基评估器的，这说明LOF在本案例中表现还是非常不错的，但值得注意的是Feature Bagging其实是一个模型框架，子模型可以用任何模型，比如KNN、HBOS等，因此效果还可以再提升。</span></p><ul><li><span>优化模型，调参</span></li></ul><p><span>为了让Feature Bagging 模型表现进一步提升，可以对模型进行调参工作，由于Feature 采用的是LOF基评估器，模型调参其实就是对LOF评估器进行调参。而LOF算法最重要的参数就是领域数k，为此以k为参数变量做Feature Bagging 关于k的学习曲线，结果如下：</span></p><iframe src="pyecharts/邻域k学习曲线.html" height="650"></iframe><p><span>可以看到，</span><strong><span>随着k的增大，模型的精确度和真正率呈现波动上升的趋势，并在k=60处，取得最大值，之后呈现缓慢下降的趋势。这意味着当邻域值k在60</span></strong><span>（因为是以5为间隔取值，所以可能是56~64之间的其它整数，可以进一步作学习曲线，限于篇幅，不作深入处理）</span><strong><span>左右时，Feature Bagging在案例数据中的异常检测效果最好。</span></strong></p><p><span>ROC曲线衡量模型在尽量捕捉少数类的时候，误伤多数类的情况如何变化。下面就将以调参后的Feature Bagging 模型设定的不同异常比例为调整阈值，做不同异常比例阈值下的ROC曲线。结果如下：</span></p><iframe src="pyecharts/异常检测ROC曲线1.html" height="650"></iframe><p><span>从ROC曲线可以看出，</span><strong><span>随着异常比例的提高，真正率迅速提高，假正率增长速度相比之下明显较低。当异常比例上升值2.5%后，真正率增长速度也明显放缓，至异常比例7%时，真正率达到100%，之后不随异常比例变化。</span></strong></p><p><span>现在，有了ROC曲线，了解了模型的分类效力，以及面对样本不均衡问题时的效力，那我们如何求解我们最佳的阈值呢？我们想要了解，什么样的状况下我们的模型的效果才是最好的。回到我们对ROC曲线的理解来：ROC曲线反应的是TPN增加的时候FPR如何变化，也就是当模型捕获少数类的能力变强的时候，会误伤多数类的情况是否严重。我们的希望是，模型在捕获少数类的能力变强的时候，尽量不误伤多数类，也就是说，随着TPN的变大，FPR 的大小越小越好。所以我们希望找到的最优点，其实是TPN和FPR差距最大的点。这个点，又叫做</span><strong><span>约登指数</span></strong><span>。在本案例的结果中，约登指数是在异常比例为2.5%时取得，此时</span><strong><span>约登指数=0.963-0.005=0.958</span></strong><span>，</span></p><p><span>这样最佳阈值就这样选取出来了，由于现在我们是使用异常比例来画ROC曲线，只要我们让模型选用此异常比例，模型表现就是最好的：</span><strong><span>即能够捕捉出少数类，又能够尽量不误伤多数类，整体的精确性和对少数类的捕捉都得到了保证。</span></strong></p><p><strong><span>但需要强调的是，此时算法标定的异常标签是利用数学模型得出的，并没有区分异常是自然异常还是非自然异常。对于锂电池测试，如果是自然异常，那就是实验本身的规律导致的，非自然异常是由于操作失误等其它需要纠正的因素导致的。所以在算法标定这些异常标签后，如果要进一步探究这些异常背后的产生原因，在数据样本存在不平衡的情况下（如本案例中的样本，很多实验组合的电芯数量太少，只有几个，样本分布不平衡），此时还需要进行人工介入调查；如果样本较为平衡，样本数量充足，就可以利用同维度横向比较（即比较相同材料组成，制造工艺，测试条件的电芯数据）来调查异常原因。</span></strong><span>这里由于篇幅限制就不作具体展开。</span></p><p>&nbsp;</p><h3 id='424-多变量异常检测'><span>4.2.4 多变量异常检测</span></h3><p><span>在实际数据挖掘和机器学习工作中，检测维度大于2维的多变量异常检测是异常检测的主要内容，毕竟在低维空间上无法体现机器学习的优势。虽然检测维度更大，但具体实施流程还是同二维异常检测一样，都是先建模标定异常标签再评估算法效果。但与二维异常检测不同的是，多维变量在可视化方面会比较困难，常需要其它一些处理手段。</span></p><h4 id='4241-案例分析量产lfp10370c2-200mah电池循环百分比容量的异常检测'><span>4.2.4.1 案例分析：量产LFP10370C2-200mAh电池循环百分比容量的异常检测</span></h4><p><strong><span>电池循环百分比容量是指相对于经历n次完整循环工步后的电池容量C</span><sub><span>n</span></sub><span>与经历首次完整循环工步后的电池容量C</span><sub><span>1</span></sub><span>之间的百分比</span></strong><span>，即:</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1436" cid="n1436" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="5.243ex" viewBox="0 -1364.4 59683.7 2257.2" role="img" focusable="false" style="vertical-align: -1.846ex; margin-bottom: -0.228ex; max-width: 100%;"><defs><path stroke-width="0" id="E20-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E20-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E20-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E20-MJMAIN-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path stroke-width="0" id="E20-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E20-MJMATHI-43" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path stroke-width="0" id="E20-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E20-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E20-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E20-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E20-MJMAIN-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path stroke-width="0" id="E20-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E20-MJMAIN-25" d="M465 605Q428 605 394 614T340 632T319 641Q332 608 332 548Q332 458 293 403T202 347Q145 347 101 402T56 548Q56 637 101 693T202 750Q241 750 272 719Q359 642 464 642Q580 642 650 732Q662 748 668 749Q670 750 673 750Q682 750 688 743T693 726Q178 -47 170 -52Q166 -56 160 -56Q147 -56 142 -45Q137 -36 142 -27Q143 -24 363 304Q469 462 525 546T581 630Q528 605 465 605ZM207 385Q235 385 263 427T292 548Q292 617 267 664T200 712Q193 712 186 709T167 698T147 668T134 615Q132 595 132 548V527Q132 436 165 403Q183 385 203 385H207ZM500 146Q500 234 544 290T647 347Q699 347 737 292T776 146T737 0T646 -56Q590 -56 545 0T500 146ZM651 -18Q679 -18 707 24T736 146Q736 215 711 262T644 309Q637 309 630 306T611 295T591 265T578 212Q577 200 577 146V124Q577 -18 647 -18H651Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-4.8" transform="translate(0,-87)"><use xlink:href="#E20-MJMAIN-28"></use><use xlink:href="#E20-MJMAIN-34" x="389" y="0"></use><use xlink:href="#E20-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E20-MJMAIN-38" x="1167" y="0"></use><use xlink:href="#E20-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(25606,0)"><g transform="translate(-15,0)"><g transform="translate(0,-87)"><use xlink:href="#E20-MJMATHI-43" x="0" y="0"></use><use xlink:href="#E20-MJMATHI-72" x="1010" y="0"></use><use xlink:href="#E20-MJMAIN-3D" x="1988" y="0"></use><g transform="translate(2766,0)"><g transform="translate(397,0)"><rect stroke="none" width="1980" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="#E20-MJMATHI-43" x="0" y="0"></use><use xlink:href="#E20-MJMATHI-6E" x="1010" y="0"></use></g><g transform="translate(110,-686)"><use xlink:href="#E20-MJMATHI-43" x="0" y="0"></use><use xlink:href="#E20-MJMAIN-31" x="1010" y="0"></use></g></g></g><use xlink:href="#E20-MJMAIN-D7" x="5486" y="0"></use><g transform="translate(6487,0)"><use xlink:href="#E20-MJMAIN-31"></use><use xlink:href="#E20-MJMAIN-30" x="500" y="0"></use><use xlink:href="#E20-MJMAIN-30" x="1000" y="0"></use></g><use xlink:href="#E20-MJMAIN-25" x="7987" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">C~r~=\frac{C~n~}{C~1~}\times100\%\tag{4.8}</script></div></div><p><strong><span>因为生产控制的波动，即使是同一批次的电池的循环容量也会存在一定的散布。对于电池的循环性能如果采用电池循环容量来衡量，就会出现偏差。所以为了更好地衡量电池在循环使用中的性能变化，采用循环百分比容量更为合适。理论上，如果同一批次的电池一致性较好，电池循环百分比容量曲线应该较为收束重叠。如果同一批次的电池之间出现百分比容量偏差较大的情况，就有可能是生产波动较大甚至是其它生产异常造成。为此，如果能对循环百分比容量进行异常检测，是有明确的现实意义的。</span></strong></p><ul><li><span>案例数据</span></li></ul><p><span>本案例数据采用生产批次，测试温度均为25℃，生产批次为：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.25px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-string">'AP2045B13'</span>, <span class="cm-string">'AP2045C19'</span>, <span class="cm-string">'AP2045E27'</span>, <span class="cm-string">'AP2048A09'</span>, <span class="cm-string">'AP2048B12'</span>, <span class="cm-string">'AP2048D14'</span>, <span class="cm-string">'AP2048C13'</span>, <span class="cm-string">'AP2048E15'</span>, <span class="cm-string">'AP2048F15'</span>, <span class="cm-string">'AP2048G16'</span>, <span class="cm-string">'AP2048H17'</span>, <span class="cm-string">'AP2048I18'</span>, <span class="cm-string">'AP2050A08'</span>, <span class="cm-string">'AP2050C10'</span>, <span class="cm-string">'AP2050D10'</span>, <span class="cm-string">'AP2050E11'</span>, <span class="cm-string">'AP2050F11'</span>, <span class="cm-string">'AP2050G12'</span>, <span class="cm-string">'AP2050H12'</span>, <span class="cm-string">'AP2050I13'</span>, <span class="cm-string">'AP2050J14'</span>, <span class="cm-string">'AP2050K15'</span>, <span class="cm-string">'AP2051A11'</span>, <span class="cm-string">'AP2051B12'</span>, <span class="cm-string">'AP2051C'</span>, <span class="cm-string">'AP2051D'</span>]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 69px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p><span>样本构成：</span></p><iframe src="pyecharts/量产批次柱状图.html" height="930"></iframe><p>&nbsp;</p><p>&nbsp;</p><iframe src="pyecharts/多维异常检测指标1.html" height="640"></iframe><p>&nbsp;</p><iframe src="JS/多变量结果指标.html" height="420"></iframe><p>&nbsp;</p><p>&nbsp;</p><div align="center">
    <img src="figure/PCA空间2.png">
</div><p>&nbsp;</p><p>&nbsp;</p><div align="center">
<iframe src="pyecharts/百分比容量异常检测_random.html" height="640"></iframe>
</div><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h1 id='5-特征工程'><span>5. 特征工程</span></h1><p><span>有这么一句话在业界广泛流传：</span><strong><span>对于一个机器学习问题，数据和特征决定了机器学习的上限，而模型和算法只是逼近这个上限而已。</span></strong><span>特征工程指的是把原始数据转变为模型的训练数据的过程，它的目的就是获取更好的训练数据特征，使得机器学习模型逼近这个上限。</span></p><p><span>特征工程，顾名思义，是对原始数据进行一系列工程处理，将其提炼为特征，作为输入供算法和模型使用。从本质上来讲，特征工程是一个表示和展现数据的过程。在实际工作中，特征工程旨在去除原始数据中的杂质和冗余，设计更高效的特征以刻画求解的问题与预测模型之间的关系。</span></p><p><span>对于机器学习领域，特征工程其实没有严格的定义和范围。一般狭义上的特征工程是指：</span></p><ul><li><span>特征选择</span></li><li><span>特征提取</span></li><li><span>特征构建</span></li></ul><p><span>广义上的特征工程除了上面三个核心内容外，也包括前面章节所介绍的数据特征分析、缺失值分析、异常值检测，还有下面要介绍的数据预处理过程。如果用思维导图来展示，如下：</span></p><div align="center">
    <img src="pic/特征工程.jpg">
</div><p>&nbsp;</p><h2 id='51-特征工程在电池领域的应用'><span>5.1 特征工程在电池领域的应用</span></h2><p><span>任何一种工业品的背后，肯定有着非常繁复的上下游产业、部件构成、工艺流程等。比如一部手机，它就涉及了液晶面板、PCB、芯片、塑料/金属外壳、锂电池等诸多部件，而每种部件又有着自身的部件构成、工艺流程，任何一项细节都会对最终手机性能产生影响；同时不同部件间如何配合，如何进行体系构建也会对手机最终性能产生极大影响。如果对手机这个工业品进行机器学习建模，将最终性能（可以是运行流程度、游戏性能……）当做是最终要预测的标签，那么这些繁复的部件参数、工艺参数就是特征输入。同样的，对于锂电池而言，如果将电池最终性能看做是标签，那么正极材料、负极材料……这些材料构成就是特征的一部分，这些材料的性能参数、之间的配比、组合（如正负极颗粒度、注液量、N/P比……）也是特征组成；同时生产过程中的工艺控制参数（如生产环境湿度、电芯烘烤时间、老化参数……）和电池产品最终的使用环境（如温度、充放电条件……）也是特征组成部分。</span></p><h3 id='511-特征困境'><span>5.1.1 特征困境</span></h3><ul><li><span>维度灾难和成本</span></li></ul><p><span>可以想象，特征数量（即特征维度）如果十分庞大，不仅对于人类而言无法处理，对于机器来讲，也有相当的困难，这就会出现所谓的</span><strong><span>维度灾难</span></strong><span>。另外，一项特征意味着一项数据采集、数据录入过程，比如，如果将制造过程中的环境湿度作为一项特征，那么就需要对应的湿度传感器进行数据采集，也需要机器或人工的数据录入过程，</span><strong><span>越多的特征维度意味越高的成本（设备成本、时间成本、人力成本……）</span></strong><span>。</span></p><ul><li><span>特征有效性</span></li></ul><p><span>除了维度灾难和成本考量之外，还有一个很明显的问题就是，千辛万苦所获得的特征对于模型构建是否有效。通过前期数据收集清洗所获得的特征数据，最终是要能在标签预测上有所贡献才行，否则就是无效的特征，比如重复冗余的特征，实际上只需选择一项即可，对于贡献度极低的特征也可以选择性的舍弃。甚至有些特征是</span><strong><span>有害的</span></strong><span>，这些有害特征不仅不能为模型提供有效数据，反而有可能导致模型精度下降和模型失效。举一个不是锂电池行业的例子，如果我们要通过各项特征来预测一个人的消费能力，此时如果将这个人的收入水平当作是特征，显然是十分合理的，因为消费能力的基础就是这个的财力水平，总不可能月入3000，天天五星级酒店（极端例子不考虑）；但如果将这个人的身高当作是特征，显然是值得商榷的，毕竟高个子不见得个个都是高富帅，也可以是身无分文的穷光蛋，矮个子也可以是一掷千金的土豪。</span></p><p><strong><span>所以如何判断特征有效性，就是机器学习的核心重点。</span></strong></p><h3 id='512-特征工程对于电池设计的重要性'><span>5.1.2 特征工程对于电池设计的重要性</span></h3><p><span>作为电池技术人员，特别是电池设计人员，我们平时所要面对的</span><strong><span>核心问题就是如何选取有效的设计参数，来获得理想的电池。</span></strong><span>从长远来看，更为深刻的问题是</span><strong><span>如何了解电池背后的规律，进而利用规律展开有效工作。</span></strong><span>显然，这种规律更多的是经验总结，比如通过不同组的交叉实验知道哪些参数对于最终性能的影响大概是怎么样的。传统的做法：</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart6" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="108.5" style="max-width: 841.859px; height: 148.5px;" viewBox="0 0 841.859375 108.5" class="md-require-zoom-fix"><style>#mermaidChart6{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart6 .error-icon{fill:#552222;}#mermaidChart6 .error-text{fill:#552222;stroke:#552222;}#mermaidChart6 .edge-thickness-normal{stroke-width:2px;}#mermaidChart6 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart6 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart6 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart6 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart6 .marker{fill:#333333;}#mermaidChart6 .marker.cross{stroke:#333333;}#mermaidChart6 svg{font-family:sans-serif;font-size:16px;}#mermaidChart6 .label{font-family:sans-serif;color:#333;}#mermaidChart6 .label text{fill:#333;}#mermaidChart6 .node rect,#mermaidChart6 .node circle,#mermaidChart6 .node ellipse,#mermaidChart6 .node polygon,#mermaidChart6 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart6 .node .label{text-align:center;}#mermaidChart6 .node.clickable{cursor:pointer;}#mermaidChart6 .arrowheadPath{fill:#333333;}#mermaidChart6 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart6 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart6 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart6 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart6 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart6 .cluster text{fill:#333;}#mermaidChart6 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart6:root{--mermaid-font-family:sans-serif;}#mermaidChart6:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart6 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M156,43.00954198473282L213,30.5L270,30.5" marker-end="url(#arrowhead246)" style="fill:none"></path><defs><marker id="arrowhead246" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M354,30.5L460.9296875,30.5L567.859375,30.5" marker-end="url(#arrowhead247)" style="fill:none"></path><defs><marker id="arrowhead247" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;"><path class="path" d="M651.859375,30.5L676.859375,30.5L701.859375,38.39835164835165" marker-end="url(#arrowhead248)" style="fill:none"></path><defs><marker id="arrowhead248" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-A" id="L-E-A" style="opacity: 1;"><path class="path" d="M701.859375,80.10164835164835L676.859375,88L609.859375,88L460.9296875,88L312,88L213,88L156,75.49045801526718" marker-end="url(#arrowhead249)" style="fill:none"></path><defs><marker id="arrowhead249" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(213,30.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>获得数据</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(460.9296875,30.5)" style="opacity: 1;"><g transform="translate(-81.9296875,-12.5)" class="label"><rect rx="0" ry="0" width="163.859375" height="25"></rect><foreignObject width="163.859375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>数据可视化,数据计算等</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(460.9296875,88)" style="opacity: 1;"><g transform="translate(-21.96875,-12.5)" class="label"><rect rx="0" ry="0" width="43.9375" height="25"></rect><foreignObject width="43.9375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>PCDA</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-159" transform="translate(82,59.25)" style="opacity: 1;"><rect rx="0" ry="0" x="-74" y="-22.5" width="148" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-64,-12.5)"><foreignObject width="128" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">利用经验设计实验</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-160" transform="translate(312,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据整理</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-161" transform="translate(609.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据分析</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-162" transform="translate(767.859375,59.25)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">获得阶段性结论</div></foreignObject></g></g></g></g></g></g></svg></div><p><span>在上面的流程中，有一个比较明显的问题是如何在保证结论正确的前提下，提取有效特征。如果按照传统的做法流程，其实是比较难实现的，因为多维度特征之间可能存在相关性，无法简单的割裂来看待。举个例子，某实验设计人员甲设计了一组实验，如下：</span></p><figure><table><thead><tr><th><span>实验编号</span></th><th><span>电解液</span></th><th><span>正极</span></th><th><span>负极</span></th><th><span>隔膜</span></th><th><span>测试温度</span></th><th><span>测试工步</span></th><th><span>注液量</span></th><th><span>最终性能</span></th></tr></thead><tbody><tr><td><span>1</span></td><td><span>E</span><sub><span>1</span></sub></td><td><span>P</span><sub><span>1</span></sub></td><td><span>N</span><sub><span>1</span></sub></td><td><span>S</span><sub><span>1</span></sub></td><td><span>T</span><sub><span>1</span></sub><span>，T</span><sub><span>2</span></sub><span>，T</span><sub><span>3</span></sub></td><td><span>G</span><sub><span>1</span></sub><span>，G</span><sub><span>2</span></sub><span>，G</span><sub><span>3</span></sub></td><td><span>Z</span><sub><span>1</span></sub></td><td><span>X</span><sub><span>1</span></sub><sup><span>1</span></sup><span>，X</span><sub><span>2</span></sub><sup><span>1</span></sup><span>,……</span></td></tr><tr><td><span>2</span></td><td><span>E</span><sub><span>1</span></sub></td><td><span>P</span><sub><span>1</span></sub></td><td><span>N</span><sub><span>2</span></sub></td><td><span>S</span><sub><span>1</span></sub></td><td><span>T</span><sub><span>1</span></sub><span>，T</span><sub><span>2</span></sub><span>，T</span><sub><span>3</span></sub></td><td><span>G</span><sub><span>1</span></sub><span>，G</span><sub><span>2</span></sub><span>，G</span><sub><span>3</span></sub></td><td><span>Z</span><sub><span>2</span></sub></td><td><span>X</span><sub><span>1</span></sub><sup><span>2</span></sup><span>，X</span><sub><span>2</span></sub><sup><span>2</span></sup><span>,……</span></td></tr><tr><td><span>3</span></td><td><span>E</span><sub><span>2</span></sub></td><td><span>P</span><sub><span>1</span></sub></td><td><span>N</span><sub><span>1</span></sub></td><td><span>S</span><sub><span>1</span></sub></td><td><span>T</span><sub><span>1</span></sub><span>，T</span><sub><span>2</span></sub><span>，T</span><sub><span>3</span></sub></td><td><span>G</span><sub><span>1</span></sub><span>，G</span><sub><span>2</span></sub><span>，G</span><sub><span>3</span></sub></td><td><span>Z</span><sub><span>3</span></sub></td><td><span>X</span><sub><span>1</span></sub><sup><span>3</span></sup><span>，X</span><sub><span>2</span></sub><sup><span>3</span></sup><span>,……</span></td></tr><tr><td><span>4</span></td><td><span>E</span><sub><span>2</span></sub></td><td><span>P</span><sub><span>1</span></sub></td><td><span>N</span><sub><span>2</span></sub></td><td><span>S</span><sub><span>1</span></sub></td><td><span>T</span><sub><span>1</span></sub><span>，T</span><sub><span>2</span></sub><span>，T</span><sub><span>3</span></sub></td><td><span>G</span><sub><span>1</span></sub><span>，G</span><sub><span>2</span></sub><span>，G</span><sub><span>3</span></sub></td><td><span>Z</span><sub><span>4</span></sub></td><td><span>X</span><sub><span>1</span></sub><sup><span>4</span></sup><span>，X</span><sub><span>2</span></sub><sup><span>4</span></sup><span>,……</span></td></tr></tbody></table></figure><p><span>假设实验设计合理，实验过程也比较顺利，没有其它因素干扰。那么现在有一个任务，</span><strong><span>找出这些特征中的主要影响特征，并在尽可能少的验证实验组合下，找出最优实验组合</span></strong><span>。</span></p><p><span>甲（嘀咕）：“ 要找出主要影响特征，理论上只能选取1个特征F1，固定其它N-1维特征，然后比较选取的这个特征的不同水平下电池最终性能结果，看不同水平下电池性能的差异情况 ，差异越大，影响程度越高。单方差分析或许可以用在这里。可这样操作效率太低，对数据方差齐性也有要求，况且无法横向比较不同特征的影响因子。”</span></p><p><span>甲（犯难）：“ 怎么横向比较不同特征之间的影响因子呢？多因子方差分析吗？可是很难保证方差齐性，况且特征太多，多因子方差操作太过于复杂。“</span></p><p><span>甲：“ 看来只能通过可视化结果，大概判断一个优化组合区间，然后再设计交叉验证了。”</span></p><p><span>上面的例子其实反映出传统电池设计的一些困境：</span></p><ul><li><strong><span>实验设计方向主要以经验判断为准，受主观判断较大，没有很好的工具支撑。</span></strong></li><li><strong><span>实验数据复用性较差，往往没有得到充分利用。碰到一个新任务，设计一套新实验，一方面效率比较低，实验成本高，另一方面实验数据没有得到充分挖掘和二次利用。</span></strong></li><li><strong><span>实验结论往往以经验概括收尾，没有很好的工具进行再拓展。</span></strong></li><li><strong><span>实验结论在多维特征空间推广性很差。</span></strong></li></ul><p>&nbsp;</p><p><span>上面的这些问题，通过机器学习的手段可以有进一步提升的空间。</span><strong><span>特别是特征工程，它能通过模型结果，告诉设计人员特征对于最终结果的影响大小，特征对于结果的影响趋势等这些非常重要的结论，通过这些结论，在实验设计时，就可以针对重要特征进行设计，做到有的放矢，降低实验成本，提高实验效率，同时能为实验设计人员提供理论依据，使其更好地总结电池规律，这对于电池设计来讲，是非常有帮助的。</span></strong></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart7" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="121" style="max-width: 991.859px; height: 161px;" viewBox="0 0 991.859375 121" class="md-require-zoom-fix"><style>#mermaidChart7{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart7 .error-icon{fill:#552222;}#mermaidChart7 .error-text{fill:#552222;stroke:#552222;}#mermaidChart7 .edge-thickness-normal{stroke-width:2px;}#mermaidChart7 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart7 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart7 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart7 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart7 .marker{fill:#333333;}#mermaidChart7 .marker.cross{stroke:#333333;}#mermaidChart7 svg{font-family:sans-serif;font-size:16px;}#mermaidChart7 .label{font-family:sans-serif;color:#333;}#mermaidChart7 .label text{fill:#333;}#mermaidChart7 .node rect,#mermaidChart7 .node circle,#mermaidChart7 .node ellipse,#mermaidChart7 .node polygon,#mermaidChart7 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart7 .node .label{text-align:center;}#mermaidChart7 .node.clickable{cursor:pointer;}#mermaidChart7 .arrowheadPath{fill:#333333;}#mermaidChart7 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart7 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart7 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart7 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart7 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart7 .cluster text{fill:#333;}#mermaidChart7 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart7:root{--mermaid-font-family:sans-serif;}#mermaidChart7:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart7 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M156,45.729007633587784L213,30.5L270,30.5" marker-end="url(#arrowhead283)" style="fill:none"></path><defs><marker id="arrowhead283" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M354,30.5L460.9296875,30.5L567.859375,30.5" marker-end="url(#arrowhead284)" style="fill:none"></path><defs><marker id="arrowhead284" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;"><path class="path" d="M651.859375,30.5L676.859375,30.5L701.859375,30.5" marker-end="url(#arrowhead285)" style="fill:none"></path><defs><marker id="arrowhead285" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;"><path class="path" d="M785.859375,30.5L842.859375,30.5L899.859375,50.651515151515156" marker-end="url(#arrowhead286)" style="fill:none"></path><defs><marker id="arrowhead286" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-A" id="L-F-A" style="opacity: 1;"><path class="path" d="M899.859375,80.34848484848484L842.859375,100.5L743.859375,100.5L676.859375,100.5L609.859375,100.5L460.9296875,100.5L312,100.5L213,100.5L156,85.27099236641222" marker-end="url(#arrowhead287)" style="fill:none"></path><defs><marker id="arrowhead287" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(213,30.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>获得数据</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(460.9296875,30.5)" style="opacity: 1;"><g transform="translate(-81.9296875,-12.5)" class="label"><rect rx="0" ry="0" width="163.859375" height="25"></rect><foreignObject width="163.859375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>数据可视化,数据计算等</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(842.859375,30.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>特征优化</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(609.859375,100.5)" style="opacity: 1;"><g transform="translate(-21.96875,-12.5)" class="label"><rect rx="0" ry="0" width="43.9375" height="25"></rect><foreignObject width="43.9375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>PDCA</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-171" transform="translate(82,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-74" y="-22.5" width="148" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-64,-12.5)"><foreignObject width="128" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">利用经验设计实验</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-172" transform="translate(312,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据整理</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-173" transform="translate(609.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据分析</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-174" transform="translate(743.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">特征工程</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-175" transform="translate(941.859375,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">优化实验</div></foreignObject></g></g></g></g></g></g></svg></div><p><span>其实，特征工程在电池领域要回答的问题就是：</span></p><ul><li><span>哪些特征在模型里是最重要的？即哪个特征对电池性能的影响最大？</span></li><li><span>从大量的记录整体来考虑，每一个特征如何影响模型的预测的？即对于所有模型里的电池数据，每个特征是如何影响最终结果的？</span></li><li><span>关于某一条记录的预测，每一个特征是如何影响到最终的预测结果的？即对于某一个具体电池，每个特征对其结果会有怎样的影响？</span></li></ul><p><span>最终，特征工程可以帮助技术人员：</span></p><ul><li><span>调试模型</span></li><li><span>指导工程师做特征工程</span></li><li><span>指导数据采集的方向</span></li><li><span>指导人们做决策</span></li><li><span>建立模型和人之间的信任</span></li></ul><h2 id='52-数据预处理'><span>5.2 数据预处理</span></h2><p><span>通过特征提取，我们能得到未经处理的特征，这时的特征可能有以下问题：</span></p><ul><li><strong><span>不属于同一量纲</span></strong><span>：即特征的规格不一样，不能够放在一起比较。就需要对数据进行</span><strong><span>无量纲化</span></strong><span>处理。</span></li><li><strong><span>信息冗余</span></strong><span>：对于某些定量特征，其包含的有效信息为区间划分，例如学习成绩，假若只关心“及格”或不“及格”，那么需要将定量的考分，转换成“1”和“0”表示及格和未及格。二值化可以解决这一问题。</span></li><li><strong><span>定性特征不能直接使用</span></strong><span>：某些机器学习算法和模型只能接受定量特征的输入，那么需要将定性特征转换为定量特征。最简单的方式是为每一种定性值指定一个定量值，但是这种方式过于灵活，增加了调参的工作。通常使用</span><strong><span>one-hot编码（也称哑变量编码）</span></strong><span>的方式将定性特征转换为定量特征：假设有N种定性值，则将这一个特征扩展为N种特征，当原始特征值为第i种定性值时，第i个扩展特征赋值为1，其他扩展特征赋值为0。哑编码的方式相比直接指定的方式，不用增加调参的工作，对于线性模型来说，使用哑编码后的特征可达到非线性的效果。</span></li><li><strong><span>缺失值</span></strong><span>：缺失值需要填补，具体可参照上章 </span><a href='#4.1 缺失值分析'><span> 4.1 缺失值分析</span></a><span>。</span></li><li><strong><span>信息利用率低</span></strong><span>：不同的机器学习算法和模型对数据中信息的利用是不同的，之前提到在线性模型中，使用对定性特征哑编码可以达到非线性的效果。类似地，对定量变量多项式化，或者进行其他的转换，都能达到非线性的效果。（对数据的处理不仅局限于特征，有时也会对标签进行处理）</span></li></ul><p><span>数据预处理的基本内容和方法如下所示：</span></p><div align="center">
<img src="pic/数据预处理4.png">
</div><p>&nbsp;</p><p>&nbsp;</p><h3 id='521-无量纲化'><span>5.2.1 无量纲化</span></h3><p><span>在机器学习算法实践中，我们往往有着将不同规格的数据转换到同一规格，或不同分布的数据转换到某个特定分布的需求，这种需求统称为将数据“无量纲化”。譬如梯度和矩阵为核心的算法中，譬如逻辑回归，支持向量机，神经网络，无量纲化可以加快求解速度；而在距离类模型，譬如K近邻，K-Means聚类中，无量纲化可以帮我们提升模型精度，避免某一个取值范围特别大的特征对距离计算造成影响。（一个特例是决策树和树的集成算法们，对决策树我们不需要无量纲化，决策树可以把任意数据都处理得很好。）</span></p><p><span>数据的无量纲化可以是线性的，也可以是非线性的。线性的无量纲化包括</span><strong><span>标准化、归一化、区间缩放</span></strong><span>等。</span></p><h4 id='5211-标准化z-score-标准化）'><span>5.2.1.1 标准化（Z-Score 标准化）</span></h4><p><span>当数据(x)按均值(μ)中心化后，再按标准差(σ)缩放，数据就会服从为均值为0，方差为1的正态分布（即标准正态分布），而这个过程，就叫做</span><strong><span>数据标准化</span></strong><span>(Standardization，又称Z-score 标准化)，公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1604" cid="n1604" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="5.851ex" viewBox="0 -1521.6 59683.7 2519.2" role="img" focusable="false" style="vertical-align: -2.146ex; margin-bottom: -0.171ex; max-width: 100%;"><defs><path stroke-width="0" id="E21-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E21-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E21-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E21-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E21-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E21-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E21-MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path stroke-width="0" id="E21-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E21-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E21-MJMATHI-3BC" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z"></path><path stroke-width="0" id="E21-MJMATHI-3C3" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.1" transform="translate(0,-88)"><use xlink:href="#E21-MJMAIN-28"></use><use xlink:href="#E21-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E21-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E21-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E21-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(27033,0)"><g transform="translate(-15,0)"><g transform="translate(0,-88)"><use transform="scale(1.2)" xlink:href="#E21-MJMATHI-78" x="0" y="0"></use><g transform="translate(686,495)"><use transform="scale(0.6)" xlink:href="#E21-MJMAIN-2032" x="0" y="513"></use></g><use transform="scale(1.2)" xlink:href="#E21-MJMAIN-3D" x="1157" y="0"></use><g transform="translate(2323,0)"><g transform="translate(477,0)"><rect stroke="none" width="3020" height="72" x="0" y="264"></rect><g transform="translate(72,811)"><use transform="scale(1.2)" xlink:href="#E21-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E21-MJMAIN-2212" x="794" y="0"></use><use transform="scale(1.2)" xlink:href="#E21-MJMATHI-3BC" x="1794" y="0"></use></g><use transform="scale(1.2)" xlink:href="#E21-MJMATHI-3C3" x="973" y="-686"></use></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-21">\large x^{'}=\frac{x-μ}{σ}\tag{5.1}</script></div></div><p><span>如果数值特征列中存在数值极大或极小的 outlier（通过 </span><a href='#4.2 异常检测'><span>异常检测</span></a><span> 发现），应该使用更稳健（robust）的统计数据：用</span><strong><span>中位数</span></strong><span>而不是算术平均数，用</span><strong><span>分位数</span></strong><span>（quantile）而不是方差。这种标准化方法有一个重要的参数：（分位数下限，分位数上限），最好通过 </span><a href='#4.2 异常检测'><span>异常检测</span></a><span> 的数据可视化确定。通过这样处理，可以使标准化的结果免疫 outlier。</span></p><h4 id='5212-归一化min-max-缩放）'><span>5.2.1.2 归一化（Min-Max 缩放）</span></h4><p><span>当数据(x)按照最小值中心化后，再按极差（最大值 - 最小值）缩放，数据移动了最小值个单位，并且会被收敛到[0,1]之间，而这个过程，就叫做</span><strong><span>数据归一化(Normalization，又称Min-Max Scaling)</span></strong><span>，公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1608" cid="n1608" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="7.068ex" viewBox="0 -1783.6 59683.7 3043.2" role="img" focusable="false" style="vertical-align: -2.926ex; max-width: 100%;"><defs><path stroke-width="0" id="E22-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E22-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E22-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E22-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E22-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E22-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E22-MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path stroke-width="0" id="E22-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E22-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E22-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E22-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E22-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E22-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.2" transform="translate(0,-50)"><use xlink:href="#E22-MJMAIN-28"></use><use xlink:href="#E22-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E22-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E22-MJMAIN-32" x="1167" y="0"></use><use xlink:href="#E22-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(23837,0)"><g transform="translate(-15,0)"><g transform="translate(0,-50)"><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-78" x="0" y="0"></use><g transform="translate(686,495)"><use transform="scale(0.6)" xlink:href="#E22-MJMAIN-2032" x="0" y="513"></use></g><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-3D" x="1157" y="0"></use><g transform="translate(2323,0)"><g transform="translate(477,0)"><rect stroke="none" width="9413" height="72" x="0" y="264"></rect><g transform="translate(1726,839)"><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-2212" x="794" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-6D" x="1794" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-69" x="2672" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-6E" x="3017" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-28" x="3617" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-78" x="4006" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-29" x="4578" y="0"></use></g><g transform="translate(72,-840)"><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-6D" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-61" x="878" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-78" x="1407" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-28" x="1978" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-78" x="2367" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-29" x="2939" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-2212" x="3551" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-6D" x="4551" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-69" x="5429" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-6E" x="5774" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-28" x="6374" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMATHI-78" x="6763" y="0"></use><use transform="scale(1.2)" xlink:href="#E22-MJMAIN-29" x="7335" y="0"></use></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-22">\large x^{'}=\frac{x-min(x)}{max(x)-min(x)}\tag{5.2}</script></div></div><p><span>注：此处的归一化是区间缩放的一种，依照特征矩阵的</span><strong><span>列</span></strong><span>处理数据，即处理的同一列（即同一特征）的数据。要跟下面的样本归一化区分开。</span></p><h4 id='5213-区间缩放'><span>5.2.1.3 区间缩放</span></h4><p><span>区间缩放法有多种，比如上面的标准化和Min-Max缩放其实都是常见的区间缩放的方法。实际上区间缩放是包含两个操作步骤的：</span></p><ol start='' ><li><p><span>区间平移</span></p><p><span>就是对特征中的每一个数据同时加减某一固定值，比如标准化是减去平均值μ，而归一化是减去最小值min(x)。</span></p></li><li><p><span>区间缩放</span></p><p><span>将平移的后数据同时乘除某一固定值（即线性放大或缩小），比如标准化是除以标准差σ，而归一化是除以区间宽度（即最大值-最小值）。</span></p></li></ol><p><span>区间缩放（包括标准化和归一化）其实是线性变换，当然区间缩放还有无数种变形，只要选取不同的平移大小和缩放倍数即可。下面要介绍的另一种区间缩放方法，</span><strong><span>绝对最大值缩放（Max Absolute Scaling)</span></strong><span>。</span></p><p><span>数据不经过区间平移，直接按特征中绝对值的最大值进行缩放，数据就会被收敛到 [-a, b] (</span><span class='math-in-toc'>$ a,b\in [0,1]$</span><span>, 且a,b中至少有一个是1）之间，这个过程就是绝对最大值缩放，公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1621" cid="n1621" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="6.094ex" viewBox="0 -1574 59683.7 2624" role="img" focusable="false" style="vertical-align: -2.439ex; max-width: 100%;"><defs><path stroke-width="0" id="E23-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E23-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E23-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E23-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E23-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E23-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E23-MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path stroke-width="0" id="E23-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E23-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E23-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E23-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.3" transform="translate(0,148)"><use xlink:href="#E23-MJMAIN-28"></use><use xlink:href="#E23-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E23-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E23-MJMAIN-33" x="1167" y="0"></use><use xlink:href="#E23-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(26140,0)"><g transform="translate(-15,0)"><g transform="translate(0,148)"><use transform="scale(1.2)" xlink:href="#E23-MJMATHI-78" x="0" y="0"></use><g transform="translate(686,495)"><use transform="scale(0.6)" xlink:href="#E23-MJMAIN-2032" x="0" y="513"></use></g><use transform="scale(1.2)" xlink:href="#E23-MJMAIN-3D" x="1157" y="0"></use><g transform="translate(2323,0)"><g transform="translate(477,0)"><rect stroke="none" width="4806" height="72" x="0" y="264"></rect><use transform="scale(1.2)" xlink:href="#E23-MJMATHI-78" x="1716" y="676"></use><g transform="translate(72,-840)"><use transform="scale(1.2)" xlink:href="#E23-MJMATHI-6D" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E23-MJMATHI-61" x="878" y="0"></use><use transform="scale(1.2)" xlink:href="#E23-MJMATHI-78" x="1407" y="0"></use><use transform="scale(1.2)" xlink:href="#E23-MJMAIN-28" x="1978" y="0"></use><use transform="scale(1.2)" xlink:href="#E23-MJMAIN-7C" x="2367" y="0"></use><use transform="scale(1.2)" xlink:href="#E23-MJMATHI-78" x="2645" y="0"></use><use transform="scale(1.2)" xlink:href="#E23-MJMAIN-7C" x="3217" y="0"></use><use transform="scale(1.2)" xlink:href="#E23-MJMAIN-29" x="3496" y="0"></use></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">\large x^{'}=\frac{x}{max(|x|)}\tag{5.3}</script></div></div><p><span>区间缩放在进行区间平移时，是有可能引入0数值的（当减去的固定值等于数据值时），这样就有可能破坏数据的稀疏性。数据的稀疏性是指数据中包含 0 的比例。当在希望压缩数据，却不影响数据的稀疏性时（不影响矩阵中取值为0的个数时），就可以使用Max Absolute Scaling，因为绝对最大值缩放并没有进行平移操作。</span></p><h4 id='5214-样本归一化'><span>5.2.1.4 样本归一化</span></h4><p><span>把每一行数据（即单个样本的不同特征值）归一化，缩放到单位范数上，使得整个样本（整个向量）的长度都为单位向量长度。范数的种类可以选 L</span><sub><span>1</span></sub><span>范数（向量中所有元素绝对值之和，即曼哈顿距离）、L</span><sub><span>2</span></sub><span>范数（向量或矩阵的元素平方和开根号，即欧式距离） 或 L</span><sub><span>∞</span></sub><span>（即向量中元素数值绝对值的最大值，即切比雪夫距离）。 样本归一化对</span><strong><span>异常值</span></strong><span>敏感。公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1625" cid="n1625" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="13.032ex" viewBox="0 -3041.2 59683.7 5610.8" role="img" focusable="false" style="vertical-align: -5.774ex; margin-bottom: -0.194ex; max-width: 100%;"><defs><path stroke-width="0" id="E24-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E24-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E24-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E24-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E24-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E24-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E24-MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path stroke-width="0" id="E24-MJMAIN-2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E24-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E24-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E24-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E24-MJMATHI-70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path stroke-width="0" id="E24-MJMAIN-3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E24-MJMATHI-4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path stroke-width="0" id="E24-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E24-MJMATHI-50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.4" transform="translate(0,945)"><use xlink:href="#E24-MJMAIN-28"></use><use xlink:href="#E24-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E24-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E24-MJMAIN-34" x="1167" y="0"></use><use xlink:href="#E24-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(23849,0)"><g transform="translate(-15,0)"><g transform="translate(0,945)"><g transform="translate(96,0)"><use transform="scale(1.44)" xlink:href="#E24-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E24-MJMAIN-2032" x="808" y="583"></use></g><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-2192" x="0" y="906"></use><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-3D" x="1277" y="0"></use><g transform="translate(2960,0)"><g transform="translate(572,0)"><rect stroke="none" width="3253" height="86" x="0" y="316"></rect><g transform="translate(1215,974)"><use transform="scale(1.44)" xlink:href="#E24-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-20D7" x="540" y="12"></use></g><g transform="translate(86,-988)"><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-7C" x="278" y="0"></use><g transform="translate(800,0)"><use transform="scale(1.44)" xlink:href="#E24-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-20D7" x="540" y="12"></use></g><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-7C" x="1128" y="0"></use><g transform="translate(2024,0)"><use transform="scale(1.44)" xlink:href="#E24-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E24-MJMATHI-70" x="393" y="-403"></use></g></g></g></g><g transform="translate(0,-2926)"><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-7C" x="278" y="0"></use><g transform="translate(667,0)"><use transform="scale(1.2)" xlink:href="#E24-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-20D7" x="544" y="-2"></use></g><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-7C" x="1128" y="0"></use><g transform="translate(1687,0)"><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E24-MJMATHI-70" x="393" y="-403"></use></g><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-3A" x="2417" y="0"></use><g transform="translate(3567,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">向</text></g><g transform="translate(4546,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">量</text></g><g transform="translate(5525,0)"><use transform="scale(1.2)" xlink:href="#E24-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-20D7" x="544" y="-2"></use></g><g transform="translate(6211,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">的</text></g><use transform="scale(1.2)" xlink:href="#E24-MJMATHI-4C" x="5991" y="0"></use><use transform="scale(1.2)" xlink:href="#E24-MJMAIN-2212" x="6894" y="0"></use><use transform="scale(1.2)" xlink:href="#E24-MJMATHI-50" x="7895" y="0"></use><g transform="translate(10375,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">范</text></g><g transform="translate(11353,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">数</text></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">\Large\vec{x'}=\frac{\vec{x}}{||\vec{x}||_p}\tag{5.4}\\
\large ||\vec{x}||_p:向量\vec{x}的L-P范数</script></div></div><h4 id='5215-范数'><span>5.2.1.5 范数</span></h4><p><span>这里稍微介绍一下范数的概念，我们知道距离的定义是一个宽泛的概念，只要满足非负、自反、三角不等式就可以称之为距离，范数是一种强化了的距离概念，在数学上，范数包括向量范数和矩阵范数，向量范数表征向量空间中向量的大小，矩阵范数表征矩阵引起变化的大小。一种非严密的解释就是，对应向量范数，向量空间中的向量都是有大小的，这个大小如何度量，就是用范数来度量的，不同的范数都可以来度量这个大小。向量</span><strong><span>L-P范数</span></strong><span>的公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1629" cid="n1629" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="10.598ex" viewBox="0 -2517.2 59683.7 4562.8" role="img" focusable="false" style="vertical-align: -4.536ex; margin-bottom: -0.215ex; max-width: 100%;"><defs><path stroke-width="0" id="E25-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E25-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E25-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E25-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E25-MJMATHI-4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path stroke-width="0" id="E25-MJMATHI-50" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path stroke-width="0" id="E25-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E25-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E25-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E25-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E25-MJMATHI-70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path stroke-width="0" id="E25-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E25-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E25-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E25-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E25-MJSZ4-221A" d="M983 1739Q988 1750 1001 1750Q1008 1750 1013 1745T1020 1733Q1020 1726 742 244T460 -1241Q458 -1250 439 -1250H436Q424 -1250 424 -1248L410 -1166Q395 -1083 367 -920T312 -601L201 44L137 -83L111 -57L187 96L264 247Q265 246 369 -357Q470 -958 473 -963L727 384Q979 1729 983 1739Z"></path><path stroke-width="0" id="E25-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E25-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.5" transform="translate(0,-24)"><use xlink:href="#E25-MJMAIN-28"></use><use xlink:href="#E25-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E25-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E25-MJMAIN-35" x="1167" y="0"></use><use xlink:href="#E25-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(16051,0)"><g transform="translate(-15,0)"><g transform="translate(0,-24)"><use transform="scale(1.44)" xlink:href="#E25-MJMATHI-4C" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMATHI-50" x="963" y="-213"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-3D" x="1589" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-7C" x="2645" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-7C" x="2923" y="0"></use><g transform="translate(4610,0)"><use transform="scale(1.44)" xlink:href="#E25-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-20D7" x="540" y="12"></use></g><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-7C" x="3773" y="0"></use><g transform="translate(5834,0)"><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMATHI-70" x="393" y="-403"></use></g><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-3D" x="5063" y="0"></use><g transform="translate(8811,0)"><use transform="scale(0.72)" xlink:href="#E25-MJMATHI-70" x="802" y="500"></use><use transform="scale(1.44)" xlink:href="#E25-MJSZ4-221A" x="0" y="-90"></use><rect stroke="none" width="3799" height="86" x="1440" y="2304"></rect><g transform="translate(1440,0)"><use transform="scale(1.44)" xlink:href="#E25-MJSZ2-2211" x="0" y="0"></use><g transform="translate(213,-1567)"><use transform="scale(1.018)" xlink:href="#E25-MJMATHI-69" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMAIN-3D" x="345" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMAIN-31" x="1123" y="0"></use></g><use transform="scale(1.018)" xlink:href="#E25-MJMATHI-6E" x="721" y="1626"></use><g transform="translate(2319,0)"><use transform="scale(1.44)" xlink:href="#E25-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMATHI-70" x="808" y="681"></use><use transform="scale(1.018)" xlink:href="#E25-MJMATHI-69" x="808" y="-429"></use></g></g></g><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-2C" x="10451" y="0"></use><g transform="translate(15690,0)"><use transform="scale(1.44)" xlink:href="#E25-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-20D7" x="540" y="12"></use></g><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-3D" x="11746" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-28" x="12801" y="0"></use><g transform="translate(18994,0)"><use transform="scale(1.44)" xlink:href="#E25-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMAIN-31" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-2C" x="14216" y="0"></use><g transform="translate(21111,0)"><use transform="scale(1.44)" xlink:href="#E25-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMAIN-32" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-2C" x="15686" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-2E" x="16131" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-2E" x="16575" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-2E" x="17020" y="0"></use><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-2C" x="17465" y="0"></use><g transform="translate(25790,0)"><use transform="scale(1.44)" xlink:href="#E25-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E25-MJMATHI-6E" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E25-MJMAIN-29" x="19006" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-25">\Large L_P=||\vec{x}||_p=\sqrt[p]{\sum_{i=1}^{n}x_i^p}\quad,\vec{x}=(x_1,x_2,...,x_n)\tag{5.5}</script></div></div><p><span> 常用的向量范数：</span></p><ul><li><span>L0范数</span></li></ul><p><span>当P=0时，也就是L0范数，由上面定义可知，L0范数并不是一个真正的范数（L0并不满足三角不等式的性质），它主要被用来度量向量中非零元素的个数。用上面的L-P定义可以得到的L-0的定义为： </span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1635" cid="n1635" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="10.598ex" viewBox="0 -2517.2 59683.7 4562.8" role="img" focusable="false" style="vertical-align: -4.536ex; margin-bottom: -0.215ex; max-width: 100%;"><defs><path stroke-width="0" id="E26-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E26-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E26-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E26-MJMAIN-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path stroke-width="0" id="E26-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E26-MJMATHI-4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path stroke-width="0" id="E26-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E26-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E26-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E26-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E26-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E26-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E26-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E26-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E26-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E26-MJSZ4-221A" d="M983 1739Q988 1750 1001 1750Q1008 1750 1013 1745T1020 1733Q1020 1726 742 244T460 -1241Q458 -1250 439 -1250H436Q424 -1250 424 -1248L410 -1166Q395 -1083 367 -920T312 -601L201 44L137 -83L111 -57L187 96L264 247Q265 246 369 -357Q470 -958 473 -963L727 384Q979 1729 983 1739Z"></path><path stroke-width="0" id="E26-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E26-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.6" transform="translate(0,-24)"><use xlink:href="#E26-MJMAIN-28"></use><use xlink:href="#E26-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E26-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E26-MJMAIN-36" x="1167" y="0"></use><use xlink:href="#E26-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(16182,0)"><g transform="translate(-15,0)"><g transform="translate(0,-24)"><use transform="scale(1.44)" xlink:href="#E26-MJMATHI-4C" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMAIN-30" x="963" y="-213"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-3D" x="1412" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-7C" x="2468" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-7C" x="2746" y="0"></use><g transform="translate(4354,0)"><use transform="scale(1.44)" xlink:href="#E26-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-20D7" x="540" y="12"></use></g><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-7C" x="3596" y="0"></use><g transform="translate(5578,0)"><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMAIN-30" x="393" y="-403"></use></g><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-3D" x="4883" y="0"></use><g transform="translate(8552,0)"><use transform="scale(0.72)" xlink:href="#E26-MJMAIN-30" x="839" y="410"></use><use transform="scale(1.44)" xlink:href="#E26-MJSZ4-221A" x="0" y="-90"></use><rect stroke="none" width="3796" height="86" x="1440" y="2304"></rect><g transform="translate(1440,0)"><use transform="scale(1.44)" xlink:href="#E26-MJSZ2-2211" x="0" y="0"></use><g transform="translate(213,-1567)"><use transform="scale(1.018)" xlink:href="#E26-MJMATHI-69" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMAIN-3D" x="345" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMAIN-31" x="1123" y="0"></use></g><use transform="scale(1.018)" xlink:href="#E26-MJMATHI-6E" x="721" y="1626"></use><g transform="translate(2319,0)"><use transform="scale(1.44)" xlink:href="#E26-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMAIN-30" x="808" y="509"></use><use transform="scale(1.018)" xlink:href="#E26-MJMATHI-69" x="808" y="-429"></use></g></g></g><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-2C" x="10269" y="0"></use><g transform="translate(15428,0)"><use transform="scale(1.44)" xlink:href="#E26-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-20D7" x="540" y="12"></use></g><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-3D" x="11564" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-28" x="12620" y="0"></use><g transform="translate(18733,0)"><use transform="scale(1.44)" xlink:href="#E26-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMAIN-31" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-2C" x="14034" y="0"></use><g transform="translate(20850,0)"><use transform="scale(1.44)" xlink:href="#E26-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMAIN-32" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-2C" x="15504" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-2E" x="15949" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-2E" x="16394" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-2E" x="16838" y="0"></use><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-2C" x="17283" y="0"></use><g transform="translate(25528,0)"><use transform="scale(1.44)" xlink:href="#E26-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E26-MJMATHI-6E" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E26-MJMAIN-29" x="18824" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">\Large L_0=||\vec{x}||_0=\sqrt[0]{\sum_{i=1}^{n}x_i^0}\quad,\vec{x}=(x_1,x_2,...,x_n)\tag{5.6}</script></div></div><p><span>对于L0范数，其优化问题为： </span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1637" cid="n1637" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="6.094ex" viewBox="0 -1574 59683.7 2624" role="img" focusable="false" style="vertical-align: -2.439ex; max-width: 100%;"><defs><path stroke-width="0" id="E27-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E27-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E27-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E27-MJMAIN-37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path><path stroke-width="0" id="E27-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E27-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E27-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E27-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E27-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E27-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E27-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E27-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E27-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E27-MJCAL-41" d="M576 668Q576 688 606 708T660 728Q676 728 675 712V571Q675 409 688 252Q696 122 720 57Q722 53 723 50T728 46T732 43T737 41T743 39L754 45Q788 61 803 61Q819 61 819 47Q818 43 814 35Q799 15 755 -7T675 -30Q659 -30 648 -25T630 -8T621 11T614 34Q603 77 599 106T594 146T591 160V163H460L329 164L316 145Q241 35 196 -7T119 -50T59 -24T30 43Q30 75 46 100T74 125Q81 125 83 120T88 104T96 84Q118 57 151 57Q189 57 277 182Q432 400 542 625L559 659H567Q574 659 575 660T576 668ZM584 249Q579 333 577 386T575 473T574 520V581L563 560Q497 426 412 290L372 228L370 224H371L383 228L393 232H586L584 249Z"></path><path stroke-width="0" id="E27-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E27-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E27-MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.7" transform="translate(0,584)"><use xlink:href="#E27-MJMAIN-28"></use><use xlink:href="#E27-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E27-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E27-MJMAIN-37" x="1167" y="0"></use><use xlink:href="#E27-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(27079,0)"><g transform="translate(-15,0)"><g transform="translate(0,584)"><use transform="scale(1.2)" xlink:href="#E27-MJMATHI-6D" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E27-MJMATHI-69" x="878" y="0"></use><use transform="scale(1.2)" xlink:href="#E27-MJMATHI-6E" x="1223" y="0"></use><use transform="scale(1.2)" xlink:href="#E27-MJMAIN-7C" x="1823" y="0"></use><use transform="scale(1.2)" xlink:href="#E27-MJMAIN-7C" x="2101" y="0"></use><use transform="scale(1.2)" xlink:href="#E27-MJMATHI-78" x="2379" y="0"></use><use transform="scale(1.2)" xlink:href="#E27-MJMAIN-7C" x="2951" y="0"></use><g transform="translate(3874,0)"><use transform="scale(1.2)" xlink:href="#E27-MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E27-MJMAIN-30" x="393" y="-403"></use></g><g transform="translate(0,-1519)"><use xlink:href="#E27-MJMATHI-73" x="0" y="0"></use><use xlink:href="#E27-MJMAIN-2E" x="469" y="0"></use><use xlink:href="#E27-MJMATHI-74" x="913" y="0"></use><use xlink:href="#E27-MJMAIN-2E" x="1274" y="0"></use><use xlink:href="#E27-MJCAL-41" x="2719" y="0"></use><g transform="translate(3538,0)"><use xlink:href="#E27-MJMATHI-78" x="0" y="0"></use><use xlink:href="#E27-MJMAIN-20D7" x="549" y="4"></use></g><use xlink:href="#E27-MJMAIN-3D" x="4388" y="0"></use><use xlink:href="#E27-MJMATHI-62" x="5443" y="0"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-27">\large min||x||_0\tag{5.7}\\
s.t.\quad\cal{A}\vec{x}=\cal{b}</script></div></div><p><span>L0范数表示向量中所有非零元素的个数，正是L0范数的这个属性，使得其非常适合机器学习中稀疏编码，特征选择的应用。通过最小化L0范数，来寻找最少最优的稀疏特征项。但不幸的是，L0范数的最小化问题在实际应用中是NP难问题。因此很多情况下，L0优化问题就会被转化为为更高维度的范数问题，如L1范数，L2范数最小化问题。</span></p><ul><li><span>L</span><sub><span>1</span></sub><span>范数</span></li></ul><p><span>L1范数是我们经常见到的一种范数，它表示向量 x 中非零元素的绝对值之和，L1范数有很多的名字，例如我们熟悉的曼哈顿距离、最小绝对误差等，它的定义如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1643" cid="n1643" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="8.042ex" viewBox="0 -1993.2 59683.7 3462.4" role="img" focusable="false" style="vertical-align: -3.264ex; margin-bottom: -0.149ex; max-width: 100%;"><defs><path stroke-width="0" id="E28-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E28-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E28-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E28-MJMAIN-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path stroke-width="0" id="E28-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E28-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E28-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E28-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E28-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E28-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E28-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E28-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E28-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.8" transform="translate(0,29)"><use xlink:href="#E28-MJMAIN-28"></use><use xlink:href="#E28-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E28-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E28-MJMAIN-38" x="1167" y="0"></use><use xlink:href="#E28-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(26083,0)"><g transform="translate(-15,0)"><g transform="translate(0,29)"><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-7C" x="278" y="0"></use><g transform="translate(667,0)"><use transform="scale(1.2)" xlink:href="#E28-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-20D7" x="544" y="-2"></use></g><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-7C" x="1128" y="0"></use><g transform="translate(1687,0)"><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E28-MJMAIN-31" x="393" y="-403"></use></g><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-3D" x="2415" y="0"></use><g transform="translate(4165,0)"><use transform="scale(1.2)" xlink:href="#E28-MJSZ2-2211" x="0" y="0"></use><g transform="translate(177,-1306)"><use transform="scale(0.849)" xlink:href="#E28-MJMATHI-69" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E28-MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.849)" xlink:href="#E28-MJMAIN-31" x="1123" y="0"></use></g><use transform="scale(0.849)" xlink:href="#E28-MJMATHI-6E" x="721" y="1626"></use></g><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-7C" x="5081" y="0"></use><g transform="translate(6431,0)"><use transform="scale(1.2)" xlink:href="#E28-MJMATHI-78" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E28-MJMATHI-69" x="808" y="-213"></use></g><use transform="scale(1.2)" xlink:href="#E28-MJMAIN-7C" x="6275" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">\large||\vec{x}||_1=\sum_{i=1}^{n}|x_i|\tag{5.8}</script></div></div><p><span>对于L1范数，它的优化问题如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1645" cid="n1645" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="6.094ex" viewBox="0 -1574 59683.7 2624" role="img" focusable="false" style="vertical-align: -2.439ex; max-width: 100%;"><defs><path stroke-width="0" id="E29-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E29-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E29-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E29-MJMAIN-39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"></path><path stroke-width="0" id="E29-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E29-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E29-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E29-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E29-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E29-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E29-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E29-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E29-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E29-MJCAL-41" d="M576 668Q576 688 606 708T660 728Q676 728 675 712V571Q675 409 688 252Q696 122 720 57Q722 53 723 50T728 46T732 43T737 41T743 39L754 45Q788 61 803 61Q819 61 819 47Q818 43 814 35Q799 15 755 -7T675 -30Q659 -30 648 -25T630 -8T621 11T614 34Q603 77 599 106T594 146T591 160V163H460L329 164L316 145Q241 35 196 -7T119 -50T59 -24T30 43Q30 75 46 100T74 125Q81 125 83 120T88 104T96 84Q118 57 151 57Q189 57 277 182Q432 400 542 625L559 659H567Q574 659 575 660T576 668ZM584 249Q579 333 577 386T575 473T574 520V581L563 560Q497 426 412 290L372 228L370 224H371L383 228L393 232H586L584 249Z"></path><path stroke-width="0" id="E29-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E29-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E29-MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57627,0)"><g id="mjx-eqn-5.9" transform="translate(0,575)"><use xlink:href="#E29-MJMAIN-28"></use><use xlink:href="#E29-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E29-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E29-MJMAIN-39" x="1167" y="0"></use><use xlink:href="#E29-MJMAIN-29" x="1667" y="0"></use></g></g><g transform="translate(27079,0)"><g transform="translate(-15,0)"><g transform="translate(0,575)"><use transform="scale(1.2)" xlink:href="#E29-MJMATHI-6D" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E29-MJMATHI-69" x="878" y="0"></use><use transform="scale(1.2)" xlink:href="#E29-MJMATHI-6E" x="1223" y="0"></use><use transform="scale(1.2)" xlink:href="#E29-MJMAIN-7C" x="1823" y="0"></use><use transform="scale(1.2)" xlink:href="#E29-MJMAIN-7C" x="2101" y="0"></use><use transform="scale(1.2)" xlink:href="#E29-MJMATHI-78" x="2379" y="0"></use><use transform="scale(1.2)" xlink:href="#E29-MJMAIN-7C" x="2951" y="0"></use><g transform="translate(3874,0)"><use transform="scale(1.2)" xlink:href="#E29-MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E29-MJMAIN-31" x="393" y="-403"></use></g><g transform="translate(0,-1500)"><use xlink:href="#E29-MJMATHI-73" x="0" y="0"></use><use xlink:href="#E29-MJMAIN-2E" x="469" y="0"></use><use xlink:href="#E29-MJMATHI-74" x="913" y="0"></use><use xlink:href="#E29-MJMAIN-2E" x="1274" y="0"></use><use xlink:href="#E29-MJCAL-41" x="2719" y="0"></use><g transform="translate(3538,0)"><use xlink:href="#E29-MJMATHI-78" x="0" y="0"></use><use xlink:href="#E29-MJMAIN-20D7" x="549" y="4"></use></g><use xlink:href="#E29-MJMAIN-3D" x="4388" y="0"></use><use xlink:href="#E29-MJMATHI-62" x="5443" y="0"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-29">\large min||x||_1\tag{5.9}\\
s.t.\quad\cal{A}\vec{x}=\cal{b}</script></div></div><p><span>由于L1范数的天然性质，对L1优化的解是一个稀疏解，因此L1范数也被叫做稀疏规则算子。通过L1可以实现特征的稀疏，去掉一些没有信息的特征。这使得L1范数的应用十分广泛，如绝对误差和（Sum of Absolute Difference）、平均绝对误差（Mean Absolute Error，MAE）等都是利用L1范式的定义。由于L1范数并没有平滑的函数表示，起初L1最优化问题解决起来非常困难，但随着计算机技术的到来，利用很多凸优化算法使得L1最优化成为可能。</span></p><ul><li><span>L2范数</span></li></ul><p><span>范数中最常见，也最著名的非L2范数莫属。其应用也几乎包括科学和工程的各个领域。它表示向量元素的平方和再开平方，用的最多的度量距离欧氏距离就是一种L2范数，定义公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1651" cid="n1651" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="10.598ex" viewBox="0 -2517.2 59683.7 4562.8" role="img" focusable="false" style="vertical-align: -4.536ex; margin-bottom: -0.215ex; max-width: 100%;"><defs><path stroke-width="0" id="E30-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E30-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E30-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E30-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E30-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E30-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E30-MJMATHI-4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path stroke-width="0" id="E30-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E30-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E30-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E30-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E30-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E30-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E30-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E30-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E30-MJSZ4-221A" d="M983 1739Q988 1750 1001 1750Q1008 1750 1013 1745T1020 1733Q1020 1726 742 244T460 -1241Q458 -1250 439 -1250H436Q424 -1250 424 -1248L410 -1166Q395 -1083 367 -920T312 -601L201 44L137 -83L111 -57L187 96L264 247Q265 246 369 -357Q470 -958 473 -963L727 384Q979 1729 983 1739Z"></path><path stroke-width="0" id="E30-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.10" transform="translate(0,-24)"><use xlink:href="#E30-MJMAIN-28"></use><use xlink:href="#E30-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E30-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E30-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E30-MJMAIN-30" x="1667" y="0"></use><use xlink:href="#E30-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(16182,0)"><g transform="translate(-15,0)"><g transform="translate(0,-24)"><use transform="scale(1.44)" xlink:href="#E30-MJMATHI-4C" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMAIN-32" x="963" y="-213"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-3D" x="1412" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-7C" x="2468" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-7C" x="2746" y="0"></use><g transform="translate(4354,0)"><use transform="scale(1.44)" xlink:href="#E30-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-20D7" x="540" y="12"></use></g><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-7C" x="3596" y="0"></use><g transform="translate(5578,0)"><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMAIN-32" x="393" y="-403"></use></g><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-3D" x="4883" y="0"></use><g transform="translate(8552,0)"><use transform="scale(0.72)" xlink:href="#E30-MJMAIN-32" x="850" y="410"></use><use transform="scale(1.44)" xlink:href="#E30-MJSZ4-221A" x="0" y="-90"></use><rect stroke="none" width="3796" height="86" x="1440" y="2304"></rect><g transform="translate(1440,0)"><use transform="scale(1.44)" xlink:href="#E30-MJSZ2-2211" x="0" y="0"></use><g transform="translate(213,-1567)"><use transform="scale(1.018)" xlink:href="#E30-MJMATHI-69" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMAIN-3D" x="345" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMAIN-31" x="1123" y="0"></use></g><use transform="scale(1.018)" xlink:href="#E30-MJMATHI-6E" x="721" y="1626"></use><g transform="translate(2319,0)"><use transform="scale(1.44)" xlink:href="#E30-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMAIN-32" x="808" y="487"></use><use transform="scale(1.018)" xlink:href="#E30-MJMATHI-69" x="808" y="-429"></use></g></g></g><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-2C" x="10269" y="0"></use><g transform="translate(15428,0)"><use transform="scale(1.44)" xlink:href="#E30-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-20D7" x="540" y="12"></use></g><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-3D" x="11564" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-28" x="12620" y="0"></use><g transform="translate(18733,0)"><use transform="scale(1.44)" xlink:href="#E30-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMAIN-31" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-2C" x="14034" y="0"></use><g transform="translate(20850,0)"><use transform="scale(1.44)" xlink:href="#E30-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMAIN-32" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-2C" x="15504" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-2E" x="15949" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-2E" x="16394" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-2E" x="16838" y="0"></use><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-2C" x="17283" y="0"></use><g transform="translate(25528,0)"><use transform="scale(1.44)" xlink:href="#E30-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E30-MJMATHI-6E" x="808" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E30-MJMAIN-29" x="18824" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">\Large L_2=||\vec{x}||_2=\sqrt[2]{\sum_{i=1}^{n}x_i^2}\quad,\vec{x}=(x_1,x_2,...,x_n)\tag{5.10}</script></div></div><p><span>对于L2范数，它的优化问题如下： </span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1653" cid="n1653" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="6.094ex" viewBox="0 -1574 59683.7 2624" role="img" focusable="false" style="vertical-align: -2.439ex; max-width: 100%;"><defs><path stroke-width="0" id="E31-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E31-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E31-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E31-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E31-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E31-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E31-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E31-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E31-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E31-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E31-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E31-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E31-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E31-MJCAL-41" d="M576 668Q576 688 606 708T660 728Q676 728 675 712V571Q675 409 688 252Q696 122 720 57Q722 53 723 50T728 46T732 43T737 41T743 39L754 45Q788 61 803 61Q819 61 819 47Q818 43 814 35Q799 15 755 -7T675 -30Q659 -30 648 -25T630 -8T621 11T614 34Q603 77 599 106T594 146T591 160V163H460L329 164L316 145Q241 35 196 -7T119 -50T59 -24T30 43Q30 75 46 100T74 125Q81 125 83 120T88 104T96 84Q118 57 151 57Q189 57 277 182Q432 400 542 625L559 659H567Q574 659 575 660T576 668ZM584 249Q579 333 577 386T575 473T574 520V581L563 560Q497 426 412 290L372 228L370 224H371L383 228L393 232H586L584 249Z"></path><path stroke-width="0" id="E31-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E31-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E31-MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.11" transform="translate(0,575)"><use xlink:href="#E31-MJMAIN-28"></use><use xlink:href="#E31-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E31-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E31-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E31-MJMAIN-31" x="1667" y="0"></use><use xlink:href="#E31-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(27079,0)"><g transform="translate(-15,0)"><g transform="translate(0,575)"><use transform="scale(1.2)" xlink:href="#E31-MJMATHI-6D" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E31-MJMATHI-69" x="878" y="0"></use><use transform="scale(1.2)" xlink:href="#E31-MJMATHI-6E" x="1223" y="0"></use><use transform="scale(1.2)" xlink:href="#E31-MJMAIN-7C" x="1823" y="0"></use><use transform="scale(1.2)" xlink:href="#E31-MJMAIN-7C" x="2101" y="0"></use><use transform="scale(1.2)" xlink:href="#E31-MJMATHI-78" x="2379" y="0"></use><use transform="scale(1.2)" xlink:href="#E31-MJMAIN-7C" x="2951" y="0"></use><g transform="translate(3874,0)"><use transform="scale(1.2)" xlink:href="#E31-MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E31-MJMAIN-32" x="393" y="-403"></use></g><g transform="translate(0,-1500)"><use xlink:href="#E31-MJMATHI-73" x="0" y="0"></use><use xlink:href="#E31-MJMAIN-2E" x="469" y="0"></use><use xlink:href="#E31-MJMATHI-74" x="913" y="0"></use><use xlink:href="#E31-MJMAIN-2E" x="1274" y="0"></use><use xlink:href="#E31-MJCAL-41" x="2719" y="0"></use><g transform="translate(3538,0)"><use xlink:href="#E31-MJMATHI-78" x="0" y="0"></use><use xlink:href="#E31-MJMAIN-20D7" x="549" y="4"></use></g><use xlink:href="#E31-MJMAIN-3D" x="4388" y="0"></use><use xlink:href="#E31-MJMATHI-62" x="5443" y="0"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-31">\large min||x||_2\tag{5.11}\\
s.t.\quad\cal{A}\vec{x}=\cal{b}</script></div></div><p><span>像L1范数一样，L2也可以度量两个向量间的差异，如平方差和（Sum of Squared Difference）。在机器学习中，L2范数通常会被用来做优化目标函数的正则化项，防止模型为了迎合训练集而过于复杂造成过拟合的情况，从而提高模型的泛化能力。L2相对于L1具有更为平滑的特性，在模型预测中，往往比L1具有更好的预测特性。当遇到两个对预测有帮助的特征时，L1倾向于选择一个更大的特征。而L2更倾向把两者结合起来。</span></p><ul><li><span class='math-in-toc'>$L_\infty$</span><span>范数</span></li></ul><p><span>当</span><img src="https://img-blog.csdn.net/20180604172938724?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E0OTM4MjM4ODI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" referrerpolicy="no-referrer" alt="img"><span>时，也就是</span><img src="https://img-blog.csdn.net/20180604172949953?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E0OTM4MjM4ODI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" referrerpolicy="no-referrer" alt="img"><span>范数，它主要被用来度量向量元素的最大值，也称切比雪夫距离，公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1659" cid="n1659" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="3.295ex" viewBox="0 -945.2 59683.7 1418.8" role="img" focusable="false" style="vertical-align: -1.1ex; max-width: 100%;"><defs><path stroke-width="0" id="E32-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E32-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E32-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E32-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E32-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E32-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E32-MJMAIN-7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path><path stroke-width="0" id="E32-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E32-MJMAIN-20D7" d="M-123 694Q-123 702 -118 708T-103 714Q-93 714 -88 706T-80 687T-67 660T-40 633Q-29 626 -29 615Q-29 606 -36 600T-53 590T-83 571T-121 531Q-135 516 -143 516T-157 522T-163 536T-152 559T-129 584T-116 595H-287L-458 596Q-459 597 -461 599T-466 602T-469 607T-471 615Q-471 622 -458 635H-99Q-123 673 -123 694Z"></path><path stroke-width="0" id="E32-MJMAIN-221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path><path stroke-width="0" id="E32-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E32-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E32-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.12" transform="translate(0,-25)"><use xlink:href="#E32-MJMAIN-28"></use><use xlink:href="#E32-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E32-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E32-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E32-MJMAIN-32" x="1667" y="0"></use><use xlink:href="#E32-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(25390,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-7C" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-7C" x="278" y="0"></use><g transform="translate(667,0)"><use transform="scale(1.2)" xlink:href="#E32-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-20D7" x="544" y="-2"></use></g><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-7C" x="1128" y="0"></use><g transform="translate(1687,0)"><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E32-MJMAIN-221E" x="393" y="-403"></use></g><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-3D" x="2768" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMATHI-6D" x="3824" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMATHI-61" x="4702" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMATHI-78" x="5231" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-28" x="5803" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-7C" x="6192" y="0"></use><g transform="translate(7764,0)"><use transform="scale(1.2)" xlink:href="#E32-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-20D7" x="544" y="-2"></use></g><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-7C" x="7042" y="0"></use><use transform="scale(1.2)" xlink:href="#E32-MJMAIN-29" x="7320" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">\large ||\vec x||_{\infty}=max(|\vec x|)\tag{5.12}</script></div></div><p><span>根据P的变化，范数也有着不同的变化，一个经典的有关P范数的变化图如下：</span></p><div align="center">
    <img src="pic/范数.png">
</div><p><span>Lp范数是常用的正则化项，其中L2范数|w|2倾向于w的分量取值尽量均衡，即非零分量个数尽量稠密，而L0范数与L1范数则是倾向于w的分量尽量稀疏，即非零分量个数尽量少。</span></p><h4 id='5216-不同无量纲处理的区别与应用场景'><span>5.2.1.6 不同无量纲处理的区别与应用场景</span></h4><ul><li><strong><span>归一化与标准化</span></strong></li></ul><p><span>归一化是将样本的特征值转换到同一量纲下把数据映射到[0,1]区间内，仅由变量的极值决定。标准化是依照特征矩阵的列处理数据，其通过求z-score的方法，转换为标准正态分布，和整体样本分布相关，每个样本点都能对标准化产生影响。它们的相同点在于都能取消由于量纲不同引起的误差；都是一种线性变换，都是对向量X按照比例压缩再进行平移。</span></p><ul><li><strong><span>样本归一化与标准化</span></strong></li></ul><p><span>简单来说，标准化是依照特征矩阵的列处理数据，其通过求z-score的方法，将样本的特征值转换到同一量纲下。归一化是依照特征矩阵的行处理数据，其目的在于样本向量在点乘运算或其他核函数计算相似性时，拥有统一的标准，也就是说都转化为“单位向量”。两者的目的不同，归一化是为了消除纲量压缩到[0,1]区间；标准化只是调整特征整体的分布。归一化与最大，最小值有关；标准化与均值，标准差有关。归一化输出在[0,1]之间；标准化无限制。</span></p><ul><li><strong><span>归一化与标准化应用场景</span></strong></li></ul><ol start='' ><li><span>在分类、聚类算法中，需要使用距离来度量相似性的时候（如 SVM、KNN）或者使用 PCA 技术进行降维的时候，标准化(Z-score standardization)表现更好。 </span></li><li><span>在不涉及距离度量、协方差计算、数据不符合正太分布的时候，可以使用第一种方法或其他归一化方法。比如图像处理中，将 RGB 图像转换为灰度图像后将其值限定在[0 255]的范围。 </span></li><li><span>基于树的方法不需要进行特征的归一化。例如</span><strong><span>随机森林，bagging 与 boosting</span></strong><span> 等方法。如果是基于参数的模型或者基于距离的模型，因为需要对参数或者距离进行计算，都需要进行归一化。 </span></li></ol><h3 id='522-分类变量编码离散化'><span>5.2.2 分类变量编码/离散化</span></h3><h4 id='5221-定量特征二值化'><span>5.2.2.1 </span><strong><span>定量特征二值化</span></strong></h4><p><span>根据阈值将数据二值化（将特征值设置为0或1），用于处理连续型变量。大于阈值的值映射为1，而小于或等于阈值的值映射为0。默认阈值为0时，特征中所有的正值都映射到1。二值化是对文本计数数据的常见操作，分析人员可以决定仅考虑某种现象的存在与否。它还可以用作考虑布尔随机变量的估计器的预处理步骤（例如，使用贝叶斯设置中的伯努利分布建模）。定量特征二值化的核心在于设定一个阈值，大于阈值的赋值为1，小于等于阈值的赋值为0，公式表达如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1685" cid="n1685" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="7.068ex" viewBox="0 -1783.6 59683.7 3043.2" role="img" focusable="false" style="vertical-align: -2.926ex; max-width: 100%;"><defs><path stroke-width="0" id="E33-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E33-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E33-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E33-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E33-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E33-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E33-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E33-MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path stroke-width="0" id="E33-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E33-MJMAIN-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path stroke-width="0" id="E33-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E33-MJMAIN-69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path><path stroke-width="0" id="E33-MJMAIN-66" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z"></path><path stroke-width="0" id="E33-MJMAIN-3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path><path stroke-width="0" id="E33-MJMATHI-74" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path stroke-width="0" id="E33-MJMATHI-68" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path><path stroke-width="0" id="E33-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E33-MJMATHI-65" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path stroke-width="0" id="E33-MJMATHI-73" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path stroke-width="0" id="E33-MJMATHI-6F" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path stroke-width="0" id="E33-MJMATHI-6C" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path stroke-width="0" id="E33-MJMATHI-64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path stroke-width="0" id="E33-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E33-MJMAIN-2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path><path stroke-width="0" id="E33-MJSZ3-7B" d="M618 -943L612 -949H582L568 -943Q472 -903 411 -841T332 -703Q327 -682 327 -653T325 -350Q324 -28 323 -18Q317 24 301 61T264 124T221 171T179 205T147 225T132 234Q130 238 130 250Q130 255 130 258T131 264T132 267T134 269T139 272T144 275Q207 308 256 367Q310 436 323 519Q324 529 325 851Q326 1124 326 1154T332 1205Q369 1358 566 1443L582 1450H612L618 1444V1429Q618 1413 616 1411L608 1406Q599 1402 585 1393T552 1372T515 1343T479 1305T449 1257T429 1200Q425 1180 425 1152T423 851Q422 579 422 549T416 498Q407 459 388 424T346 364T297 318T250 284T214 264T197 254L188 251L205 242Q290 200 345 138T416 3Q421 -18 421 -48T423 -349Q423 -397 423 -472Q424 -677 428 -694Q429 -697 429 -699Q434 -722 443 -743T465 -782T491 -816T519 -845T548 -868T574 -886T595 -899T610 -908L616 -910Q618 -912 618 -928V-943Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.13" transform="translate(0,-50)"><use xlink:href="#E33-MJMAIN-28"></use><use xlink:href="#E33-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E33-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E33-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E33-MJMAIN-33" x="1667" y="0"></use><use xlink:href="#E33-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(22852,0)"><g transform="translate(-15,0)"><g transform="translate(0,-50)"><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-78" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E33-MJMAIN-2032" x="808" y="583"></use><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-3D" x="1144" y="0"></use><g transform="translate(2640,0)"><use transform="scale(1.2)" xlink:href="#E33-MJSZ3-7B"></use><g transform="translate(1067,0)"><g transform="translate(-15,0)"><g transform="translate(0,640)"><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-31" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-2C" x="500" y="0"></use></g><g transform="translate(0,-760)"><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-30" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-2C" x="500" y="0"></use></g></g><g transform="translate(1919,0)"><g transform="translate(0,640)"><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-69"></use><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-66" x="278" y="0"></use><g transform="translate(950,0)"><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-3E" x="849" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-74" x="1905" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-68" x="2266" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-72" x="2842" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-65" x="3293" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-73" x="3759" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-68" x="4228" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-6F" x="4804" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-6C" x="5289" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-64" x="5587" y="0"></use></g></g><g transform="translate(0,-760)"><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-69"></use><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-66" x="278" y="0"></use><g transform="translate(950,0)"><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMAIN-2264" x="849" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-74" x="1905" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-68" x="2266" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-72" x="2842" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-65" x="3293" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-73" x="3759" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-68" x="4228" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-6F" x="4804" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-6C" x="5289" y="0"></use><use transform="scale(1.2)" xlink:href="#E33-MJMATHI-64" x="5587" y="0"></use></g></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-33">\large x' =
\begin{cases}
1,  & \text{if $x>threshold$ } \\
0, & \text{if $x\leq threshold$}
\end{cases}\tag{5.13}</script></div></div><p><span>将数值特征二值化在现实中应用广泛。</span><strong><span>以电池测试为例，很多时候我们其实更关心结果是否大于标准线，比如寿命是否达到客户设定的要求。这时候就需要对寿命值进行二值化操作。二值化操作是二分类工作的基础，而算法需要设定的阈值则是具体问题的实际要求或业务经验。</span></strong></p><h4 id='5222-分箱编码'><span>5.2.2.2 分箱编码</span></h4><p><span>二值化操作能将数值特征分为两值分类特征，而分箱编码则是进一步可以按顺序将数值特征编码为多分类特征。分箱就是将</span><strong><span>连续变量离散化</span></strong><span>，将多状态的离散变量合并成少状态。同属一个箱段的数据，就可以对落入其中的数据进行统一编码，比如可以用连续整数来编码，也可以用哑变量编码等，具体编码方式根据算法需要灵活来定。介绍分箱方法之前，首先要了解为什么分箱？分箱的好处：</span></p><ol start='' ><li><span>分箱后的特征对异常数据有更强的鲁棒性。比如年龄中有一个异常值为300，分箱之后就可能划到&gt;80这一箱中，而如果直接入模的话会对模型造成很大干扰。</span></li><li><span>特征离散化之后，每个变量有单独的权重，可以为模型引入了非线性，能够提升模型表达能力，加大拟合。</span></li><li><span>特征离散化以后，起到了简化了模型的作用，降低了模型过拟合的风险。</span></li><li><span>可以将缺失值作为独立的一类带入模型。</span></li><li><span>稀疏向量内积乘法运算速度快，计算结果方便存储，容易扩展。</span></li><li><span>将所有变量变换到相似的尺度上。</span></li><li><span>离散化后可以进行特征交叉，由M+N个变量变为M*N个变量，进一步引入非线性，提升表达能力；</span></li></ol><p><span>按照不同分箱算法，分箱算法又可以分为</span><strong><span>无监督分箱</span></strong><span>和</span><strong><span>有监督分箱</span></strong><span>两种，下面就将这两种分箱进行讨论：</span></p><h5 id='52221-无监督分箱'><span>5.2.2.2.1 无监督分箱</span></h5><p><span>无监督分箱主要有4种：自定义分箱、等宽分箱、等位分箱、聚类分箱。</span></p><ul><li><strong><span>自定义分箱</span></strong></li></ul><p><span>指根据业务经验或者常识等自行设定划分的区间，然后将原始数据归类到各个区间中。举个现实生活中的例子，身体质量指数（BMI指数，Body Mass index），是国际上常用的衡量人体胖瘦程度以及是否健康的一个标准，BMI=体重÷身高</span><sup><span>2</span></sup><span>。虽然BMI的计算公式全世界统一，但考虑到不同地区、不同人种的体质差异，对于BMI对应的体质状况（比如下表的偏瘦、肥胖等标准）分类也不同。根据不同标准对BMI进行划分，其实就是自定义分箱的例子。</span></p><div align="center">
    <img src="pic/自定义分箱.jpg">
</div><p><span>同样的，以电池行业为例，比如某类电池的内阻上下限设定其实也是根据业务经验和实际要求来划分，而不是机械地固定划分。</span></p><ul><li><strong><span>等宽分箱（等距分箱）</span></strong></li></ul><p><span>按照相同宽度将数据分成几等份。从最小值到最大值之间均分为 N 等份，如果 A,B 为最小最大值，则每个区间的长度为 W=(B−A)/N , 则区间边界值为A+W, A+2W,…. A+(N−1)W 。这里只考虑边界，每个等份里面的实例数量可能不等。</span></p><p><span>在不同的分箱宽度下得到的各个箱内样本数量也不同。</span><strong><span>以数据样本中的电池循环寿命为例</span></strong><span>，如下图所示，不同的分箱宽度下得到的数据组合也不同（可以点击直方图上方的工具条按钮切换不同的分箱直方图）：</span></p><iframe src="pyecharts/分箱组合1.html" height="575"></iframe><p><span>当然等宽分箱的缺点就是受到异常值的影响比较大，如果异常值远离正常的数据分布，就会导致分箱中有部分箱段数据密度很低。</span></p><p>&nbsp;</p><ul><li><span>等位分箱（等频分箱）</span></li></ul><p><span>等位分箱（也称等频分箱）就是将数据分成几等份，并保证每等份数据里面的个数是一样的，即每个特征中的每个箱内的样本数量都相同。还是以样本数据中电池循环寿命为例，我们随机从数据样本里抽取1200个样本的循环寿命数据做等位分箱操作。下列图表表示的是不同单箱样本数量下的分箱频谱图（图内不同颜色的箱体表示不同的分箱，横坐标表箱体宽度，即箱内数据的起始值和终末值构成的区间，纵坐标表示箱体内样本数量）：</span></p><figure>
  <img type="image/svg+xml" src="pygal/chart100.svg" width="48%" height="50%">  <img type="image/svg+xml" src="pygal/chart200.svg" width="48%" height="50%"><img type="image/svg+xml" src="pygal/chart300.svg" width="48%" height="50%">  <img type="image/svg+xml" src="pygal/chart400.svg" width="48%" height="50%">
</figure><ul><li><span>聚类分箱</span></li></ul><p><span>聚类分箱是基于无监督聚类算法衍生而来的分箱方法。</span></p><p><span>聚类分析是一个无监督学习 (Unsupervised Learning) 过程, 一般是用来对数据对象按照其特征属性进行分组，经常被应用在客户分群，欺诈检测，图像分析等领域。常见的分箱聚类算法有</span><strong><span>K-means聚类（K-means Clustering）、层次聚类（Hierarchical Clustering）、层次K-means聚类(Hierarchical KMeans Clustering)</span></strong><span>等。由于篇幅重点不在具体算法，这里就不展开细讲，主要介绍一下K-means聚类算法。</span></p><p><strong><span>K-means聚类</span></strong></p><p><span>K-means 应该是最有名并且最经常使用的聚类算法了，其原理比较容易理解，并且聚类效果良好，有着广泛的使用。KMeans聚类是应用很广，算法易懂的聚类算法，基本概念和算法过程如下：</span></p><p><span>1、首先确定一个k值，即我们希望将数据集经过聚类得到集合数量k。</span></p><p><span>2、从数据集中随机选择k个数据点作为质心。</span></p><p><span>3、对数据集中每一个点，计算其与每一个质心的距离（如欧式距离），离哪个质心近，就划分到那个质心所属的集合。</span></p><p><span>4、把所有数据归好集合后，一共有k个集合。重新计算每个聚类内所有同类点的平均值（每个维度的平均值构成的向量，如果只有一维，则为标量平均值），并将其作为新的聚类质心。</span></p><p><span>5、如果新计算出来的质心和原来的质心之间的距离小于某一个设置的阈值（表示重新计算的质心的位置变化不大，趋于稳定，或者说收敛）或者聚类中心不再变化，我们可以认为聚类已经达到期望的结果，算法终止。</span></p><p><span>6、如果新质心和原质心距离变化很大，需要迭代3~5步骤。</span></p><p><span>K-Means采用的算法相对比较简单（指理解难度，不是指算法复杂度），用下面一组图就可以形象的描述（k=2) :</span></p><div align="center">
    <img src="pic/k-means.webp" style="zoom:70%">
</div><p>&nbsp;</p><p>&nbsp;</p><p><span>由于一维空间内的K-means聚类分箱效果与其他分箱相比不具有优势，我们就以二维的数据做为案例来说明。选取</span><strong><span>LFP10370C2-200电池样本数据中的分容容量和首次容量两个连续特征组成的数据来进行聚类分箱示例。</span></strong><span>流程如下：</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart8" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="156" style="max-width: 947.813px; height: 196px;" viewBox="0 0 947.8125 156" class="md-require-zoom-fix"><style>#mermaidChart8{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart8 .error-icon{fill:#552222;}#mermaidChart8 .error-text{fill:#552222;stroke:#552222;}#mermaidChart8 .edge-thickness-normal{stroke-width:2px;}#mermaidChart8 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart8 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart8 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart8 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart8 .marker{fill:#333333;}#mermaidChart8 .marker.cross{stroke:#333333;}#mermaidChart8 svg{font-family:sans-serif;font-size:16px;}#mermaidChart8 .label{font-family:sans-serif;color:#333;}#mermaidChart8 .label text{fill:#333;}#mermaidChart8 .node rect,#mermaidChart8 .node circle,#mermaidChart8 .node ellipse,#mermaidChart8 .node polygon,#mermaidChart8 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart8 .node .label{text-align:center;}#mermaidChart8 .node.clickable{cursor:pointer;}#mermaidChart8 .arrowheadPath{fill:#333333;}#mermaidChart8 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart8 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart8 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart8 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart8 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart8 .cluster text{fill:#333;}#mermaidChart8 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart8:root{--mermaid-font-family:sans-serif;}#mermaidChart8:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart8 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M124,78L149,78L174,78" marker-end="url(#arrowhead318)" style="fill:none"></path><defs><marker id="arrowhead318" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M342.0526315789474,55.5L411,30.5L462,30.5L513,30.5L578,30.5" marker-end="url(#arrowhead319)" style="fill:none"></path><defs><marker id="arrowhead319" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M630,30.5L695,30.5L739.1611842105264,55.5" marker-end="url(#arrowhead320)" style="fill:none"></path><defs><marker id="arrowhead320" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-E" id="L-B-E" style="opacity: 1;"><path class="path" d="M342.0526315789474,100.5L411,125.5L436,125.5" marker-end="url(#arrowhead321)" style="fill:none"></path><defs><marker id="arrowhead321" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;"><path class="path" d="M488,125.5L513,125.5L538,125.5" marker-end="url(#arrowhead322)" style="fill:none"></path><defs><marker id="arrowhead322" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-D" id="L-F-D" style="opacity: 1;"><path class="path" d="M670,125.5L695,125.5L739.1611842105264,100.5" marker-end="url(#arrowhead323)" style="fill:none"></path><defs><marker id="arrowhead323" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-H" id="L-D-H" style="opacity: 1;"><path class="path" d="M837.8125,78L862.8125,78L887.8125,78" marker-end="url(#arrowhead324)" style="fill:none"></path><defs><marker id="arrowhead324" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-187" transform="translate(66,78)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">聚类分箱流程</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-188" transform="translate(280,78)" style="opacity: 1;"><rect rx="0" ry="0" x="-106" y="-22.5" width="212" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-96,-12.5)"><foreignObject width="192" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">数据不同维度量纲是否相同</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-189" transform="translate(604,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">相同</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-190" transform="translate(778.90625,78)" style="opacity: 1;"><rect rx="0" ry="0" x="-58.90625" y="-22.5" width="117.8125" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48.90625,-12.5)"><foreignObject width="97.8125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">k-means计算</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-192" transform="translate(462,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">不同</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-193" transform="translate(604,125.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">各维数据标准化</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-195" transform="translate(913.8125,78)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">结果</div></foreignObject></g></g></g></g></g></g></svg></div><p>&nbsp;</p><p><span>注：实际上在机器学习应用中，数据预处理中数据分箱编码更多的是针对单独维度来说的，比如将分容容量聚类分为n箱，序列编码为 [0，1，2，…，n]；然后再将首次容量聚类分为m箱，序列编码为 [0，1，2，…，m]。依次对每个数值特征进行分箱操作，每个维度得到一组一维分箱结果。如果一次性将二维以上特征（包括二维）当作数据点（即数据有多个维度）进行分箱操作，得出的分箱结果只能返回一组一维信息。比如样本数量为p，分箱特征数为 t 的数据，总共分q箱，分箱编码 为[0，1，2，…q] ， 样本集合为</span><span class='math-in-toc'>$X=\{X_1,X_2,...,X_p\}$</span><span>，分箱结果</span><span class='math-in-toc'>$K=\{K_1,K_2,...,K_p\}，k_i\in[0,1,2,...q]$</span><span>。这样操作的结果是分箱编码只有1维，而特征维度却为 t，就相当于</span><strong><span>损失了 t-1 维的特征信息！</span></strong><span> 显然，这样的分箱编码是无法作为特征的！但这里是演示案例，并不会将分箱编码作为特征输入，所以是没有问题的。</span></p><p><span>因为分容容量和首次容量的量纲相同，都是描述电池的容量，所以不需要进行标准化操作，就可以直接进行K-means算法计算，结果可视化如下：</span></p><iframe src="pyecharts/K-means.html" height="575"></iframe><p><span>k-means聚类分析的原理虽然简单，但缺点也比较明显：</span></p><ol start='' ><li><span>首先聚成几类这个k值你要自己定，但在对数据一无所知的情况下你自己也不知道k应该定多少；</span></li><li><span>初始中心也要自己选，而这个初始中心直接决定最终的聚类效果；</span></li><li><span>每一次迭代都要重新计算各个点与中心的距离，然后排序，时间成本较高。</span></li></ol><p><span>特别是如何选定k值和如何确定初始中心，这是K-means聚类要面对的关键问题。层次K-means聚类算法结合了层次聚类算法和K-means算法的特点，算法初始中心是由层次聚类得到，会更加合理。下面的动态聚类图就是</span><strong><span>基于层次K-means聚类算法在LFP1370C-200电池样本的分容容量和首次容量两个特征上的聚类生成过程</span></strong><span>（可以点击右下方播放按钮进行自动播放）：</span></p><iframe src="JS/层次聚类1.html" height="620"></iframe><h5 id='52222-有监督分箱'><span>5.2.2.2.2 有监督分箱</span></h5><p><strong><span>有监督分箱其实是对特征进行分箱时，要借助标签结果来进行，即分箱是考虑样本标签的。放在电池案例里，电池特征分箱时是要借助电池的最终性能（可以是寿命、容量……）表现的。有监督分箱主要有best-ks分箱和卡方分箱。有监督分箱主要适用于分类问题，这是由其算法决定的。</span></strong></p><p>&nbsp;</p><h6 id='522221-卡方分箱'><span>5.2.2.2.2.1 </span><a id='卡方分箱'><span>卡方分箱</span></a></h6><p><span>卡方分箱是自底向上的（即基于合并的）数据离散化方法。它依赖于卡方检验：具有最小卡方值的相邻区间合并在一起,直到满足确定的停止准则。基本思想:对于精确的离散化，相对类频率在一个区间内应当完全一致。因此,如果两个相邻的区间具有非常类似的类分布，则这两个区间可以合并；否则，它们应当保持分开。而低卡方值表明它们具有相似的类分布。</span></p><p><span>提到卡方分箱，必须要提到卡方检验。卡方检验也是一种假设检验，与常见的假设检验方法一致。</span></p><ul><li><span>提出假设，比如假设两个变量之间独立</span></li><li><span>根据分类的观察频数计算期望频数</span></li><li><span>根据卡方公式，计算实际频数与期望频数的卡方值</span></li><li><span>根据自由度和事先确定的显著性水平，查找卡方分布表计算卡法值，并与上一步卡方值比较</span></li><li><span>得出结果判断是否拒绝原假设</span></li></ul><p><span>卡方公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1777" cid="n1777" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="15.222ex" viewBox="0 -3512.8 59683.7 6554" role="img" focusable="false" style="vertical-align: -7.063ex; max-width: 100%;"><defs><path stroke-width="0" id="E34-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E34-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E34-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E34-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E34-MJMAIN-34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path stroke-width="0" id="E34-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E34-MJMATHI-3C7" d="M576 -125Q576 -147 547 -175T487 -204H476Q394 -204 363 -157Q334 -114 293 26L284 59Q283 58 248 19T170 -66T92 -151T53 -191Q49 -194 43 -194Q36 -194 31 -189T25 -177T38 -154T151 -30L272 102L265 131Q189 405 135 405Q104 405 87 358Q86 351 68 351Q48 351 48 361Q48 369 56 386T89 423T148 442Q224 442 258 400Q276 375 297 320T330 222L341 180Q344 180 455 303T573 429Q579 431 582 431Q600 431 600 414Q600 407 587 392T477 270Q356 138 353 134L362 102Q392 -10 428 -89T490 -168Q504 -168 517 -156T536 -126Q539 -116 543 -115T557 -114T571 -115Q576 -118 576 -125Z"></path><path stroke-width="0" id="E34-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E34-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E34-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E34-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path stroke-width="0" id="E34-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E34-MJMATHI-54" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path stroke-width="0" id="E34-MJMAIN-3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.14" transform="translate(0,1470)"><use xlink:href="#E34-MJMAIN-28"></use><use xlink:href="#E34-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E34-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E34-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E34-MJMAIN-34" x="1667" y="0"></use><use xlink:href="#E34-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(25040,0)"><g transform="translate(-15,0)"><g transform="translate(0,1470)"><use transform="scale(1.2)" xlink:href="#E34-MJMATHI-3C7" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E34-MJMAIN-32" x="885" y="583"></use><use transform="scale(1.2)" xlink:href="#E34-MJMAIN-3D" x="1357" y="0"></use><use transform="scale(1.2)" xlink:href="#E34-MJSZ2-2211" x="2413" y="0"></use><g transform="translate(4628,0)"><g transform="translate(344,0)"><rect stroke="none" width="4833" height="72" x="0" y="264"></rect><g transform="translate(72,839)"><use transform="scale(1.2)" xlink:href="#E34-MJMAIN-28" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E34-MJMATHI-41" x="389" y="0"></use><use transform="scale(1.2)" xlink:href="#E34-MJMAIN-2212" x="1361" y="0"></use><use transform="scale(1.2)" xlink:href="#E34-MJMATHI-54" x="2361" y="0"></use><g transform="translate(3678,0)"><use transform="scale(1.2)" xlink:href="#E34-MJMAIN-29" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E34-MJMAIN-32" x="550" y="674"></use></g></g><use transform="scale(1.2)" xlink:href="#E34-MJMATHI-54" x="1661" y="-686"></use></g></g><g transform="translate(2552,-1970)"><use xlink:href="#E34-MJMATHI-41" x="0" y="0"></use><use xlink:href="#E34-MJMAIN-3A" x="1027" y="0"></use><g transform="translate(1583,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">实</text></g><g transform="translate(2399,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">际</text></g><g transform="translate(3214,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">值</text></g><g transform="translate(4029,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">；</text></g></g><g transform="translate(2575,-3217)"><use xlink:href="#E34-MJMATHI-54" x="0" y="0"></use><use xlink:href="#E34-MJMAIN-3A" x="981" y="0"></use><g transform="translate(1537,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">期</text></g><g transform="translate(2353,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">望</text></g><g transform="translate(3168,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">值</text></g><g transform="translate(3983,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(52.4) matrix(1 0 0 -1 0 0)">；</text></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">\large \chi^{2}=\sum\frac{(A-T)^2}{T}\tag{5.14}\\
A:实际值；\\
T:期望值；\\</script></div></div><p><span>卡方分箱步骤：</span></p><ul><li><span>1）设定卡方阈值</span></li><li><span>2）根据要离散的属性值对实例进行排序</span></li><li><span>3）计算每一对相邻区间的卡方值</span></li><li><span>4）将卡方值最小的一对区间进行合并</span></li><li><span>5）重复3）4）两步直至满足停止条件，即只要当所有分箱对的卡方值都大于阈值，并且分箱数目小于最大分箱数时，计算就会继续，直到不满足。</span></li></ul><p><span>卡方值根据显著性水平和自由度来获得，比如查询</span><strong><span>卡方检验临界值表</span></strong><span>。一般推荐使用0.9，0.95，0.99的置信度(即显著性α取0.1, 0.05，0.01)。</span></p><ul><li><strong><span>案例分析</span></strong></li></ul><p><strong><span>案例目标：以LFP10370C2-200电池的分容容量和循环寿命为卡方检验的两个检验变量，利用卡方分箱对分容容量进行卡方分箱，并进行离散编码。</span></strong></p><p><span>案例流程如下：</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart9" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="61" style="max-width: 1077.86px; height: 101px;" viewBox="0 0 1077.859375 61" class="md-require-zoom-fix"><style>#mermaidChart9{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart9 .error-icon{fill:#552222;}#mermaidChart9 .error-text{fill:#552222;stroke:#552222;}#mermaidChart9 .edge-thickness-normal{stroke-width:2px;}#mermaidChart9 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart9 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart9 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart9 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart9 .marker{fill:#333333;}#mermaidChart9 .marker.cross{stroke:#333333;}#mermaidChart9 svg{font-family:sans-serif;font-size:16px;}#mermaidChart9 .label{font-family:sans-serif;color:#333;}#mermaidChart9 .label text{fill:#333;}#mermaidChart9 .node rect,#mermaidChart9 .node circle,#mermaidChart9 .node ellipse,#mermaidChart9 .node polygon,#mermaidChart9 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart9 .node .label{text-align:center;}#mermaidChart9 .node.clickable{cursor:pointer;}#mermaidChart9 .arrowheadPath{fill:#333333;}#mermaidChart9 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart9 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart9 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart9 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart9 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart9 .cluster text{fill:#333;}#mermaidChart9 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart9:root{--mermaid-font-family:sans-serif;}#mermaidChart9:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart9 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M223.859375,30.5L248.859375,30.5L273.859375,30.5" marker-end="url(#arrowhead352)" style="fill:none"></path><defs><marker id="arrowhead352" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M389.859375,30.5L414.859375,30.5L439.859375,30.5" marker-end="url(#arrowhead353)" style="fill:none"></path><defs><marker id="arrowhead353" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;"><path class="path" d="M603.859375,30.5L668.859375,30.5L733.859375,30.5" marker-end="url(#arrowhead354)" style="fill:none"></path><defs><marker id="arrowhead354" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-F" id="L-E-F" style="opacity: 1;"><path class="path" d="M817.859375,30.5L842.859375,30.5L867.859375,30.5" marker-end="url(#arrowhead355)" style="fill:none"></path><defs><marker id="arrowhead355" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-F LE-H" id="L-F-H" style="opacity: 1;"><path class="path" d="M951.859375,30.5L976.859375,30.5L1001.859375,30.5" marker-end="url(#arrowhead356)" style="fill:none"></path><defs><marker id="arrowhead356" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(668.859375,30.5)" style="opacity: 1;"><g transform="translate(-40,-12.5)" class="label"><rect rx="0" ry="0" width="80" height="25"></rect><foreignObject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>卡方值合并</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-202" transform="translate(115.9296875,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-107.9296875" y="-22.5" width="215.859375" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-97.9296875,-12.5)"><foreignObject width="195.859375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">标签变量分类编码,即二值化</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-203" transform="translate(331.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">特征水平排序</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-204" transform="translate(521.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-82" y="-22.5" width="164" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-72,-12.5)"><foreignObject width="144" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">计算相邻样本卡方值</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-205" transform="translate(775.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">卡方分箱</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-206" transform="translate(909.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">分类编码</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-207" transform="translate(1035.859375,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-34" y="-22.5" width="68" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-24,-12.5)"><foreignObject width="48" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">可视化</div></foreignObject></g></g></g></g></g></g></svg></div><p>&nbsp;</p><p><span>1）标签二值化</span></p><p><span>现在将LFP10370C2-200电池循环寿命二值化为分类标签，令y为电池循环寿命值，则二值化标准如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1800" cid="n1800" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="7.068ex" viewBox="0 -1783.6 59683.7 3043.2" role="img" focusable="false" style="vertical-align: -2.926ex; max-width: 100%;"><defs><path stroke-width="0" id="E35-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E35-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E35-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E35-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E35-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E35-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E35-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E35-MJMAIN-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path stroke-width="0" id="E35-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E35-MJMAIN-3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path><path stroke-width="0" id="E35-MJMAIN-37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path><path stroke-width="0" id="E35-MJMAIN-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path stroke-width="0" id="E35-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E35-MJMAIN-3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path><path stroke-width="0" id="E35-MJSZ3-7B" d="M618 -943L612 -949H582L568 -943Q472 -903 411 -841T332 -703Q327 -682 327 -653T325 -350Q324 -28 323 -18Q317 24 301 61T264 124T221 171T179 205T147 225T132 234Q130 238 130 250Q130 255 130 258T131 264T132 267T134 269T139 272T144 275Q207 308 256 367Q310 436 323 519Q324 529 325 851Q326 1124 326 1154T332 1205Q369 1358 566 1443L582 1450H612L618 1444V1429Q618 1413 616 1411L608 1406Q599 1402 585 1393T552 1372T515 1343T479 1305T449 1257T429 1200Q425 1180 425 1152T423 851Q422 579 422 549T416 498Q407 459 388 424T346 364T297 318T250 284T214 264T197 254L188 251L205 242Q290 200 345 138T416 3Q421 -18 421 -48T423 -349Q423 -397 423 -472Q424 -677 428 -694Q429 -697 429 -699Q434 -722 443 -743T465 -782T491 -816T519 -845T548 -868T574 -886T595 -899T610 -908L616 -910Q618 -912 618 -928V-943Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.15" transform="translate(0,-50)"><use xlink:href="#E35-MJMAIN-28"></use><use xlink:href="#E35-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E35-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E35-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E35-MJMAIN-35" x="1667" y="0"></use><use xlink:href="#E35-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(22574,0)"><g transform="translate(-15,0)"><g transform="translate(0,-50)"><use transform="scale(1.2)" xlink:href="#E35-MJMATHI-79" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-3D" x="774" y="0"></use><g transform="translate(2196,0)"><use transform="scale(1.2)" xlink:href="#E35-MJSZ3-7B"></use><g transform="translate(1067,0)"><g transform="translate(-15,0)"><g transform="translate(0,646)"><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-31" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-2C" x="500" y="0"></use></g><g transform="translate(0,-760)"><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-30" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-2C" x="500" y="0"></use></g></g><g transform="translate(1919,0)"><g transform="translate(0,646)"><use transform="scale(1.2)" xlink:href="#E35-MJMATHI-79" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-3C" x="774" y="0"></use><g transform="translate(2196,0)"><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-37"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-33" x="500" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-30" x="1000" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-30" x="1500" y="0"></use></g><g transform="translate(6596,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">正</text></g><g transform="translate(7575,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(8553,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g></g><g transform="translate(0,-760)"><use transform="scale(1.2)" xlink:href="#E35-MJMATHI-79" x="0" y="0"></use><g transform="translate(929,0)"><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-3E"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-3D" x="778" y="0"></use></g><g transform="translate(3130,0)"><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-37"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-33" x="500" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-30" x="1000" y="0"></use><use transform="scale(1.2)" xlink:href="#E35-MJMAIN-30" x="1500" y="0"></use></g><g transform="translate(6530,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">负</text></g><g transform="translate(7508,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(8487,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">\large y=\begin{cases}\tag{5.15}
1, &y<7300\quad\quad 正样本\\
0, &y>=7300\quad 负样本\\
\end{cases}</script></div></div><p><span>2）计算过程和结果</span></p><p><span>计算是利用python代码实现，限于篇幅原因将实现过程省略，</span><strong><span>其中置信度区间取95%，自由度为1（样本两两检验），最大分箱数为10，停止条件为大于置信水平且分箱数目小于最大分箱数，</span></strong><span>结果如下：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>分箱编码</span></th><th style='text-align:center;' ><span>分箱区间</span></th><th style='text-align:center;' ><span>负样本数量</span></th><th style='text-align:center;' ><span>正样本数量</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>（0，190.4]</span></td><td style='text-align:center;' ><span>8</span></td><td style='text-align:center;' ><span>1</span></td></tr><tr><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>（190.4，194.6]</span></td><td style='text-align:center;' ><span>8</span></td><td style='text-align:center;' ><span>39</span></td></tr><tr><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>（194.6，199.1]</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>153</span></td></tr><tr><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>（199.1，201.1]</span></td><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>60</span></td></tr><tr><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>（201.1，206.1]</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>169</span></td></tr><tr><td style='text-align:center;' ><span>5</span></td><td style='text-align:center;' ><span>（206.1，208.7]</span></td><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>55</span></td></tr><tr><td style='text-align:center;' ><span>6</span></td><td style='text-align:center;' ><span>（208.7，216.8]</span></td><td style='text-align:center;' ><span>65</span></td><td style='text-align:center;' ><span>119</span></td></tr><tr><td style='text-align:center;' ><span>7</span></td><td style='text-align:center;' ><span>（216.8，223.3]</span></td><td style='text-align:center;' ><span>235</span></td><td style='text-align:center;' ><span>40</span></td></tr><tr><td style='text-align:center;' ><span>8</span></td><td style='text-align:center;' ><span>（223.3，228.2]</span></td><td style='text-align:center;' ><span>315</span></td><td style='text-align:center;' ><span>133</span></td></tr><tr><td style='text-align:center;' ><span>9</span></td><td style='text-align:center;' ><span>&gt;228.2</span></td><td style='text-align:center;' ><span>142</span></td><td style='text-align:center;' ><span>3</span></td></tr></tbody></table></figure><p><span>3）可视化（可单击图片打开原始图片）</span></p><div class="responsive">   
    <div class="img" style="
    margin: 0px;
    border: 1px solid #ccc;
    float: left;
    width: 48%;  height: auto;">     
        <a target="_blank" href="figure/卡方分箱1.png">       
            <img loading="lazy" src="figure/卡方分箱1.png" alt="图片文本描述" style="
      width: 100%;  height: 380px;">     
        </a>     
        <div class="desc" style="padding: 15px;
    text-align: center;">卡方分箱散点图</div>   
    </div> 
</div>   
<div class="responsive" style="
    margin: 0px;
    border: 1px solid #ccc;
    float: right;
    width: 48%;  height: auto;">   
    <div class="img">     
        <a target="_blank" href="figure/卡方分箱散布.png">       
            <img loading="lazy" src="figure/卡方分箱散布.png" alt="图片文本描述" style="
      width: 100%;  height: 380px;">
        </a>     
        <div class="desc" style="padding: 15px;
    text-align: center;">卡方分箱编码</div>   
    </div> 
</div> <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div class="responsive" align="center">   
    <div class="img" style="                     
    margin: auto;
    border: 1px solid #ccc;
    width: 80%;">     
        <a target="_blank" href="figure/卡方分箱violin.png">       
            <img loading="lazy" src="figure/卡方分箱violin.png" alt="图片文本描述" style="
      width: 100%;  height: auto;">     
        </a>     
        <div class="desc" style="padding: 15px;
    text-align: center;">卡方分箱小提琴图+散点图</div>   
    </div> 
</div> <p>&nbsp;</p><p>&nbsp;</p><h6 id='522222-best-ks分箱'><span>5.2.2.2.2.2 Best-KS分箱</span></h6><p><span>在介绍Best-KS分箱前，需先了解一下KS值的含义。</span></p><ul><li><span>KS值</span></li></ul><p><span>KS（Kolmogorov-Smirnov）用于模型风险区分能力进行评估，指标衡量的是好坏样本累计部分之间的差距 。KS值越大，表示该变量越能将正，负样本的区分程度越大。通常来说，KS&gt;0.2即表示特征有较好的准确率。强调一下，分箱操作里的KS值是分箱特征变量的KS值，而不是模型的KS值。</span></p><p><strong><span>KS值计算过程</span></strong></p><ol start='' ><li><span>计算每个评分区间的正负样本数。</span></li><li><span>计算各每个评分区间的累计负样本数占总负样本数比率（negative%)和累计正样本数占总正样本数比率（postive%）。</span></li><li><span>计算每个评分区间累计正样本比与累计负账户占比差的绝对值（累计positive%-累计negative%），然后对这些绝对值取最大值记得到KS值。</span></li></ol><p><strong><span>注：机器学习中的正样本一般指的是少数类样本，比如案例中电池寿命&lt;7300的样本。之所以称少数类为正样本，主要是因为一般在标签二值化编码时常规定为1，而少数类一般是预测的核心部分，比如在做异常值检测时，异常值才是算法关心的预测结果。还比如，在做金融风险管控时，少数类客户一般就是指有违约风险的客户，这些客户是算法想要预测的核心样本。</span></strong></p><p><span>BestKs方法其实就是找到变量中的最优KS值进行切分，从而让分箱后的组别的分布差异最大化。具体操作步骤:</span></p><ol start='' ><li><span>对是连续变量的特征进行初步离散化，例如取整，等距分箱等离散化操作，如果特征本身就是离散变量，就可跳过此步骤；</span></li><li><span>将离散后的特征值值进行从小到大的排序；</span></li><li><span>计算出KS最大的那个值，即为切点，记为D。然后把数据切分成两部分。</span></li><li><span>重复步骤2，进行递归，D左右的数据进一步切割。直到KS的箱体数达到预设阈值。</span></li></ol><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart10" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="121" style="max-width: 1131.39px; height: 161px;" viewBox="0 0 1131.390625 121" class="md-require-zoom-fix"><style>#mermaidChart10{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart10 .error-icon{fill:#552222;}#mermaidChart10 .error-text{fill:#552222;stroke:#552222;}#mermaidChart10 .edge-thickness-normal{stroke-width:2px;}#mermaidChart10 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart10 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart10 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart10 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart10 .marker{fill:#333333;}#mermaidChart10 .marker.cross{stroke:#333333;}#mermaidChart10 svg{font-family:sans-serif;font-size:16px;}#mermaidChart10 .label{font-family:sans-serif;color:#333;}#mermaidChart10 .label text{fill:#333;}#mermaidChart10 .node rect,#mermaidChart10 .node circle,#mermaidChart10 .node ellipse,#mermaidChart10 .node polygon,#mermaidChart10 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart10 .node .label{text-align:center;}#mermaidChart10 .node.clickable{cursor:pointer;}#mermaidChart10 .arrowheadPath{fill:#333333;}#mermaidChart10 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart10 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart10 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart10 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart10 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart10 .cluster text{fill:#333;}#mermaidChart10 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart10:root{--mermaid-font-family:sans-serif;}#mermaidChart10:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart10 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M124,47.84782608695652L181,30.5L238,30.5" marker-end="url(#arrowhead394)" style="fill:none"></path><defs><marker id="arrowhead394" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M338,30.5L363,30.5L388,47.65686274509804" marker-end="url(#arrowhead395)" style="fill:none"></path><defs><marker id="arrowhead395" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M124,83.15217391304347L181,100.5L288,100.5L363,100.5L388,83.34313725490196" marker-end="url(#arrowhead396)" style="fill:none"></path><defs><marker id="arrowhead396" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M440,65.5L465,65.5L490,65.5" marker-end="url(#arrowhead397)" style="fill:none"></path><defs><marker id="arrowhead397" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;"><path class="path" d="M641.390625,65.5L666.390625,65.5L691.390625,65.5" marker-end="url(#arrowhead398)" style="fill:none"></path><defs><marker id="arrowhead398" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-E LE-H" id="L-E-H" style="opacity: 1;"><path class="path" d="M775.390625,65.5L832.390625,65.5L889.390625,65.5" marker-end="url(#arrowhead399)" style="fill:none"></path><defs><marker id="arrowhead399" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-H LE-I" id="L-H-I" style="opacity: 1;"><path class="path" d="M1005.390625,65.5L1030.390625,65.5L1055.390625,65.5" marker-end="url(#arrowhead400)" style="fill:none"></path><defs><marker id="arrowhead400" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(181,30.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>连续变量</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(288,100.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>离散变量</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(832.390625,65.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>重复递归</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-217" transform="translate(66,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">判断特征类型</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-218" transform="translate(288,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-50" y="-22.5" width="100" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-40,-12.5)"><foreignObject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">初步离散化</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-219" transform="translate(414,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">排序</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-222" transform="translate(565.6953125,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-75.6953125" y="-22.5" width="151.390625" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-65.6953125,-12.5)"><foreignObject width="131.390625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">计算找出最大KS值</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-223" transform="translate(733.390625,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">切分数据</div></foreignObject></g></g></g><g class="node default" id="flowchart-H-224" transform="translate(947.390625,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">达到停止条件</div></foreignObject></g></g></g><g class="node default" id="flowchart-I-225" transform="translate(1089.390625,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-34" y="-22.5" width="68" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-24,-12.5)"><foreignObject width="48" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">可视化</div></foreignObject></g></g></g></g></g></g></svg></div><p><span>还是以</span><strong><span>LFP10370C2-200电池的分容容量为待分箱特征，判定标签为循环寿命是否达到7300，对分容容量进行Best-KS分箱编码</span></strong><span>为案例来说明：</span></p><p><span>1）标签二值化</span></p><p><span>此步骤同卡方分箱一致。</span></p><p><span>2）计算过程和结果</span></p><p><span>省略代码实现过程。其中</span><strong><span>初步离散化操作采取取整操作，就是对原本带有小数位的分容容量进行取整操作</span></strong><span>。停止条件为下列任意一项：</span></p><ol start='' ><li><span>分箱后，两个箱中数量最小的箱中样本总数低于样本总数的5%；</span></li><li><span>分箱后，箱中正样本或负样本的数量为0；</span></li></ol><p><strong><span>计算结果：</span></strong></p><p><span>当分箱数大于4时，达到停止条件，故分箱数为4。</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>分箱编码</span></th><th style='text-align:center;' ><span>分箱区间</span></th><th style='text-align:center;' ><span>负样本数量</span></th><th style='text-align:center;' ><span>正样本数量</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>[169.0-216.0]</span></td><td style='text-align:center;' ><span>84</span></td><td style='text-align:center;' ><span>591</span></td></tr><tr><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>[217.0-223.0]</span></td><td style='text-align:center;' ><span>327</span></td><td style='text-align:center;' ><span>140</span></td></tr><tr><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>[224.0-227.0]</span></td><td style='text-align:center;' ><span>200</span></td><td style='text-align:center;' ><span>36</span></td></tr><tr><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>[228.0-237.0]</span></td><td style='text-align:center;' ><span>169</span></td><td style='text-align:center;' ><span>5</span></td></tr></tbody></table></figure><p><span>3）可视化（可单击图片打开原始图片）</span></p><p>&nbsp;</p><div class="responsive">   
    <div class="img" style="
    margin: 0px;
    border: 1px solid #ccc;
    float: left;
    width: 48%;  height: auto;">     
        <a target="_blank" href="figure/B-KS分箱.png">       
            <img loading="lazy" src="figure/B-KS分箱.png" alt="图片文本描述" style="
      width: 100%;  height: 380px;">     
        </a>     
        <div class="desc" style="padding: 15px;
    text-align: center;">B-KS分箱散点图</div>   
    </div> 
</div>   
<div class="responsive" style="
    margin:0px;
    border: 1px solid #ccc;
    float: right;
    width: 48%;  height: auto;">   
    <div class="img">     
        <a target="_blank" href="figure/B-KS分箱散布.png">       
            <img loading="lazy" src="figure/B-KS分箱散布.png" alt="图片文本描述" style="
      width: 100%;  height: 380px;">
        </a>     
        <div class="desc" style="padding: 15px;
    text-align: center;">B-KS分箱编码</div>   
    </div> 
</div> <p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div class="responsive" align="center">   
    <div class="img" style="                     
    margin: auto;
    border: 1px solid #ccc;
    width: 80%;">     
        <a target="_blank" href="figure/B-KS分箱violin.png">       
            <img loading="lazy" src="figure/B-KS分箱violin.png" alt="图片文本描述" style="
      width: 100%;  height: auto;">     
        </a>     
        <div class="desc" style="padding: 15px;
    text-align: center;">B-KS分箱小提琴图+散点图</div>   
    </div> 
</div> <p>&nbsp;</p><h6 id='522223-woe编码和iv'><span>5.2.2.2.2.3 WOE编码和IV</span></h6><p><span>分箱策略好不好，需要有一定的评判标准。最直接的方法就是将编码后的数据直接输入到模型中进行拟合，看拟合效果。在实际应用中，数据在完成分箱处理之后其实不必每次都输入到模型中重新跑一遍，如果模型比较复杂这样会花费很高的时间成本。最好的办法就是在完成分箱之后用一个指标来评价策越的好坏，这就是我们下面要说的WOE和IV。</span></p><ul><li><strong><span>WOE</span></strong></li></ul><p><span>WOE的全称是“Weight of Evidence”，即证据权重。WOE是对原始特征的一种</span><strong><span>编码形式</span></strong><span>。要对一个特征进行WOE编码，需要首先把这个变量进行分箱处理（也叫分组处理）。分箱后，对于第i箱，WOE的计算公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1968" cid="n1968" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="30.922ex" viewBox="0 -2674.4 59683.7 13313.6" role="img" focusable="false" style="vertical-align: -24.711ex; max-width: 100%;"><defs><path stroke-width="0" id="E36-MJMATHI-57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path><path stroke-width="0" id="E36-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E36-MJMATHI-45" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path stroke-width="0" id="E36-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E36-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E36-MJMAIN-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path stroke-width="0" id="E36-MJMAIN-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path stroke-width="0" id="E36-MJMATHI-70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path stroke-width="0" id="E36-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E36-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E36-MJMATHI-54" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path stroke-width="0" id="E36-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E36-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E36-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E36-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E36-MJMAIN-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path stroke-width="0" id="E36-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E36-MJMAIN-3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(22095,0)"><use transform="scale(1.44)" xlink:href="#E36-MJMATHI-57" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E36-MJMATHI-4F" x="1048" y="0"></use><g transform="translate(2607,0)"><use transform="scale(1.44)" xlink:href="#E36-MJMATHI-45" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E36-MJMATHI-69" x="1043" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E36-MJMAIN-3D" x="3170" y="0"></use><g transform="translate(6086,0)"><use transform="scale(1.44)" xlink:href="#E36-MJMAIN-6C"></use><use transform="scale(1.44)" xlink:href="#E36-MJMAIN-6E" x="278" y="0"></use></g><g transform="translate(7287,0)"><g transform="translate(412,0)"><rect stroke="none" width="2002" height="86" x="0" y="316"></rect><g transform="translate(142,1203)"><use transform="scale(1.44)" xlink:href="#E36-MJMATHI-70" x="0" y="0"></use><g transform="translate(724,-331)"><use transform="scale(1.018)" xlink:href="#E36-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E36-MJMATHI-69" x="692" y="-340"></use></g></g><g transform="translate(86,-988)"><use transform="scale(1.44)" xlink:href="#E36-MJMATHI-70" x="0" y="0"></use><g transform="translate(724,-331)"><use transform="scale(1.018)" xlink:href="#E36-MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E36-MJMATHI-69" x="848" y="-213"></use></g></g></g></g><use transform="scale(1.44)" xlink:href="#E36-MJMAIN-3D" x="7135" y="0"></use><g transform="translate(11795,0)"><use transform="scale(1.44)" xlink:href="#E36-MJMAIN-6C"></use><use transform="scale(1.44)" xlink:href="#E36-MJMAIN-6E" x="278" y="0"></use></g><g transform="translate(12996,0)"><g transform="translate(412,0)"><rect stroke="none" width="1910" height="86" x="0" y="316"></rect><g transform="translate(142,1361)"><g transform="translate(172,0)"><rect stroke="none" width="1280" height="86" x="0" y="316"></rect><g transform="translate(215,797)"><use transform="scale(1.018)" xlink:href="#E36-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E36-MJMATHI-69" x="692" y="-340"></use></g><g transform="translate(86,-497)"><use transform="scale(1.018)" xlink:href="#E36-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E36-MJMATHI-54" x="692" y="-340"></use></g></g></g><g transform="translate(86,-1057)"><g transform="translate(172,0)"><rect stroke="none" width="1392" height="86" x="0" y="316"></rect><g transform="translate(215,705)"><use transform="scale(1.018)" xlink:href="#E36-MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E36-MJMATHI-69" x="848" y="-213"></use></g><g transform="translate(86,-497)"><use transform="scale(1.018)" xlink:href="#E36-MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E36-MJMATHI-54" x="848" y="-213"></use></g></g></g></g></g></g><g transform="translate(0,-6595)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.16" transform="translate(0,3618)"><use xlink:href="#E36-MJMAIN-28"></use><use xlink:href="#E36-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E36-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E36-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E36-MJMAIN-36" x="1667" y="0"></use><use xlink:href="#E36-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(21903,0)"><g transform="translate(-15,0)"><g transform="translate(0,3618)"><use transform="scale(1.2)" xlink:href="#E36-MJMATHI-70" x="0" y="0"></use><g transform="translate(603,-276)"><use transform="scale(0.849)" xlink:href="#E36-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.6)" xlink:href="#E36-MJMATHI-69" x="692" y="-340"></use></g><use transform="scale(1.2)" xlink:href="#E36-MJMAIN-3A" x="1470" y="0"></use><g transform="translate(2431,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">分</text></g><g transform="translate(3410,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">箱</text></g><g transform="translate(4388,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">内</text></g><g transform="translate(5367,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">正</text></g><g transform="translate(6345,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(7324,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(8302,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">占</text></g><g transform="translate(9281,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">所</text></g><g transform="translate(10260,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">有</text></g><g transform="translate(11238,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">正</text></g><g transform="translate(12217,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(13195,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(14174,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">比</text></g><g transform="translate(15152,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">例</text></g></g><g transform="translate(0,1993)"><use transform="scale(1.2)" xlink:href="#E36-MJMATHI-70" x="0" y="0"></use><g transform="translate(603,-276)"><use transform="scale(0.849)" xlink:href="#E36-MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.6)" xlink:href="#E36-MJMATHI-69" x="848" y="-213"></use></g><use transform="scale(1.2)" xlink:href="#E36-MJMAIN-3A" x="1548" y="0"></use><g transform="translate(2524,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">分</text></g><g transform="translate(3503,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">箱</text></g><g transform="translate(4481,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">内</text></g><g transform="translate(5460,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">负</text></g><g transform="translate(6439,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(7417,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(8396,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">占</text></g><g transform="translate(9374,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">所</text></g><g transform="translate(10353,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">有</text></g><g transform="translate(11331,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">负</text></g><g transform="translate(12310,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(13289,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(14267,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">比</text></g><g transform="translate(15246,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">例</text></g></g><g transform="translate(0,445)"><use transform="scale(1.2)" xlink:href="#E36-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E36-MJMATHI-69" x="692" y="-340"></use><use transform="scale(1.2)" xlink:href="#E36-MJMAIN-3A" x="1111" y="0"></use><g transform="translate(2001,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">分</text></g><g transform="translate(2979,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">箱</text></g><g transform="translate(3958,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">内</text></g><g transform="translate(4936,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">正</text></g><g transform="translate(5915,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(6893,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(7872,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(8851,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">量</text></g></g><g transform="translate(0,-992)"><use transform="scale(1.2)" xlink:href="#E36-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E36-MJMATHI-54" x="692" y="-340"></use><use transform="scale(1.2)" xlink:href="#E36-MJMAIN-3A" x="1365" y="0"></use><g transform="translate(2305,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">所</text></g><g transform="translate(3284,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">有</text></g><g transform="translate(4262,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">正</text></g><g transform="translate(5241,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(6219,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(7198,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(8177,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">量</text></g></g><g transform="translate(0,-2419)"><use transform="scale(1.2)" xlink:href="#E36-MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E36-MJMATHI-69" x="848" y="-213"></use><use transform="scale(1.2)" xlink:href="#E36-MJMAIN-3A" x="1221" y="0"></use><g transform="translate(2133,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">分</text></g><g transform="translate(3111,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">箱</text></g><g transform="translate(4090,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">负</text></g><g transform="translate(5068,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(6047,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(7025,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(8004,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">量</text></g></g><g transform="translate(0,-3758)"><use transform="scale(1.2)" xlink:href="#E36-MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.849)" xlink:href="#E36-MJMATHI-54" x="848" y="-213"></use><use transform="scale(1.2)" xlink:href="#E36-MJMAIN-3A" x="1475" y="0"></use><g transform="translate(2437,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">所</text></g><g transform="translate(3416,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">有</text></g><g transform="translate(4394,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">负</text></g><g transform="translate(5373,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(6351,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g><g transform="translate(7330,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">数</text></g><g transform="translate(8309,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">量</text></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">\Large WOE_i=\ln\frac{p_{y_i}}{p_{n_i}}=\ln\frac{\frac{y_i}{y_T}}{\frac{n_i}{n_T}}\tag{5.16}\\
\begin{align*}
&\large p_{y_i}:分箱内正样本占所有正样本比例\\
&\large p_{n_i}:分箱内负样本占所有负样本比例\\
&\large y_i:分箱内正样本数量\\
&\large y_T:所有正样本数量\\
&\large n_i:分箱负样本数量\\
&\large n_T:所有负样本数量\\
\end{align*}</script></div></div><p><span>从这个公式中我们可以体会到，WOE表示的实际上是“当前分组中正例样本占所有样本中所有正例样本的比例”和“当前分组中负例样本占所有样本中所有负例样本比例”的差异，再取对数来表示的。WOE越大，这种差异越大，这个分组里的样本是正样本的可能性就越大（这组数据分到正例的概率越大），WOE越小，差异越小，这个分组里的样本是正样本的可能性就越小。对于一组样本数据，上述公式中的分母是固定的，如果分子中的yi越大，则WOE返回的数值越大。</span></p><p><span>那么WOE在业务中常有哪些应用呢？</span></p><ol start='' ><li><strong><span>处理缺失值</span></strong><span>：当数据源没有100%覆盖时，那就会存在缺失值，此时可以把null单独作为一个分箱。这点在分数据源建模时非常有用，可以有效将覆盖率哪怕只有20%的数据源利用起来。</span></li><li><strong><span>处理异常值</span></strong><span>：当数据中存在离群点时，可以把其通过分箱离散化处理，从而提高变量的鲁棒性（抗干扰能力）。例如，LFP10370C2-200电池分容容量若出现160mAh这种异常值，可分入“分容容量 &lt;170”这个分箱里，排除影响。</span></li><li><strong><span>业务解释性</span></strong><span>：我们习惯于线性判断变量的作用，当x越来越大，y就越来越大。但实际x与y之间经常存在着</span><strong><span>非线性</span></strong><span>关系，此时可经过WOE变换。</span></li></ol><p><strong><span>对连续变量进行WOE编码，需要先离散化，然后进行WOE编码; 对离散变量进行WOE编码，则要看离散值数量，如果离散值数量太多，则要适当地合并分箱后再进行WOE编码</span></strong><span>。WOE编码流程如下：</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart11" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="226" style="max-width: 902.109px; height: 266px;" viewBox="0 0 902.109375 226" class="md-require-zoom-fix"><style>#mermaidChart11{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart11 .error-icon{fill:#552222;}#mermaidChart11 .error-text{fill:#552222;stroke:#552222;}#mermaidChart11 .edge-thickness-normal{stroke-width:2px;}#mermaidChart11 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart11 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart11 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart11 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart11 .marker{fill:#333333;}#mermaidChart11 .marker.cross{stroke:#333333;}#mermaidChart11 svg{font-family:sans-serif;font-size:16px;}#mermaidChart11 .label{font-family:sans-serif;color:#333;}#mermaidChart11 .label text{fill:#333;}#mermaidChart11 .node rect,#mermaidChart11 .node circle,#mermaidChart11 .node ellipse,#mermaidChart11 .node polygon,#mermaidChart11 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart11 .node .label{text-align:center;}#mermaidChart11 .node.clickable{cursor:pointer;}#mermaidChart11 .arrowheadPath{fill:#333333;}#mermaidChart11 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart11 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart11 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart11 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart11 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart11 .cluster text{fill:#333;}#mermaidChart11 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart11:root{--mermaid-font-family:sans-serif;}#mermaidChart11:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart11 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M127.0625,83.30571731074643L187.125,65.5L244.125,65.5" marker-end="url(#arrowhead428)" style="fill:none"></path><defs><marker id="arrowhead428" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-D" id="L-B-D" style="opacity: 1;"><path class="path" d="M376.125,47.86641221374046L441.125,30.5L588.0546875,30.5" marker-end="url(#arrowhead429)" style="fill:none"></path><defs><marker id="arrowhead429" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-F" id="L-D-F" style="opacity: 1;"><path class="path" d="M672.0546875,30.5L778.984375,30.5L826.5267857142857,78" marker-end="url(#arrowhead430)" style="fill:none"></path><defs><marker id="arrowhead430" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-F" id="L-B-F" style="opacity: 1;"><path class="path" d="M376.125,83.13358778625954L441.125,100.5L630.0546875,100.5L778.984375,100.5L803.984375,100.5" marker-end="url(#arrowhead431)" style="fill:none"></path><defs><marker id="arrowhead431" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M107.01116071428572,123L187.125,170.5L310.125,170.5L441.125,170.5L506.125,170.5" marker-end="url(#arrowhead432)" style="fill:none"></path><defs><marker id="arrowhead432" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-F" id="L-C-F" style="opacity: 1;"><path class="path" d="M753.984375,170.5L778.984375,170.5L826.5267857142857,123" marker-end="url(#arrowhead433)" style="fill:none"></path><defs><marker id="arrowhead433" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(187.125,65.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>离散变量</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(441.125,30.5)" style="opacity: 1;"><g transform="translate(-40,-12.5)" class="label"><rect rx="0" ry="0" width="80" height="25"></rect><foreignObject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>离散值太多</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(630.0546875,100.5)" style="opacity: 1;"><g transform="translate(-40,-12.5)" class="label"><rect rx="0" ry="0" width="80" height="25"></rect><foreignObject width="80" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>离散值不多</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(310.125,170.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>连续变量</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-236" transform="translate(69.0625,100.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">判断变量类型</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-237" transform="translate(310.125,65.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-66" y="-22.5" width="132" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-56,-12.5)"><foreignObject width="112" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">判断离散值数量</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-238" transform="translate(630.0546875,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">合并分箱</div></foreignObject></g></g></g><g class="node default" id="flowchart-F-239" transform="translate(849.046875,100.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-45.0625" y="-22.5" width="90.125" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-35.0625,-12.5)"><foreignObject width="70.125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">WOE编码</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-243" transform="translate(630.0546875,170.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-123.9296875" y="-22.5" width="247.859375" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-113.9296875,-12.5)"><foreignObject width="227.859375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">离散化,如分箱编码等离散化操作</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-245" transform="translate(69.0625,195.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-61.0625" y="-22.5" width="122.125" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-51.0625,-12.5)"><foreignObject width="102.125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">WOE编码过程</div></foreignObject></g></g></g></g></g></g></svg></div><p>&nbsp;</p><ul><li><strong><span>IV</span></strong></li></ul><p><span>IV的全称是Information Value，中文意思是</span><strong><span>信息价值，或者信息量</span></strong><span>，用来衡量自变量的预测能力。那这个IV具体有什么用处呢？这个就要从特征工程的基础来讲：</span></p><p><span>我们构建分类模型时，经常需要对特征进行筛选（这也是后面章节</span><a href='#特征选择'><span>特征选择</span></a><span>重点内容)。比如我们有200个候选特征，通常情况下，不会直接把200个特征直接放到模型中去进行训练，那这样计算成本太高了。此时会用一些方法，从这200个特征中挑选一些出来，放进模型，形成训练集数据。那么我们怎么去挑选训练模型的特征呢？挑选特征的过程是个比较复杂的过程，需要考虑的因素很多，比如：特征的预测能力，特征之间的相关性，特征在业务上的可解释性等等。但是，其中最主要和最直接的衡量标准是特征的预测能力。“变量的预测能力”这个说法很笼统，在筛选变量的时候我们总不能说：“我觉得这个变量预测能力很强，所以要将其放入模型”吧？此时需要一些具体的量化指标来衡量每个自变量的预测能力，并根据这些量化指标的大小，来确定哪些变量进入模型。</span><strong><span>IV就是这样一种指标，可以用来衡量自变量(特征)的预测能力</span></strong><span>。</span></p><p><span>我们假设在一个分类问题中，目标变量的类别有两类：Y1，Y2（就如之前的案例中</span><strong><span>循环寿命是否达到标准</span></strong><span>）。对于一个待预测的样本A，要判断某一样本A属于Y1还是Y2，我们是需要一定的信息，假设这个信息总量是 </span><strong><span>I</span></strong><span>，而这些所需要的信息，就蕴含在所有的待预测样本的特征C</span><sub><span>1</span></sub><span>，C</span><sub><span>2</span></sub><span>，C</span><sub><span>3</span></sub><span>，……，C</span><sub><span>n</span></sub><span>中，那么，对于其中的一个特征C</span><sub><span>i</span></sub><span> 来说，其蕴含的信息越多，那么它对于判断A属于Y1还是Y2的贡献就越大，Ci的信息价值就越大，Ci的IV就越大，它就越应该进入到入模变量列表中。这就是IV的内涵所在。</span></p><p><span>有了前面的介绍，我们可以正式给出IV的计算公式。对于一个分组后的变量对应的IV</span><sub><span>i</span></sub><span>值，计算公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1988" cid="n1988" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="4.269ex" viewBox="0 -1154.8 59683.7 1838" role="img" focusable="false" style="vertical-align: -1.587ex; max-width: 100%;"><defs><path stroke-width="0" id="E37-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E37-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E37-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E37-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E37-MJMAIN-37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path><path stroke-width="0" id="E37-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E37-MJMATHI-49" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path><path stroke-width="0" id="E37-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E37-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E37-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E37-MJMATHI-70" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path stroke-width="0" id="E37-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E37-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E37-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E37-MJMAIN-2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"></path><path stroke-width="0" id="E37-MJMATHI-57" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path><path stroke-width="0" id="E37-MJMATHI-4F" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path stroke-width="0" id="E37-MJMATHI-45" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.17" transform="translate(0,1)"><use xlink:href="#E37-MJMAIN-28"></use><use xlink:href="#E37-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E37-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E37-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E37-MJMAIN-37" x="1667" y="0"></use><use xlink:href="#E37-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(22048,0)"><g transform="translate(-15,0)"><g transform="translate(0,1)"><use transform="scale(1.44)" xlink:href="#E37-MJMATHI-49" x="0" y="0"></use><g transform="translate(725,0)"><use transform="scale(1.44)" xlink:href="#E37-MJMATHI-56" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E37-MJMATHI-69" x="824" y="-213"></use></g><use transform="scale(1.44)" xlink:href="#E37-MJMAIN-3D" x="1708" y="0"></use><use transform="scale(1.44)" xlink:href="#E37-MJMAIN-28" x="2764" y="0"></use><g transform="translate(4541,0)"><use transform="scale(1.44)" xlink:href="#E37-MJMATHI-70" x="0" y="0"></use><g transform="translate(724,-331)"><use transform="scale(1.018)" xlink:href="#E37-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E37-MJMATHI-69" x="692" y="-340"></use></g></g><use transform="scale(1.44)" xlink:href="#E37-MJMAIN-2212" x="4568" y="0"></use><g transform="translate(8018,0)"><use transform="scale(1.44)" xlink:href="#E37-MJMATHI-70" x="0" y="0"></use><g transform="translate(724,-331)"><use transform="scale(1.018)" xlink:href="#E37-MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E37-MJMATHI-69" x="848" y="-213"></use></g></g><use transform="scale(1.44)" xlink:href="#E37-MJMAIN-29" x="6839" y="0"></use><use transform="scale(1.44)" xlink:href="#E37-MJMAIN-2217" x="7450" y="0"></use><use transform="scale(1.44)" xlink:href="#E37-MJMATHI-57" x="8172" y="0"></use><use transform="scale(1.44)" xlink:href="#E37-MJMATHI-4F" x="9220" y="0"></use><g transform="translate(14376,0)"><use transform="scale(1.44)" xlink:href="#E37-MJMATHI-45" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E37-MJMATHI-69" x="1043" y="-213"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-37">\Large IV_i=(p_{y_i}-p_{n_i})*WOE_{i}\tag{5.17}</script></div></div><p><span>计算整个变量的IV值，n为变量分组个数:</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1990" cid="n1990" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="9.624ex" viewBox="0 -2307.6 59683.7 4143.6" role="img" focusable="false" style="vertical-align: -4.264ex; max-width: 100%;"><defs><path stroke-width="0" id="E38-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E38-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E38-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E38-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E38-MJMAIN-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path stroke-width="0" id="E38-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E38-MJMATHI-49" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path><path stroke-width="0" id="E38-MJMATHI-56" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z"></path><path stroke-width="0" id="E38-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E38-MJSZ2-2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z"></path><path stroke-width="0" id="E38-MJMATHI-69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E38-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.18" transform="translate(0,-18)"><use xlink:href="#E38-MJMAIN-28"></use><use xlink:href="#E38-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E38-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E38-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E38-MJMAIN-38" x="1667" y="0"></use><use xlink:href="#E38-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(25949,0)"><g transform="translate(-15,0)"><g transform="translate(0,-18)"><use transform="scale(1.44)" xlink:href="#E38-MJMATHI-49" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E38-MJMATHI-56" x="504" y="0"></use><use transform="scale(1.44)" xlink:href="#E38-MJMAIN-3D" x="1550" y="0"></use><g transform="translate(3753,0)"><use transform="scale(1.44)" xlink:href="#E38-MJSZ2-2211" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E38-MJMATHI-69" x="848" y="-1534"></use><use transform="scale(1.018)" xlink:href="#E38-MJMATHI-6E" x="721" y="1626"></use></g><use transform="scale(1.44)" xlink:href="#E38-MJMATHI-49" x="4217" y="0"></use><g transform="translate(6798,0)"><use transform="scale(1.44)" xlink:href="#E38-MJMATHI-56" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E38-MJMATHI-69" x="824" y="-213"></use></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-38">\Large IV=\sum_{i}^{n}IV_i\tag{5.18}</script></div></div><p><span>得到变量的IV值后，如何评判变量的预测能力呢？一般在应用实践中，其评价标准如下：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>特征IV值范围</span></th><th style='text-align:center;' ><span>特征预测效果</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>&lt;0.02</span></td><td style='text-align:center;' ><span>几乎没有</span></td></tr><tr><td style='text-align:center;' ><span>0.02~0.1</span></td><td style='text-align:center;' ><span>弱</span></td></tr><tr><td style='text-align:center;' ><span>0.1~0.3</span></td><td style='text-align:center;' ><span>中</span></td></tr><tr><td style='text-align:center;' ><span>0.3~0.5</span></td><td style='text-align:center;' ><span>强</span></td></tr><tr><td style='text-align:center;' ><span>&gt;0.5</span></td><td style='text-align:center;' ><span>极高，可能要介入调查</span></td></tr></tbody></table></figure><p><span>IV依赖WOE，并且IV是一个很好的衡量自变量对目标变量影响程度的指标。但是，使用过程中应该注意一个问题：变量的任何分组中，不应该出现正样本数=0或负样本数=0的情况。原因很简单，当变量一个分组中，响应数=0时，IV=±∞。很不巧的是，我们之前在进行卡方分箱时，出现了分箱内，正/负样本数=0的情况，那么该如何处理呢？</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>分箱编码</span></th><th style='text-align:center;' ><span>分箱区间</span></th><th style='text-align:center;' ><span>负样本数量</span></th><th style='text-align:center;' ><span>正样本数量</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>（0，190.4]</span></td><td style='text-align:center;' ><span>8</span></td><td style='text-align:center;' ><span>1</span></td></tr><tr><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>（190.4，194.6]</span></td><td style='text-align:center;' ><span>8</span></td><td style='text-align:center;' ><span>39</span></td></tr><tr><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>（194.6，199.1]</span></td><td style='text-align:center;' ><mark><span>0</span></mark></td><td style='text-align:center;' ><span>153</span></td></tr><tr><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>（199.1，201.1]</span></td><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>60</span></td></tr><tr><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>（201.1，206.1]</span></td><td style='text-align:center;' ><mark><span>0</span></mark></td><td style='text-align:center;' ><span>169</span></td></tr><tr><td style='text-align:center;' ><span>5</span></td><td style='text-align:center;' ><span>（206.1，208.7]</span></td><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>55</span></td></tr><tr><td style='text-align:center;' ><span>6</span></td><td style='text-align:center;' ><span>（208.7，216.8]</span></td><td style='text-align:center;' ><span>65</span></td><td style='text-align:center;' ><span>119</span></td></tr><tr><td style='text-align:center;' ><span>7</span></td><td style='text-align:center;' ><span>（216.8，223.3]</span></td><td style='text-align:center;' ><span>235</span></td><td style='text-align:center;' ><span>40</span></td></tr><tr><td style='text-align:center;' ><span>8</span></td><td style='text-align:center;' ><span>（223.3，228.2]</span></td><td style='text-align:center;' ><span>315</span></td><td style='text-align:center;' ><span>133</span></td></tr><tr><td style='text-align:center;' ><span>9</span></td><td style='text-align:center;' ><span>&gt;228.2</span></td><td style='text-align:center;' ><span>142</span></td><td style='text-align:center;' ><span>3</span></td></tr></tbody></table></figure><p><span>一般有下面三种</span><a id='IV处理手段'><span>处理手段</span></a><span>：</span></p><p><span>（1）如果可能，直接把这个分组做成一个规则，作为模型的前置条件或补充条件；</span></p><p><span>（2）重新对变量进行离散化或分组，使每个分组的响应比例都不为0且不为100%，尤其是当一个分箱个体数很小时，建议这样操作，因为本身把一个分箱个体数弄得很小就不是太合理。</span></p><p><span>（3）如果上面两种方法都无法使用，建议人工把该分箱的正样本数和负样本数进行一定的调整。如果正样本数原本为0，可以人工调整正样本数为1，或者正样本数原本为0，可以人工调整为1.</span></p><p><span>针对第一种处理方式，我们来看一下。从表中可以看出在</span><strong><span>194.6&lt;电池分容容量&lt;=206.1时，样本几乎都是由正样本构成，即循环寿命小于7300，比例为（153+60+169）/（4+153+60+169）=382/386≈99.0%，这就说明对于此数据空间构成的模型，电池的分容容量落在这个上述区间时有极大概率循环寿命小于7300，那么我们就可以为这个循环寿命预测模型（只针对原有数据构成的模型）设立这样的规则：当194.6&lt;电池分容容量&lt;=206.1时，人为规定模型预测的循环寿命小于7300，后续在做循环寿命预测时可以将其作为模型的前置条件。</span></strong><span>这样处理能相当大程度地简化模型，并使模型专注于其它区间的规律。但需要说明的是，这样处理的只能针对当前数据空间，如果有新数据点加入，就需要重新评估该区间的构成。同时，</span><strong><span>这样处理只能应用在对正负样本预测没有风险控制的范畴里，比如像电池测试这样的环境里，存在比较多相同或近似特征水平构成的样本（同一材料构成、测试参数构成的电池，如同一实验批次下相同测试参数的电池样本），此时因为有其它相同工艺电池的表现来背书，所以可以认为这些微量负样本是系统误差，不影响预测结果。但如果模型有严格的风险管控要求，比如在电池异常值检测模型中；还比如其它风险管控领域中，如在信用卡用户评级模型中，是不能忽略这些微量样本的，因为这些样本就是潜在的风险客户（bad customer)。</span></strong></p><p><span>将分组当作规则，从而消除样本数为0的分箱，这样做毕竟有很大的局限性。所以更多的时候我们会采取第二种做法：重新分箱。比如将（194.6，199.1]，（199.1，201.1]，（201.1，206.1]合并成一组（194.6，206.1]，分组后的正负样本数为382 / 4。重新分组后就消除样本数为0的分箱，同时也不过多影响其它区间的卡方分箱结果。至于第三种处理方法：人工调整样本数，这种做法属于人为操纵修改模型，尽量避免。</span></p><p><span>回到本节案例中，为了评估和比较</span><strong><span>经过卡方分箱和</span><a id='best-ks'><span>Best-KS分箱</span></a><span>编码后的分容容量这个特征对循环寿命的预测效果</span></strong><span>，分别对这两种编码，并对样本数为0的分箱进行重新分箱后的分容容量特征求IV值，看两种编码的效果如何。</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>卡方编码</span></th><th style='text-align:center;' ><span>卡方区间</span></th><th style='text-align:center;' ><span>卡方WOE</span></th><th style='text-align:center;' ><span>卡方IV</span></th><th style='text-align:center;' ><span>Best-KS编码</span></th><th style='text-align:center;' ><span>Best-KS区间</span></th><th style='text-align:center;' ><span>Best-KS WOE</span></th><th style='text-align:center;' ><span>Best-KS IV</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>（0，190.4]</span></td><td style='text-align:center;' ><mark><span>-2.0691</span></mark></td><td style='text-align:center;' ><span>0.0185</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>[169.0-216.0]</span></td><td style='text-align:center;' ><span>1.9613</span></td><td style='text-align:center;' ><span>1.2903</span></td></tr><tr><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>（190.4，194.6]</span></td><td style='text-align:center;' ><span>1.5944</span></td><td style='text-align:center;' ><span>0.0642</span></td><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>[217.0-223.0]</span></td><td style='text-align:center;' ><span>-0.838</span></td><td style='text-align:center;' ><span>0.1993</span></td></tr><tr><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>（194.6，206.1]</span></td><td style='text-align:center;' ><mark><span>4.5694</span></mark></td><td style='text-align:center;' ><span>2.2376</span></td><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>[224.0-227.0]</span></td><td style='text-align:center;' ><span>-1.7045</span></td><td style='text-align:center;' ><span>0.3576</span></td></tr><tr><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>（206.1，208.7]</span></td><td style='text-align:center;' ><span>2.919</span></td><td style='text-align:center;' ><span>0.1967</span></td><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>[228.0-237.0]</span></td><td style='text-align:center;' ><span>-3.5102</span></td><td style='text-align:center;' ><span>0.7378</span></td></tr><tr><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>（208.7，216.8]</span></td><td style='text-align:center;' ><span>0.615</span></td><td style='text-align:center;' ><span>0.0436</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' ><span>5</span></td><td style='text-align:center;' ><span>（216.8，223.3]</span></td><td style='text-align:center;' ><span>-0.8519</span></td><td style='text-align:center;' ><span>0.1973</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' ><span>6</span></td><td style='text-align:center;' ><span>（223.3，228.2]</span></td><td style='text-align:center;' ><span>-1.7604</span></td><td style='text-align:center;' ><span>0.4392</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' ><span>7</span></td><td style='text-align:center;' ><span>&gt;228.2</span></td><td style='text-align:center;' ><span>-3.8469</span></td><td style='text-align:center;' ><span>0.6854</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' >&nbsp;</td></tr><tr><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' ><span>总计：</span></td><td style='text-align:center;' ><span>1.1695</span></td><td style='text-align:center;' ><span>3.8825</span></td><td style='text-align:center;' >&nbsp;</td><td style='text-align:center;' ><span>总计：</span></td><td style='text-align:center;' ><span>-4.0914</span></td><td style='text-align:center;' ><span>2.585</span></td></tr></tbody></table></figure><p><span>从上面的结果对比来看，卡方分箱更为精细，得到IV值也更大（IV值会随着分箱数的变多而增长，但是如果分箱数量过多，比如大于20个分箱会导致每个分箱中样本数量太少，导致某个分箱几乎没有正样本或者是几乎没有负样本）。其实这也容易理解，分箱越细，特征提供的信息量越大，细节越多，自然IV值也越大。</span></p><p><span>之前我们分析过，对于某一具体分箱，</span><strong><span>正样本（在案例中正样本指的是循环寿命&lt;7300的电池）的比例越大，WOE值越大</span></strong><span>，从上表的Best-KS WOE中可以看出，WOE随着分容容量的增大整体呈现单调下降的趋势，即样本电池中循环寿命&lt;7300的电池占总体的比例随着分容容量的增大而逐渐下降。</span><strong><span>而卡方WOE则呈现了更多的细节，比如分容容量在（0，190.4]时，循环寿命&lt;7300的电池是少数，占比较小，分容容量在（194.6，206.1]区间时，占比最大，远高于负样本（即循环寿命&gt;=7300）的比例。这是一个十分有趣的结论！这证明了对于LFP10370C2-200这款电池而言，并非分容容量越大，循环寿命高于7300标准的概率越大，概率是随分容容量的增大是先从高到低，之后在上升的过程。</span></strong></p><h4 id='5223-利用woe和iv优化电池设计'><span>5.2.2.3 利用WOE和IV优化电池设计</span></h4><p><strong><span>既然已经谈到了WOE和IV能对特征的预测能力进行评判，那么我们就可以利用WOE和IV指标对电池的各项特征进行预测能力的计算和排名，选出最有价值的特征！这对电池设计而言是十分重要的，因为这意味着我们有了一种有效的工具能对电池各项细节进行筛选优化。</span></strong></p><p><span>光讲理论可能不是很直观，我们现在就以实际案例来进行讲解。</span></p><p><span>假设电池设计人员需要构建一个预测模型，这个模型是</span><strong><span>预测在LFP10370C2-200电池在经历过5000次循环后，电池的百分比容量是否大于90%（当然预测模型可以千变万化，随业务需要自由变换）。那么为达到预测目的，需要进行特征选择（不可能将所有变量作为输入特征，毕竟过多的特征会导致无法设计实验和成本爆炸），从中选出最有价值的特征进行优化</span></strong><span>，其实就是后面要讲的</span><a href='#特征选择'><span>特征选择</span></a><span>的过程。通过上面对WOE和IV的介绍，我们已经了解到，这两个指标是可以用在评价</span><strong><span>特征对模型标签的预测能力</span></strong><span>。我们的工作就是从众多候选特征中选择对模型最有预测价值的特征。</span></p><p><span>流程：</span></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart12" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="121" style="max-width: 1144.88px; height: 161px;" viewBox="0 0 1144.875 121" class="md-require-zoom-fix"><style>#mermaidChart12{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart12 .error-icon{fill:#552222;}#mermaidChart12 .error-text{fill:#552222;stroke:#552222;}#mermaidChart12 .edge-thickness-normal{stroke-width:2px;}#mermaidChart12 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart12 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart12 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart12 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart12 .marker{fill:#333333;}#mermaidChart12 .marker.cross{stroke:#333333;}#mermaidChart12 svg{font-family:sans-serif;font-size:16px;}#mermaidChart12 .label{font-family:sans-serif;color:#333;}#mermaidChart12 .label text{fill:#333;}#mermaidChart12 .node rect,#mermaidChart12 .node circle,#mermaidChart12 .node ellipse,#mermaidChart12 .node polygon,#mermaidChart12 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart12 .node .label{text-align:center;}#mermaidChart12 .node.clickable{cursor:pointer;}#mermaidChart12 .arrowheadPath{fill:#333333;}#mermaidChart12 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart12 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart12 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart12 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart12 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart12 .cluster text{fill:#333;}#mermaidChart12 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart12:root{--mermaid-font-family:sans-serif;}#mermaidChart12:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart12 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M124,37.84782608695652L181,20.5L321.9296875,20.5L430.859375,20.5L472.9380580357143,33" marker-end="url(#arrowhead460)" style="fill:none"></path><defs><marker id="arrowhead460" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-C" id="L-A-C" style="opacity: 1;"><path class="path" d="M124,73.15217391304347L181,90.5L238,90.5" marker-end="url(#arrowhead461)" style="fill:none"></path><defs><marker id="arrowhead461" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-B" id="L-C-B" style="opacity: 1;"><path class="path" d="M405.859375,90.5L430.859375,90.5L472.9380580357143,78" marker-end="url(#arrowhead462)" style="fill:none"></path><defs><marker id="arrowhead462" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-D" id="L-B-D" style="opacity: 1;"><path class="path" d="M641.5,55.5L666.5,55.5L691.5,55.5" marker-end="url(#arrowhead463)" style="fill:none"></path><defs><marker id="arrowhead463" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-D LE-E" id="L-D-E" style="opacity: 1;"><path class="path" d="M970.875,55.5L995.875,55.5L1020.875,55.5" marker-end="url(#arrowhead464)" style="fill:none"></path><defs><marker id="arrowhead464" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(321.9296875,20.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>离散变量</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(181,90.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>连续变量</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-253" transform="translate(66,55.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">判断特征类型</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-254" transform="translate(548.6796875,55.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-92.8203125" y="-22.5" width="185.640625" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-82.8203125,-12.5)"><foreignObject width="165.640625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">利用公式求解WOE和IV</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-256" transform="translate(321.9296875,90.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-83.9296875" y="-22.5" width="167.859375" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-73.9296875,-12.5)"><foreignObject width="147.859375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">分箱编码,如卡方分箱</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-258" transform="translate(831.1875,55.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-139.6875" y="-22.5" width="279.375" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-129.6875,-12.5)"><foreignObject width="259.375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">比较不同特征的IV值,确定有价值特征</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-259" transform="translate(1078.875,55.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">优化电池实验</div></foreignObject></g></g></g></g></g></g></svg></div><p><span>候选特征有以下几个：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-string">'电解液'</span>, <span class="cm-string">'正极材料'</span>, <span class="cm-string">'负极材料'</span>, <span class="cm-string">'隔膜纸'</span>, <span class="cm-string">'2ex百分比'</span>, <span class="cm-string">'单次放电容量'</span>, <span class="cm-string">'充电电流'</span>, <span class="cm-string">'充电后搁置时间'</span>,</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'放电后搁置时间'</span>, <span class="cm-string">'温度'</span>, <span class="cm-string">'特殊工步'</span>, <span class="cm-string">'分容容量'</span>, <span class="cm-string">'首次容量'</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><span>规定经历5000次循环后电池容量小于90%为正样本，大于等于90%的电池为负样本：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n2177" cid="n2177" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="7.068ex" viewBox="0 -1783.6 59683.7 3043.2" role="img" focusable="false" style="vertical-align: -2.926ex; max-width: 100%;"><defs><path stroke-width="0" id="E39-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E39-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E39-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E39-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E39-MJMAIN-39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"></path><path stroke-width="0" id="E39-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E39-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E39-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E39-MJMAIN-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path stroke-width="0" id="E39-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="0" id="E39-MJMAIN-3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path><path stroke-width="0" id="E39-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E39-MJMAIN-3E" d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path><path stroke-width="0" id="E39-MJSZ3-7B" d="M618 -943L612 -949H582L568 -943Q472 -903 411 -841T332 -703Q327 -682 327 -653T325 -350Q324 -28 323 -18Q317 24 301 61T264 124T221 171T179 205T147 225T132 234Q130 238 130 250Q130 255 130 258T131 264T132 267T134 269T139 272T144 275Q207 308 256 367Q310 436 323 519Q324 529 325 851Q326 1124 326 1154T332 1205Q369 1358 566 1443L582 1450H612L618 1444V1429Q618 1413 616 1411L608 1406Q599 1402 585 1393T552 1372T515 1343T479 1305T449 1257T429 1200Q425 1180 425 1152T423 851Q422 579 422 549T416 498Q407 459 388 424T346 364T297 318T250 284T214 264T197 254L188 251L205 242Q290 200 345 138T416 3Q421 -18 421 -48T423 -349Q423 -397 423 -472Q424 -677 428 -694Q429 -697 429 -699Q434 -722 443 -743T465 -782T491 -816T519 -845T548 -868T574 -886T595 -899T610 -908L616 -910Q618 -912 618 -928V-943Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.19" transform="translate(0,-50)"><use xlink:href="#E39-MJMAIN-28"></use><use xlink:href="#E39-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E39-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E39-MJMAIN-31" x="1167" y="0"></use><use xlink:href="#E39-MJMAIN-39" x="1667" y="0"></use><use xlink:href="#E39-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(23008,0)"><g transform="translate(-15,0)"><g transform="translate(0,-50)"><use transform="scale(1.2)" xlink:href="#E39-MJMATHI-79" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-3D" x="774" y="0"></use><g transform="translate(2196,0)"><use transform="scale(1.2)" xlink:href="#E39-MJSZ3-7B"></use><g transform="translate(1067,0)"><g transform="translate(-15,0)"><g transform="translate(0,646)"><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-31" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-2C" x="500" y="0"></use></g><g transform="translate(0,-760)"><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-30" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-2C" x="500" y="0"></use></g></g><g transform="translate(1919,0)"><g transform="translate(0,646)"><use transform="scale(1.2)" xlink:href="#E39-MJMATHI-79" x="0" y="0"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-3C" x="774" y="0"></use><g transform="translate(2196,0)"><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-30"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-2E" x="500" y="0"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-39" x="778" y="0"></use></g><g transform="translate(5730,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">正</text></g><g transform="translate(6708,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(7687,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g></g><g transform="translate(0,-760)"><use transform="scale(1.2)" xlink:href="#E39-MJMATHI-79" x="0" y="0"></use><g transform="translate(929,0)"><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-3E"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-3D" x="778" y="0"></use></g><g transform="translate(3130,0)"><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-30"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-2E" x="500" y="0"></use><use transform="scale(1.2)" xlink:href="#E39-MJMAIN-39" x="778" y="0"></use></g><g transform="translate(5663,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">负</text></g><g transform="translate(6642,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">样</text></g><g transform="translate(7621,0)"><text font-family="STIXGeneral, 'PingFang SC', serif" stroke="none" transform="scale(62.88) matrix(1 0 0 -1 0 0)">本</text></g></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-39">\large y=\begin{cases}\tag{5.19}
1, &y<0.9\quad\quad 正样本\\
0, &y>=0.9\quad 负样本\\
\end{cases}</script></div></div><p><span>实施过程：</span></p><ul><li><span>连续变量分箱编码</span></li></ul><p><span>特征中除了分容容量和首次容量这两个连续变量外，其它特征均为离散变量。所以只需对这两个特征进行分箱编码即可，本案例采用卡方编码，编码结果如下：</span></p><p><span>分容容量：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>分箱编码</span></th><th style='text-align:center;' ><span>分箱区间</span></th><th style='text-align:center;' ><span>负样本数量</span></th><th style='text-align:center;' ><span>正样本数量</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>[0，207.0]</span></td><td style='text-align:center;' ><span>121</span></td><td style='text-align:center;' ><span>4</span></td></tr><tr><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>[207.0，226.0]</span></td><td style='text-align:center;' ><span>709</span></td><td style='text-align:center;' ><span>385</span></td></tr><tr><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>[226.0，229.0]</span></td><td style='text-align:center;' ><span>182</span></td><td style='text-align:center;' ><span>61</span></td></tr><tr><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>&gt;229.0</span></td><td style='text-align:center;' ><span>119</span></td><td style='text-align:center;' ><span>71</span></td></tr></tbody></table></figure><p><span>首次容量</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>分箱编码</span></th><th style='text-align:center;' ><span>分箱区间</span></th><th style='text-align:center;' ><span>负样本数量</span></th><th style='text-align:center;' ><span>正样本数量</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>[0，208.0]</span></td><td style='text-align:center;' ><span>68</span></td><td style='text-align:center;' ><span>3</span></td></tr><tr><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>[208.0，215.0]</span></td><td style='text-align:center;' ><span>102</span></td><td style='text-align:center;' ><span>33</span></td></tr><tr><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>[215.0，218.0]</span></td><td style='text-align:center;' ><span>81</span></td><td style='text-align:center;' ><span>68</span></td></tr><tr><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>[218.0，224.0]</span></td><td style='text-align:center;' ><span>430</span></td><td style='text-align:center;' ><span>252</span></td></tr><tr><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>&gt;224.0</span></td><td style='text-align:center;' ><span>450</span></td><td style='text-align:center;' ><span>165</span></td></tr></tbody></table></figure><ul><li><span>计算woe和IV</span></li></ul><p><span>计算过程省略，具体的每个特征的WOE和IV值可查看</span><a href='output/离散特征WOEIV.xlsx'><span>链接</span></a><span>，计算出来的各个特征的IV总和值如下：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>特征</span></th><th style='text-align:center;' ><span>iv总和</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>隔膜纸</span></td><td style='text-align:center;' ><span>0.5736</span></td></tr><tr><td style='text-align:center;' ><span>负极材料</span></td><td style='text-align:center;' ><span>0.5286</span></td></tr><tr><td style='text-align:center;' ><span>电解液</span></td><td style='text-align:center;' ><span>0.4333</span></td></tr><tr><td style='text-align:center;' ><span>温度</span></td><td style='text-align:center;' ><span>0.3481</span></td></tr><tr><td style='text-align:center;' ><span>分容容量</span></td><td style='text-align:center;' ><span>0.3019</span></td></tr><tr><td style='text-align:center;' ><span>正极材料</span></td><td style='text-align:center;' ><span>0.252</span></td></tr><tr><td style='text-align:center;' ><span>首次容量</span></td><td style='text-align:center;' ><span>0.2157</span></td></tr><tr><td style='text-align:center;' ><span>2ex百分比</span></td><td style='text-align:center;' ><span>0.1547</span></td></tr><tr><td style='text-align:center;' ><span>特殊工步</span></td><td style='text-align:center;' ><span>0.0814</span></td></tr><tr><td style='text-align:center;' ><span>充电后搁置时间</span></td><td style='text-align:center;' ><span>0.063</span></td></tr><tr><td style='text-align:center;' ><span>单次放电容量</span></td><td style='text-align:center;' ><span>0.0462</span></td></tr><tr><td style='text-align:center;' ><span>放电后搁置时间</span></td><td style='text-align:center;' ><span>0.0368</span></td></tr><tr><td style='text-align:center;' ><span>充电电流</span></td><td style='text-align:center;' ><span>0.0233</span></td></tr></tbody></table></figure><ul><li><span>IV值的比较和特征预测能力的排序</span></li></ul><p><span>通过结果，我们发现，</span><strong><span>电池各项特征在对“电池循环5000次后其百分比容量是否小于90%”的预测能力排名为：隔膜纸&gt;负极材料&gt;电解液&gt;温度&gt;分容容量&gt;……&gt;放电后搁置时间&gt;充电电流。</span></strong></p><iframe src="pyecharts/特征预测能力漏斗图.html" height="450" align="center"></iframe><p>&nbsp;</p><ul><li><strong><span>优化设计、实验</span></strong></li></ul><p><span>得出结论后，电池技术人员就能运用上面的结论</span><strong><span>有针对性调整后续电池实验方向，优化实验，进而减少实验成本，提高实验效率。比如重点选取排名靠前的特征进行实验，并根据WOE分组情况，选择负样本（百分比容量&gt;=90%）比例较大的区间。</span></strong><span>这就是分箱和WOE、IV值在电池设计领域的十分有效的应用！</span></p><ul><li><span>IV的极端情况以及处理方式</span></li></ul><p><span>由于部分特征水平数较多，比如光电解液就有27种，而有些特征水平样本数太少，像有些材料就只做过一次实验，导致样本出现极度不平衡的状态，进而使得分箱之后有部分分箱出现正样本或负样本数为0的状况。这些少量的特征水平得出的IV值为</span><span class='math-in-toc'>$±\infin$</span><span>这两种极端情况，无法参与该特征的IV值求和计算，这样样本如下表所示：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>特征</span></th><th style='text-align:center;' ><span>分类</span></th><th style='text-align:center;' ><span>负样本数量</span></th><th style='text-align:center;' ><span>正样本数量</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>电解液</span></td><td style='text-align:center;' ><span>TC-E269-F10</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>6</span></td></tr><tr><td style='text-align:center;' ><span>电解液</span></td><td style='text-align:center;' ><span>TC-E269-F11</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>3</span></td></tr><tr><td style='text-align:center;' ><span>电解液</span></td><td style='text-align:center;' ><span>TC-E269-F6</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>9</span></td></tr><tr><td style='text-align:center;' ><span>电解液</span></td><td style='text-align:center;' ><span>TC-E269-F7</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>6</span></td></tr><tr><td style='text-align:center;' ><span>电解液</span></td><td style='text-align:center;' ><span>TC-E269-F9</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>6</span></td></tr><tr><td style='text-align:center;' ><span>正极材料</span></td><td style='text-align:center;' ><span>DY-3</span></td><td style='text-align:center;' ><span>54</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>正极材料</span></td><td style='text-align:center;' ><span>P2S</span></td><td style='text-align:center;' ><span>54</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>正极材料</span></td><td style='text-align:center;' ><span>P2S2</span></td><td style='text-align:center;' ><span>20</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>正极材料</span></td><td style='text-align:center;' ><span>S20</span></td><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>负极材料</span></td><td style='text-align:center;' ><span>AGP-6H</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>29</span></td></tr><tr><td style='text-align:center;' ><span>隔膜</span></td><td style='text-align:center;' ><span>NJT(7+2)*32.5</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>10</span></td></tr><tr><td style='text-align:center;' ><span>隔膜</span></td><td style='text-align:center;' ><span>恩捷(7+2)*32.5</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>34</span></td></tr><tr><td style='text-align:center;' ><span>2ex百分比</span></td><td style='text-align:center;' ><span>1.004</span></td><td style='text-align:center;' ><span>32</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>单次充电电流</span></td><td style='text-align:center;' ><span>59</span></td><td style='text-align:center;' ><span>6</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>充电后搁置时间</span></td><td style='text-align:center;' ><span>3.5</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>2</span></td></tr><tr><td style='text-align:center;' ><span>放电后搁置时间</span></td><td style='text-align:center;' ><span>60</span></td><td style='text-align:center;' ><span>96</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>特殊工步</span></td><td style='text-align:center;' ><span>BTP:07048</span></td><td style='text-align:center;' ><span>16</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>特殊工步</span></td><td style='text-align:center;' ><span>TEC-TEST-2008-001</span></td><td style='text-align:center;' ><span>6</span></td><td style='text-align:center;' ><span>0</span></td></tr></tbody></table></figure><p><a href='#IV处理手段'><span>上文</span></a><span>提到过碰到IV极端值的三种处理手段：制定规则、重新分组、人为干预。</span><strong><span>对于此案例中出现的这些极端特征分箱（分箱内全部为正样本或负样本），其实对于我们在优化实验设计方面也能提供非常多有用的信息，比如对于DY-3这种正极材料，其组成的电池样本在循环5000次后其百分比容量均大于90%，这说明这种正极材料其容量衰减比较慢（只考虑单变量因素，如果要综合考虑，可以在保证其它多个特征取相同水平下进行比较），那么在后续的实验设计中就可以加以运用。同理，其它极端特征水平也可以进行类型运用。</span></strong></p><ul><li><span>IV运用局限性</span></li></ul><ol start='' ><li><span>当你在建立的分类模型不是二元逻辑回归模型时，比如你用SVM或者是随机森林等，不应该用IV值作为变量选择的方法，因为IV值作为变量选择的方法是专门针对逻辑回归设计的（公式中WOE取对数的原因）。当然这不代表IV值只能用于逻辑回归模型的特征选择，因为IV值本身有着明确的信息熵含义，而这是脱离模型存在的，这不过其用在逻辑回归上效果会更好罢了。</span></li><li><span>IV值没有考虑不同特征间的相互影响。</span></li><li><span>IV值受分箱结果影响，如果分箱不合理，IV值也会出现偏差。</span></li><li><span>IV值在比较不同特征的预测能力时，特征之间的分箱数量不能相差过大，否则也会有较大偏差。所以在分箱操作时，就要对分箱数过多的特征进行重新合并分箱，对箱内样本数量过少甚至为0的分箱也要进行合并操作，减少分箱数。</span></li></ol><ul><li><span>WOE编码的优缺点</span></li></ul><p><span>优点：</span></p><ol start='' ><li><span>可以有效处理缺失值(把缺失值单独作为一个分箱)；</span></li><li><span>可以有效处理异常值（Outlier）；</span></li><li><span>WOE转换基于分布的对数值。 这与逻辑回归输出函数一致；</span></li><li><span>不需要进行哑变量编码；</span></li><li><strong><span>用了合适的分箱手段后，能够建立自变量与因变量的单调关系，比如</span><a href='#best-ks'><span>上文</span></a><span>提到的分容容量为分箱特征，循环寿命为响应标签的Best-KS 分箱结果中，分箱后的WOE值随分容容量单调下降，即</span><span class='math-in-toc'>$\Large\ln{\frac{y_i}{y_T}}/{\frac{n_i}{n_T}}$</span><span>单调下降，由于</span><span class='math-in-toc'>$y_T,n_T$</span><span>为常数，所以，其实就是</span><span class='math-in-toc'>$y_i/n_i$</span><span>单调下降，即随分容容量的增加，分箱内正样本（循环寿命&lt;7300的电池样本）与负样本（循环寿命&gt;=7300的电池样本）比例单调下降，而正负样本比例，就是因变量（标签）“循环寿命是否小于7300” 的概率判断。此时采用Best-Ks分箱，就能建立起自变量（分容容量）与因变量（循环寿命是否小于7300）之间单调关系！</span></strong></li></ol><p><span>缺点：</span></p><p><span>只考虑了每个分箱的相对风险，没有考虑到每个分箱样本数量占全样本的比例。可以用IV值来评估每个分箱的相对贡献。</span></p><h4 id='5223-序列编码'><span>5.2.2.3 </span><a id='序列编码'><span>序列编码</span></a></h4><p><span>序列编码（Ordinal Encoding）是指对离散数值或类别变量按一定数值序列进行编码。数值序列常见是连续自然数序列，比如[0，1，2，……，n]。序列编码隐含了一个假设：</span><strong><span>相同特征不同的类别之间</span></strong><span>，存在一种顺序关系。比如对学历特征[小学，初中，高中，大学，硕士，博士]进行序列编码[1，2，3，4，5，6]，其实编码后的类别之间能体现：小学—&gt;初中—&gt;高中—&gt;大学—&gt;硕士—&gt;博士这样逐级递增的顺序关系。</span></p><p><span>在</span><a href='#查看数据类型'><span>3.3.1.3 查看数据类型</span></a><span>中，我们介绍了数据的几种基本类型，其中的</span><strong><span>离散定性有序</span></strong><span>数据类型是适合采用序列编码的。</span></p><p><strong><span>序列编码优点：</span></strong></p><p><span>简单，不需要增维操作，相对于 OneHot 编码等其它增维编码，序列编码占用内存空间小，并且支持文本特征编码。</span></p><p><strong><span>序列编码缺点：</span></strong></p><p><span>序列编码的应用范围十分有限。目前还没有发现标签编码的广泛使用，一般在</span><strong><span>树模型（包括使用树模型作为弱评估器的集成算法）</span></strong><span>中可以使用。</span></p><h4 id='5224-one-hot编码哑变量编码'><span>5.2.2.4 One-Hot编码/哑变量编码</span></h4><ul><li><strong><a id='Onehot编码'><span>One-Hot编码</span></a></strong></li></ul><p><span>One-Hot编码（独热编码）用于将表示分类特征扩维编码。最简单的理解用 N 位状态寄存器编码 N 个状态，每个状态都有独立的寄存器位，且这些寄存器位中只有一位有效，只能有一个状态。</span></p><p><span>One-Hot编码是</span><strong><span>分类变量</span></strong><span>作为</span><strong><span>二进制向量</span></strong><span>的表示。这首先要求将分类值映射到整数值。然后，每个整数值被表示为二进制向量，除了整数的索引之外，它都是零值，它被标记为1。</span></p><p><span>还是上节中学历特征为例，来对其进行编码，会得到如下的稀疏矩阵：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>学历</span></th><th style='text-align:center;' ><span>小学</span></th><th style='text-align:center;' ><span>初中</span></th><th style='text-align:center;' ><span>高中</span></th><th style='text-align:center;' ><span>大学</span></th><th style='text-align:center;' ><span>硕士</span></th><th style='text-align:center;' ><span>博士</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>小学</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>初中</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>高中</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>大学</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>硕士</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>博士</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td></tr></tbody></table></figure><p><span>上面一行二进制就代表了一个类别的One-Hot编码，比如小学的编码为 [1，0，0，0，0，0]。one-hot编码保证了每一个取值只会使得一种状态处于“激活态”，也就是说这N种状态中只有一个状态位值为1，其他状态位都是0。如果特征中有N个不相同的取值，那么我们就可以将该特征抽象成N种不同的状态，即数据维度从1—&gt;N。</span></p><p><span>One-Hot编码优点：</span></p><ol start='' ><li><span>在回归，分类，聚类等机器学习算法中，特征之间距离的计算或相似度的计算是非常重要的，而我们常用的距离或相似度的计算都是在欧式空间的相似度计算，计算余弦相似性，基于的就是欧式空间。而我们使用one-hot编码，将</span><strong><span>离散特征的取值扩展到了欧式空间</span></strong><span>，离散特征的某个取值就对应欧式空间的某个点。将离散型特征使用one-hot编码，确实会让特征之间的距离计算更加合理。在利用机器学习的算法时一般需要进行向量化或者数字化。那么你可能想 假设 红=1，黄=2，蓝=3，那么这样实现了序列编码，即给不同类别以标签。然而这意味着机器可能会学习到“红&lt;黄&lt;蓝”，但这并不是我们的让机器学习的本意，只是想让机器区分它们，并无大小比较之意。所以这时序列编码是不够的，需要进一步转换。因为有三种颜色状态，所以就有 3 个比特。即红色：1 0 0，黄色: 0 1 0，蓝色：0 0 1。如此一来每两个向量之间的距离都是根号 2，在向量空间距离都相等，所以这样不会出现偏序性，基本不会影响基于向量空间度量算法的效果。</span></li><li><span>编码过程简单，应用广泛。One-Hot编码属于无监督的编码方式，没有特别的计算过程，编码过程唯一要做的就是特征类别计数，编码过程十分简单。同时，One-Hot编码几乎适用所有的机器学习算法。</span></li></ol><p><a id='OneHot编码缺点'><span>One-Hot编码缺点</span></a><span>：</span></p><ol start='' ><li><p><span>对于类别特征数量大，或者单个特征类别非常多的数据，容易造成维度灾难。比如以中国所有人的姓名做为一项输入特征，假设不重名的姓名类别有500万，那么如果采用One-Hot编码，那么将产生500万维的编码数据，这对数据存储和机器学习模型计算来讲都是非常大的开销。当然，也有技巧缓解这种维度灾难，比如对One-Hot编码得到的稀疏矩阵进行压缩，比如采用COO、CSR、CSC等压缩格式；也可以在One-Hot编码后再进行</span><a href='#PCA'><span>PCA（主成分分析）</span></a><span>等降维操作，以降低特征维度。但总的来说，增维所导致的维度灾难是限制One-Hot应用的最主要问题。</span></p></li><li><p><span>One-Hot 编码是类别特征的一种通用解决方法，然而在树模型里面，这并不是一个比较好的方案，尤其当类别特征维度很高的时候。主要的问题是：</span></p><ul><li><span>可能无法在这个类别特征上进行切分。使用One-Hot 编码的话，意味着在每一个决策节点上只能用 one-vs-rest (以电解液为例，采用One-Hot后，某个节点就会呈现是电解液1，不是电解液1，显然是电解液1的样本数量要远远小于不是电解液1的样本数量) 的切分方式。当特征纬度高时，每个类别上的数据都会比较少，这时候产生的切分不平衡，切分增益（split gain）也会很小（比较直观的理解是，不平衡的切分和不切分几乎没有区别）。</span></li><li><span>会影响决策树的学习。因为就算可以在这个类别特征进行切分，也会把数据切分到很多零散的小空间上，如下图左边部分所示。而决策树学习时利用的是统计信息，在这些数据量小的空间上，统计信息不准确，学习会变差。但如果使用下图右边部分的切分方法，数据会被切分到两个比较大的空间，进一步的学习也会更好。</span></li></ul><p><span>这个问题在前面</span><a href='#案例分析：随机森林预测缺失值'><span>案例分析：随机森林预测缺失值</span></a><span>中体现的比较明显，有兴趣可以再返回去看看。</span></p></li></ol><div align="center">
    <img src="pic/One-Hot.jpg">
</div><ul><li><span>哑变量编码 </span></li></ul><p><span>哑变量编码直观的解释就是任意的将一个状态位去除。还是拿上面的例子来说，我们用5个状态位就足够反应上述6个类别的信息，也就是我们仅仅使用前五个状态位 [0，0，0，0，0] 就可以表达博士了。只是因为对于一个我们研究的样本，他已不是小学生、也不是中学生、也不是大学生、又不是研究生，那么我们就可以默认他是博士，是不是。所以，我们用哑变量编码可以将上述6类表示成：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>学历</span></th><th style='text-align:center;' ><span>小学</span></th><th style='text-align:center;' ><span>初中</span></th><th style='text-align:center;' ><span>高中</span></th><th style='text-align:center;' ><span>大学</span></th><th style='text-align:center;' ><span>硕士</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>小学</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>初中</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>高中</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>大学</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td><td style='text-align:center;' ><span>0</span></td></tr><tr><td style='text-align:center;' ><span>硕士</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><mark><span>1</span></mark></td></tr><tr><td style='text-align:center;' ><span>博士</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>0</span></td></tr></tbody></table></figure><p><span>通过上面的例子，我们可以看出One-Hot编码和哑变量编码其核心是相同的，只是哑变量编码觉得one-hot编码太罗嗦了（一些很明显的事实还说的这么清楚），所以它就很那么很明显的东西省去了。这种简化不能说到底好不好，这要看使用的场景。</span></p><p><span>哑变量使用场景：</span></p><p><span>如果特征中有一部分类别是可以归结为一类，比如经常在调查问卷里出现 &#39;其它&#39; 这个选项，它包含了除了列举的主要选项之外的选项合集，此时就可以对其使用哑变量编码。这样做还有个好处，如果模型里有新的输入数据，而如果数据特征只要不属于主要类别，就可以直接将其编码为哑变量（即都是0状态位组成的编码），这样就不需要像One-Hot那样重新加入状态位，重新编码。</span><strong><span>特别是特征存在缺失值，就非常适合用哑变量编码</span></strong><span>，可以直接将缺失值的每个状态位直接置0即可。</span></p><p><span>哑变量的缺点：</span></p><p><span>在进行分类特征离散编码时，要每个离散型特征各个取值的地位都是对等的，采用One-Hot编码，其特征类别之间的向量间欧式距离都相等，均为</span><span class='math-in-toc'>$\sqrt2$</span><span>。但如果采用哑变量编码，哑变量与其它向量之间的欧式距离为1，而其它向量间的欧式距离为</span><span class='math-in-toc'>$\sqrt{2}$</span><span>，这样操作的后果，会使得类别之间的权重天然存在失衡，有可能会影响模型输出。</span></p><h4 id='5225-二进制编码'><span>5.2.2.5 二进制编码</span></h4><p><span>二进制编码（Binary Encoding）步骤：</span></p><ol start='' ><li><span>先采用序列编码给每个类别赋予一个类别 ID；</span></li><li><span>接着将类别 ID 对应的二进制编码作为结果。</span></li></ol><p><span>还是以学历特征编码为例：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>学历</span></th><th style='text-align:center;' ><span>序列编码</span></th><th style='text-align:center;' ><span>二进制编码</span></th><th style='text-align:center;' ><span>One-Hot编码</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>小学</span></td><td style='text-align:center;' ><span>1</span></td><td style='text-align:center;' ><span>001</span></td><td style='text-align:center;' ><span>100000</span></td></tr><tr><td style='text-align:center;' ><span>初中</span></td><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>010</span></td><td style='text-align:center;' ><span>010000</span></td></tr><tr><td style='text-align:center;' ><span>高中</span></td><td style='text-align:center;' ><span>3</span></td><td style='text-align:center;' ><span>011</span></td><td style='text-align:center;' ><span>001000</span></td></tr><tr><td style='text-align:center;' ><span>大学</span></td><td style='text-align:center;' ><span>4</span></td><td style='text-align:center;' ><span>100</span></td><td style='text-align:center;' ><span>000100</span></td></tr><tr><td style='text-align:center;' ><span>硕士</span></td><td style='text-align:center;' ><span>5</span></td><td style='text-align:center;' ><span>101</span></td><td style='text-align:center;' ><span>000010</span></td></tr><tr><td style='text-align:center;' ><span>博士</span></td><td style='text-align:center;' ><span>6</span></td><td style='text-align:center;' ><span>110</span></td><td style='text-align:center;' ><span>000001</span></td></tr></tbody></table></figure><p><span>二进制编码本质上是利用</span><strong><span>二进制对类别 ID 进行哈希映射，最终得到 0/1 特征向量，并且特征维度小于独热编码，更加节省存储空间</span></strong><span>。以上面编码为例，One-Hot需要6位内存，二进制编码只需3位内存。但其缺点与序列编码类似，无法有效拓展类别之间的距离或相似度。</span></p><h4 id='5226-histgram-映射'><span>5.2.2.6 Histgram 映射</span></h4><p><span>Histgram 映射直译成中文就是直方图映射，直方图是一个可以快速展示数据概率分布的工具。那么这个Histgram 映射又是如何操作的呢？单纯的文字定义显得空洞乏力，我们就以实际案例来说明。比如，要使用模型预测LFP10370C2-200电池循环寿命是否大于7300，那么在这个前提下，利用Histgram 映射对分类特征负极材料进行编码。具体步骤如下：</span></p><p><span>按照histgram 的处理方式，会按照预测的类别的占比来标注属性。根据样本数据就会有这样一个统计列表：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>负极材料种类</span></th><th style='text-align:center;' ><span>负样本数量</span></th><th style='text-align:center;' ><span>正样本样本数量</span></th><th style='text-align:center;' ><span>正样本占比</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>CP5</span></td><td style='text-align:center;' ><span>495</span></td><td style='text-align:center;' ><span>216</span></td><td style='text-align:center;' ><span>0.3038</span></td></tr><tr><td style='text-align:center;' ><span>CP5-H</span></td><td style='text-align:center;' ><span>484</span></td><td style='text-align:center;' ><span>99</span></td><td style='text-align:center;' ><span>0.1698</span></td></tr><tr><td style='text-align:center;' ><span>CP5-H+ACP-H(5:5)</span></td><td style='text-align:center;' ><span>10</span></td><td style='text-align:center;' ><span>2</span></td><td style='text-align:center;' ><span>0.1667</span></td></tr><tr><td style='text-align:center;' ><span>E11</span></td><td style='text-align:center;' ><span>35</span></td><td style='text-align:center;' ><span>10</span></td><td style='text-align:center;' ><span>0.2222</span></td></tr><tr><td style='text-align:center;' ><span>E22</span></td><td style='text-align:center;' ><span>27</span></td><td style='text-align:center;' ><span>75</span></td><td style='text-align:center;' ><span>0.7353</span></td></tr><tr><td style='text-align:center;' ><span>EP7-M+PG09SC</span></td><td style='text-align:center;' ><span>64</span></td><td style='text-align:center;' ><span>65</span></td><td style='text-align:center;' ><span>0.5039</span></td></tr><tr><td style='text-align:center;' ><span>ZH-T7H</span></td><td style='text-align:center;' ><span>16</span></td><td style='text-align:center;' ><span>25</span></td><td style='text-align:center;' ><span>0.6098</span></td></tr><tr><td style='text-align:center;' ><span>AGP-6H</span></td><td style='text-align:center;' ><span>0</span></td><td style='text-align:center;' ><span>29</span></td><td style='text-align:center;' ><span>1</span></td></tr></tbody></table></figure><p><span>那么我们就可以以每个类被的正样本占比作为该类别的编码，比如CP5的 Histgram 映射编码就是216/（216+495）≈0.3038。当然，也可以采用负样本占比作为编码。</span></p><ul><li><span>Histgram 映射的优点</span></li></ul><ol start='' ><li><span>操作简单，适用范围广。</span></li><li><span>具有一定的统计含义，编码较为科学。能将分类特征映射到【0，1】区间。</span></li></ol><ul><li><span>Histgram 映射的缺点</span></li></ul><ol start='' ><li><span>模型有新数据加入，就必须调整编码，拓展性较差。</span></li><li><span>属于</span><strong><span>有监督编码</span></strong><span>，无法处理无监督模型。</span></li></ol><p>&nbsp;</p><h3 id='523-数据变换'><span>5.2.3 数据变换</span></h3><p><span>数据变换是指利用统计或数学变换来减轻数据分布倾斜的影响，使原本密集的区间的值尽可能的分散，原本分散的区间的值尽量的聚合。常见的数据变换方式有：对数变换，多项式变换，幂变换，box-cox变换。</span></p><h4 id='5231-对数变换'><span>5.2.3.1 对数变换</span></h4><p><span>对数变换（log变换）通常用来创建单调的数据变换。它的主要作用在于帮助</span><strong><span>稳定方差</span></strong><span>，始终保持分布接近于</span><strong><span>正态分布</span></strong><span>并使得数据与分布的平均值无关。因为对数变换倾向于拉伸那些落在较低的幅度范围内自变量值的范围，倾向于压缩或减少更高幅度范围内的自变量值的范围。从而使得倾斜分布尽可能的接近正态分布。 所以针对一些数值连续特征的方差不稳定，特征值重尾分布我们需要采用 log 化来调整整个数据分布的方差，属于方差稳定型数据转换。变换公式也十分简单：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n2697" cid="n2697" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="3.904ex" viewBox="0 -1102.4 59683.7 1680.8" role="img" focusable="false" style="vertical-align: -1.343ex; max-width: 100%;"><defs><path stroke-width="0" id="E40-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E40-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E40-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E40-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E40-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E40-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E40-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E40-MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path stroke-width="0" id="E40-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E40-MJMATHI-6C" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path stroke-width="0" id="E40-MJMATHI-6F" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path stroke-width="0" id="E40-MJMATHI-67" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"></path><path stroke-width="0" id="E40-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.20" transform="translate(0,-153)"><use xlink:href="#E40-MJMAIN-28"></use><use xlink:href="#E40-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E40-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E40-MJMAIN-32" x="1167" y="0"></use><use xlink:href="#E40-MJMAIN-30" x="1667" y="0"></use><use xlink:href="#E40-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(26211,0)"><g transform="translate(-15,0)"><g transform="translate(0,-153)"><use transform="scale(1.44)" xlink:href="#E40-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E40-MJMAIN-2032" x="808" y="583"></use><use transform="scale(1.44)" xlink:href="#E40-MJMAIN-3D" x="1144" y="0"></use><use transform="scale(1.44)" xlink:href="#E40-MJMATHI-6C" x="2200" y="0"></use><use transform="scale(1.44)" xlink:href="#E40-MJMATHI-6F" x="2498" y="0"></use><g transform="translate(4295,0)"><use transform="scale(1.44)" xlink:href="#E40-MJMATHI-67" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E40-MJMATHI-61" x="674" y="-340"></use></g><use transform="scale(1.44)" xlink:href="#E40-MJMAIN-28" x="3934" y="0"></use><use transform="scale(1.44)" xlink:href="#E40-MJMATHI-78" x="4323" y="0"></use><use transform="scale(1.44)" xlink:href="#E40-MJMAIN-29" x="4895" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-40">\Large x'=log_a(x)\tag{5.20}</script></div></div><p><span>下面这个例子就是电池样本数据中循环寿命的分布在经过log变换后的前后对比（例子是以标签列作为处理对象，实际应用中更多的是处理特征列）。未经对数变换时，寿命的分布呈现重尾分布，在经过对寿命值取以自然数e为底的对数后，变换呈现双分布中心的正态分布。</span></p><div align="center">
    <img src="figure/life-dis.png" style="zoom:55%"><img src="figure/life-dis-log.png" style="zoom:55%">
</div><h4 id='5232-多项式变换'><span>5.2.3.2 多项式变换</span></h4><p><span>严格来说，对特征组合进行多项式变换属于后面章节要讲的</span><a href='特征构造'><span>特征构造</span></a><span>的内容（其实分箱也可以算是特征构造的内容），但多项式变换也是属于数据预处理中的重要环节，所以就放在数据预处理章节进行阐述。</span></p><p><span>机器学习中一种常见的模式，是使用线性模型训练数据的非线性函数（如线性回归、逻辑回归、神经网络等）。这种方法保持了一般快速的线性方法的性能，同时允许它们适应更广泛的数据范围。而多项式变换则是将互相独立的各特征转化为非线性组合特征的过程。</span></p><p><span>假设现在有一组二维特征构建的线性预测模型：</span></p><p><span class='math-in-toc'>$\large \hat{y}=w_0+w_1x_1+w_2x_2$</span></p><p><span>如果我们想把抛物面拟合成数据而不是平面，我们可以结合二阶多项式的特征，将特征转换为2次多项式的特征组合：</span></p><p><span class='math-in-toc'>$\large [x_1,x_2]\to[x_1,x_2,x_1x_2,x_1^2,x_2^2]$</span></p><p><span>使模型看起来像这样:</span></p><p><span class='math-in-toc'>$\large \hat{y}=w_0+w_1x_1+w_2x_2+w_3x_1x_2+w_4x_1^2+w_5x_2^2$</span></p><p><span>可以看到，模型还是线性模型，但创造了新的特征组合：</span></p><p><span class='math-in-toc'>$\large \vec{z}=[x_1,x_2,x_1x_2,x_1^2,x_2^2]=[z_1,z_2,z_3,z_4,z_5]$</span></p><p><span class='math-in-toc'>$\large \hat{y}=w_0+w_1z_1+w_2z_2+w_3z_3+w_4z_4+w_5z_5$</span></p><p><span>通过用这些基函数建立的高维空间中的线性拟合，该模型具有灵活性，可以适应更广泛的数据范围。同时经过多项式处理后，又能将</span><span class='math-in-toc'>$x_1,x_2$</span><span>的相互影响考虑在内，即</span><span class='math-in-toc'>$x_1x_2$</span><span>项。在某些情况下，没有必要包含任何单个特征的更高的幂，只需要相乘最多 </span><img src="https://www.scikitlearn.com.cn/0.21.3/img/adf83056bc2bd05628e24c40cb728b3d.jpg" referrerpolicy="no-referrer" alt="d"><span> 个不同的特征即可，所谓交互特征 。</span></p><p><span>多项式变换优点：</span></p><ol start='' ><li><span>灵活。多项式变换在众多核函数中都能发挥不错的效果。</span></li><li><span>能将特征之间的相互作用考虑进构成的新特征组合里。</span></li></ol><p><span>多项式变换缺点：</span></p><ol start='' ><li><span>属于升维操作，增加模型复杂度。</span></li><li><span>没有明确的应用场景，更多地是先尝试，再评判效果。</span></li></ol><h4 id='5233-幂变换'><span>5.2.3.3 幂变换</span></h4><p><span>幂变换其实多项式变换的一种特殊形式，即只考虑单特征变换，即：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n2728" cid="n2728" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="3.66ex" viewBox="0 -1050 59683.7 1576" role="img" focusable="false" style="vertical-align: -1.222ex; max-width: 100%;"><defs><path stroke-width="0" id="E41-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E41-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E41-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E41-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E41-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E41-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E41-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path stroke-width="0" id="E41-MJMAIN-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path><path stroke-width="0" id="E41-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E41-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path stroke-width="0" id="E41-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E41-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path stroke-width="0" id="E41-MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.21" transform="translate(0,-208)"><use xlink:href="#E41-MJMAIN-28"></use><use xlink:href="#E41-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E41-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E41-MJMAIN-32" x="1167" y="0"></use><use xlink:href="#E41-MJMAIN-31" x="1667" y="0"></use><use xlink:href="#E41-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(26072,0)"><g transform="translate(-15,0)"><g transform="translate(0,-208)"><use transform="scale(1.44)" xlink:href="#E41-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E41-MJMAIN-2032" x="808" y="583"></use><use transform="scale(1.44)" xlink:href="#E41-MJMAIN-3D" x="1144" y="0"></use><use transform="scale(1.44)" xlink:href="#E41-MJMATHI-61" x="2200" y="0"></use><g transform="translate(3929,0)"><use transform="scale(1.44)" xlink:href="#E41-MJMATHI-78" x="0" y="0"></use><use transform="scale(1.018)" xlink:href="#E41-MJMATHI-6E" x="808" y="583"></use></g><use transform="scale(1.44)" xlink:href="#E41-MJMAIN-2B" x="4047" y="0"></use><use transform="scale(1.44)" xlink:href="#E41-MJMATHI-62" x="5047" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-41">\Large x'=ax^n+b\tag{5.21}</script></div></div><p><span>幂变换函数和对数变换函数都属于幂变换函数簇，通常用来创建单调的数据变换。它们的主要作用都在于它能帮助稳定方差，始终保持分布接近于正态分布。具体也没有明确的应用场景。</span></p><h4 id='5234-box-cox-变换'><span>5.2.3.4 Box-Cox 变换</span></h4><p><span>百度百科里是这样介绍Box-Cox变换的：Box-Cox变换是Box和Cox在1964年提出的一种广义幂变换方法，是统计建模中常用的一种数据变换，用于连续的响应变量不满足正态分布的情况。Box-Cox变换之后，可以一定程度上减小不可观测的误差和预测变量的相关性。Box-Cox变换的主要特点是引入一个参数 λ，通过数据本身估计该参数进而确定应采取的数据变换形式，Box-Cox变换可以明显地改善数据的正态性、对称性和方差相等性，对许多实际数据都是行之有效的。</span></p><p><span>box-cox 变换是另一个流行的幂变换函数簇中的一个函数。该函数有一个前提条件，即</span><strong><span>数值型值必须先变换为正数</span></strong><span>（与 log 变换所要求的一样）。万一出现数值是负的，使用一个常数对数值进行偏移是有帮助的。</span><strong><span>box-cox</span></strong><span> 变换函数公式如下：</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n2733" cid="n2733" mdtype="math_block"><div class="md-rawblock-container md-math-container" tabindex="-1"><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.621ex" height="10.354ex" viewBox="0 -2464.8 59683.7 4458" role="img" focusable="false" style="vertical-align: -4.434ex; margin-bottom: -0.195ex; max-width: 100%;"><defs><path stroke-width="0" id="E42-MJMAIN-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path stroke-width="0" id="E42-MJMAIN-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path stroke-width="0" id="E42-MJMAIN-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path stroke-width="0" id="E42-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="0" id="E42-MJMAIN-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path stroke-width="0" id="E42-MJMATHI-79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="0" id="E42-MJMATHI-3BB" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z"></path><path stroke-width="0" id="E42-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="0" id="E42-MJMAIN-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path stroke-width="0" id="E42-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="0" id="E42-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="0" id="E42-MJMAIN-2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path><path stroke-width="0" id="E42-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="0" id="E42-MJMAIN-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path stroke-width="0" id="E42-MJMAIN-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path stroke-width="0" id="E42-MJSZ4-7B" d="M661 -1243L655 -1249H622L604 -1240Q503 -1190 434 -1107T348 -909Q346 -897 346 -499L345 -98L343 -82Q335 3 287 87T157 223Q146 232 145 236Q144 240 144 250Q144 265 145 268T157 278Q242 333 288 417T343 583L345 600L346 1001Q346 1398 348 1410Q379 1622 600 1739L622 1750H655L661 1744V1727V1721Q661 1712 661 1710T657 1705T648 1700T630 1690T602 1668Q589 1659 574 1643T531 1593T484 1508T459 1398Q458 1389 458 1001Q458 614 457 605Q441 435 301 316Q254 277 202 251L250 222Q260 216 301 185Q443 66 457 -104Q458 -113 458 -501Q458 -888 459 -897Q463 -944 478 -988T509 -1060T548 -1114T580 -1149T602 -1167Q620 -1183 634 -1192T653 -1202T659 -1207T661 -1220V-1226V-1243Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(57127,0)"><g id="mjx-eqn-5.22" transform="translate(0,-110)"><use xlink:href="#E42-MJMAIN-28"></use><use xlink:href="#E42-MJMAIN-35" x="389" y="0"></use><use xlink:href="#E42-MJMAIN-2E" x="889" y="0"></use><use xlink:href="#E42-MJMAIN-32" x="1167" y="0"></use><use xlink:href="#E42-MJMAIN-32" x="1667" y="0"></use><use xlink:href="#E42-MJMAIN-29" x="2167" y="0"></use></g></g><g transform="translate(23313,0)"><g transform="translate(-15,0)"><g transform="translate(0,-110)"><use transform="scale(1.44)" xlink:href="#E42-MJMATHI-79" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-28" x="497" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMATHI-3BB" x="886" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-29" x="1468" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-3D" x="2135" y="0"></use><g transform="translate(4595,0)"><use transform="scale(1.44)" xlink:href="#E42-MJSZ4-7B"></use><g transform="translate(1327,0)"><g transform="translate(-15,0)"><g transform="translate(0,644)"><g transform="translate(172,0)"><rect stroke="none" width="2503" height="86" x="0" y="316"></rect><g transform="translate(86,753)"><use transform="scale(1.018)" xlink:href="#E42-MJMATHI-79" x="0" y="0"></use><use transform="scale(0.72)" xlink:href="#E42-MJMATHI-3BB" x="705" y="513"></use><use transform="scale(1.018)" xlink:href="#E42-MJMAIN-2212" x="1011" y="0"></use><use transform="scale(1.018)" xlink:href="#E42-MJMAIN-31" x="1789" y="0"></use></g><use transform="scale(1.018)" xlink:href="#E42-MJMATHI-3BB" x="938" y="-522"></use></g></g><g transform="translate(0,-1252)"><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-6C"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-6E" x="278" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMATHI-79" x="1000" y="0"></use></g></g><g transform="translate(3835,0)"><g transform="translate(0,644)"><use transform="scale(1.44)" xlink:href="#E42-MJMATHI-3BB" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-2260" x="860" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-30" x="1916" y="0"></use></g><g transform="translate(0,-1252)"><use transform="scale(1.44)" xlink:href="#E42-MJMATHI-3BB" x="0" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-3D" x="860" y="0"></use><use transform="scale(1.44)" xlink:href="#E42-MJMAIN-30" x="1916" y="0"></use></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex; mode=display" id="MathJax-Element-42">\Large y(\lambda)=\begin{cases}\frac{y^{\lambda}-1}{\lambda} & \lambda\not=0\\
\ln{y} &\lambda=0
\end{cases}\tag{5.22}</script></div></div><p><span>生成的变换后的输出 y 是输入 x 和变换参数的函数；当 λ=0 时，该变换就是以自然对数e为底的 log 变换；当λ≠0时，该变化就是幂变换。这两者前面我们已经提到过了。λ 的最佳取值通常由最大似然或最大对数似然确定。下方左图为经过Box-Cox变换的循环寿命分布图（计算得出的λ=0.3292），右图为经过log变换后得到循环寿命分布图。</span></p><div align="center">
    <img src="figure/life-dis-boxcox.png" style="zoom:55%"><img src="figure/life-dis-log.png" style="zoom:55%">
</div><p><span>可以看出，不管是Box-Cox变换或对数变换，得出的循环寿命都有两个正态分布峰。具体效果还要结合后续模型的表现。</span></p><ul><li><span>Box-Cox变换特点：</span></li></ul><p><span>Box-Cox变换的一个显著优点是通过求变换参数λ来确定变换形式，而这个过程完全基于数据本身而无须任何先验信息，这无疑比凭经验或通过尝试而选用对数、平方根等变换方式要客观和精确。</span></p><p><span>Box-Cox变换的目的是为了让数据满足线性模型的基本假定，即线性、正态性及方差齐性，然而经Box-Cox变换后数据是否同时满足了以上假定，仍需要考察验证 。</span></p><h2 id='53-特征选择'><span>5.3 特征选择</span></h2><p><span>当数据预处理完成后，我们就要开始进行特征工程的核心内容：特征选择、特征提取、特征构建。这其中特征选择是最为关键的一环，它直接关系到模型的表现。同时，特征选择能回答电池模型的很多问题，比如：</span><strong><span>哪个特征对电池性能的影响最大；每个特征对其电池性能会有怎样的影响等。这些问题能为电池设计、电池测试提供理论依据。</span></strong></p><p><span>一个典型的机器学习任务，是通过样本的特征来预测样本所对应的标签值。如果样本的特征少，我们会考虑增加特征，比如采用上文提到多项式变换就是典型的增加特征的算法。而现实中的情况往往是特征太多了，需要减少一些特征。这个时候就需要对特征进行选择。特征选择其实就是从所有的特征中，选择出有意义，对模型有帮助的特征，以避免必须将所有特征都导入模型去训练，以降低模型开销，提升模型表现。</span></p><p><span>根据特征对模型的贡献情况，我们可以大致将特征分为五类：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>特征类型</span></th><th style='text-align:center;' ><span>有效特征</span></th><th style='text-align:center;' ><span>无关特征</span></th><th style='text-align:center;' ><span>冗余特征</span></th><th style='text-align:center;' ><span>不发散特征</span></th><th style='text-align:center;' ><span>有害特征</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>特征描述</span></td><td style='text-align:center;' ><span>与标签存在关联的特征，能为预测标签起到正向作用</span></td><td style='text-align:center;' ><span>与标签没有关联的特征，不能为预测标签起到任何作用</span></td><td style='text-align:center;' ><span>特征x</span><sub><span>1</span></sub><span>,x</span><sub><span>2</span></sub><span>对模型的贡献是接近一致或一致的，两者存在高度相关</span></td><td style='text-align:center;' ><span>特征数据方差接近于 0，也就是说样本在这个特征上基本上没有差异</span></td><td style='text-align:center;' ><span>带有误导信息的特征或异常比例过高的特征</span></td></tr><tr><td style='text-align:center;' ><span>特征举例</span></td><td style='text-align:center;' ><span>电池材料种类、测试条件等对于电池性能就是有效特征</span></td><td style='text-align:center;' ><span>类如，电池设计人员身高对电池性能而言就是无关特征</span></td><td style='text-align:center;' ><span>电解液电导率与电解液电阻率互为反比关系，二者其一为冗余特征</span></td><td style='text-align:center;' ><span>比如预测LFP10370C2电池性能，字面容量200mAh就是不发散特征</span></td><td style='text-align:center;' ><span>数据录入被随机搅乱的特征</span></td></tr><tr><td style='text-align:center;' ><span>特征影响</span></td><td style='text-align:center;' ><span>增强模型拟合能力</span></td><td style='text-align:center;' ><span>加剧模型开销；模型容易受无关特征噪声影响</span></td><td style='text-align:center;' ><span>加剧模型开销；模型容易过拟合</span></td><td style='text-align:center;' ><span>加剧模型开销</span></td><td style='text-align:center;' ><span>模型容易受其噪声影响，造成有偏拟合</span></td></tr><tr><td style='text-align:center;' ><span>取舍策略</span></td><td style='text-align:center;' ><span>保留</span></td><td style='text-align:center;' ><span>舍弃</span></td><td style='text-align:center;' ><span>特征之间相关性不高可以进行特征构建或特征提取；相关性极高时保留一个即可</span></td><td style='text-align:center;' ><span>舍弃</span></td><td style='text-align:center;' ><span>舍弃</span></td></tr></tbody></table></figure><p><span>减少特征具有重要的现实意义，不仅减少过拟合、减少特征数量（降维）、提高模型泛化能力，而且还可以使模型获得更好的解释性，增强对特征和特征值之间的理解，加快模型的训练速度，一般的，还会获得更好的性能。问题是，在面对未知领域时，很难有足够的认识去判断特征与目标之间的相关性，特征与特征之间的相关性。这时候就需要用一些数学或工程上的方法来帮助我们更好地进行特征选择。</span></p><p><span>根据特征选择的形式又可以将特征选择方法分为3种：</span></p><ul><li><span>Filter：过滤法，按照发散性或者相关性对各个特征进行评分，设定阈值或者待选择阈值的个数，选择特征。</span></li><li><span>Wrapper：包装法，根据目标函数（通常是预测效果评分），每次选择若干特征，或者排除若干特征。</span></li><li><span>Embedded：嵌入法，先使用某些机器学习的算法和模型进行训练，得到各个特征的权值系数，根据系数从大到小选择特征。类似于Filter方法，但是是通过训练来确定特征的优劣。</span></li></ul><p><span>严格来说，对样本进行降维操作（如PCA，LDA等）也可以算是特征选择的方法，但由于降维过程还涉及到空间映射、特征重组过程，特征在这个过程中已经发生变换，所以就不列入特征选择范畴，后面会专列内容来讲降维算法。</span></p><p><span>特征选择分为两个问题：一个是子集搜索问题，另外一个是子集评价问题。这两个问题也是特征选择的核心与难点。</span></p><h3 id='531-过滤法'><span>5.3.1 过滤法</span></h3><p><span>过滤方法通常用作预处理步骤，特征选择完全独立于任何机器学习算法，即先进行特征选择，然后进行后续的训练，特征选择和后续的训练过程没有关系。</span><strong><span>它是根据各种统计检验中的分数以及相关性的各项指标来选择特征。</span></strong></p><div class="md-diagram-panel md-fences-adv-panel"><svg id="mermaidChart13" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="156" style="max-width: 694px; height: 196px;" viewBox="0 0 694 156" class="md-require-zoom-fix"><style>#mermaidChart13{font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart13 .error-icon{fill:#552222;}#mermaidChart13 .error-text{fill:#552222;stroke:#552222;}#mermaidChart13 .edge-thickness-normal{stroke-width:2px;}#mermaidChart13 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart13 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart13 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart13 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart13 .marker{fill:#333333;}#mermaidChart13 .marker.cross{stroke:#333333;}#mermaidChart13 svg{font-family:sans-serif;font-size:16px;}#mermaidChart13 .label{font-family:sans-serif;color:#333;}#mermaidChart13 .label text{fill:#333;}#mermaidChart13 .node rect,#mermaidChart13 .node circle,#mermaidChart13 .node ellipse,#mermaidChart13 .node polygon,#mermaidChart13 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart13 .node .label{text-align:center;}#mermaidChart13 .node.clickable{cursor:pointer;}#mermaidChart13 .arrowheadPath{fill:#333333;}#mermaidChart13 .edgePath .path{stroke:#333333;stroke-width:1.5px;}#mermaidChart13 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart13 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart13 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart13 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart13 .cluster text{fill:#333;}#mermaidChart13 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart13:root{--mermaid-font-family:sans-serif;}#mermaidChart13:root{--mermaid-alt-font-family:sans-serif;}#mermaidChart13 flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M156,30.5L277,30.5L334,30.5" marker-end="url(#arrowhead482)" style="fill:none"></path><defs><marker id="arrowhead482" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-C" id="L-B-C" style="opacity: 1;"><path class="path" d="M450,30.5L475,30.5L500,30.5" marker-end="url(#arrowhead483)" style="fill:none"></path><defs><marker id="arrowhead483" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-D" id="L-C-D" style="opacity: 1;"><path class="path" d="M552,30.5L577,30.5L602,30.5" marker-end="url(#arrowhead484)" style="fill:none"></path><defs><marker id="arrowhead484" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(277,30.5)" style="opacity: 1;"><g transform="translate(-32,-12.5)" class="label"><rect rx="0" ry="0" width="64" height="25"></rect><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span>过滤特征</span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-265" transform="translate(114,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">全部特征</div></foreignObject></g></g></g><g class="node default" id="flowchart-B-266" transform="translate(392,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-58" y="-22.5" width="116" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-48,-12.5)"><foreignObject width="96" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">最佳特征子集</div></foreignObject></g></g></g><g class="node default" id="flowchart-C-267" transform="translate(526,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-26" y="-22.5" width="52" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-16,-12.5)"><foreignObject width="32" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">算法</div></foreignObject></g></g></g><g class="node default" id="flowchart-D-268" transform="translate(644,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-42" y="-22.5" width="84" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-32,-12.5)"><foreignObject width="64" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">模型评估</div></foreignObject></g></g></g><g class="node default" id="flowchart-E-269" transform="translate(114,125.5)" style="opacity: 1;"><rect rx="5" ry="5" x="-106" y="-22.5" width="212" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-96,-12.5)"><foreignObject width="192" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">采用过滤法的模型构建过程</div></foreignObject></g></g></g></g></g></g></svg></div><h4 id='5311-方差过滤'><span>5.3.1.1 方差过滤</span></h4><p><span>方差过滤是通过特征本身的方差来筛选特征的方法，只适用于数值特征。比如一个特征本身的方差很小，就表示样本在这个特征上基本没有差异，可能特征中的大多数值都一样，甚至整个特征的取值都相同，那这个特征对于样本区分没有什么作用。所以无论接下来的特征工程要做什么，都要优先消除方差为 0 的特征。当然实际过程中，几乎不可能出现0方差特征，而是方差明显小于其它特征（归一化条件下）。此时我们就可以设置一个方差阈值（Variance Threshold），舍弃所有方差小于threshold的特征。</span></p><p><span>因为没有实际的低方差电池特征数据，这里就不做过程展示。</span><strong><span>应该指出的是，在做方差过滤前，一定要对特征有比较深的业务理解。因为方差过滤是无监督的过滤方法，不考虑特征的物理实际。有些特征取值比较一致的特征组合，其方差很小，但不代表特征没有携带有效信息！此时，这些特征虽然对模型预测起不到太大的作用，但是有其实际的现实含义。</span></strong><span>另外，比较不同特征的方差大小时，需将特征无量纲化操作（特别是归一化操作），只有在同一量纲尺度下，方差比较才有意义。</span></p><p><span>诸如最近邻算法KNN，单棵决策树，支持向量机SVM，神经网络，回归算法，都需要遍历特征或升维来进行运算，所以他们本身的运算量就很大，需要的时间就很长，运算开销很大，因此方差过滤这样的特征选择对他们来说就尤为重要。但对于不需要遍历特征的算法，比如随机森林，它随机选取特征进行分枝，本身运算就非常快速，因此特征选择对它来说效果平平。这其实很容易理解，无论过滤法如何降低特征的数量，随机森林也只会选取固定数量的特征来建模。所以过滤法的主要对象是：</span><strong><span>需要遍历特征或升维的算法。</span></strong></p><p><span>总结一下方差过滤的特点：</span></p><ol start='' ><li><span>用于数值特征的过滤，无法处理分类特征（只有数值特征才有方差的概念）；</span></li><li><span>适用于需要遍历特征或升维的算法；</span></li><li><span>简单灵活，可以通过设置方差阈值调整过滤特征数量；</span></li><li><span>能有效过滤不发散特征。</span></li></ol><h4 id='5312相关性过滤'><span>5.3.1.2相关性过滤</span></h4><p><span>方差挑选完毕之后，我们过滤掉了不发散特征。那么我们就要考虑下一个问题：相关性。通过相关性差异进行的特征过滤就是相关性过滤。这里相关性是分为两个方面来理解的：</span></p><ol start='' ><li><span>特征与特征之间的相关性（即要过滤冗余特征）；</span></li><li><span>特征与标签之间的相关性（即要过滤无关特征）。</span></li></ol><p><span>虽然这两种相关性过滤的目的不同，但处理方法和评价体系是一致的，主要的区别就是</span><strong><span>过滤冗余特征时，是过滤特征之间相关性高的特征；而过滤无关特征时，是过滤与标签相关性低的特征。</span></strong><span>下面我们将以第二种相关性（即特征与标签之间的相关性过滤）为例，对相关性过滤进行一些介绍。</span></p><p><span>过滤无关特征时，我们希望选出与标签相关且有意义的特征，因为这样的特征能够为我们提供大量信息。如果特征与标签无关，那只会白白浪费我们的计算内存，可能还会给模型带来噪音。在实际应用中，我们有三种常用的方法来评判特征与标签之间的相关性：卡方过滤，F检验过滤，互信息过滤。</span></p><h4 id='53121-卡方过滤'><span>5.3.1.2.1 卡方过滤</span></h4><p><span>卡方过滤是专门针对离散型标签（即分类问题）的相关性过滤。卡方过滤（可以参见</span><a href='#卡方分箱'><span>卡方分箱</span></a><span>章节内容）是通过卡方检验计算每个非负特征和标签之间的卡方统计量，并依照卡方统计量由高到低为特征排名。再结合设定阈值标准来选出前K个分数最高的特征的类，我们可以借此除去最可能独立于标签，与我们分类目的无关的特征。简单来讲，卡方检验，专用于分类算法，捕捉相关性， 追求p小于显著性水平的特征。</span></p><p><span>光讲理论，对方法理解帮助不大，我们就以实际的电池样本数据来看一下卡方过滤在特征选择中应用。</span></p><p><span>案例：</span><strong><span>以 ‘LFP10370C2-200电池的循环寿命是否大于7300’ 为模型标签，利用卡方过滤寻找相关性最高的前5个分类特征，并采用决策数模型评价特征过滤前后模型的表现情况。</span></strong></p><p><span>候选特征共有11个，如下所示：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9.5px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-string">'电解液'</span>, <span class="cm-string">'正极材料'</span>, <span class="cm-string">'负极材料'</span>, <span class="cm-string">'隔膜纸'</span>, <span class="cm-string">'2ex百分比'</span>, <span class="cm-string">'单次放电容量'</span>, <span class="cm-string">'充电电流'</span>, <span class="cm-string">'充电后搁置时间'</span>,</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-string">'放电后搁置时间'</span>, <span class="cm-string">'温度'</span>, <span class="cm-string">'特殊工步'</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 46px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><ul><li><span>计算</span></li></ul><p><span>得出的卡方检验后的各个特征与标签之间的卡方值，如下动态柱状图所示：</span></p><iframe src="pyecharts/卡方柱状图.html" height="520" align="center"></iframe><p><span>卡方检验的本质是推测两组数据之间的差异，其检验的原假设是”两组数据是相互独立的”。卡方检验返回卡方值和 P值两个统计量，其中卡方值很难界定有效的范围，而p值，我们一般使用0.01或0.05作为显著性水平，即p值判断 的边界，具体我们可以这样来看：</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>p值</span></th><th style='text-align:center;' ><span>p&lt;=α（α为显著性水平，常取0.05或0.01）</span></th><th style='text-align:center;' ><span>p&gt;α（α为显著性水平，常取0.05或0.01）</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>数据差异</span></td><td style='text-align:center;' ><span>差异不是自然形成的</span></td><td style='text-align:center;' ><span>这些差异是很自然的样本误差</span></td></tr><tr><td style='text-align:center;' ><span>相关性</span></td><td style='text-align:center;' ><span>两组数据是相关的</span></td><td style='text-align:center;' ><span>两组数据是相互独立的</span></td></tr><tr><td style='text-align:center;' ><span>原假设</span></td><td style='text-align:center;' ><span>拒绝原假设，接受备择假设</span></td><td style='text-align:center;' ><span>接受原假设</span></td></tr></tbody></table></figure><p><span>从特征工程的角度，我们希望选取卡方值很大，p值小于0.05的特征，即和标签是相关联的特征。我们可以直接各个特征所对应的卡方值求得P值，进而通过p值分析特征与标签之间的相关性：p值&lt;=α的特征是模型的有效特征，对模型预测起正向作用；p&gt;α的特征与标签相互独立，不存在相关性，属于无关特征，可以舍弃。</span></p><p><span>下面是卡方检验获得的各特征与标签之间p值动态折线图：</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span>1 特征工程是什么？</span>
<span>2 数据预处理</span>
<span>　　2.1 无量纲化</span>
<span>　　　　2.1.1 标准化</span>
<span>　　　　2.1.2 区间缩放法</span>
<span>　　　　2.1.3 标准化与归一化的区别</span>
<span>　　2.2 对定量特征二值化</span>
<span>　　2.3 对定性特征哑编码</span>
<span>　　2.4 缺失值计算</span>
<span>　　2.5 数据变换</span>
<span>3 特征选择</span>
<span>　　3.1 Filter</span>
<span>　　　　3.1.1 方差选择法</span>
<span>　　　　3.1.2 相关系数法</span>
<span>　　　　3.1.3 卡方检验</span>
<span>　　　　3.1.4 互信息法</span>
<span>　　3.2 Wrapper</span>
<span>　　　　3.2.1 递归特征消除法</span>
<span>　　3.3 Embedded</span>
<span>　　　　3.3.1 基于惩罚项的特征选择法</span>
<span>　　　　3.3.2 基于树模型的特征选择法</span>
<span>4 降维</span>
<span>　　4.1 主成分分析法（PCA）</span>
<span>　　4.2 线性判别分析法（LDA）</span></p><p>&nbsp;</p><p><span>聚类、样本相似性可以作电池的类型分析和主要失效模式分析</span></p><p>&nbsp;</p><p><strong><span>层次聚类</span></strong></p><p><span>层次聚类通过连续不断地将最为相似的群组两两合并，来构造出一个群组的层级结构。其中的每个群组都是从单一元素开始的。在每次迭代的过程中，层次聚类算法会计算每两个群组间的距离，并将距离最近的两个群组合并成一个新的群组。这一过程会一直重复下去，直至只剩一个群组为止。</span></p><p><span>假设有N个待聚类的样本，对于层次聚类来说，基本步骤就是：</span></p><ol start='' ><li><span>(初始化)计算样本与样本之间的相似度，将相似的样本聚为一类，常用的算法有欧氏距离、皮尔逊相关系数、余弦距离、Jaccard距离等；</span></li><li><span>然后寻找各个类之间最近的两个类，把他们归为一类(这样类的总数就少了一个)，计算类间距离算法常见的有SingleLinkage、CompleteLinkage和Average-linkage等，选择不同的距离指标，最终的聚类效果也不同，其中CompleteLinkage和Average-linkage用得比较多，因为产生的谱系图较为均衡；</span></li><li><span>重新计算新生成的这个类与各个旧类之间的相似度；</span></li><li><span>重复2和3直到所有样本点都归为一类，结束。</span></li></ol><p><span>生成层次聚类有两种基本方法：</span><strong><span>凝聚、分裂</span></strong><span>。</span></p><p><strong><span>凝聚</span></strong></p><p><span>在凝聚层次聚类中，我们从点作为单个聚类开始。在每一步，我们合并最近的一对集群。</span>
<span>这需要定义群集邻近度的概念。</span></p><p><strong><span>分裂</span></strong></p><p><span>在分裂的层次聚类中，我们从一个包罗万象的集群开始。在每一步，我们拆分一个集群。这个过程一直持续到只剩下单个单个点的集群。在这种情况下，我们需要做出决定在每个步骤拆分哪个集群怎么做分裂。</span></p><p><span>层次聚类是一组嵌套的聚类，它们被组织为树。层次聚类通常使用</span><strong><span>树状图</span></strong><span>，以图形方式显示，下图为实例图。</span>
<span>树形图显示集群 - 子集群关系和集群合并（凝聚）或分裂（分裂）的顺序。</span></p><p>&nbsp;</p><p><span>下面这个聚类划分动态图能更好地看出聚类算法的过程：</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p></div></div>

<script>(function(){var e=document.body.parentElement,t=[],n=null,i=document.body.classList.contains("typora-export-collapse-outline"),r=function(e,t,n){document.addEventListener(e,function(e){if(!e.defaultPrevented)for(var i=e.target;i&&i!=this;i=i.parentNode)if(i.matches(t)){!1===n.call(i,e)&&(e.preventDefault(),e.stopPropagation());break}},!1)};function o(){return e.scrollTop}r("click",".outline-expander",function(e){var t=this.closest(".outline-item-wrapper").classList;return t.contains("outline-item-open")?t.remove("outline-item-open"):t.add("outline-item-open"),d(),!1}),r("click",".outline-item",function(e){var t=this.querySelector(".outline-label");if(location.hash="#"+t.getAttribute("href"),i){var n=this.closest(".outline-item-wrapper").classList;n.contains("outline-item-open")||n.add("outline-item-open"),c(),n.add("outline-item-active")}});var a,s,l=function(){var e=o();n=null;for(var i=0;i<t.length&&t[i][1]-e<60;i++)n=t[i]},c=function(){document.querySelectorAll(".outline-item-active").forEach(e=>e.classList.remove("outline-item-active")),document.querySelectorAll(".outline-item-single.outline-item-open").forEach(e=>e.classList.remove("outline-item-open"))},d=function(){if(n){c();var e=document.querySelector('.outline-label[href="#'+(CSS.escape?CSS.escape(n[0]):n[0])+'"]');if(e)if(i){var t=e.closest(".outline-item-open>ul>.outline-item-wrapper");if(t)t.classList.add("outline-item-active");else{for(var r=(e=e.closest(".outline-item-wrapper")).parentElement.closest(".outline-item-wrapper");r;)r=(e=r).parentElement.closest(".outline-item-wrapper");e.classList.add("outline-item-active")}}else e.closest(".outline-item-wrapper").classList.add("outline-item-active")}};window.addEventListener("scroll",function(e){a&&clearTimeout(a),a=setTimeout(function(){l(),d()},300)});var u=function(){s=setTimeout(function(){!function(){t=[];var e=o();document.querySelector("#write").querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(n=>{var i=n.getAttribute("id");t.push([i,e+n.getBoundingClientRect().y])})}(),l(),d()},300)};window.addEventListener("resize",function(e){s&&clearTimeout(s),u()}),u()})();</script></body>
</html>